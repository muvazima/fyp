@&#MAIN-TITLE@&#Watermarking 3D CAPD models for topology verification

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose a novel watermarking scheme for topology verification of CAPD models.


                        
                        
                           
                           Watermark bits are embedded in a subset of the model’s connection points.


                        
                        
                           
                           It is a semi-fragile and blind watermarking scheme.


                        
                        
                           
                           It provides good tamper localization accuracy.


                        
                        
                           
                           It is robust against similarity transformations and simplification.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topological integrity

Topological tagging

Semi-fragile watermarking

Watermarking

Process plant

Connection points

@&#ABSTRACT@&#


               
               
                  The Computer-Aided Plant Design (CAPD) model characterizes its peculiar complex topology among a tremendous number of plant components under complex constraints rather than just geometrical shapes. Lots of watermarking schemes for CAD models have been proposed for geometrical information protection or authentication. However, in the literature, none of them has mentioned the problem of topology authentication for CAPD models yet. In this paper, a semi-fragile watermarking algorithm for topology authentication of CAPD models is presented. We first discuss the problem of topology authentication of CAPD models. Then a subset of the model’s connection points are selected as mark points, also called watermark carriers, according to the mark point selecting principle. We encode the topological relation among components into watermarks. Afterwards, the topology based watermarks are embedded in mark points to keep them in a predefined relationship with neighboring connection points so that any changes will ruin the relationship between marked connection points and neighboring connection points. To the best of our knowledge, our algorithm is the first semi-fragile and blind scheme that can authenticate and verify the topology of CAPD models. Experimental results show that our approach not only can detect and locate malicious topology attacks such as components modification and joint ends modification, but also is robust against various non-malicious attacks such as similarity transformations and simplification.
               
            

@&#INTRODUCTION@&#

Nowadays, process plant engineering is characterized by globalization. The design, engineering and construction of process plants often involve multidisciplinary team effort. Therefore, engineers and designers are increasingly focusing on a collaborative design approach with each other to survive in a competitive global environment. The Computer-Aided Plant Design (CAPD) system is an automatic solution designed specifically for process plant engineers and designers. It is devoted to increasing productivity, accuracy, and collaboration to meet the challenges of complex process plant design projects. With the wide application of CAPD systems, CAPD models may be copied and distributed frequently with an increase during the collaboration. Thus, the integrity, authentication and verification of CAPD models are critical to companies when sharing models with their collaborators. Digital watermarking has been considered as an efficient solution to solve this problem, and thus has been paid significant attention in recent years [1].

Digital watermarking techniques intend to hide some secret information (called a watermark) in the cover content to mark the digital data content. There exist different classifications of watermarking techniques. According to whether the original digital content is needed or not during the watermark extraction stage, watermarking techniques can be classified as non-blind or blind schemes. According to the intended application, we can also distinguish between robust watermark schemes and fragile watermark schemes. Robust watermark schemes indicate ownership, whereas fragile watermark schemes authenticate and verify digital content. Moreover, good fragile watermarking schemes should be able to survive in some possibly unintentional operations the digital content may undergo. This kind of fragile watermarking scheme is called a semi-fragile scheme. In this paper, we intend to develop a semi-fragile and blind watermarking scheme to authenticate and verify the topology integrity for CAPD models.

A CAPD model may be completely described by three kinds of information: the geometrical information describes the shape and 3D positions (coordinates) of all plant components, the topological information provides the adjacency relations among different plant components, while the engineering information refers to design constraints, engineering disciplines and so on. Even though the graphical representation of the results may look like a detailed engineering plant design, it has to be kept in mind that the aim of CAPD systems is only to optimize the plant layout [2]. The objective of plant layout design is to find the most economical spatial arrangement of process vessels and equipment and their interconnecting pipes that satisfy construction, operation, maintenance, and safety requirements [3]. This is an important aspect in the design of process plants since a good layout will ensure that the plant functions correctly and will provide an economically acceptable balance between the many, often conflicting, design constraints [4]. Therefore, the topological information is a significant part of integrity authentication for CAPD models.

However, in the literature, watermarking techniques proposed for CAD models mainly focus on addressing the problem of geometrical information protection or authentication. And among them the topology authentication problem of CAPD models, to the best of our knowledge, has not been mentioned in any reported literature. Hence, the issue of defining watermarking for topological information of CAPD models is still an unsolved problem. To address the issue of verifying the integrity of the topological information, we propose a semi-fragile watermarking scheme in this paper. The topological information is exploited to generate watermarks. We prefer embedding topology based watermarks into a subset of a model’s connection points to keep them in a predefined relationship with neighboring connection points so that any changes will ruin the relationship between the marked connection points and neighboring connection points.

The rest of this paper is organized as follows. We review some related works in Section 2; Section 3 gives a brief introduction of CAPD models; and Section 4 describes the proposed scheme. Experimental results that demonstrate our watermarking scheme performance are presented in Section 5. Conclusions and future work follow in Section 6.

@&#RELATED WORK@&#

Digital watermarking techniques for 3D models have been widely studied since Ohbuchi first proposed a watermarking scheme for 3D models [5]. However, relatively few watermarking algorithms have been proposed for CAD models especially for the topology integrity authentication of CAPD models. In this section, we mainly review some related works about watermarking 3D and 2D CAD models. Some watermarking schemes exploiting the topological relation of various models are also reviewed. These existing relevant works all target the geometrical information protection or authentication.

Watermarking schemes for 3D CAD models mainly target NURBS curves, subdivision surfaces, constructive solid geometry (CSG) models and CAD-based drawings represented by various geometric objects in some layers such as LINEs, ARCs, POLYGONs and 3DFACEs.

Ohbuchi et al. [6] presented a watermarking scheme for 3D NURBS curves using reparameterization. Their method is robust under affine transformations, but not under Möbius reparameterization. Lee et al. also presented a method for watermarking NURBS data using two-dimensional virtual images [7]. A fragile watermarking scheme for authenticating CSG models was proposed by Fornaro and Sanna [8]. It computes the watermark from selected attributes of the model and stores it in one or more places in the model itself. Weng et al. presented a method for watermarking 
                           T
                        -spline curves and surfaces by using knot insertion [9]. In order to watermark subdivision surfaces, Cheung et al. presented a robust non-blind watermarking scheme using modulating spectral coefficients of the subdivision control mesh [10]. Reuter et al. [11] introduced a method to extract Shape-DNA, a numerical fingerprint or signature, of any 2D or 3D manifold (surface or solid) by taking the eigenvalues (i.e. the spectrum) of its Laplace–Beltrami operator. It uses the sequence of eigenvalues (spectrum) of the Laplace operator of a planar domain or 3D solid or the Laplace–Beltrami operator of a surface or parameterized solid in Euclidean space as a fingerprint. A digital watermarking technique for 3D design drawing was proposed by Park et al. [12]. The scheme uses LINEs and 3D FACEs based on vertexes in CAD systems to prevent infringement of copyright from unlawful reproduction and distribution. Kwon et al. also proposed a watermarking scheme for 3D CAD drawings [13,14]. The approach arbitrarily selects the line, face, and arc components and embeds the watermark into the difference in length between the reference line and the connected lines in the case of line components, the circular radius in the case of the arc components, and the length ratio of two sides in the case of the face components. These schemes require the index and order of embedding components and the original point coordinates for watermark extraction. Therefore, they cannot detect watermarks when the components of the drawing are rearranged. A robust watermarking scheme based on geometric features with 
                           k
                        -means++ clustering for 3D CAD drawings was presented by Lee et al. [15]. The proposed scheme embeds the watermark into the geometric distribution of POLYLINE, 3DFACE, and ARC objects in the main layers.

A watermarking scheme for a 2D architectural design drawing using LINEs and ARCs based on vertexes was presented in [16]. It embeds the watermark into the LINE’s length and ARC’s angle information. Kwon et al. [17] proposed a digital watermarking for 2D CAD drawings. The watermark is embedded by using a self-adaptive algorithm related to the length of LINEs, angles of ARCs, and radii of CIRCLEs. It is robust against various attacks, such as geometrical transformation. A semi-fragile watermarking algorithm for authenticating 2D CAD engineering graphics based on log-polar transformation was proposed in [18]. The vertices are divided into groups, and the vertices for the watermark in each group are mapped to the log-polar coordinate system. Then the watermark is embedded in the mantissa of the real-valued log-polar coordinates via bit substitution. It is robust against incidental global operations such as rotation, translation, and scaling, and can detect and locate malicious attacks such as entity modification and entity addition/deletion. Peng et al. also proposed a reversible watermarking scheme for 2D CAD engineering graphics based on improved difference expansion [19]. The watermark is embedded into the scale factor of the relative coordinates by using improved difference expansion technology.

There exist some watermarking schemes which focus on geometrical information protection or authentication by exploiting the topological relation of target models. Rahman et al. presented a topology based watermarking method to embed information in objects for geometry sensitive 3D triangular mesh models [20,21]. They utilize the redundancy of topological information as well as the layered structure of the model to embed data by changing only the local numbering of the triangular patch of the model. Wang et al. proposed a new blind algorithm for watermarking a 2D vector map based on the spatial topology domain by hiding data in the spatial topological relation existing among map objects [22]. The geometric invariance property of the topological relation between map objects is exploited to embed watermarks in the spatial topological relation. A robust and blind watermarking method for 3D semi-regular triangular meshes based on wavelet decomposition was proposed by Beddiaf et al. [23]. The contribution of this paper is a new topological synchronization mechanism for the embedding and extraction schemes. The new topological synchronization mechanism is based on triangles traversal of a semi-regular mesh, which makes the watermark robust to noise regardless of the level of resolution. Huber et al. investigated the problem of computing so-called perturbation regions (MPR) of a planar straight-line graph [24]. Two different algorithms for MPR computing for every vertex are discussed. Watermarks are embedded by dislocating the vertices while still preserving the topology of the input data.

Process plants are complex facilities mainly consisting of equipment and pipelines (including pipes and piping components). Fig. 1
                      shows an example of a solid model of a hydrogenation plant. We first introduce the geometry and topology modeling of CAPD models in this section. Then we give a brief description of the topology authentication problem.

CAPD systems often involve more than just shapes. They mainly focus on providing an effective and efficient platform to concentrate on the layout of a tremendous number of plant components (equipment, pipes and piping components) under complex constraints. Plant components are normally modeled by basic entities, such as box, cylinder, prism, sphere and so on. Fig. 2
                         shows some entities used in CAPD systems.

In order to support the automatic generation of isometrics, orthographics, and other construction documents, which are directly exchanged with the 3D model, CAPD models are designed by using a parametric geometry modeling method. Only their geometric parameters and types rather than meshes are stored in the file. An example of a cone entity is shown in Fig. 3
                        . Plant components placed in a design model are parametric objects with a high degree of intelligence. Designers progressively construct a highly intelligent design database by placing instances of parametric components into the model.

Plant layout is an important part of the plant design. It is concerned with the most economical spatial arrangement of process vessels and equipment and their interconnections that satisfy construction, operation, maintenance, and safety requirements. The layout poses significant limitations on the type, size and location of plant components. Positions of plant components can be simply described by their absolute Cartesian coordinates. But how to represent the interconnections among plant components is a key issue of CAPD systems. Not only should the layout represent the interconnection between two plant components, but it should also describe their corresponding interconnection ends. Only the two ends of different plant components which satisfy pipe diameter, end type, pressure rating, and flow direction requirements can then be connected.

End connection can be mainly represented in two formats: connection points [25] and the order of plant components stored in the CAPD file. This paper aims to watermark CAPD models which describe the end connection by connection points since this format is the most widely used and effective representation for topology modeling.

Connection points can be classified into two kinds: invariant connection points and variant connection points. Invariant connection points are just to do with the structure of their plant components, while variant connection points are concomitant with some operations. For example, a new variant connection point will be added at the joint when we insert a nozzle into an equipment. Unlike pipes and piping components, the number of connection points any equipment may hold is unlimited in theory. Each connection point has the same attributes including geometrical information, topology constraint, handle value and various engineering properties. In general, a connection point is defined as the center point of the end face. And it is added, deleted and transformed along with its corresponding plant component in CAPD systems. Each connection point may have one joint connection point at most. The handle value is an abstract reference to an object. Each object in CAPD files has a unique handle value (i.e., an identification number), which is not changed even if the object is modified [18]. Fig. 4
                         shows a connection point data structure model, and Fig. 5
                         shows an application example in a plant detail.

The problem of topology authentication of CAPD models consists of two aspects. One is joint plant components authentication. The other is joint ends authentication. Joint plant components authentication aims to make sure whether the joint plant components of each plant component are changed or not, while joint ends authentication further verifies whether the exact joint ends between two joint plant components are modified or not. That is to say that, for each plant component, the problem of topology authentication targets verifying not only the joint components, but also the exact joint ends, since a plant component usually has more than one joint end.

We argue that, for topology authentication, connection points are the best candidates for data embedding for the following reasons.
                           
                              •
                              First, the topological relation among different plant components is described by their connection points.

Second, each end of plant components has one and only one associated connection point. And connection points are by definition the least likely to be removed among the types of data objects that exist in CAPD models. Moreover, the deletion of connection points will inevitably lead to incorrectly generating construction documents.

Third, connection points are within 3D CAPD models. There are two main kinds of displaying mode for CAPD systems: solid mode and wireframe mode. There is no doubt that they are fully invisible to viewers in the solid mode. For the wireframe mode, one could also hardly perceive the slight modification of connection points due to their small size and small contribution to the final scene.


                        Fig. 6
                         shows the flowcharts of the proposed watermark embedding and extraction procedures.

In the watermark embedding part, for each pipeline, the scheme first selects the mark point for each plant component following the mark point selecting principle. After that, the watermark embedding part modifies the mantissa of the real-valued sphere-polar coordinates through bit substitution for the mark point of each component according to the watermarks embedding method. Finally, it generates the watermarked model.

In the watermark extracting part, for each pipeline, we traverse all of the connection points of each plant component to find whether the plant component has one and only one mark point. The scheme first extracts the mantissa of the real-valued sphere-polar coordinates 
                           
                              (
                              r
                              ,
                              θ
                              ,
                              φ
                              )
                           
                        . Then watermark bits for the connection point are generated according to the content-based watermark generation method. Finally, we check whether the connection point is a mark point or not according to the tamper detection method. Only if the plant component has one and only one mark point can we then make sure that the plant component has not been modified. Otherwise, the tampering plant component is located accurately and reported visually.

In the following part, we call the connection points to be watermarked as mark points and the other points as non-mark points.

In this section, we describe how to select for each component a single mark point from the set of all of its connection points, as follows. Let 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         be a component with 
                           
                              
                                 n
                              
                              
                                 i
                              
                              
                                 p
                              
                           
                         connection points and let 
                           L
                         be a given pipeline in a plant model composed of 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                         such components, 
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              ]
                           
                        . Further, let the set of connection points 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         be given by 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ,
                              j
                              ∈
                              
                                 [
                                 0
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 −
                                 1
                                 ]
                              
                              }
                           
                        . Then 
                           S
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                         is the 1-ring of 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         defined by: 
                           
                              (1)
                              
                                 S
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ∖
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    }
                                 
                                 ⋃
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 p
                              
                              
                                 m
                                 ,
                                 n
                              
                           
                           ∈
                           
                              
                                 P
                              
                              
                                 m
                              
                           
                         is the connection point belonging to a connected component 
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                         in 
                           L
                         that joins with 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         is the 1-ring belonging to the 
                           j
                        -th connection point of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        . In Eq. (1), 
                           C
                           a
                           r
                           d
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , 
                           C
                           a
                           r
                           d
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    m
                                 
                              
                              )
                           
                           ≥
                           1
                        , 
                           C
                           a
                           r
                           d
                           
                              (
                              
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 }
                              
                              )
                           
                        , 
                           C
                           a
                           r
                           d
                           
                              (
                              
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 }
                              
                              )
                           
                           =
                           1
                        , and 
                           C
                           a
                           r
                           d
                           
                              (
                              S
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                              )
                           
                           =
                           C
                           a
                           r
                           d
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        .

We traverse each pipeline of the model, according to its flow direction, from one end to the other end and choose mark points following the discipline below. 
                           
                              •
                              Each plant component has one and only one mark point.

One of the two connection points of two joint ends should be selected as a mark point.

The connection point chosen as a mark point must have no mark point among its 1-ring neighboring connection points. Once a connection point has been chosen as a mark point, its 1-ring neighboring connection points are no longer eligible.

Note that those isolated plant components, which have no joint plant components, are not taken into consideration for topology authentication in our scheme.


                        Fig. 7
                         gives an example of our mark points selection of a simple pipeline. The black points 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                           
                           
                              (
                              i
                              ∈
                              
                                 [
                                 0
                                 ,
                                 8
                                 ]
                              
                              )
                           
                         are mark points while the white points are non-mark points. For example, the 1-ring neighbors of 
                           
                              
                                 p
                              
                              
                                 4
                                 ,
                                 0
                              
                           
                         are 
                           S
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    4
                                    ,
                                    0
                                 
                              
                              )
                           
                           =
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    3
                                    ,
                                    1
                                 
                              
                              }
                           
                           ⋃
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    4
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    4
                                    ,
                                    2
                                 
                              
                              }
                           
                           =
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    3
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    4
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    4
                                    ,
                                    2
                                 
                              
                              }
                           
                        .

The union of all mark points should cover the whole model so that all of the plant components are protected. However, there might still be some plant components with no mark points according to the above mark point selecting principle. These plant components are always located at the end of a pipeline according to its flow direction. Fig. 8
                         shows an example of a plant component 
                           
                              
                                 C
                              
                              
                                 5
                              
                           
                         with no mark point assigned in a pipeline. For these plant components, we randomly select one of their connection points, which has not been included in their joint mark point’s 1-ring neighbors, as a mark point. Take the plant component 
                           
                              
                                 C
                              
                              
                                 5
                              
                           
                         for example, 
                           
                              
                                 p
                              
                              
                                 5
                                 ,
                                 1
                              
                           
                         is selected as a mark point since 
                           
                              
                                 p
                              
                              
                                 5
                                 ,
                                 0
                              
                           
                         has been included in the 1-ring neighbors of its joint mark point 
                           
                              
                                 p
                              
                              
                                 4
                                 ,
                                 1
                              
                           
                        .

As a sequence, it can be guaranteed that the 1-ring neighbors of all mark points cover the whole model according to our mark point selecting principle. And the selected mark points are uniformly distributed in the model so that all plant components are protected. Therefore it results in high locating accuracy for each joint end.

In order to improve the accuracy of tampering detection, a content-based watermark generation method is proposed by exploiting the topological information.

First, we define 
                           T
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           =
                           
                              {
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                           
                         connected with 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        , 
                           j
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              ]
                           
                        , 
                           
                              j
                              ≠
                              i
                              }
                           
                         as the set of topologically connected components of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        . 
                           C
                           a
                           r
                           d
                           
                              (
                              T
                              
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              )
                           
                           =
                           
                              
                                 n
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                        . 
                           
                              
                                 n
                              
                              
                                 i
                              
                              
                                 c
                              
                           
                           ≤
                           4
                         in this work since most of the common plant components have no more than 3 ends in general except the component ‘Cross’ with 4 ends. Note that the isolated plant components are not taken into account. Let the handle value of 
                           
                              
                                 C
                              
                              
                                 j
                              
                           
                         be 
                           
                              
                                 h
                              
                              
                                 j
                              
                           
                         respectively. These unique handle values are not changed even if the entity is modified [18]. And they are involved in the construction of the watermark bits in order to protect the interconnection among 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         and its joint plant components 
                           T
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        .

Given that the mark point of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         is 
                           p
                        , we generate 
                           b
                         bits watermark strings for 
                           p
                         according to the handle values 
                           
                              
                                 h
                              
                              
                                 j
                              
                           
                        . These handle values are first arranged in ascending order and are then denoted as 
                           
                              
                                 h
                              
                              
                                 j
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              ∈
                              
                                 [
                                 1
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 ]
                              
                              )
                           
                        . Then the 
                           b
                         bits watermark strings 
                           w
                         for 
                           p
                         can be generated by 
                           
                              (2)
                              
                                 
                                    w
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    S
                                    e
                                    l
                                    
                                       (
                                       h
                                       a
                                       s
                                       h
                                       
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       K
                                       )
                                    
                                    ,
                                    
                                    i
                                    ∈
                                    
                                       [
                                       1
                                       ,
                                       n
                                       ]
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    n
                                    =
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                       
                                          c
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                b
                                                ,
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   ⌊
                                                   b
                                                   /
                                                   n
                                                   ⌋
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      n
                                                   
                                                
                                                =
                                                b
                                                −
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                             
                                                n
                                                >
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    b
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    K
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           h
                           a
                           s
                           h
                           
                              (
                              )
                           
                         is a hash function, 
                           S
                           e
                           l
                           
                              (
                              f
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ,
                              K
                              )
                           
                         is a function that selects 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         bits from the mantissa parts of the floating-point number 
                           f
                         in a random fashion under the control of a secret key 
                           K
                        . The maximum handle value of handle values 
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                         is set as the key 
                           K
                         for the mark point 
                           p
                        . That means the secret key 
                           K
                         depends on the topological relation among 
                           p
                         and its joint plant components. The topology modification of the mark point 
                           p
                         must lead to the changing of the key 
                           K
                        . For a specified floating-point number 
                           f
                        , different values of 
                           K
                         will result in different 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         bits strings. Consequently the security of the watermark bits 
                           w
                         is enhanced by virtue of this strategy.

For a selected mark point 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , we first find its 1-ring neighbors 
                           S
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         according to the mark point selecting principle described in Section 4.3. Then, we calculate the center 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         of its 1-ring neighboring points by 
                           
                              (3)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   c
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      C
                                                      a
                                                      r
                                                      d
                                                      
                                                         (
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   c
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      C
                                                      a
                                                      r
                                                      d
                                                      
                                                         (
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   c
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      C
                                                      a
                                                      r
                                                      d
                                                      
                                                         (
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           S
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the set of neighboring points of 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        . No two 1-ring centers coalesce and as a result, no pair 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                        , 
                           j
                           ≠
                           i
                        , can coalesce either.

Given that 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         is the origin of the spherical polar coordinate system after transformation, we transform the cartesian coordinates 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         of 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         into sphere-polar coordinates 
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                        
                           
                              (4)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             arccos
                                             
                                                (
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             arctan
                                             
                                                (
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Afterwards, we embed the same 
                           b
                         bits watermark strings 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         of 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         into 
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                         (treated as IEEE-754 double-precision floating-point numbers) by modifying their bit notations. The modified bit positions are parameters of our scheme, namely, 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                        . 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                         are the distance from the point to the lower bit and to the higher bit respectively: 
                           
                              (5)
                              
                                 b
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       L
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       H
                                    
                                 
                                 +
                                 1
                                 .
                              
                           
                         We select 
                           b
                         bits each from the mantissa parts of 
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                         according to 
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        , and substitute them with the same 
                           b
                         bits watermark strings 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        . Invisibility refers to the property that the watermarked content is perceptually equivalent to the original, unwatermarked content. Higher invisibility is obtained by lower positions in our method. And higher robustness against malicious attacks through unauthorized modification is obtained by higher positions. Finally, we perform the reverse spherical polar transformation on the watermarked mark point.

In this section, we describe the procedure used to accurately locate the tampering joint ends of plant components for each pipeline in the model.

For each plant component 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         in a pipeline, we traverse all its ends to see if it has a mark point. For each connection point 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        , we first find its 1-ring neighbors. Then we apply a sphere-polar transformation to 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         according to Eq. (4) and take 
                           b
                         bits from the mantissa parts of 
                           r
                        , 
                           θ
                         and 
                           φ
                         according to 
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        . Let the three bit sequences generated be 
                           
                              
                                 w
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 r
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 θ
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 φ
                              
                           
                         respectively. Afterwards, we calculate the watermark bits 
                           
                              
                                 w
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         for 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         according to the content-based watermark generation method. Finally we verify if 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is a mark point and do topology verification by checking the Boolean of 
                           t
                           a
                           g
                        , 
                           
                              (6)
                              
                                 t
                                 a
                                 g
                                 =
                                 B
                                 o
                                 o
                                 l
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          r
                                       
                                    
                                    =
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             θ
                                          
                                       
                                       =
                                       =
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       ‖
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          φ
                                       
                                    
                                    =
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           ∥
                         is a Boolean logical operator OR. Only if the predefined condition 
                           t
                           a
                           g
                           =
                           =
                           t
                           r
                           u
                           e
                         is satisfied can we then set 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         as a mark point.

If 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         has no mark point or more than one mark point, it suggests that the topology relationship among 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         and its joint plant components has been changed since each plant component has one and only one mark point.

The objective of our scheme, for each plant component, is to authenticate its joint components and furthermore the exact joint ends. Therefore, we discuss the performance on detecting the modifications on the model from the following two aspects: components specific attacks and joint ends specific attacks. Components attacks mainly include adding and deleting components, while joint ends attacks include disconnecting the two joint ends geometrically and logically respectively. These unauthorized modifications are common in practical design processes. As discussed later, the proposed scheme in this paper can detect these kinds of modifications on CAPD models.


                           
                              
                                 •
                                 
                                    Components addition. Without loss of generality, we assume that 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is the component to be added, and 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is connected with an existing component 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                    . One could only insert new components successfully when having access to the secret hash key 
                                       K
                                    . Therefore, the newly added component 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     will have no watermarked mark point according to the mark point selecting and embedding principle described in Sections 4.3 and 4.5 respectively.

During the watermark verification stage, there exist two situations when a component is added which is shown in Fig. 9
                                    . One is that 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                     is a non-mark point, then 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                     will be inevitably selected as a mark point shown in Fig. 9(a) according to the mark point selecting principle. Thus the extracted mantissa parts from 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                     will not match Eq. (6) since no watermark bits have been embedded into it. The other is that 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                     is a mark point shown in Fig. 9(b). Then the newly added component 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     will change the centroid of the neighborhood of the mark point 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                    . As a result, the extracted watermark will not match Eq. (6). Meanwhile, one of the two connection points 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             2
                                          
                                       
                                     of 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     will be selected as a mark point according to the mark point selecting principle. And the extracted mantissa parts will not match Eq. (6) too, since it is not watermarked. As a consequence, the topology modification between 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                     will be detected and located accurately for both of the two situations above.


                                    Components deletion. Component deletion modifies the topological relation of the model. Without loss of generality, we also assume that 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is the component to be deleted, and 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is connected with an existing component 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                    . Generally, component deletion can be classified into two categories shown in Fig. 9. The first category is that 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                     is a non-mark point. Then during the watermarking verification, the generated watermark for 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             0
                                          
                                       
                                     will be different from the original watermark according to the watermark generation principle. The second category is that 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                     is a mark point. Thus, during the watermarking verification, the 1-ring neighbors and its centroid will be changed and the generated watermark for 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                     will be modified too. So that for all situations this will lead to incorrect verification, and thus the topology modification induced by components deletion is detected.


                           
                              
                                 •
                                 
                                    Disconnect the two joint ends geometrically. This kind of topology attack separates one end from the other end geometrically while keeping their topological relation logically. At least one connection point will be alerted under this situation. The modified connection point may be a mark point or a non-mark point. The spherical polar coordinates 
                                       
                                          (
                                          r
                                          ,
                                          θ
                                          ,
                                          φ
                                          )
                                       
                                     of the point will be changed if it is a mark point, while the coordinates 
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                c
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                     will be modified if it is a non-mark point, which will also lead to the modification of the value 
                                       
                                          (
                                          r
                                          ,
                                          θ
                                          ,
                                          φ
                                          )
                                       
                                    . Therefore the extracted watermark will be different from the original, and subsequently the geometrical modification is detected.


                                    Change the topological relation between two joint ends logically. This kind of topology attack changes the connection between two joint ends logically while keeping the coordinates of their connection points unmodified. As described in Section 4.3, one of the two joint ends must have a mark point. Thus, the 1-ring neighbors of the mark point will be modified. And the original watermark generated for the mark point according to the method described in Section 4.4 will be alerted too. Consequently, the extracted watermark will be different from the original and the attack will be detected.

A good semi-fragile watermarking scheme should be invariant to translation, rotation, uniform scaling and simplification operations. These operations do not change the integrity of the original model and should not be regarded as attacks.

The objective of performing spherical polar transformation is to obtain invariance against rotation, uniform scaling and translation (RST) in this paper. We analyze the robustness against similarity transformation in this section provided that 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is a selected mark point and 
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                            is the geometric center of 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           ’s 1-ring neighboring connection points in the Cartesian coordinate system. 
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                            corresponds to the origin of the spherical polar coordinate system. 
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is the sphere-polar coordinates of 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                            after spherical polar transformation. 
                              
                                 •
                                 
                                    Rotation. Without loss of generality, we rotate 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                     about an arbitrary axis by the angle 
                                       ϕ
                                    , provided that the axis passes through the origin, since we do not consider the translation at the moment. The axis is defined by a unit vector 
                                       n
                                       =
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                z
                                             
                                          
                                          )
                                       
                                    . Then the new coordinates of 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                     after rotating about 
                                       n
                                     can be written 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       R
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                r
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                       R
                                     respectively.

The matrix 
                                       R
                                     can be constructed by three basis vectors 
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                    , 
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    , and 
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                    : 
                                       
                                          (7)
                                          
                                             R
                                             =
                                             
                                                [
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                     where 
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            cos
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            cos
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               cos
                                                               ϕ
                                                               )
                                                            
                                                            +
                                                            cos
                                                            ϕ
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                .
                                             
                                          
                                       
                                     The corresponding new spherical polar coordinates 
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                     can then be computed by 
                                       
                                          (8)
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              r
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              r
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              r
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              r
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              r
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              r
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         =
                                                         arccos
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           r
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         =
                                                         arctan
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           r
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           r
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     then we get 
                                       
                                          (9)
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                     which means the component 
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                     is not changed under rotation. Thus, our scheme is invariant to rotation.


                                    Uniform scaling. We apply scale independent of the coordinate system used by scaling in an arbitrary direction. We will define 
                                       n
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                z
                                             
                                          
                                          )
                                       
                                     to be the unit vector parallel to the direction of scale, and 
                                       k
                                     be the scale factor to be applied about the plane that passes through the origin and is perpendicular to 
                                       n
                                    . Then the new coordinates of 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                     after scaling about 
                                       n
                                     can be written 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                          
                                             s
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       S
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                          
                                             s
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                s
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                       S
                                     respectively. The matrix 
                                       S
                                     can be constructed by three basis vectors 
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    , 
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    , and 
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                    : 
                                       
                                          (10)
                                          
                                             S
                                             =
                                             
                                                [
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                     where 
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  z
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               k
                                                               −
                                                               1
                                                               )
                                                            
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                .
                                             
                                          
                                       
                                     The corresponding new spherical polar coordinates 
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                     can then be computed by 
                                       
                                          (11)
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              s
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              s
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              s
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              s
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         arccos
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           s
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           s
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         arctan
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           s
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           s
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           s
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           s
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     then we have 
                                       
                                          (12)
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     which means the components 
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                     keep unchanged under uniform scaling. So the proposed scheme is robust against uniform scaling.


                                    Translation. Given a translation by a vector 
                                       v
                                       =
                                       
                                          (
                                          Δ
                                          x
                                          ,
                                          Δ
                                          y
                                          ,
                                          Δ
                                          z
                                          )
                                       
                                    , the new coordinates of 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                     can be written 
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          Δ
                                          x
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          Δ
                                          y
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          Δ
                                          z
                                          )
                                       
                                     and 
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                c
                                                t
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                c
                                             
                                          
                                          +
                                          Δ
                                          x
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                             
                                                c
                                             
                                          
                                          +
                                          Δ
                                          y
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                             
                                                c
                                             
                                          
                                          +
                                          Δ
                                          z
                                          )
                                       
                                     respectively. Then the corresponding new spherical polar coordinates 
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                     can be computed by 
                                       
                                          (13)
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              t
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              t
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              c
                                                                              t
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         arccos
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           t
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         arctan
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           t
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           c
                                                                           t
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     then we have 
                                       
                                          (14)
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     which means the components 
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                    , and 
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                     are the same. Therefore, we can see that our scheme is invariant to translation.

As the complexity of process plant models increases, the enormous size of these CAD data sets poses a number of challenges in terms of interactive display and manipulation. Simplification is a key technology to reduce the model complexity and improve the rendering performance for large scale complex CAPD models. However, connection points and topological relation among plant components will not be influenced by simplification since it can only change the levels of detail of entities. Therefore, the 1-ring neighboring points set of each mark connection point will not be affected. Subsequently it will not change the centroid of the neighborhood of mark points. As a result, our scheme is robust against simplification.

@&#EXPERIMENTAL RESULTS@&#

In this section, we evaluate our semi-fragile watermarking scheme against various attacks on a set of CAPD models. Fig. 10
                         shows the three models used for experiments. Table 1
                         gives the detailed information about the three models. Parameters are set as follows: 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                           =
                           18
                        , 
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                           =
                           10
                        . Our scheme is implemented on a Intel Core i5-2450M 2.50 GHz Notebook, with 4 GB of RAM. The processing time needed for the three tested models in our experiment varies from about 1 to 3 min, which depends on the model complexity.


                           Fig. 11
                            illustrates our scheme on a hydrogenation plant model shown in Fig. 10 and the detected changes by our scheme. Fig. 11(a) shows part of the original hydrogenation plant model. The hydrogenation plant has 32624 connection points; 10847 connection points are selected as mark points. Fig. 11(b) is the same view of the watermarked model, which is visually identical to the original model. Fig. 11(c), (e), (g) and (i) show a close view of part of the marked hydrogenation plant model that has been changed by joint components modification and joint ends modification respectively. The regions labeled A, B, C, and D denote the regions of joint components addition, joint components deletion, disconnecting the two joint ends geometrically and changing the topological relation between two joint ends logically, respectively. Our scheme locates these changed regions by setting all detected suspicious plant components as suspicious regions. Fig. 11(d), (f), (h) and (j) illustrate the located suspicious plant components in red. From Fig. 11(d), (f), (h) and (j) we can find that the regions in red are exactly where the tampering operations happen. The experimental results verify the accuracy of our locating procedure.

We evaluated the robustness against various operations provided by CAPD systems that can be considered to be non-malicious attacks on the design model. The robustness is evaluated in terms of the bit error rate (
                              B
                              E
                              R
                           ) of the extracted watermark bit sequences, as well as the correlation coefficient 
                              C
                              o
                              r
                              r
                            between the extracted binary sequence 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                            and the originally embedded one 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                            as given by the following equation [26]: 
                              
                                 (15)
                                 
                                    C
                                    o
                                    r
                                    r
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                                ¯
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   o
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                                ¯
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                            ¯
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                            
                                                            ¯
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          s
                                       
                                    
                                 
                                 ¯
                              
                            and 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          o
                                       
                                    
                                 
                                 ¯
                              
                            indicate the averages of the watermark bit sequence 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                            respectively. This correlation value measures the similarity between two watermark bit sequences and varies between −1 (orthogonal strings) and +1 (the same strings).

For each plant component, we set it as untampered if the values of 
                              B
                              E
                              R
                            and 
                              C
                              o
                              r
                              r
                            are 0 and 1 respectively. Otherwise the plant component is detected as tampered. Let 
                              
                                 
                                    N
                                 
                                 
                                    c
                                 
                              
                            be the number of plant components in a model and 
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                            be the number of plant components detected as tampered. Table 2
                            details the 
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              /
                              
                                 
                                    N
                                 
                                 
                                    c
                                 
                              
                            of the three models after various non-malicious attacks. And we can find that our scheme is robust against these non-malicious operations.

We measure the objective distortion of plant components and connection points induced by watermarking between the original and watermarked CAPD models by Metro [27] in terms of maximum root mean square error (MRMS) and peak signal-to-noise ratio (PSNR) [15] respectively, 
                              
                                 (16)
                                 
                                    
                                       PSNR
                                    
                                    =
                                    10
                                    lg
                                    
                                       
                                          
                                             
                                                
                                                   MAX
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             MSE
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          MAX
                                       
                                       =
                                       max
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          o
                                          ‖
                                       
                                       ,
                                       
                                       i
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          N
                                          −
                                          1
                                          ]
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          MSE
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            are the corresponding connection points in the original model and watermarked model, 
                              o
                            is the geometric center of the model, 
                              N
                            is the number of connection points, 
                              
                                 ‖
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ‖
                              
                            is the Euclidean distance between these two connection points.

From Table 3
                           , we can see that the MRMS values of plant components are all 0, since our scheme does not modify the geometric parameters of plant components. The PSNR values of connection points are also listed in Table 3. According to the embedding algorithm described in Section 4.5, we know that the embedding distortion of connection points depends on the bit positions where the watermarks are embedded and the length 
                              b
                            of the watermark. And the PSNR values are inversely proportional to the number of watermark bits 
                              b
                           .

Note that our approach prefers the connection points, which are integral parts of CAPD models, instead of geometric parameters of plant components themselves as watermark carriers. That means our watermark embedding scheme will not modify the geometric parameters of plant components and the topological relation among components. As a consequence, our scheme will have no influence on the design and automatic generation of various construction documents. Thus, our scheme is also functionally imperceptible.

@&#CONCLUSIONS AND FUTURE WORK@&#

This paper is the first paper, to the best of our knowledge, to report and analyze the problem of topology authentication and verification for CAPD models. A semi-fragile and blind watermarking scheme is proposed to address the problem of authenticating topology integrity. We generate content-based watermark bits for each plant component by taking their topological relation into consideration. And the watermark bits are embedded into a subset of the model’s connection points which are uniformly distributed in the model. Theoretical analysis and experimental results show that our scheme has a strong ability to detect and locate malicious attacks such as components modification and joint ends modification. And it is proven to be robust against various non-malicious attacks, such as transformation, rotation, uniform scaling and simplification. It is believed that the proposed scheme can make a valuable and industry-relevant contribution to the topology authentication of CAPD and other CAx models.

There are two main drawbacks in our scheme. First, we generate the watermark through hashing the handle values of plant components and embed it in the middle bits of the mantissa field of the coordinates of connection points. Therefore, our scheme strikes a good balance between the contrasting requirements of low embedding distortion and high resolution of tampering localization. Second, our scheme can only authenticate and verify the topology integrity. To date, the authentication of geometrical parameters of plant components has not been taken into consideration in our scheme. Our future research will focus on taking both geometrical and topological information into consideration for integrity authentication and verification.

@&#ACKNOWLEDGMENTS@&#

This work is supported by the National Natural Science Foundation of China (No. 61170250, and No. 61103201). The models used in this paper are courtesy of Beijing Zhongke Fulong Computer Technology Co., Ltd. The authors also gratefully acknowledge the helpful comments and suggestions of the reviewers, which have improved the presentation.

@&#REFERENCES@&#

