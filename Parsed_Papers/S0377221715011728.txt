@&#MAIN-TITLE@&#Optimisation models for expanding a railway's theoretical capacity

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Analytical models were introduced for railway capacity expansion planning.


                        
                        
                           
                           Track duplications and track sub divisions were used to expand the network and its capacity.


                        
                        
                           
                           Profiles of train speed and sectional running time were incorporated.


                        
                        
                           
                           The expansion models were successfully applied to a case study and their worth is demonstrated.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Railways

Railway capacity

Railway capacity expansion

Theoretical capacity

@&#ABSTRACT@&#


               
               
                  Changing the topology of a railway network can greatly affect its capacity. Railway networks however can be altered in a multitude of different ways. As each way has significant immediate and long term financial ramifications, it is a difficult task to decide how and where to expand the network. In response some railway capacity expansion models (RCEM) have been developed to help capacity planning activities, and to remove physical bottlenecks in the current railway system. The exact purpose of these models is to decide given a fixed budget, where track duplications and track sub divisions should be made, in order to increase theoretical capacity most. These models are high level and strategic, and this is why increases to the theoretical capacity is concentrated upon. The optimisation models have been applied to a case study to demonstrate their application and their worth. The case study evidently shows how automated approaches of this nature could be a formidable alternative to current manual planning techniques and simulation. If the exact effect of track duplications and sub-divisions can be sufficiently approximated, this approach will be very applicable.
               
            

@&#INTRODUCTION@&#

@&#BACKGROUND@&#

This article considers the expansion of railways in order to increase their capacity. Considering how a railway network should be upgraded to meet increased demand, and to facilitate superior train scheduling is an important activity of government planners and railway operators. This is an important topic in the transportation field and is particularly important in countries like Australia (Singh et al., 2012) that have to transport increasing volumes of goods and passengers across large distances by road, rail, air and sea.

The expansion of railways, and their associated infrastructure, is typically considered when there is lack of actual or perceived capacity. In those circumstances some form of analysis is typically performed to understand the current and future requirements of the railway system in question. Infrastructure expansions considered generally involve the following: (i) the positioning and construction of new sidings and signals, (ii) the duplication of existing sections of rail with the same gauge of rail, and (iii) the upgrading or replacement of existing corridors to different gauge tracks. The use of different rolling stock (i.e. faster trains) may also be considered as an avenue for increasing the capacity of a railway network. Unfortunately funding for these activities is rarely consistent, i.e. it is ad-hoc and often limited by “political” forces. Hence extensions are not performed until capacity limitations have become a more serious issue, and have been present for a significant period of time. When funding does become available the idea is typically to perform a set of specific changes. Those changes should not exceed the funding available otherwise partial solutions can only be realised and any extensions that do occur can be somewhat narrow sighted. Another issue with infrastructure expansion is that current decisions affect future ones. For instance future extensions are based upon the previous layout – which is fixed. Previous expansion decisions cannot be easily unmade, for example if they are incorrect, as the cost is prohibitive.

Determining where to build new railway corridors and networks and how to “configure” and “arrange” them is another important task. For reference purposes the cost of laying tracks in 2003 in Western Australia (by John Holland) was between $83k (standard gauge) and $120k (dual gauge) per kilometre (WestNet Rail Report). In another report the cost of performing earthworks in the same region for completely new sections of rail was of the order of $200k per linear kilometre in 2007 (Economic Regulation Authority). It might be inferred from past projects that upgrading and duplicating tracks are better options than building new railway corridors as earthwork costs are less. The cost of duplication however can vary greatly as it is affected by the availability of land adjacent to each section, and the type of buildings and structures present and adjacent, above and below the ground. For the most recent information concerning earthwork activities and costs, in road and rail linear infrastructure projects, articles like Burdett and Kozan (2014a, 2014b) can be consulted.

In many countries it is necessary to jointly consider the upgrading of railways as opposed to merely expanding existing ones. Hence it is necessary to view expansion in the context of building high speed rail (HSR) networks or to improve existing freight transportation. With respect to the former, HSR increases capacity on existing routes, and alleviates road and airport congestion, or severe bottlenecks. The cost of HSR however is substantially higher than conventional rail as new signalling mechanisms and more powerful electrification is needed. In addition HSR performs poorly if trains have frequent stops (De Rus, 2008). Hence there is little evidence to justify it when considering time savings alone (De Rus & Nombela, 2007). According to America's freight challenge the construction of HSR also represents a permanent, high-cost investment which will be stranded if business needs change. The high cost and risk of expansion limits the railroads’ ability to “scale up” capacity to meet shifting demand. With respect to the later Racunica and Wynter (2005) have reported that freight transportation cannot typically be increased because of the requirement for passenger trains to be used on the same network. In order to be more competitive, the use of sub-networks of dedicated or semi-dedicated freight rail lines is required. Nash (1991) has also reported that HSR is of limited benefit to freight and that it is more beneficial when extra capacity is needed (i.e. because there is a known limitation); as opposed to supplanting existing slower routes.

This article introduces and advocates mathematical techniques for high level strategic capacity planning. In essence they consider how physical bottlenecks can be removed from within a railway system. Consequently they determine how best to expand a railway's theoretical capacity with the secondary intention that operational capacity will also be increased, albeit at a reduced level. No pretence is made that complete accuracy is provided. To be clear, the approach intentionally neglects some real life aspects, but seeks to be sufficiently close to real life as it needs to be. This approach provides a reference point to compare other approaches, for example those for determining operational capacity. The results of simulation activities can also be compared to this reference point. The alternative to this approach is to specifically sequence and schedule a set of trains (i.e. Burdett & Kozan, 2009, 2010a, 2010b; D'Ariano, Pacciarelli, & Pranzo, 2007; Liu & Kozan, 2009, 2011) or to perform lengthy and detailed simulations (Giandomenico, Fantechi, Gnesi, & Itria, 2013). As capacity expansion planning is a network design problem, the feasibility of those approaches is questionable and problematic because they need to be applied to a specific railway structure. Furthermore train scheduling problems are computationally intractable and become considerably harder to solve as the problem size increases.

This article builds upon the approach of Burdett and Kozan (2006, 2015a, 2015b) and Kozan and Burdett (2005) which determines the theoretical capacity of a railway. It is the theoretical maximum number of trains that can utilise the network over time and is an ideal level that only occurs when critical sections of rail are saturated (i.e. continuously occupied) and train “interaction effects” and “interference delays” that are resolved by proper train scheduling, are ignored. Although theoretical capacity is an overestimation of real “operational” capacity, past research has shown that it is sufficiently accurate for high level planning purposes, thus provides a robust metric for benchmarking.

The Burdett and Kozan (2006) approach can be used to ascertain whether the railways capacity is a specified level, and whether there is free capacity for additional trains. In contrast, the purpose of this article is to determine which sections should be duplicated and which ones should be sub-divided, in order to increase the theoretical capacity most. The aforementioned approach has been extended because it is generic and robust. This article however includes significant changes, modifications and improvements. It provides a clear proof of concept, and shows that the aforementioned capacity analysis approach can be extended for capacity expansion planning.

Some of the techniques for railway capacity analysis could be the basis for models that expand railway capacity. Hence a brief summary of those techniques are first reviewed. The analytical approach of Mussone and Wolfler (2013) is noteworthy as it extends the work of Burdett and Kozan (2006). They developed a model that takes into account junctions and other more complex nodes and stations. Interference probabilities between trains are also taken into account. Yaghini, Nikoo, and Ahadi (2014) also proposed a railway capacity model and applied it to several case studies in Iran. Their model is based upon a prior binary multi-commodity network design formulation and a space-time representation of the network. Conceptually its nature is very similar to the model of Burdett and Kozan (2006) however it does additionally provide a saturated schedule at extra computational cost and complexity. Burdett (2015a) has formulated and solved a comprehensive set of multi-objective models that perform a trade-off analysis of theoretical capacity, for a clearly defined set of competing capacity metrics. In particular those models determine the theoretical capacity as the most equitable solution, and also provide a set of non-dominated solutions for later analysis and comparison. In Bevrani, Burdett, and Yarlagadda (2015) an optimisation approach was applied to a case study of the Iran national railway in order to identify its current theoretical capacity and to optimally expand it given a variety of technical conditions. In that paper an in depth sensitivity analysis of capacity was performed. That article tentatively demonstrates how an analytical approach for capacity expansion is more efficient to a manual process. It provides significant motivation for this article which more comprehensively addresses the topic of capacity expansion.

The aforementioned articles are analytical in nature and for the most part do not address railway capacity expansion per se. There are however many other articles whose approach is more empirical. For example Shih, Dick, Sogin, and Barkan (2014) have performed an analysis to identify the best option for expanding a single track railway lines involving sidings. A set of baseline alternatives was created and an incremental approach to duplicating tracks was taken. Froidh, Sipila, and Warg (2014) considered the imbalance in train speeds on Scandinavian rail networks that cause reductions in capacity utilisation. A timetable analysis and some simulations were performed. In that analysis train speed increments were considered. Giandomenico et al. (2013) developed a stochastic model for railway operation simulation. This simulation approach can be used to determine the capacity of a railway line. Goverde, Corman, and D'ariano (2013) have assessed a Dutch railway corridor with different signalling configurations. An assessment of signalling and train dispatching systems was made. The methodology used in the analysis is an extension of existing capacity assessment methods, such as the UIC 406 compression technique, and a new capacity determination approach was not proposed. Dicembre and Ricci (2011) proposed a capacity determination methodology that involves recovery times and headways. They analysed the effect of several important aspects on the capacity of a railway network. The sensitivity analysis was performed using the OpenTrack simulation tool and some analytical methods. Landex (2009) has considered differences in the UIC 406 railway capacity determination method when applied to single lines as opposed to double lines. Their approach was experimental and illustrative; hence no new mathematical or analytical models were developed. Harrod (2009) analysed the impact of alternate levels of train speed upon line capacity, but this was done experimentally too. Lu et al. (2013) considered the development of a framework for evaluating the performance of railway networks. They proposed a “quality of service” framework that includes attributes like punctuality, resilience, energy/resource usage, journey time, etc. An empirical analysis of train delays was performed to demonstrate the evaluation of a number of key performance indicators (kpi).

On the topic of infrastructure expansion Lui, Ahuja, and Sahin (2008) considered the capacity expansion of railroads and the spatial configuration of yards in a freight network. In particular they formulated a model for the yard location problem and demonstrated that railroads can make significant savings by reconfiguring their networks. This outcome provides significant motivation for this article which considers general railway networks and their expansion, and proposes more generic models and techniques for expanding line capacity. Pazour, Meller, and Pohl (2010) solved a planning problem that chooses whether HSR is used on specific arcs of a transportation network. Each arc has a capacity limitation and the objective was to minimise the total time to accomplish a set of trips. Lai and Barkan (2011) and Lai, Shih, and Jong (2010) considered strategic capacity planning and proposed a planning process to choose station layouts, expansion options, and train numbers on each section, to meet future demand. The model is a kind of network flow approach. Lai and Barkan (2011) then extended their previous work and proposed a decision support framework for railway capacity planning that generates and evaluates expansion and investment alternatives. The length of subdivisions, signal spacing, double track percentages, traffic mix, and so on are key elements of that approach. The proposed model decides given a prescribed budget, which arcs to upgrade. Two case studies were analysed. Singh et al. (2012) developed a mixed integer linear programming (MILP) model for determining capacity requirements and infrastructure improvements for the Hunter Valley Coal Chain. A trade-off was made between the accuracy of simulation and the use of a more generic mathematical model. Furthermore due to its size and complexity, meta-heuristics were necessary to optimise this bulk material supply chain.

In summary, there is little evidence of the application of analytical methods for railway capacity expansion in the literature. The type of analytical techniques and decision models developed in this article, that determine how to effectively upgrade existing railway networks and how to configure new railway networks, for example when train speed and running time profiles are additionally given, have not been provided. The closest approach is that of Lai and Barkan (2011), but that approach is very different to this article. While many studies have focussed upon the development of more detailed simulations of railways, or have proposed incremental approaches, there is no autonomous approach for railway capacity expansion planning. Simulation approaches by nature do not optimise in a mathematically rigorous way. What is missing, and has been proposed in this article, is a more direct analytical approach. As a final remark the techniques of this article provide a reference point to compare different approaches for expanding the operational capacity of a railway. That is a very useful capability in its own right and is not provided by other approaches.

The format of the remainder of this article is now described. As this article is based upon a former approach, the details of that approach are first described in Section 2.1. In Section 2.2 an approach that considers where to duplicate tracks is proposed. An alternative approach, that sub-divides existing tracks to increase capacity, has then been proposed in Section 3. In Section 4 both capacity expansion approaches are combined into a general model. In Section 5 a case study is provided to demonstrate the key developments of this paper. Finally in Section 6 the contributions of this article are discussed and summarised. It should be noted that a comprehensive listing of all parameters and notation can be found in Appendix A. A few parameters have been used several times and can be differentiated by their index type.

A linear programming (LP) model was formulated in Burdett and Kozan (2006) to identify the theoretical capacity of a railway network. As it is the starting point for the modelling activities in this paper, and the addition of more sophisticated elements, its details are reviewed here. The purpose of this formulation is to choose the maximum number of trains that it can distribute across the different corridors of the railway network over time. The time period for this model is denoted by T and its unit is minute. The solution however is limited by the time available on each section and the time trains occupy each section. The format of the model has been simplified in (1)-(7) to improve readability. In particular the “l → k” and “
                           
                              l
                              −
                              k
                           
                        ” notation of Burdett and Kozan (2006) has been removed and the decision variables have been partitioned into two parts. For example in this model 
                           
                              
                                 X
                                 →
                              
                              i
                              c
                           
                         and 
                           
                              
                                 X
                                 i
                                 c
                              
                              
                                 ←
                              
                           
                         are the number of trains of type i that traverse corridor c in each direction respectively. These are the decision variables and in total there are 2|C||I| of them. The “forward” direction of travel is specified by the original ordering of the corridor or section boundary points; hence the reverse direction is the opposite. Similarly, 
                           
                              
                                 y
                                 →
                              
                              i
                              s
                           
                         and 
                           
                              
                                 y
                                 i
                                 s
                              
                              
                                 ←
                              
                           
                         are the number of trains of type i that traverse each section s. They have been included for clarity but do not need to be explicitly included in the model. It should be noted that: 
                           
                              0
                              ≤
                              
                                 
                                    Y
                                    →
                                 
                                 i
                                 s
                              
                              ≤
                              
                                 τ
                                 s
                              
                              T
                              /
                              
                                 
                                    T
                                    →
                                 
                                 i
                                 s
                              
                           
                         and 
                           
                              0
                              ≤
                              
                                 
                                    Y
                                    i
                                    s
                                 
                                 
                                    ←
                                 
                              
                              ≤
                              
                                 τ
                                 s
                              
                              T
                              /
                              
                                 
                                    T
                                    i
                                    s
                                 
                                 
                                    ←
                                 
                              
                           
                        . The sectional occupation times (SOT) in each direction are denoted by 
                           
                              
                                 T
                                 →
                              
                              i
                              s
                           
                         and 
                           
                              
                                 T
                                 i
                                 s
                              
                              
                                 ←
                              
                           
                        . These values primarily include the sectional running time (
                           
                              SRT
                              i
                              s
                           
                        ), but may also include other time spent on sections, such as loading or unloading passengers and freight, breakdowns, delays, acceleration, deceleration, etc. The SRT may be measured or theoretical values may be used. For example the free flow sectional running time is as follows: 
                           
                              
                                 SRT
                                 i
                                 s
                              
                              =
                              60
                              ×
                              
                                 L
                                 s
                              
                              /
                              
                                 V
                                 i
                              
                           
                         where Ls
                         is the section length (in kilometre), Vi
                         is the train speed (in kilometre per hour), and 60 is multiplier needed to convert to minutes. The number of tracks on each section is denoted by τs
                         and the set of sections in each corridor is denoted by Ω
                        
                           c
                        . The mix of trains that are to use the network must be defined in order to obtain realistic results. For instance, the proportion of trains of each type (on each corridor), and the proportion of trains of each type in the forward direction, are denoted respectively by 
                           
                              η
                              i
                              c
                           
                         and 
                           
                              μ
                              i
                              c
                           
                        . These two parameters define how the demand for access from different train types is regulated. The percentage flow on each corridor is specified by σc
                        . This parameter is similarly required in order to facilitate the regulation of competition from different corridors for access. The optimisation model is as follows:

                           
                              (1)
                              
                                 
                                    Maximi
                                    s
                                    e
                                    :
                                    A
                                    =
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          C
                                       
                                    
                                    
                                       A
                                       c
                                    
                                    =
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          C
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             i
                                             c
                                          
                                          +
                                          
                                             
                                                X
                                                i
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        Subject to:
                        
                           
                              (2)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Y
                                                →
                                             
                                             i
                                             s
                                          
                                          
                                             
                                                T
                                                →
                                             
                                             i
                                             s
                                          
                                          +
                                          
                                             
                                                Y
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                          
                                             
                                                T
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    ≤
                                    T
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    
                                    
                                       [
                                       
                                          Section
                                          
                                          occupancy
                                          
                                          limit
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                       c
                                    
                                    +
                                    
                                       
                                          X
                                          i
                                          c
                                       
                                       
                                          ←
                                       
                                    
                                    =
                                    
                                       η
                                       i
                                       c
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             j
                                             c
                                          
                                          +
                                          
                                             
                                                X
                                                j
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    c
                                    ∈
                                    C
                                    
                                    
                                       [
                                       
                                          Proportional
                                          
                                          traffic
                                          
                                          mix
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                       c
                                    
                                    =
                                    
                                       μ
                                       i
                                       c
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             i
                                             c
                                          
                                          +
                                          
                                             
                                                X
                                                i
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    c
                                    ∈
                                    C
                                    
                                    
                                       [
                                       
                                          Directional
                                          
                                          traffic
                                          
                                          mix
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             i
                                             c
                                          
                                          +
                                          
                                             
                                                X
                                                i
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       σ
                                       c
                                    
                                    A
                                    
                                    ∀
                                    c
                                    ∈
                                    C
                                    
                                    
                                       [
                                       
                                          Traffic
                                          
                                          mix
                                          
                                          across
                                          
                                          corridors
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                       c
                                    
                                    ,
                                    
                                       
                                          X
                                          i
                                          c
                                       
                                       
                                          ←
                                       
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    c
                                    ∈
                                    C
                                    
                                    
                                       [
                                       
                                          Positivity
                                          
                                          requirement
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          Y
                                          →
                                       
                                       i
                                       s
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             c
                                             ∈
                                             C
                                             |
                                             s
                                             ∈
                                          
                                          
                                             Ω
                                             c
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             X
                                             →
                                          
                                          i
                                          c
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          Y
                                          i
                                          s
                                       
                                       
                                          ←
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             c
                                             ∈
                                             C
                                             |
                                             s
                                             ∈
                                          
                                          
                                             Ω
                                             c
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             X
                                             i
                                             c
                                          
                                          
                                             ←
                                          
                                       
                                       )
                                    
                                    
                                       ]
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                       ,
                                       ∀
                                       s
                                       ∈
                                       S
                                       
                                       
                                          [
                                          
                                             Section
                                             
                                             usage
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        Constraint (2) restricts the flow of trains through each section of the network. In other words it ensures that a section is not over utilised. The time that the section is occupied is the left hand side and includes both directions of travel. Constraint (3) ensures that the proportional mix of trains in each corridor is satisfied while constraint (4) regulates the flow of trains in each direction. Similarly, constraint (5) regulates the demand on each corridor as a proportion of the total system capacity. If there are specific demands on each corridor it is a simple to matter to replace constraint (5) with a more explicit constraint like 
                           
                              
                                 A
                                 c
                              
                              ≥
                              
                                 A
                                 c
                                 tar
                              
                           
                        . Constraint (6) ensures that the decision variables, i.e. the number of trains of each type traversing each corridor, are positive. Finally in constraint (7) the relationship between the number of trains travelling across individual sections and those that travel across corridors is defined. This constraint enforces flow conservation. As a final note it should be noted that while sections are parallel lengths of rail (i.e. tracks) between two locations, other complex railway infrastructure, such as junctions and stations, can also be modelled as sections. In order to correctly identify theoretical capacity these sections also have a specified sectional occupancy time.

In principle duplicating existing sections of rail (i.e. adding parallel tracks) can significantly increase the capacity of a rail network. However as shown in preliminary numerical investigations in Bevrani et al. (2015), choosing the right sections is not entirely transparent, even more so when costs of duplications and other restrictions vary at different locations. To do this capacity expansion models, denoted by RCEM-TRKDUP, are described here. This model is “static” hence there is no time element to track duplications. In other words the consideration of which sections to duplicate over time is not considered. The time period for expansions is certainly important but the focus of this article is not that, i.e. it is to determine what changes are necessary to increase capacity. To include track duplication in the capacity model, several starting assumptions have been made. These were assumed in Bevrani et al. (2015) but were not discussed or detailed. Hence it is important to do so here.


                        
                           Assumption 1
                           The sectional running times are the same on parallel tracks.


                        
                           Assumption 2
                           Each track within each section can only be occupied by a single train at any time.


                        
                           Assumption 3
                           The theoretical capacity of a parallel section of rail depends on the number of tracks present and the number of tracks on adjacent sections. In this article a section with two tracks has at most twice the theoretical capacity. Similarly a section with n parallel tracks has at most n times as much theoretical capacity.

Without Assumption 1 it would be necessary to define additional decision variables that describe which parallel track individual trains are assigned to. In that situation the problem is no longer high level and strategic. It is perhaps acceptable for the average sectional running time over all the parallel tracks to be used, but further debate and analysis of this strategy is necessary. Assumption 3 is only achievable when passing infrastructure is present at the section boundary. The capacity increases by virtue of the fact that multiple trains can travel within the section at the same time. It is interesting to note that Abril et al. (2008) have reported that two tracks could have four times as much operational capacity as a single track. But this conclusion is unlikely to be valid for a theoretical capacity paradigm.

Given these assumptions, the following constraints are added to the base model to include track duplication in the capacity model:

                           
                              (8)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Y
                                                →
                                             
                                             i
                                             s
                                          
                                          
                                             
                                                T
                                                →
                                             
                                             i
                                             s
                                          
                                          +
                                          
                                             
                                                Y
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                          
                                             
                                                T
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    ≤
                                    F
                                    
                                       (
                                       
                                          
                                             τ
                                             s
                                          
                                          +
                                          
                                             ∥
                                             s
                                          
                                          ,
                                          T
                                       
                                       )
                                    
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    
                                    
                                       [
                                       
                                          Section
                                          
                                          saturation
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          S
                                       
                                    
                                    
                                       (
                                       
                                          
                                             C
                                             s
                                             ∥
                                          
                                          .
                                          
                                             ∥
                                             s
                                          
                                       
                                       )
                                    
                                    ≤
                                    B
                                    
                                    
                                       [
                                       
                                          
                                             Limitation
                                             
                                             on
                                             
                                             spending
                                          
                                          -
                                          budget
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    0
                                    ≤
                                    
                                       ∥
                                       s
                                    
                                    ≤
                                    
                                       ∥
                                       s
                                       max
                                    
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    
                                    
                                       [
                                       
                                          Limit
                                          
                                          on
                                          
                                          track
                                          
                                          numbers
                                       
                                       ]
                                    
                                 
                              
                           
                        Above ∥
                           s
                         is an integer decision variable (i.e. 
                           
                              
                                 ∥
                                 s
                              
                              ∈
                              Z
                           
                        ) for the number of parallel tracks to add on section s,
                           
                              
                              
                                 ∥
                                 s
                                 max
                              
                           
                         is an upper bound on parallel tracks in each section, and 
                           B
                         is the budget for duplications. The cost of providing a single additional track is denoted by 
                           
                              C
                              s
                              ∥
                           
                        , and is referred to as the cost of duplication. It may also include other costs in order to provide the extra increase in capacity that is assumed in Assumption 3. Constraint (8) is an upgraded version of constraint (2) as it includes the number of newly assigned tracks. Function F determines the time that is utilisable in section s when there are parallel tracks. In this article 
                           
                              F
                              
                                 (
                                 
                                    
                                       τ
                                       s
                                    
                                    +
                                    
                                       ∥
                                       s
                                    
                                    ,
                                    T
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       τ
                                       s
                                    
                                    +
                                    
                                       ∥
                                       s
                                    
                                 
                                 )
                              
                              T
                           
                        , but other functional variants could conceivably be used, for instance where more accurate information of the improvement in capacity is known. This information could be provided from simulation experiments for instance.

When passing infrastructure is not present at section boundaries, the capacity of a parallel track is much reduced. An alternative approach involving enforced headways could conceivably be used to construct a mathematical function for F. Enforced headways are the time to travel to and from the nearest passing infrastructure (Burdett & Kozan, 2006). Their magnitude reflects additional section idle time and enforced vacancy.

The new models' objective is still to maximise theoretical capacity. From a practical perspective, track duplication cannot be separated from budgetary considerations. This is because the problem would become unbounded, and sections would be duplicated without limit. However a variant decision making problem is to decide upon what sections should be upgraded in order to achieve a specified level of theoretical capacity. In that problem a budget is not entirely necessary. This variant problem has an alternative objective which is minimisation of spending as denoted by 
                           S
                        . The complete model for that situation is as follows:

                           
                              (11)
                              
                                 
                                    Minimise
                                    :
                                    S
                                    =
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          S
                                       
                                    
                                    
                                       (
                                       
                                          
                                             C
                                             s
                                             ∥
                                          
                                          ·
                                          
                                             ∥
                                             s
                                          
                                       
                                       )
                                    
                                    
                                    
                                       [
                                       
                                          Total
                                          
                                          spending
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     


                        Subject to: Constraints (3)–(10) and

                           
                              (12)
                              
                                 
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          C
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                
                                                   i
                                                
                                                c
                                             
                                             
                                                →
                                             
                                          
                                          +
                                          
                                             
                                                X
                                                
                                                   i
                                                
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    ≥
                                    A
                                    
                                    
                                       [
                                       
                                          Target
                                          
                                          capacity
                                       
                                       ]
                                    
                                 
                              
                           
                        If the budget is insufficient then the model is infeasible and the removal of constraint (9) may be necessary. Otherwise the budget should be increased.

As previously mentioned the aforementioned models determine the extent to which theoretical capacity can be expanded straight away, however this may not be entirely possible. Another approach may be to construct and implement a long term plan of infrastructure expansions over a time period P, that takes into account any intermediate stage capacity requirements, and regular or intermittent budgets and funding. This topic is outside the scope of this article however it is worth mentioning that the aforementioned model can be extended easily. The first requirement is to add a time period subscript to each component of the model. The number of tracks present in each section must be updated in the following way: 
                           
                              
                                 τ
                                 
                                    s
                                    ,
                                    p
                                 
                              
                              =
                              
                                 τ
                                 
                                    s
                                    ,
                                    p
                                    −
                                    1
                                 
                              
                              +
                              
                                 ∥
                                 
                                    s
                                    ,
                                    p
                                    −
                                    1
                                 
                              
                              ∀
                              s
                              ∈
                              S
                              ,
                              ∀
                              p
                              ∈
                              P
                           
                        . Spending in each period can be easily quantified and restricted. Outputs of the model are intermediate values of the actual mix of trains and the theoretical capacity in each period.

Several variant decision making problems can be specified by altering the objective function accordingly. For example a plan that achieves a specific theoretical capacity outcome can be formulated. In addition the creation of an expansion plan of minimal duration may also be sought. Determining whether it is even possible to achieve a specified level may also be tested with this approach.

In Section 2 the expansion of capacity via track duplications was considered. However track duplications are quite costly and permanent and construction times may also be prohibitive. As capacity is highly related to travel and occupancy times on tracks within critical bottleneck sections, it is possible to increase capacity by sub-dividing existing sections of track (i.e. to make sub sections), for example using signals (see Fig. 1).

To increase theoretical capacity, several models, denoted by RCEM-SUBDIV, have been developed. The first assumes trains travel at a given velocity within a section. That velocity does not change, regardless of track topology. Hence the time to traverse any sub section is computable and is a function of the sub section length. The second approach is based upon some type of profile that is provided. The profile says how long it takes to traverse specified sub sections of the original section. Train velocity is not explicitly defined per se in that situation, but an average time can be obviously assumed on each sub section. The velocity on each sub section is evidently different.

To avoid confusion, it should be noted that a section of rail is one or more parallel tracks, of the same length, between two defined locations. By definition a sub section is also a section. It however occurs within the boundary of a larger section. A segment refers to a portion of a profile. In actuality a segment refers to particular static sub section.

But first, some theoretical properties are discussed that motivate the possibility of sub dividing existing sections of rail.

The main benefit of partitioning an existing track is that it allows more trains to run at the same time on that track. As a consequence the distance between trains is reduced, but in a safe way. Abril et al. (2008) state that traffic flow can potentially increase and be better managed as sections become shorter. The length of the sub section is important however it is the travelling time that is most important. The proof of the aforementioned statements is provided in Lemmas 1–5 shown in Appendix B. Lemmas 1–3 show that theoretical capacity can be increased most by sub dividing sections. However the overriding assumption required for this to be true is that the velocity is constant across the entire section. Hence sub sections have the same velocity too and the SRT and SOT are scaled "linearly". Lemma 5 is particularly important as it describes how each sub-section should be positioned for different mixes of trains, for instance when the speed is not constant.

The first mathematical model formulated for section sub division utilises Lemmas 1 and 3. It is assumed that each section of rail can be divided into many sub sections and that there is no profile for the travel times or train speeds across each section. In other words, the train speed is fixed, and the travelling time is linearly proportional to the time to travel across the entire section. Let ns
                         be a decision variable for the number of sub sections created in section s. The cost of dividing a section is denoted by 
                           
                              C
                              s
                              ‡
                           
                         and primarily includes the cost of signalisation. The following model is proposed, and seeks to maximise theoretical capacity subject to a specified limit on spending.

                           
                              
                                 
                                    Maximi
                                    s
                                    e
                                    
                                    A
                                    =
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          C
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             i
                                             c
                                          
                                          +
                                          
                                             
                                                X
                                                i
                                                c
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        Subject to:
                     

Constraints (3)–(7)

                           
                              (13)
                              
                                 
                                    N
                                    =
                                    
                                       ∑
                                       s
                                    
                                    
                                       (
                                       
                                          
                                             n
                                             s
                                          
                                          −
                                          1
                                       
                                       )
                                    
                                    
                                    
                                       [
                                       
                                          Number
                                          
                                          of
                                          
                                          new
                                          
                                          divisions
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    1
                                    ≤
                                    
                                       n
                                       s
                                    
                                    ≤
                                    
                                       
                                          n
                                          ¯
                                       
                                       s
                                    
                                    =
                                    
                                       ⌊
                                       
                                          L
                                          s
                                       
                                       /
                                       ω
                                       ⌋
                                    
                                    
                                    
                                       [
                                       Range
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    S
                                    =
                                    
                                       ∑
                                       s
                                    
                                    
                                       C
                                       s
                                       ‡
                                    
                                    
                                       (
                                       
                                          
                                             n
                                             s
                                          
                                          −
                                          1
                                       
                                       )
                                    
                                    ≤
                                    B
                                    
                                    
                                       [
                                       
                                          Limit
                                          
                                          on
                                          
                                          spending
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Y
                                                →
                                             
                                             i
                                             s
                                          
                                          
                                             
                                                T
                                                →
                                             
                                             i
                                             s
                                          
                                          +
                                          
                                             
                                                Y
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                          
                                             
                                                T
                                                i
                                                s
                                             
                                             
                                                ←
                                             
                                          
                                       
                                       )
                                    
                                    ≤
                                    
                                       
                                          F
                                       
                                       ‡
                                    
                                    
                                       (
                                       
                                          
                                             n
                                             s
                                          
                                          ,
                                          
                                             τ
                                             s
                                          
                                          ,
                                          T
                                       
                                       )
                                    
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    
                                    
                                    
                                       [
                                       
                                          Section
                                          
                                          saturation
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       n
                                       s
                                    
                                    ∈
                                    Z
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    
                                    
                                       [
                                       
                                          Integer
                                          
                                          requirement
                                       
                                       ]
                                    
                                 
                              
                           
                        In this model constraint (14) ensures that there is at least one sub section, however the total number must be less than the computed threshold, which is based upon a minimum sub-section length ω and the sections length Ls
                        . In constraint (16), the following function is used, 
                           
                              
                                 
                                    F
                                 
                                 ‡
                              
                              
                                 (
                                 
                                    
                                       n
                                       s
                                    
                                    ,
                                    
                                       τ
                                       s
                                    
                                    ,
                                    T
                                 
                                 )
                              
                              =
                              
                                 n
                                 s
                              
                              .
                              
                                 τ
                                 s
                              
                              .
                              T
                           
                        , as Lemmas 1 and 3 indicate that the capacity of each section of rail could be increased by ns
                         when it is divided into that many sub sections.

As track gradients and curvature vary considerably over the entire length of a section, the previous assumption of a constant train speed may be unrealistic. In order to avoid this assumption, and to formulate a suitable mathematical model that determines how many sub sections to have, and where each sub section begins and ends, it is necessary for some type of profile to be provided. More details about profiles will be presented in due course, however first and foremost it should be noted that another mathematical optimisation model is not required since the model of Section 3.2 is sufficient. That optimisation model does not need to explicitly consider where to divide sections, because the effect of dividing sections into so many parts is known. For instance according to the aforementioned lemmas, the increase in capacity is at most n times if there are n sub sections. Furthermore Lemma 5 demonstrates that each sub section must have a specific weighted sectional running time, i.e. (1/n)th of the original section. Hence the position of each chosen sub section can be determined later. For that task a mathematical model is now introduced. That model takes into consideration the fact that travelling on a sloping section of rail is more efficient in one direction than the other (i.e. the opposite direction).

The aforementioned profile should provide the travelling time, gradient and/or velocity within a section. From a practical point of view, the best case is when the time to traverse each segment in the profile, occurring between adjacent locations, and in both directions, is measured. Otherwise a theoretical approximation could be used. Let Us
                         be the total number of locations in the profile for section s and let x
                        
                           u, s
                         be the position of the uth location. The spacing between measurements is defined as δs
                        . Hence, 
                           
                              
                                 x
                                 
                                    u
                                    ,
                                    s
                                 
                              
                              −
                              
                                 x
                                 
                                    u
                                    +
                                    1
                                    ,
                                    s
                                 
                              
                              =
                              
                                 δ
                                 s
                              
                              
                                 
                                 for
                              
                              
                              u
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 U
                                 s
                              
                              −
                              1
                           
                        . The spacings do not need to be equidistant but they are assumed to be so in this article. It is also assumed that the velocity is constant within each segment of the profile. Hence the travelling times within segments are linearly proportional to the time to traverse the entire segment.

Let 
                           
                              
                                 τ
                                 →
                              
                              
                                 i
                                 ,
                                 u
                                 ,
                                 s
                              
                           
                         be the “cumulative” time to travel to the uth location from the beginning (i.e. lhs) of section s for trains of type i. Hence the time to travel between two adjacent locations is 
                           
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    u
                                    ,
                                    s
                                 
                              
                              −
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    u
                                    −
                                    1
                                    ,
                                    s
                                 
                              
                           
                         for all values of u > 1. Let 
                           
                              
                                 τ
                                 
                                    ←
                                 
                              
                              
                                 i
                                 ,
                                 u
                                 ,
                                 s
                              
                           
                         be the time to reach u from the end (i.e. rhs) of section s. Hence the time to travel between two adjacent locations (in reverse direction) is 
                           
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    u
                                    −
                                    1
                                    ,
                                    s
                                 
                              
                              −
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    u
                                    ,
                                    s
                                 
                              
                           
                         for all values of u > 1. If the travelling time in each direction is the same then 
                           
                              
                                 
                                    τ
                                    
                                       ←
                                    
                                 
                                 
                                    i
                                    ,
                                    u
                                    ,
                                    s
                                 
                              
                              =
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    
                                       U
                                       s
                                    
                                    ,
                                    s
                                 
                              
                              −
                              
                                 
                                    τ
                                    →
                                 
                                 
                                    i
                                    ,
                                    u
                                    ,
                                    s
                                 
                              
                           
                        .

Let α
                        
                           j, s
                         and β
                        
                           j, s
                         be the start and end position of the jth sub section such that 0 ≤ α
                        
                           j, s
                         < β
                        
                           j, s
                         ≤ Ls
                        . Hence its length is 
                           
                              
                                 L
                                 
                                    j
                                    ,
                                    s
                                 
                              
                              =
                              
                                 β
                                 
                                    j
                                    ,
                                    s
                                 
                              
                              −
                              
                                 α
                                 
                                    j
                                    ,
                                    s
                                 
                              
                           
                         and 
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       n
                                       s
                                    
                                 
                              
                              
                                 L
                                 
                                    j
                                    ,
                                    s
                                 
                              
                              =
                              
                                 L
                                 s
                              
                           
                         where ns
                         denotes the last sub section. It should be noted that 
                           
                              
                                 α
                                 
                                    1
                                    ,
                                    s
                                 
                              
                              =
                              0
                           
                        , 
                           
                              
                                 α
                                 
                                    j
                                    ,
                                    s
                                 
                              
                              =
                              
                                 β
                                 
                                    j
                                    −
                                    1
                                    ,
                                    s
                                 
                              
                              
                              ∀
                              j
                              ≥
                              2
                           
                        , and 
                           
                              
                                 β
                                 
                                    
                                       n
                                       s
                                    
                                    ,
                                    s
                                 
                              
                              =
                              
                                 L
                                 s
                              
                           
                        . Let the beginning and ending segment be b
                        
                           j, s
                         and e
                        
                           j, s
                        . These locations also abbreviated as b and e below, bound sub section j and are the nearest locations on each side. Let 
                           
                              
                                 T
                                 
                                    i
                                    ,
                                    j
                                 
                                 s
                              
                              
                                 
                                    →
                                 
                              
                           
                         and 
                           
                              
                                 T
                                 
                                    i
                                    ,
                                    j
                                 
                                 s
                              
                              
                                 
                                    ←
                                 
                              
                           
                         be the time to traverse sub section j of section s, in each direction respectively. The travelling time in the forwards direction may be computed in the following way:

                           
                              (18)
                              
                                 
                                    
                                       
                                          T
                                          
                                             i
                                             ,
                                             j
                                          
                                          s
                                       
                                       
                                          
                                             →
                                          
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                τ
                                                →
                                             
                                             
                                                i
                                                ,
                                                e
                                                ,
                                                s
                                             
                                          
                                          −
                                          
                                             
                                                τ
                                                →
                                             
                                             
                                                i
                                                ,
                                                b
                                                ,
                                                s
                                             
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                α
                                                
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                   →
                                                
                                                b
                                             
                                          
                                          
                                             
                                                V
                                                →
                                             
                                             
                                                i
                                                ,
                                                b
                                             
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   →
                                                
                                                e
                                             
                                             −
                                             
                                                β
                                                
                                                   j
                                                   ,
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                V
                                                →
                                             
                                             
                                                i
                                                ,
                                                e
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              e
                              =
                              min
                              (
                              
                                 
                                    u
                                    ∈
                                    
                                       [
                                       
                                          1
                                          ,
                                          U
                                       
                                       ]
                                    
                                    |
                                 
                                 
                                    
                                       x
                                       →
                                    
                                    u
                                 
                                 ≥
                                 
                                    β
                                    
                                       j
                                       ,
                                       s
                                    
                                 
                              
                              )
                           
                        , 
                           
                              b
                              =
                              max
                              (
                              
                                 
                                    u
                                    ∈
                                    
                                       [
                                       
                                          1
                                          ,
                                          U
                                       
                                       ]
                                    
                                    |
                                 
                                 
                                    
                                       x
                                       →
                                    
                                    u
                                 
                                 ≤
                                 
                                    α
                                    
                                       j
                                       ,
                                       s
                                    
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    x
                                    →
                                 
                                 u
                              
                              =
                              δ
                              
                                 (
                                 
                                    u
                                    −
                                    1
                                 
                                 )
                              
                           
                        . This equation sums up the times to travel between the bounding locations, i.e. over a certain number of inclined planes. However if e
                        
                           j, s
                         < xu
                         or b
                        
                           j, s
                         > xu
                         then the first term has added too much travel time. In that situation a correction is necessary, i.e. an amount of time must be subtracted that is proportional to the distance 
                           
                              
                                 
                                    x
                                    →
                                 
                                 e
                              
                              −
                              
                                 β
                                 
                                    j
                                    ,
                                    s
                                 
                              
                           
                         or 
                           
                              
                                 α
                                 
                                    j
                                    ,
                                    s
                                 
                              
                              −
                              
                                 
                                    x
                                    →
                                 
                                 b
                              
                           
                        . A demonstration is shown in Fig. 2. It should be noted that the travel times and profile distances respectively in Fig. 2 have appropriate unit of measure like hours or minutes and metres or kilometres. In this example however the values are indicative only and no specific unit of measure was chosen.

To evaluate travel times in the reverse direction, Eq. (18) can also be used. The interval however must be changed as follows: 
                           
                              
                                 [
                                 
                                    
                                       α
                                       
                                          j
                                          ,
                                          s
                                       
                                    
                                    ,
                                    
                                       β
                                       
                                          j
                                          ,
                                          s
                                       
                                    
                                 
                                 ]
                              
                              ⇒
                              
                                 [
                                 
                                    
                                       L
                                       s
                                    
                                    −
                                    
                                       β
                                       
                                          j
                                          ,
                                          s
                                       
                                    
                                    ,
                                    
                                       L
                                       s
                                    
                                    −
                                    
                                       α
                                       
                                          j
                                          ,
                                          s
                                       
                                    
                                 
                                 ]
                              
                           
                        , and the reverse cumulative travel times must be used.

For determining the position of n sub sections, the following mathematical model was first formulated:


                           Maximise:
                           
                              A
                           
                        


                           Subject to:
                           
                              
                                 (19)
                                 
                                    
                                       
                                          p
                                          j
                                       
                                       ≤
                                       
                                          p
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       2
                                       
                                       
                                          [
                                          
                                             Comparative
                                             
                                             positioning
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       0
                                       ≤
                                       
                                          p
                                          j
                                       
                                       ≤
                                       L
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                       
                                       
                                          [
                                          
                                             Valid
                                             
                                             positioning
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             T
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             
                                                →
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             
                                                α
                                                j
                                             
                                             ,
                                             …
                                             ,
                                             
                                                β
                                                j
                                             
                                          
                                       
                                       
                                          
                                             t
                                             
                                                ←
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             
                                                α
                                                j
                                             
                                             ,
                                             …
                                             ,
                                             
                                                β
                                                j
                                             
                                          
                                       
                                       
                                          
                                             t
                                             
                                                ←
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          α
                                          1
                                       
                                       =
                                       0
                                       ;
                                       
                                       
                                          α
                                          j
                                       
                                       =
                                       
                                          p
                                          
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                       j
                                       =
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          β
                                          n
                                       
                                       =
                                       L
                                       ;
                                       
                                       
                                          β
                                          j
                                       
                                       =
                                       
                                          p
                                          j
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          p
                                          j
                                       
                                       ∈
                                       Z
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       A
                                       ≤
                                       
                                          A
                                          j
                                       
                                       =
                                       
                                          T
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                η
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         μ
                                                         →
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         T
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         μ
                                                         
                                                            ←
                                                         
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         T
                                                         
                                                            ←
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                              
                           This model is to be solved for a specific section s. The section subscript however has been removed for brevity here. In this formulation pj
                            is the decision variable. It is defined as the position of the jth division and occurs between sub section j − 1 and j. It is assumed to be an integer decision. In this model constraints (19) and (20) ensure that positions are positioned correctly. Constraints (23) and (24) clarify the start and end position of each sub section. Constraint (26) defines the theoretical capacity of each sub section and forces the overall capacity to be the capacity of the worst sub section. Upon examination this model has two problems. The first is that constraint (26) is non-linear. The second is that α
                           
                              j, s
                            and β
                           
                              j, s
                            are decision variables and hence constraints (21) and (22) cannot be generated. Fortunately the first non-linearity can be resolved easily by rewriting the model in the following way:


                           Minimise
                           
                              W
                           
                        


                           Subject to:
                        

Constraints (19)-(25)

                              
                                 (27)
                                 
                                    
                                       W
                                       ≥
                                       
                                          W
                                          j
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                   
                                                      →
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                              
                           In this new model 
                              
                                 W
                                 j
                              
                            is the weighted average sectional running time for sub section j and the objective is to minimise the maximum weighted average sectional running time. To handle the second problem, several courses of action are possible to compute 
                              
                                 
                                    T
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       →
                                    
                                 
                              
                            and 
                              
                                 
                                    T
                                    
                                       ←
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           . The first approach breaks the domain into K equal pieces and introduces a number of additional binary decision variables γ
                           
                              j, k
                           . Under an assumption of an integer sub section length and integer sub division it is apparent that 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 K
                                 =
                                 
                                    L
                                    s
                                 
                              
                           . For each piece k, the travelling time 
                              
                                 
                                    t
                                    →
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                            and 
                              
                                 
                                    t
                                    
                                       ←
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                            can be defined in a pre-processing stage. Hence the aforementioned equations can be rewritten in the following way, 
                              
                                 
                                    
                                       T
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          →
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                                 
                                    (
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       .
                                       
                                          
                                             t
                                             →
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    
                                       T
                                       
                                          ←
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                                 
                                    (
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       .
                                       
                                          
                                             t
                                             
                                                ←
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                    )
                                 
                                 
                                 for
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 +
                                 1
                              
                           , where 
                              
                                 
                                    γ
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                              
                            if αj
                            ≤ k ≤ βj
                            else 
                              
                                 
                                    γ
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 0
                              
                           . In layman's terms γ
                           
                              j, k
                            is one if segment k lies within the chosen sub section. In that event the segments travelling time should be included in the overall sub section travelling time. Specifying γ
                           
                              j, k
                            simply however is not an easy task. To facilitate the γ binary variable, let 
                              
                                 
                                    γ
                                    
                                       j
                                       ,
                                       k
                                    
                                    −
                                 
                                 =
                                 1
                              
                            if k < αj
                            and zero otherwise (see Fig. 3
                           ). Similarly let 
                              
                                 
                                    γ
                                    
                                       j
                                       ,
                                       k
                                    
                                    +
                                 
                                 =
                                 1
                              
                            if k > βj
                           .

The following constraints are evidently necessary:

                              
                                 (28)
                                 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       =
                                       1
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                       <
                                       k
                                       ≤
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                −
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       <
                                       k
                                       ≤
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       ℧
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ,
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ∈
                                       
                                          {
                                          
                                             0
                                             ,
                                             1
                                          
                                          }
                                       
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                        


                           
                              Proof
                              If 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       =
                                       1
                                    
                                 , then 
                                    
                                       −
                                       ℧
                                       <
                                       k
                                       ≤
                                       
                                          α
                                          j
                                       
                                    
                                  and if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       
                                          α
                                          j
                                       
                                       +
                                       1
                                       ≤
                                       k
                                       ≤
                                       ℧
                                    
                                 . Similarly if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       =
                                       1
                                    
                                 , then 
                                    
                                       
                                          β
                                          j
                                       
                                       +
                                       1
                                       ≤
                                       k
                                       ≤
                                       ℧
                                    
                                  and if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       −
                                       ℧
                                       ≤
                                       k
                                       ≤
                                       
                                          β
                                          j
                                       
                                    
                                 .□

As “<” is not facilitated in optimisation packages the following conversions are necessary:

                              
                                 (32)
                                 
                                    
                                       k
                                       >
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       ⇒
                                       k
                                       ≥
                                       
                                          β
                                          j
                                       
                                       +
                                       1
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                    
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       k
                                       >
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                       ⇒
                                       k
                                       ≥
                                       
                                          α
                                          j
                                       
                                       +
                                       1
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                    
                                 
                              
                           Upon reflection this approach must be altered if each division is not of unit length and the aforementioned values are real valued instead of integer. Let ɛ be the size of each division, and the desired tolerance. Let 
                              
                                 n
                                 D
                                 i
                                 v
                                 =
                                 δ
                                 /
                                 
                                    ɛ
                                 
                              
                            and 
                              
                                 K
                                 =
                                 n
                                 D
                                 i
                                 v
                                 ×
                                 (
                                 
                                    U
                                    −
                                    1
                                 
                                 )
                              
                           . For example, if 
                              
                                 δ
                                 =
                                 50
                              
                            metres and 
                              
                                 
                                 
                                    ɛ
                                 
                                 =
                                 0.01
                                 
                                 metres
                              
                            then 
                              
                                 n
                                 D
                                 i
                                 v
                                 =
                                 5000
                              
                           . Constraint (25) should be removed and constraints (29) and (30) should be replaced with:

                              
                                 (34)
                                 
                                    
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                       <
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                −
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       <
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       ℧
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ;
                                       
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                        


                           
                              Proof
                              If 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       =
                                       1
                                    
                                 , then 
                                    
                                       −
                                       ℧
                                       <
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       
                                          α
                                          j
                                       
                                    
                                  and if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       
                                          α
                                          j
                                       
                                       <
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       ℧
                                    
                                 . Similarly if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       =
                                       1
                                    
                                 , then 
                                    
                                       
                                          β
                                          j
                                       
                                       <
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       ℧
                                    
                                  and if 
                                    
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          +
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       −
                                       ℧
                                       ≤
                                       k
                                       
                                          ɛ
                                       
                                       ≤
                                       
                                          β
                                          j
                                       
                                    
                                 .□

As “<” is not facilitated in optimisation packages the following conversions are necessary:

                              
                                 (36)
                                 
                                    
                                       k
                                       
                                          ɛ
                                       
                                       >
                                       
                                          α
                                          j
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                       ⇒
                                       k
                                       
                                          ɛ
                                       
                                       ≥
                                       
                                          α
                                          j
                                       
                                       +
                                       
                                          ɛ
                                       
                                       −
                                       
                                          γ
                                          
                                             j
                                             ,
                                             k
                                          
                                          −
                                       
                                       ℧
                                    
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    
                                       k
                                       
                                          ɛ
                                       
                                       >
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                       ⇒
                                       k
                                       
                                          ɛ
                                       
                                       ≥
                                       
                                          β
                                          j
                                       
                                       +
                                       
                                          ɛ
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                γ
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                +
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       ℧
                                    
                                 
                              
                           
                        

The first formulation is quite adequate for most practical applications, and that is why it is presented here. For instance when parameters are integer and the divisions are to the nearest metre. Otherwise the model may require many binary variables. For example the domain must be discretised into very small parts. In the interest of mathematical accuracy and comprehensibility a better model can be formulated. The idea behind this alternative is to use the original discretisation. In other words there is no further discretisation of the domain. The following binary variables 
                              
                                 
                                    γ
                                    
                                       u
                                       ,
                                       j
                                    
                                    −
                                 
                                 ,
                                 
                                    γ
                                    
                                       u
                                       ,
                                       j
                                    
                                    +
                                 
                                 ,
                                 
                                    γ
                                    
                                       u
                                       ,
                                       j
                                    
                                 
                              
                            are defined for each pairing of sub section and profile segment. They signify whether segment u contains the start and end respectively of sub section j or whether segment u is part of sub section j. As each sub section must start and end somewhere the following constraints are needed:

                              
                                 (38)
                                 
                                    
                                       
                                          ∑
                                          u
                                       
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       =
                                       1
                                       ;
                                       
                                       
                                          ∑
                                          u
                                       
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       =
                                       1
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       +
                                       1
                                    
                                 
                              
                           To facilitate the correct values of these binary variables the following constraints are needed:

                              
                                 (39)
                                 
                                    
                                       s
                                       
                                          t
                                          u
                                       
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       ≤
                                       
                                          α
                                          j
                                       
                                       <
                                       e
                                       
                                          n
                                          u
                                       
                                       +
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                γ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                −
                                             
                                          
                                          )
                                       
                                       ℧
                                    
                                 
                              
                           
                           
                              
                                 (40)
                                 
                                    
                                       s
                                       
                                          t
                                          u
                                       
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       <
                                       
                                          β
                                          j
                                       
                                       ≤
                                       e
                                       
                                          n
                                          u
                                       
                                       +
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                γ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                +
                                             
                                          
                                          )
                                       
                                       ℧
                                    
                                 
                              
                           
                        


                           
                              Proof
                              If 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       =
                                       1
                                    
                                 , then stu
                                  ≤ αj
                                  < enu
                                  and if 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       0
                                       ≤
                                       
                                          α
                                          j
                                       
                                       <
                                       ℧
                                    
                                 . If 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       =
                                       1
                                    
                                 , then stu
                                  < βj
                                  ≤ enu
                                  and if 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       =
                                       0
                                    
                                 , then 
                                    
                                       0
                                       <
                                       
                                          β
                                          j
                                       
                                       ≤
                                       ℧
                                    
                                 . It should be noted that 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       =
                                       0
                                    
                                  if αj
                                  ≥ enu
                                  or βj
                                  ≤ stu
                                 . Similarly, 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       =
                                       0
                                    
                                 , if αj
                                  ≥ enu
                                  or βj
                                  ≤ stu
                                 . Consequently the travelling times can be defined in the following way:

                                    
                                       (41)
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                   
                                                      →
                                                   
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   u
                                                   =
                                                   1
                                                   ,
                                                   .
                                                   .
                                                   ,
                                                   U
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                         →
                                                      
                                                      
                                                         i
                                                         ,
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      −
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            →
                                                         
                                                         
                                                            i
                                                            ,
                                                            u
                                                         
                                                      
                                                      δ
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                            j
                                                         
                                                         −
                                                         s
                                                         
                                                            t
                                                            u
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            →
                                                         
                                                         
                                                            i
                                                            ,
                                                            u
                                                         
                                                      
                                                      δ
                                                   
                                                   
                                                      (
                                                      
                                                         e
                                                         
                                                            n
                                                            u
                                                         
                                                         −
                                                         
                                                            β
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (42)
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   u
                                                   =
                                                   1
                                                   ,
                                                   .
                                                   .
                                                   ,
                                                   U
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                         
                                                            ←
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      −
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            
                                                               ←
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            u
                                                         
                                                      
                                                      δ
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                            j
                                                         
                                                         −
                                                         s
                                                         
                                                            t
                                                            u
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      +
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            
                                                               ←
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            u
                                                         
                                                      
                                                      δ
                                                   
                                                   
                                                      (
                                                      
                                                         e
                                                         
                                                            n
                                                            u
                                                         
                                                         −
                                                         
                                                            β
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 As this expression is non-linear let 
                                    
                                       
                                          ψ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       =
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       
                                          β
                                          j
                                       
                                    
                                  and 
                                    
                                       
                                          ψ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       =
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       
                                          α
                                          j
                                       
                                    
                                 . The following constraints are then required:

                                    
                                       (43)
                                       
                                          
                                             0
                                             ≤
                                             
                                                ψ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                +
                                             
                                             ≤
                                             
                                                β
                                                j
                                             
                                             ;
                                             
                                             
                                                β
                                                j
                                             
                                             −
                                             
                                                L
                                                s
                                             
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      +
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                ψ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                +
                                             
                                             ≤
                                             
                                                γ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                +
                                             
                                             
                                                L
                                                s
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (44)
                                       
                                          
                                             0
                                             ≤
                                             
                                                ψ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                −
                                             
                                             ≤
                                             
                                                α
                                                j
                                             
                                             ;
                                             
                                             
                                                α
                                                j
                                             
                                             −
                                             
                                                L
                                                s
                                             
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         ,
                                                         j
                                                      
                                                      −
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                ψ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                −
                                             
                                             ≤
                                             
                                                γ
                                                
                                                   u
                                                   ,
                                                   j
                                                
                                                −
                                             
                                             
                                                L
                                                s
                                             
                                             .
                                          
                                       
                                    
                                 The gamma
                                 
                                  variable is difficult to quantify and a better alternative does not involve it at all. Upon retrospection it is clear that 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             t
                                             →
                                          
                                          u
                                       
                                       =
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       
                                          
                                             τ
                                             →
                                          
                                          u
                                       
                                       −
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       
                                          
                                             τ
                                             →
                                          
                                          
                                             u
                                             −
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             t
                                             
                                                ←
                                             
                                          
                                          u
                                       
                                       =
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          +
                                       
                                       
                                          
                                             τ
                                             
                                                ←
                                             
                                          
                                          u
                                       
                                       −
                                       
                                          γ
                                          
                                             u
                                             ,
                                             j
                                          
                                          −
                                       
                                       
                                          
                                             τ
                                             
                                                ←
                                             
                                          
                                          
                                             u
                                             −
                                             1
                                          
                                       
                                    
                                 . This involves the known cumulative travel time from the profile. Hence the travel time equations can be computed more efficiently in the following way:

                                    
                                       (45)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            u
                                                            =
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            U
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            γ
                                                            
                                                               u
                                                               ,
                                                               j
                                                            
                                                            +
                                                         
                                                         
                                                            
                                                               τ
                                                               →
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                         −
                                                         
                                                            γ
                                                            
                                                               u
                                                               ,
                                                               j
                                                            
                                                            −
                                                         
                                                         
                                                            
                                                               τ
                                                               →
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     γ
                                                                     
                                                                        u
                                                                        ,
                                                                        j
                                                                     
                                                                     −
                                                                  
                                                                  s
                                                                  
                                                                     t
                                                                     u
                                                                  
                                                               
                                                               δ
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     γ
                                                                     
                                                                        u
                                                                        ,
                                                                        j
                                                                     
                                                                     +
                                                                  
                                                                  e
                                                                  
                                                                     n
                                                                     u
                                                                  
                                                               
                                                               δ
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               t
                                                               →
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      +
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                               →
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                         δ
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  ,
                                                                  j
                                                               
                                                               +
                                                            
                                                            
                                                               β
                                                               j
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  ,
                                                                  j
                                                               
                                                               −
                                                            
                                                            
                                                               α
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (46)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         
                                                            ←
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            u
                                                            =
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            U
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            γ
                                                            
                                                               u
                                                               ,
                                                               j
                                                            
                                                            +
                                                         
                                                         
                                                            
                                                               τ
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                         −
                                                         
                                                            γ
                                                            
                                                               u
                                                               ,
                                                               j
                                                            
                                                            −
                                                         
                                                         
                                                            
                                                               τ
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        γ
                                                                        
                                                                           u
                                                                           ,
                                                                           j
                                                                        
                                                                        −
                                                                     
                                                                     s
                                                                     
                                                                        t
                                                                        u
                                                                     
                                                                  
                                                                  δ
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        γ
                                                                        
                                                                           u
                                                                           ,
                                                                           j
                                                                        
                                                                        +
                                                                     
                                                                     e
                                                                     
                                                                        n
                                                                        u
                                                                     
                                                                  
                                                                  δ
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               t
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      +
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               i
                                                               ,
                                                               u
                                                            
                                                         
                                                         δ
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  ,
                                                                  j
                                                               
                                                               +
                                                            
                                                            
                                                               β
                                                               j
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  ,
                                                                  j
                                                               
                                                               −
                                                            
                                                            
                                                               α
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 The sub-division model can then be solved. The positioning of sub sections is very important. This is clearly demonstrated by Fig. 4 for the example shown in Fig. 2. Fig. 4 shows the effect of the positioning a single division (i.e. mid-point). The theoretical capacity varies between 51.798 and 103.597 trains. The results for up to ten divisions are shown in Table 1 and Fig. 5a. Solution times were no more than 3 seconds. This table verifies that capacity can be increased by n times as proven in the lemmas.□

For the directional mix of trains given by η = [0.5, 0.3, 0.2] and μ = [0.2, 0.3, 0.6] with travelling times 
                              
                                 τ
                                 →
                              
                           = [[10, 3, 5, 15], [11, 3.2, 5.2, 18], [15, 3.5, 5.5, 20]] and 
                              
                                 τ
                                 
                                    ←
                                 
                              
                            = [[4, 9, 5, 2], [4.2, 9.2, 7, 3], [4.5, 9.5, 8, 4]], the results are shown in Table 2
                            and Fig. 5b. It is interesting to note the subtle difference in the results, i.e. in sub section position and length.

Further numerical investigations have shown that the use of theoretical travel times also affects the analysis. Let the distance along each incline in the profile be 
                              
                                 d
                                 =
                              
                            (55, 51, 50, 60) metres respectively. Let the speed of the three train types be 
                              
                                 V
                                 =
                                 (
                                 60
                                 ,
                                 80
                                 ,
                                 100
                                 )
                              
                            and let the incline factor be 
                              
                                 φ
                                 =
                                 (
                                 1.2
                                 ,
                                 0.9
                                 ,
                                 0.0
                                 ,
                                 
                                 1.5
                                 )
                              
                           . The travelling times are computed as follows 
                              
                                 
                                    τ
                                    →
                                 
                                 =
                                 
                                    (
                                    
                                       φ
                                       ·
                                       d
                                    
                                    )
                                 
                                 /
                                 V
                              
                            and 
                              
                                 
                                    τ
                                    
                                       ←
                                    
                                 
                                 =
                                 d
                                 /
                                 
                                    (
                                    
                                       φ
                                       ·
                                       V
                                    
                                    )
                                 
                              
                           . For two different proportional mixes of trains, the results in Tables 3
                            and 4
                            were obtained. In these tables 
                              
                                 A
                                 n
                              
                            refers to the theoretical capacity when there are n sub sections. The two tables above show that except for one case, the proportional mix of trains does not alter the position of sub sections. In summary it can be concluded that the directional mix has a greater influence on sub section positioning.

In this section, the two capacity expansion alternatives investigated previously have been combined into a single decision model. The reason for doing this is that while the effect of duplication and sub division is similar, the costs may not be. Furthermore, real life technical constraints may need to be added, that will restrict options at different locations within the railway network. The following model is therefore formulated:


                     Maximise: 
                     Eq. (8)
                  


                     Subject to:
                  

Constraints (3)-(7), (10), (13), (14), (17)

                        
                           (47)
                           
                              
                                 S
                                 =
                                 
                                    ∑
                                    
                                       s
                                       ∈
                                       S
                                    
                                 
                                 
                                    C
                                    s
                                    ‡
                                 
                                 
                                    (
                                    
                                       
                                          n
                                          s
                                       
                                       −
                                       1
                                    
                                    )
                                 
                                 +
                                 
                                    C
                                    s
                                    ∥
                                 
                                 .
                                 
                                    ∥
                                    s
                                 
                                 ≤
                                 B
                                 
                                 
                                    [
                                    
                                       Limit
                                       
                                       on
                                       
                                       spending
                                    
                                    ]
                                 
                              
                           
                        
                     
                     
                        
                           (48)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                 
                                    (
                                    
                                       
                                          
                                             Y
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             →
                                          
                                       
                                       
                                          
                                             T
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             →
                                          
                                       
                                       +
                                       
                                          
                                             Y
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             
                                                ←
                                             
                                          
                                       
                                       
                                          
                                             T
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             
                                                ←
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       F
                                    
                                    ‡
                                 
                                 
                                    (
                                    
                                       
                                          n
                                          s
                                       
                                       ,
                                       
                                          τ
                                          s
                                       
                                       
                                       +
                                       
                                       
                                          ∥
                                          s
                                       
                                       ,
                                       T
                                    
                                    )
                                 
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                                 
                                 
                                 
                                    [
                                    
                                       Section
                                       
                                       saturation
                                    
                                    ]
                                 
                              
                           
                        
                     This model requires many of the constraints previously formulated. Constraint (47) however differs. It simultaneously describes the total spending and enforces a bound on it. In (48) the standard section saturation constraint has been modified to include both the effect of duplication and sub division. It is assumed that every duplicated track is sub divided in the same way, or equivalently, every sub section is duplicated in the same way. An alternative approach would be to sub divide first and then to duplicate some and not all sub sections. This approach however has not been taken here. Constraint (48) however is non-linear because of the product of the integer decision variables ns
                      and ∥
                        s
                      in the RHS. The standard approach is to let 
                        
                           
                              ξ
                              s
                           
                           =
                           
                              n
                              s
                           
                           .
                           
                              ∥
                              s
                           
                        
                      and to redefine (48) as follows:

                        
                           (49)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             Y
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             →
                                          
                                       
                                       
                                          
                                             T
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             →
                                          
                                       
                                       +
                                       
                                          
                                             Y
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             
                                                ←
                                             
                                          
                                       
                                       
                                          
                                             T
                                             
                                                i
                                             
                                             s
                                          
                                          
                                             
                                                ←
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    (
                                    
                                       
                                          n
                                          s
                                       
                                       
                                          τ
                                          s
                                       
                                       +
                                       
                                          ξ
                                          s
                                       
                                    
                                    )
                                 
                                 T
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                     To compute ξs
                      the standard approach, as described in AIMMS 3.13 (2014), is to impose the constraints 
                        
                           0
                           ≤
                           
                              ξ
                              s
                           
                           ≤
                           
                              ∥
                              s
                              max
                           
                           ·
                           
                              n
                              s
                           
                        
                      and 
                        
                           
                              ∥
                              s
                           
                           ≤
                           
                              ξ
                              s
                           
                           ≤
                           
                              
                                 n
                                 ¯
                              
                              s
                           
                           ·
                           
                              ∥
                              s
                           
                        
                      because 
                        
                           0
                           ≤
                           
                              ∥
                              s
                           
                           ≤
                           
                              ∥
                              s
                              max
                           
                        
                      and 
                        
                           1
                           ≤
                           
                              n
                              s
                           
                           ≤
                           
                              
                                 n
                                 ¯
                              
                              s
                           
                        
                     . However this will not work here due to the presence of ns
                      and ∥
                        s
                      in other constraints and the effect of constraint (49) on the objective function. Hence some additional innovation is required. Fortunately an elegant solution has been found that makes use of another trick from the AIMMS 3.13 (2014) manual, for converting the non-linear product of a binary decision variable and a continuous one. Let 
                        
                           
                              ϕ
                              
                                 s
                                 ,
                                 j
                              
                           
                           =
                           1
                        
                      if 
                        
                           
                              ∥
                              s
                           
                           =
                           j
                        
                      and 
                        
                           
                              ϕ
                              
                                 s
                                 ,
                                 j
                              
                           
                           =
                           0
                        
                      otherwise. Hence, 
                        
                           
                              ∥
                              s
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    ∥
                                    s
                                    max
                                 
                              
                           
                           
                              (
                              
                                 j
                                 ·
                                 
                                    ϕ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                              
                              )
                           
                        
                      and therefore by substitution, 
                        
                           
                              ξ
                              s
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    ∥
                                    s
                                    max
                                 
                              
                           
                           
                              (
                              
                                 j
                                 ·
                                 
                                    n
                                    s
                                 
                                 ·
                                 
                                    ϕ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                              
                              )
                           
                        
                     . This equation involves the sum of binary and integer decision variables. If we let 
                        
                           
                              λ
                              
                                 s
                                 ,
                                 j
                              
                           
                           =
                           
                              n
                              s
                           
                           ·
                           
                              ϕ
                              
                                 s
                                 ,
                                 j
                              
                           
                        
                      then the following four constraints can be added to perform that multiplication:

                        
                           (50)
                           
                              
                                 
                                    ϕ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                                 ≤
                                 
                                    λ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                                 ≤
                                 
                                    ϕ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                                 ·
                                 
                                    
                                       n
                                       ¯
                                    
                                    s
                                 
                                 ;
                              
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    n
                                    s
                                 
                                 −
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          ϕ
                                          
                                             s
                                             ,
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 ·
                                 
                                    n
                                    ¯
                                 
                                 ≤
                                 
                                    λ
                                    
                                       s
                                       ,
                                       j
                                    
                                 
                                 ≤
                                 
                                    n
                                    s
                                 
                              
                           
                        
                     
                  

Similarly to facilitate the correct designation of ϕ
                     
                        s, j
                      the following constraints must also be added:

                        
                           (52)
                           
                              
                                 j
                                 −
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          ϕ
                                          
                                             s
                                             ,
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 ·
                                 ℧
                                 ≤
                                 
                                    ∥
                                    s
                                 
                                 ≤
                                 j
                                 +
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          ϕ
                                          
                                             s
                                             ,
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 ·
                                 ℧
                              
                           
                        
                     
                  

The railway network from Burdett and Kozan (2006) has been chosen to demonstrate the techniques developed in this article. It is shown diagrammatically in Fig. 6
                     . That
                     
                      network is a simplified version of a much larger real life network in Australia and is of sufficient size and complexity to demonstrate the techniques developed in this article. There are no perceived issues with solving larger instances as the analytical model is not NP-hard. It is based upon a bottleneck analysis approach and scales linearly as the problem size increases. This is demonstrated by an analysis of the models complexity. The demonstration of the proposed approach on a larger case study is therefore not warranted, besides, the recurrent use of this network is beneficial as it provides a benchmark for other researchers and practitioners and allows constancy between articles on the same topic.

The results in this section were obtained by ILOG OplStudio which was run under Windows 7 on a 64 bit, quad core, Dell PC with a 2.5 gigahertz processor and 4 gigabyte memory. No CPU times have been described in this section as the models were not computationally difficult or time consuming to solve. The parameters for this case study are summarised in Table 5. These parametric details are shown using set and array notation (i.e. {} and []). They describe the networks topology and the associated information about the trains that will use the network. They have been explained earlier in the paper, however for ease of understanding they are as follows: time period duration, set of corridors, set of section, set of train types, train speeds, section lengths, number of tracks in each section, directional and proportional train mix, sections within corridors.

For the specified mix of trains and no constraint regulating competition between different corridors, the theoretical capacity was 561.37 trains with the following train numbers on each corridor. The train numbers on each corridor are shown in Table 6.

The track duplication model of Section 3 was first applied with a limitation of one track duplication per section and equal flow on each of the corridors. The results
                     
                     
                      are shown in Table 7.

It is interesting to note that after nine duplications, no further improvement in 
                        A
                      is possible. For example, it is not worthwhile to duplicate the remaining 12 unduplicated sections. For further improvements some duplicated sections must be duplicated again. For example if the number of duplications was increased to two then the results in Table 8 can be obtained. As the earlier results are the same, they are not redisplayed. After 18 duplications, another capacity expansion bottleneck is reached. To obtain further improvements, the limit should be increased to three. These results are shown in Table 9 for up to 26 duplications. In conclusion track duplications can only increase capacity so far and capacity improvements are not unlimited.

Under an assumption of constant velocity, the model of Section 3.2 was applied to determine the most effective section sub divisions. The results are shown in Table 10. The (× number) notation describes the number of times the section was divided. Hence ×1, ×2 and ×3 means that there are two, three and four sub sections created respectively. These results are also obtained by the duplication model when the constraint that imposes equal flow on each corridor is relaxed.

The increase in capacity is piecewise linear. Furthermore the rate of increase that occurs on each segment is not the same; but it is quite similar. Based on the specified mix of trains, it is more beneficial to divide sections which are not necessarily the longest, as greater increases can be achieved. For reference purposes the ordering of the sections from largest to smallest is as follows: 10, 19, 20, 16, 11, 21, 18, 5, 15, 3, 9, 8, 6, 14, 4, 7, 2, 13, 17, 12, 1. Hence the longest sections (i.e. 10, 19, 20) were not divided. In this scenario, the sections that are divided first are those that are most heavily used. In other words they are utilised by more corridors. The model also determined it was best to obtain higher capacity on certain corridors (i.e. 1, 2, and 6) and not the others. As the results in Table 10 are somewhat biased, the percentage flow constraint that regulates competition between different corridors was re-introduced. The results for equal flow on each corridor are shown in Table 11.

The theoretical capacity is hence much reduced. The sections that are sub divided are now generally those that are longest. But as in Table 10, the decisions made do not exactly follow the descending order of section length. After 15 divisions, no further results have been presented in Table 11 as the results shown are the same as those obtained in Tables 7 and 8. In other words the effect on theoretical capacity, of duplication and sub division is exactly the same. The only difference between the two strategies is the way in which the bounds are defined. For track duplications the bound is inherently linked to availability of land adjacent to the section. For section sub divisions, the bound is inherently linked to the minimum allowable sub section length. These two bounds are incompatible and hence there is no generic way of comparing the two alternatives.

The general expansion model was then applied with varying limits on the maximum number of track duplications per section. The results are shown in Table 12
                     . In summary that table shows quite a difference in the obtained solutions, i.e. in the number of sub divisions and duplications. The combined approach has also bypassed the bottleneck issue identified in Tables 7–9 by instead sub dividing sections when the duplication limit has been reached. Hence the capacity is the same in each row, regardless of ∥max.


                     
                        Building a 
                        n
                        ew 
                        n
                        etwork:
                      The capacity expansion methods may be used to design a new railway network and this is of great practical importance. To do this a starting template should be provided. For this case study, the skeleton template shown in Fig. 7
                      is assumed with the following parametric details in Table 13.
                     
                  

The main idea is to divide each line into various sections and to duplicate sections to achieve the greatest capacity, or else to achieve a specified level of capacity. The sub section division model was first applied and the results are shown in Table 14. In the absence of a specific budget and specific costs, an incremental approach has been taken.

The results in Table 14
                     b are quite important; they show how capacity is incrementally increased when restrictions are placed on corridor traffic. It is interesting to note that the increase is step wise linear, but varies considerably more so than in the unrestricted case. To reach the capacity of the original network, which has 21 sections and a capacity of 268 trains, the skeleton network requires at least 7 sub divisions and 8 to be sure of exceeding the original capacity. To check that this is correct, the network in Fig. 8
                      was defined. In Fig. 8 the new sub sections are distributed equidistantly as profile information is not available. The original base capacity model was applied and the same capacity results were obtained. Hence 12 sections are strictly necessary. In summary it can be concluded that the 21 sections present in the actual network are not entirely necessary for a set of operational assumptions and the imposed proportional, directional and percentage flow restrictions. From a practical point of view the presence of more sections can provide a greater level of robustness and this should not be underestimated. If a specific theoretical capacity is necessary, then the model can be easily altered to identify how this can be achieved. For instance if 
                        
                           A
                           =
                           600
                        
                      the models result was 20 divisions and the following number of sub sections (3, 5, 5, 5, 7).

Upon reflection the application of the duplication model is not entirely useful here when considering the development of a new network. The reason for this is that it only duplicates the existing undeveloped corridors which have yet to be partitioned. Hence the capacity can only be increased extensively and at great cost by duplicating the entire corridors. It is better to apply the general model and the results of its application are shown in Table 15
                     . The theoretical capacity values are predominantly the same as those described earlier, for instance by the application of either of the two alternative expansion models. It is interesting to note that a difference does occur after 19 alterations. For example there is a capacity expansion bottleneck for 
                        
                           
                              ∥
                              max
                           
                           =
                           1
                        
                      at 20 and above. It is also interesting to note the differences in the solutions. For example the manner in which the model has selected to sub-divide or duplicate sections. The strategies vary considerably as the number of extensions allowed is incrementally increased. In some cases the model has chosen to sub divide and in others it has chosen to duplicate. To achieve 268 trains, the combined model has suggested two completely different solutions, and these are shown in Fig. 9.
                     
                  

@&#CONCLUSIONS@&#

Railway capacity determination and railway capacity expansion are increasingly important topics as railways become more developed, sophisticated and have greater demands placed upon them. In this article Railway Capacity Expansion Models (RCEM) have been developed to identify how a railway should be expanded. This capability has not been provided in previous analytical approaches. Although a number of assumptions and simplifications were made, the merit of these models is obvious and it is believed that additional real life factors can be incorporated at a future time. For example, more accurate mathematical functions can be obtained for the exact increase in actual capacity that occurs, for instance when a section is duplicated or sub divided.

Two capacity expansion possibilities were considered. The first involves track duplications (RCEM-TRKDUP), and the second section sub divisions (RCEM-SUBDIV). A model that combines both alternatives was also formulated (RCEM-GEN). These models were applied to a case study and significant worth has been demonstrated. The models for choosing which sections to duplicate and sub divide are quite straight forward yet powerful. The model that was developed for identifying sub section positions however is more sophisticated. In summary, section sub division was found to be the best and cheapest option as the cost of track duplications is proportional to its length, whereas sub division is a static cost. It should however not be forgotten that dividing sections is not a magic bullet for all situations. An additional track is highly advantageous too and can allow trains moving in different directions to be on the same section. In contrast sub divisions can help increase capacity when there is predominantly uni-directional flow. In terms of theoretical capacity, and ignoring some additional real life factors, both methods provide similar levels of increase. This article has shown that under what circumstances it is better to duplicate or divide is context dependent and specific to the exact technical conditions of a case study.

The capacity expansion methods may also be used to design a completely new railway network as opposed to expanding an existing one; this is of great practical importance. A description of how the techniques can be used to do this was provided.

The analytical models for capacity expansion were solved for a specified proportional and directional mix of trains and for specified percentage flows on each corridor. These are subject to change in practice, and at different times during the day. Hence the suggested solutions are only appropriate under those circumstances. A manual approach whereby different configurations are obtained and compared can be performed. The end result of that analysis would be the identification of the most robust design. An important source of future research is hence the development of a generic automated approach to perform that analysis, and to provide the most robust and efficient solution over all possibilities.

@&#ACKNOWLEDGEMENTS@&#

I would like to thank Ms Bayan Bevrani for motivating the development of this article and for her involvement with some parts of Section 3. I would also like to thank two anonymous referees for their feedback that has allowed this article to be greatly improved.

The following is a list of the notation used. In the article some of the sub scripts have been dropped for example when not referring to specific train, corridor or sections, and the meaning is obvious.

                        
                           c, i, j, s, u, k:
                        
                           index for corridor, train type, sub section, section and location in a profile.

set of corridors, train types and sections.

number of trains of type i that traverse corridor c in each direction respectively.

number of trains of type i that traverse each section s.

time spent by trains when travelling across each section in each direction.

time to traverse the jth sub section of section s.

speed of trains generally or for specific train types.

proportional/directional mix of trains on each corridor, and across different corridor.

number of tracks in each section initially and the number to be added afterwards.

sections present in each corridor.

the theoretical capacity of the network and for particular sections or sub sections.

cost of duplication and sub division in each section.

budget for expansion activities and total spending.

length of a section generally and for a specific section s.

number of new divisions.

used on several occasions as a number of things.

number of divisions and the size of a division.

number of sub divisions in section s and the upper bound.

weighted average sectional running time generally or for a specific section or division.

minimum sub section length.

total number of points in the profile for section s and the spacing between points.

cumulative travel time to the uth point within the profile.

start and end position of the jth sub section in section s and its respective length.

for the jth sub section within section s, the index of its start and end with respect to the profile.

position of the uth location in the profile and the location from the left side.

position of the jth division.

travelling time within segments of the discretised domain in each direction.

Binary variable to define where the jth sub section occurs w.r.t one of the discretisations.

Binary variable to describe where the left and right boundary of the sub section occurs in relation to one of the discretisations.

an appropriately large value.

Start and end of the uth segment in the profile.

product of binary and integer decision variables.

product of two decision variables ns
                               and ∥
                                 s
                              .

binary decision to facilitate the calculation of the non-linear term ξs
                              .

product of ns
                               and ϕ
                              
                                 s, j
                              .

incline reduction factor.


                     
                        Lemma 1
                        
                           Theoretical capacity is at most n times larger when a section of rail is divided equidistantly into n sub-sections and the up and down sectional running time
                           
                              
                                 T
                                 
                                    →
                                 
                              
                            
                           and
                           
                              
                                 T
                                 
                                    ←
                                 
                              
                            
                           are equal (i.e. 
                              
                                 
                                    T
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    T
                                    
                                       ←
                                    
                                 
                              
                           ).


                     
                        Proof
                        Let 
                              A
                            be the theoretical capacity of a section of rail such that, 
                              
                                 A
                                 =
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          T
                                          
                                             →
                                          
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          T
                                          
                                             ←
                                          
                                       
                                    
                                 
                              
                           . Because 
                              
                                 
                                    T
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    T
                                    
                                       ←
                                    
                                 
                                 =
                                 
                                    T
                                    ¯
                                 
                                 =
                                 
                                    L
                                    V
                                 
                              
                           , the directional mix of trains is unimportant. Hence, 
                              
                                 A
                                 =
                                 T
                                 /
                                 
                                    T
                                    ¯
                                 
                                 =
                                 T
                                 ·
                                 V
                                 /
                                 L
                              
                           . The theoretical capacity of each sub-section j is as follows: 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 
                                    T
                                    
                                       
                                          T
                                          ¯
                                       
                                       j
                                    
                                 
                                 =
                                 T
                                 ·
                                 V
                                 /
                                 
                                    L
                                    j
                                 
                              
                           . As 
                              
                                 
                                    L
                                    j
                                 
                                 =
                                 L
                                 /
                                 n
                              
                            then 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 n
                                 ·
                                 T
                                 ·
                                 V
                                 /
                                 L
                                 =
                                 n
                                 A
                              
                           .□


                     
                        Lemma 2
                        
                           A section of rail should be split into equidistant sub sections in order to increase theoretical capacity.
                        


                     
                        Proof
                        If the section was not divided equidistantly then the theoretical capacity (i.e. using bottleneck analysis logic) would be based upon the longest sub section or else the sub section with the greatest SOT. In the former case the length (i.e. denoted by L*) will be greater than L/n. Given that 
                              
                                 
                                    T
                                    *
                                 
                                 =
                                 
                                    L
                                    *
                                 
                                 /
                                 n
                              
                            then 
                              
                                 
                                    A
                                    *
                                 
                                 =
                                 T
                                 .
                                 V
                                 /
                                 
                                    L
                                    *
                                 
                              
                           . As L* > L/n then 
                              
                                 
                                    A
                                    *
                                 
                                 =
                                 
                                    
                                       T
                                       .
                                       V
                                    
                                    
                                       L
                                       *
                                    
                                 
                                 <
                                 
                                    
                                       T
                                       .
                                       V
                                    
                                    
                                       L
                                       /
                                       n
                                    
                                 
                              
                           . Hence theoretical capacity is less.□


                     
                        Lemma 3
                        
                           Theoretical capacity will be n times bigger even when the sectional occupancy times are different in each direction, provided that the velocity is constant across the entire section.


                     
                        Proof
                        Let 
                              
                                 
                                    (
                                    
                                       
                                          T
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          T
                                          
                                             ←
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          L
                                          
                                             V
                                             →
                                          
                                       
                                       ,
                                       
                                          L
                                          
                                             V
                                             
                                                ←
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                            and let 
                              
                                 μ
                                 =
                                 (
                                 
                                    
                                       μ
                                       →
                                    
                                    ,
                                    
                                       μ
                                       
                                          ←
                                       
                                    
                                 
                                 )
                              
                            be the directional “percentage” mix of trains. The capacity of an equidistant sub section is as follows:

                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                j
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   T
                                                   
                                                      
                                                         μ
                                                         →
                                                      
                                                      
                                                         
                                                            T
                                                            →
                                                         
                                                         j
                                                      
                                                      +
                                                      
                                                         μ
                                                         
                                                            ←
                                                         
                                                      
                                                      
                                                         
                                                            T
                                                            
                                                               ←
                                                            
                                                         
                                                         j
                                                      
                                                   
                                                
                                                =
                                                
                                                   T
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                               →
                                                            
                                                            
                                                               L
                                                               j
                                                            
                                                         
                                                         
                                                            V
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               μ
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               L
                                                               j
                                                            
                                                         
                                                         
                                                            V
                                                            
                                                               ←
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   T
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                               →
                                                            
                                                            L
                                                         
                                                         
                                                            n
                                                            
                                                               V
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               μ
                                                               
                                                                  ←
                                                               
                                                            
                                                            L
                                                         
                                                         
                                                            n
                                                            
                                                               V
                                                               
                                                                  ←
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   T
                                                   
                                                      
                                                         L
                                                         n
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  μ
                                                                  →
                                                               
                                                               
                                                                  V
                                                                  
                                                                     →
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  μ
                                                                  
                                                                     ←
                                                                  
                                                               
                                                               
                                                                  V
                                                                  
                                                                     ←
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      T
                                                      n
                                                   
                                                   
                                                      L
                                                      (
                                                      
                                                         
                                                            
                                                               μ
                                                               →
                                                            
                                                            
                                                               V
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               μ
                                                               
                                                                  ←
                                                               
                                                            
                                                            
                                                               V
                                                               
                                                                  ←
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                =
                                                n
                                                .
                                                
                                                   T
                                                   
                                                      
                                                         μ
                                                         →
                                                      
                                                      
                                                         T
                                                         →
                                                      
                                                      +
                                                      
                                                         μ
                                                         
                                                            ←
                                                         
                                                      
                                                      
                                                         T
                                                         
                                                            ←
                                                         
                                                      
                                                   
                                                
                                                =
                                                n
                                                A
                                             
                                          
                                       
                                    
                                 
                              
                           For example: Let 
                              
                                 μ
                                 =
                                 (
                                 
                                    0.6
                                    ,
                                    0.4
                                 
                                 )
                              
                           . If 
                              
                                 n
                                 =
                                 2
                              
                           , 
                              
                                 A
                                 =
                                 
                                    1440
                                    
                                       0.6
                                       (
                                       6
                                       )
                                       +
                                       0.4
                                       (
                                       8
                                       )
                                    
                                 
                                 =
                                 211.76
                              
                           , 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 
                                    1440
                                    
                                       0.6
                                       
                                          (
                                          
                                             6
                                             2
                                          
                                          )
                                       
                                       +
                                       0.4
                                       
                                          (
                                          
                                             8
                                             2
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 423.53
                                 =
                                 2
                                 A
                              
                           .□


                     
                        Lemma 4
                        
                           The theoretical capacity increases by a factor of L/Lj if the longest sub section (i.e. j) has length Lj
                           .


                     
                        Proof
                        For a single train type and direction of travel, 
                              
                                 A
                                 =
                                 T
                                 /
                                 
                                    T
                                    ¯
                                 
                              
                            where 
                              
                                 
                                    T
                                    ¯
                                 
                                 =
                                 L
                                 /
                                 V
                              
                           . Given Lj
                            < L and 
                              
                                 
                                    T
                                    j
                                 
                                 =
                                 
                                    L
                                    j
                                 
                                 /
                                 V
                              
                            then 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 T
                                 /
                                 
                                    T
                                    j
                                 
                                 =
                                 T
                                 .
                                 V
                                 /
                                 
                                    L
                                    j
                                 
                              
                           . Hence by substitution: 
                              
                                 
                                    A
                                    j
                                 
                                 /
                                 A
                                 =
                                 
                                    
                                       T
                                       V
                                    
                                    
                                       L
                                       j
                                    
                                 
                                 ÷
                                 
                                    T
                                    
                                       T
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       V
                                       .
                                       
                                          T
                                          ¯
                                       
                                    
                                    
                                       L
                                       j
                                    
                                 
                                 =
                                 
                                    L
                                    
                                       L
                                       j
                                    
                                 
                              
                           . For multiple train types and both directions of travel, it can be shown that 
                              
                                 A
                                 =
                                 
                                    T
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   →
                                                
                                                i
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           . Therefore: 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 
                                    
                                       T
                                       ¯
                                    
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   →
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           . As 
                              
                                 
                                    (
                                    
                                       
                                          
                                             T
                                             →
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             L
                                             j
                                          
                                          
                                             
                                                V
                                                
                                                   →
                                                
                                             
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             L
                                             j
                                          
                                          
                                             
                                                V
                                                
                                                   ←
                                                
                                             
                                             i
                                          
                                       
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    (
                                    
                                       
                                          
                                             T
                                             →
                                          
                                          i
                                       
                                       ,
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          L
                                          
                                             
                                                V
                                                
                                                   →
                                                
                                             
                                             i
                                          
                                       
                                       ,
                                       
                                          L
                                          
                                             
                                                V
                                                
                                                   ←
                                                
                                             
                                             i
                                          
                                       
                                    
                                    )
                                 
                              
                            the ratio is as follows: 
                              
                                 
                                    
                                       A
                                       j
                                    
                                    A
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   →
                                                
                                                i
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   →
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   T
                                                   
                                                      ←
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                L
                                                
                                                   
                                                      V
                                                      
                                                         →
                                                      
                                                   
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                L
                                                
                                                   
                                                      V
                                                      
                                                         ←
                                                      
                                                   
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                
                                                   L
                                                   j
                                                
                                                
                                                   
                                                      V
                                                      
                                                         →
                                                      
                                                   
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   L
                                                   j
                                                
                                                
                                                   
                                                      V
                                                      
                                                         ←
                                                      
                                                   
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                1
                                                
                                                   
                                                      V
                                                      
                                                         →
                                                      
                                                   
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                1
                                                
                                                   
                                                      V
                                                      
                                                         ←
                                                      
                                                   
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          L
                                          j
                                       
                                       
                                          ∑
                                          i
                                       
                                       
                                          η
                                          i
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                   →
                                                
                                                i
                                             
                                             
                                                1
                                                
                                                   
                                                      V
                                                      
                                                         →
                                                      
                                                   
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                   
                                                      ←
                                                   
                                                
                                                i
                                             
                                             
                                                1
                                                
                                                   
                                                      V
                                                      
                                                         ←
                                                      
                                                   
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    L
                                    
                                       L
                                       j
                                    
                                 
                              
                           
                           □


                     
                        Lemma 5
                        
                           The weighted sectional running time on each sub section j should be equal in order for capacity to be expanded optimally. The value should be
                           
                              
                                 
                                    W
                                    j
                                 
                                 =
                                 W
                                 /
                                 n
                              
                            
                           where
                           
                              
                                 W
                                 =
                                 
                                    μ
                                    →
                                 
                                 
                                    T
                                    →
                                 
                                 +
                                 
                                    μ
                                    
                                       ←
                                    
                                 
                                 
                                    T
                                    
                                       ←
                                    
                                 
                              
                           .


                     
                        Proof
                        Let 
                              
                                 A
                                 =
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          T
                                          →
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          T
                                          
                                             ←
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          
                                             T
                                             →
                                          
                                          j
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          j
                                       
                                    
                                 
                              
                           . Lemma 1 showed that 
                              
                                 
                                    A
                                    j
                                 
                                 =
                                 n
                                 A
                              
                           . Therefore: 
                              
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          
                                             T
                                             →
                                          
                                          j
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          j
                                       
                                    
                                 
                                 =
                                 n
                                 A
                              
                           . By substitution: 
                              
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          
                                             T
                                             →
                                          
                                          j
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          
                                             T
                                             
                                                ←
                                             
                                          
                                          j
                                       
                                    
                                 
                                 =
                                 n
                                 
                                    T
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          T
                                          →
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          T
                                          
                                             ←
                                          
                                       
                                    
                                 
                              
                           . By rearrangement and simplification: 
                              
                                 
                                    μ
                                    →
                                 
                                 
                                    
                                       T
                                       →
                                    
                                    j
                                 
                                 +
                                 
                                    μ
                                    
                                       ←
                                    
                                 
                                 
                                    
                                       T
                                       
                                          ←
                                       
                                    
                                    j
                                 
                                 =
                                 
                                    
                                       
                                          μ
                                          →
                                       
                                       
                                          T
                                          →
                                       
                                       +
                                       
                                          μ
                                          
                                             ←
                                          
                                       
                                       
                                          T
                                          
                                             ←
                                          
                                       
                                    
                                    n
                                 
                              
                           . The lhs is 
                              
                                 W
                                 j
                              
                            and the rhs is 
                              
                                 W
                                 /
                                 n
                              
                           .□

@&#REFERENCES@&#

