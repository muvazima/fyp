@&#MAIN-TITLE@&#Optimum wavelet based masking for the contrast enhancement of medical images using enhanced cuckoo search algorithm

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An Optimum Wavelet Based Masking (OWBM) algorithm for medical image enhancement.


                        
                        
                           
                           Hybrid algorithm with cuckoo search and adaptive genetic operators is proposed.


                        
                        
                           
                           Dynamic nest rebuilding of the cuckoo search is performed.


                        
                        
                           
                           The proposed algorithm performed better results compared to the reported medical enhancement techniques.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Contrast enhancement

Cuckoo search algorithm

Genetic algorithm

Unsharp masking

Wavelet transforms

Medical imaging

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           fx1
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Contrast enhancement is a technique which improves the image quality for various applications. In medical image analysis, contrast enhancement algorithms are used as a preprocessing module. Medical image analysis mainly helps in improving the clarity of diagnosis. Generally, contrast enhancement is classified as example based [1] and intensity based [2]. Intensity based enhancement is broadly classified as the histogram based, transform domain, filter based and masking based approaches. Histogram based approach is a conventional contrast manipulation technique [3]. Akila et al. [4] performed a comparative study on different histogram based techniques for mammogram image enhancement. Improved histogram techniques are modified for better enhancement; such as automatic exact histogram specification [5], segments dependent dynamic multi histogram equalization [6] and threshold optimized histogram equalization [7] etc. Wavelet transform techniques have a greater role in image processing such as compression [8], segmentation [9], enhancement [10] etc. Lie et al. [11] developed a Stationary Wavelet Transform (SWT) based enhancement for finding the de bonding defects in solid rocket motors. Feng et al. [12] developed a contourlet transform based technique for retinal image enhancement. Liao et al. [13] proposed multi scale top hat transform based enhancement technique for retinal vessel enhancement; quality of enhancement is analyzed using extracted blood vessels and the available ground truth vessels. Fourier domain is a very conventional approach in transform based signal processing. Rallabandi and Roy [14] proposed a Fourier based image enhancement approach for Magnetic Resonance (MR) images. Anand et al. [15] proposed directional transform based enhancement algorithm for mammographic X-ray images. Filtering is the process of selecting a desired band of signal. In image communication, filter based techniques are mainly used for restoration [16–18] and enhancement. Paul et al. [17] proposed a neighborhood filter for MR image enhancement. Unsharp masking is an enhancement approach, in which scale value is used for mask formulation. Depending on the scale value, mask is classified as unsharp mask and high boost mask. Conventional masking techniques use static scale value, which is based on random selection [19–20]. Polesel et al. [19] proposed an adaptive unsharp masking technique for image enhancement. Optimum scale value selection can dynamically adjust the scale value using an optimization algorithm. There are various optimization algorithms applied in image processing applications, such as Genetic Algorithm (GA) [21,22], Particle Swarm Optimization (PSO) [23–25], Ant Colony Optimization (ACO) [26,27], Cuckoo Search Algorithm (CSA) [28,29] etc., which are some examples. Enhanced Genetic Algorithm (EGA) is a modified technique, in which crossover ratio and mutation ratio are selected based on the threshold value [30]. Conventional cuckoo search algorithm is modified for the performance improvement based on genetic operators and adaptive parameters [31–33].

The organization of this paper is as follows. Section 2 describes the generalized unsharp masking and the need of optimum scale value. Section 3 presents the proposed optimum wavelet based masking in detail. Section 4 discusses the conventional cuckoo search algorithm, need of the proposed adaptive rebuild of worst nest and enhanced cuckoo search algorithm in detail. Section 5 discusses the results and discussion. Lastly, Section 6 presents the conclusions.

Unsharp masking is a reliable contrast enhancement technique [34] in which, the filtered version of an original image is scaled with a fixed value and the resultant is subtracted from the original image, which is called a mask and is added with the original image as shown in 
                     Fig. 1. The main difficulty of this scheme is, fixed scale value irrespective of input images, in which scale values are selected randomly.

Our proposed technique is a dynamic unsharp masking, in which scale selection is performed using an optimization algorithm. Original image is decomposed as approximation coefficients and high pass filter using Discrete Wavelet Transform (DWT) given by Eq. (1). The approximated coefficients reconstructed using Inverse Discrete Wavelet Transformation (IDWT) is given by Eq. (2).
                        
                           (1)
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       φ
                                    
                                 
                                 (
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 m
                                 ,
                                 n
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             M
                                             N
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       x
                                       =
                                       0
                                    
                                    
                                       M
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          y
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             φ
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             m
                                             ,
                                             n
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          (
                                       
                                       
                                          x
                                       
                                       
                                          ,
                                       
                                       
                                          y
                                       
                                       
                                          )
                                       
                                    
                                    
                                       A
                                    
                                 
                                 
                                    =
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             MN
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             φ
                                          
                                       
                                       
                                          (
                                       
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    m
                                 
                                 
                                    ,
                                 
                                 
                                    n
                                 
                                 
                                    )
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       
                                          ,
                                       
                                       
                                          m
                                       
                                       
                                          ,
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    (
                                 
                                 
                                    x
                                 
                                 
                                    ,
                                 
                                 
                                    y
                                 
                                 
                                    )
                                 
                              
                           
                        
                     
                  

Where, 
                        
                           
                              
                                 W
                              
                              
                                 φ
                              
                           
                           (
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           ,
                           m
                           ,
                           n
                           )
                        
                      is the approximation coefficients, 
                        φ
                      represents the scale coefficients, 
                        
                           
                              j
                           
                           
                              0
                           
                        
                      is the arbitrary initial scale value, 
                        
                           m
                           ,
                           n
                        
                     is the wavelet domain discrete variables. In which, 
                        
                           f
                           (
                           x
                           ,
                           y
                           )
                        
                      is the input time domain image with discrete variables 
                        
                           x
                           ,
                           y
                        
                      with size 
                        
                           M
                           ×
                           N
                        
                     , here 
                        
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                           
                              =
                              0
                           
                        
                     , 
                        
                           
                              
                                 φ
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 m
                                 ,
                                 n
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        
                      is the scale function and 
                        
                           
                              f
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           
                              A
                           
                        
                      is the reconstructed approximation coefficients [35].

The reconstructed approximation coefficients consist of wavelet low pass filtered image. In our approach instead of the original image, wavelet approximated image is considered for masking formulation. Reconstructed low pass signal is optimum scaled using an enhanced cuckoo search algorithm. The mask formulated is optimum wavelet mask, which can dynamically improve the contrast of the image. Optimum wavelet mask is added to the original image and an intensity improved image is obtained as output image as shown in 
                     Fig. 2. The proposed technique can be used as preprocessing technique; here it is tested for brain MRI, face XR, MRI and ribs from Brain Web data base and various mammogram images from MIAS data base.
                        
                           Table
                           
                              
                              
                                 
                                    
                                       Algorithm for proposed OWBM
                                    
                                 
                              
                              
                                 
                                    Input: Original medical image
                                 
                                 
                                    Output: Enhanced medical image
                                 
                                 
                                    Step 1: Read the input image
                                 
                                 
                                    Step 2: Perform DWT (db4) decomposition as frequency sub bands [LL, LH, HL, HH]
                                 
                                 
                                    Step3: Reconstruct approximation coefficients LL
                                 
                                 
                                    Step 4: Select the optimum scale value using ECSA
                                 
                                 
                                    Step 5: Perform product of scale value and approximated image
                                 
                                 
                                    Step 6: Subtract the product from original image [mask]
                                 
                                 
                                    Step 7: Add the mask with original image
                                 
                              
                           
                        
                     
                  

This section is divided into 3 subsections as follows,
                        
                           1.
                           Conventional cuckoo search algorithm.

Need of adaptive nest rebuilding.

Proposed enhanced cuckoo search algorithm.

Yang and Deb [29] proposed a biological inspired optimization technique called cuckoo search algorithm (CSA) based on brood parasites of bird cuckoo. Usually cuckoo does not construct nests but lay their eggs in some host bird nests. If it identifies that the eggs are not their own, host bird either rebuild their nest or they will abandon their eggs. Egg contained in a nest is considered as a solution and cuckoo egg considered as a new solution. In cuckoo search, generation of new solutions x 
                        (t+1) is performed using levy fight.
                           
                              (3)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    α
                                    ⊗
                                    L
                                    e
                                    v
                                    y
                                    (
                                    λ
                                    )
                                 
                              
                           
                        
                     

In Eq. (3) step size 
                           
                              (
                              α
                              )
                           
                         is related to the scales of the problem of interests. The product 
                           ⊗
                         represents entry wise multiplications. The Levy flight essentially provides a random walk while the random step length is drawn from a Levy distribution.
                           
                              (4)
                              
                                 
                                    L
                                    e
                                    v
                                    y
                                    ~
                                    u
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          −
                                          λ
                                       
                                    
                                    ,
                                    (
                                    1
                                    <
                                    λ
                                    ≤
                                    3
                                    )
                                 
                              
                           
                        
                     

The objective of this technique is to replace the not so good egg by the new solution. In the conventional form, each nest has one egg. Nevertheless, the simplest algorithm can be extended to multiple solution applications [36].

In conventional cuckoo search, rate or probability (Pa) of nest rebuilding is a static value irrespective of the fitness of nests [29,36]. Yang and Deb [29] tested various probability values from 0.01 to 0.5 and reported probability value 0.25 is suited for their application. Stationary nests rebuilt can lead to keep in local minima or local maxima region. Li and Yin [31] proposed a self-adaptive approach based on static learning based on two learning parameters.

In this section, we have proposed an adaptive cuckoo search algorithm for scale value optimization. Here, fitness of each nest is estimated for all iterations and the threshold value is fixed based on the fitness value. The nests below the threshold value are abandoned each time and the probability of nest rebuilding is dynamically changed in all iterations. The abandoned nest is replaced using adaptive crossover and mutation. In our approach, the same threshold value is used for the probability of nest rebuilding and adaptive genetic operators. Unlike the conventional cuckoo search algorithm, in our proposed technique dynamically operates based on adaptive crossover and adaptive mutation as shown in 
                        Fig. 3. Implementation parameters of cuckoo search and genetic algorithm is given in 
                        Table 1.

@&#RESULTS AND DISCUSSION@&#

In this section, the performance of proposed OWBM as well as ECSA is analysed. The steps involved in qualitative and quantitative analysis of techniques are:
                        
                           1.
                           Quantitative results of enhanced cuckoo search algorithm.

Quantitative and qualitative analysis of OWBM with Brain web database medical images.

Quantitative and qualitative analysis of OWBM with mammogram database medical images.

In this section, the implementation result of ECSA is presented. Unlike the conventional cuckoo search analysis, here we have adaptively selected the ratio of nest rebuilding as listed in Table 1. Static probability of nest rebuilding (pa) may bias the contrast enhancement values in local maxima or local minima. In our analysis, the least number of nest rebuilding observed is pa=0.2291 for MRI data base image, that means 22.91% of nests are replaced in cuckoos search place and the remaining 77.09% of nests remain unaltered in generated solutions. In our ECSA, maximum number of nest rebuilding reported is pa=0.8299 for Brain MRI of data base image, that means 82.99% of nests are replaced in cuckoos search place and the remaining 17.01% of nests remain unchanged in generated solutions. The conventional unsharp masking technique uses static scale value for image analysis, in which fixed scale value (
                           
                              λ
                           
                        ) is not suited for medical image analysis. Demerits of fixed scale value are that, it might under or over boost the contrast of medical images. In our ECSA analysis, we considered 50 iterations and evaluated both mean scale value (
                           
                              
                                 λ
                              
                              
                                 mean
                              
                           
                        ) and best scale value (
                           
                              
                                 λ
                              
                              
                                 best
                              
                           
                        ). In which, 
                           
                              
                                 λ
                              
                              
                                 mean
                              
                           
                         is the average value of all scale values obtained in final iteration and 
                           
                              
                                 λ
                              
                              
                                 best
                              
                           
                         is the best value obtained in the final iteration or sorted first value in final iteration. Both mean and best scale values of our analysis are listed in 
                        Table 2.

In this section, we have analysed the performance of our proposed OWBM in brain web data base. Here we have considered five medical images: Brain MRI, Face XR, MRI and Ribs [10]. 
                        Fig. 4 shows original image, reconstructed approximation matrix, mask and the enhanced image. In which, the original image is reconstructed as wavelet based low pass filtered image using Eq. (2). The reconstructed approximation image is scaled using ECSA and resultant image is blurred in nature. The scaled image based mask is formulated which provides better visual information than approximated and scaled versions of images. The formulated mask is added with the original image and the resultant image is contrast enhanced image, which provided acceptable visual information than the original image. Comparison is done using PSNR and SSIM values with literature work. The quantitative PSNR results are given in 
                        Fig. 5(a) and SSIM values in Fig. 5(b).The result of PSNR provided the quality of enhancement whereas the SSIM provided the similarity between both the images as well as better values than reported works.

In this section, our proposed OWBM is tested with mammogram images obtained from publicly available MIAS database images [33]. Here we are considering four mammogram images: mdb209, mdb211, mdb212 and mdb213 for qualitative analysis and quantitative comparison. 
                        Fig. 6 shows original image, reconstructed approximation matrix, scaled pattern of the reconstructed matrix, formulated mask and enhanced image. The enhanced images have more visual clarity than that of original images. The performance evaluation of contrast improvement is performed based on AMBE values with various contrast enhancement techniques: Histogram Equalization (HE), Contrast Limited Adaptive Histogram Equalization (CLAHE) and Histogram Modified Local Contrast Enhancement (HM-LCE) reported in literature [3]. The quantitative results of ABME are provided quality of contrast improvement. It has better AMBE values than reported literature works as given in 
                        Table 3.

@&#CONCLUSION@&#

In this paper, the OWBM is proposed for the contrast enhancement of medical images. Optimization of scale values is obtained using ECSA, in which dynamic scale selection is performed using ARWN. The ARWN is based on genetic parameters such as adaptive crossover and adaptive mutation. For performance comparison, OWBM is initially compared with the brain web database images based on SSIM and PSNR values. In the second part, OWBM is tested with mammogram images obtained from MIAS database based on AMBE values. It is found that, our proposed approach has higher performance than other state of the art enhancement techniques. In medical diagnosis, the contrast of images has more importance and is obtained through our technique.

None Declared

@&#REFERENCES@&#

