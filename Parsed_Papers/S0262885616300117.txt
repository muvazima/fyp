@&#MAIN-TITLE@&#Deep and fast: Deep learning hashing with semi-supervised graph construction

@&#HIGHLIGHTS@&#


               
                  
                     
                        
                           
                           A semi-supervised graph approach is proposed to infer the hash codes.


                        
                        
                           
                           We simultaneously learn visual features and hash functions.


                        
                        
                           
                           Extensive experiments are conducted to exploit the performance of our method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Deep learning

Hashing

Multimedia retrieval

@&#ABSTRACT@&#


               
               
                  Learning-based hashing methods are becoming the mainstream for approximate scalable multimedia retrieval. They consist of two main components: hash codes learning for training data and hash functions learning for new data points. Tremendous efforts have been devoted to designing novel methods for these two components, i.e., supervised and unsupervised methods for learning hash codes, and different models for inferring hashing functions. However, there is little work integrating supervised and unsupervised hash codes learning into a single framework. Moreover, the hash function learning component is usually based on hand-crafted visual features extracted from the training images. The performance of a content-based image retrieval system crucially depends on the feature representation and such hand-crafted visual features may degrade the accuracy of the hash functions. In this paper, we propose a semi-supervised deep learning hashing (DLH) method for fast multimedia retrieval. More specifically, in the first component, we utilize both visual and label information to learn an optimal similarity graph that can more precisely encode the relationship among training data, and then generate the hash codes based on the graph. In the second stage, we apply a deep convolutional network to simultaneously learn a good multimedia representation and a set of hash functions. Extensive experiments on five popular datasets demonstrate the superiority of our DLH over both supervised and unsupervised hashing methods.
               
            

@&#INTRODUCTION@&#

During the last decade, the amount of multimedia data has reached an unprecedented level, due to the development of multimedia and the Internet technologies. This has impacted a wide range of research areas, including multimedia retrieval, computer vision, database management, data mining, and social media analysis. A basic solution for dealing with massive multimedia databases is content-based image retrieval (CBIR), which aims to retrieve similar images from a database to the query image. Particularly, image retrieval has long been a major research theme due to many applications such as event detection, scene classification and face recognition [1-3].

Image retrieval is typically accomplished in three steps: feature extraction, searching and post-processing. Over the last few years, a long stream of research efforts has been made to improve these three components [4]. From the perspective of image representation and search scheme, most of the successful scalable image retrieval algorithms can be categorized into: 1) quantized local features (e.g., BOW) [5,6] indexed by an inverted index [7]; and 2) holistic features (e.g., GIST and HSV) indexed by compact hash codes [8,9]. The BOW vector for an image is usually high-dimensional when used for large scale image search. In this case, the search efficiency results from the use of inverted lists, which speeds up the calculation of distances between sparse vectors. However, when the size of the image database reaches the million level, the speed degrades greatly. To scale to even larger databases, hashing methods are usually adopted. Each image is represented as a vector, either by extracting holistic feature directly or by compressing local descriptors into a vector representation using recent encoding techniques such as Fisher kernels [10] and the ‘vector of locally aggregated descriptors' (VLAD) [11]. Then, images can be encoded by a small number of bytes using hashing methods [8,12], but with the advantage of preserving some key properties inherited from visual features. For post-processing, after image retrieval returns a list of images, a potential re-ranking technique can be used to reorder the initial results. But this procedure is optional, and there are no well-accepted methods for post-processing due to the time limitation.

Although a variety of techniques have been proposed, image retrieval remains one of the most challenging problems. This is due to the fact that the global and local features have different strengths and weaknesses, and specific search schemes have to be adopted based on different visual features. Therefore, there is an urgent need to find a more robust feature and a unified searching scheme for larger scale image retrieval. There arise several questions for scalable CBIR: 1) Is there a generic feature extraction method that is robust on different image datasets? 2) How to integrate this generic feature to existing searching schemes? Some recent efforts have been proposed to tackle these questions. In Refs. [8,13], the authors propose utilizing supervised deep learning to learn image representation and hash codes for image retrieval and promising results were obtained. On the other hand, Wan et al. [14] propose a general framework to apply deep learning to content-based image retrieval. However, these methods use the label information only to identify the similarity between two data points, which is inaccurate in a lot of cases. As shown in Fig. 1
                     , image (b) is more similar than (c) to the query (a), both visually and semantically. If we only use the label information, (b) and (c) will have the same similarity to (a). Therefore, it is necessary to learn a more accurate similarity between images by using visual and label information.

In this paper, we propose integrating a generic feature into a hashing search scheme. More specifically, we present deep learning hashing (DLH) with semi-supervised graph construction to enhance the performance of hashing methods for scalable image retrieval. It is worth highlighting the following contributions: 1) We propose a framework to utilize the CNN-generated visual feature as a generic feature, and incorporate this feature into this hashing search scheme for efficient image retrieval on scalable datasets. 2) To infer the hash codes of the training set in both supervised and unsupervised settings, a novel semi-supervised graph construction approach is proposed and an efficient solution is devised. 3) We propose to simultaneously learn a good feature representation and a set of hash functions via CNN for new data points. (4) We conduct extensive experiments to exploit the performance of different hashing methods on five popular image datasets.

@&#RELATED WORK@&#

To address the scalability issue in image retrieval, more recently, tremendous research efforts have been devoted to learning-based hashing methods [9,12,15-23,36,37], due to the compact binary representation and efficient Hamming distance. Such approaches map data points to compact binary codes through a hash function, which can be generally expressed as: 
                        
                           (1)
                           
                              
                                 y
                              
                              =
                              
                                 h
                              
                              (
                              
                                 x
                              
                              )
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    L
                                 
                              
                           
                        
                     where x is a m-dimensional vector, h(.) is the hash functions, and y is a binary vector with code length L. The learning of the hash functions is usually based on the criterion of preserving some properties of the training data points. Typical approaches preserve code consistency property (i.e., the similarity of binary codes should be consistent with that of the original data points) [15], similarity alignment property (i.e., the Hamming distance of the binary code should approximate the Euclidean distance of the original data points) [24], order preserving property (i.e., the orders of a reference data item computed from the original space and the Hamming space should be aligned) [25], etc. However, these hashing methods are all based on hand-crafted visual features.

On the other hand, we have witnessed dramatic progress in deep convolution networks in the last few years. Approaches based on deep networks have achieved state-of-the-art performance on image retrieval [8,14], image classification [26], object detection [27] and other recognition tasks. The success of deep-networks-based methods for images is mainly due to their power to automatically learn effective image representations. Xia et al. [8] developed a supervised hashing method for image retrieval, which simultaneously learns a good representation of images as well as a set of hash functions. Lai et al. [13] developed a ‘one-stage’ supervised hashing method for image retrieval, which generates bitwise hash codes for images via a carefully designed deep architecture. Zhao et al. [28] proposed employing multi-level semantic ranking supervision to learn deep hash functions based on CNN which preserves the semantic structure of multi-label images. However, all of the above CNN_based hashing methods are supervised learning approaches and cannot exploit the useful information from the unlabeled data samples.

In this section, we introduce our method. In some supervised hashing methods, the learning task is formulated as a single optimization objective function which is complex and difficult to solve. While in other methods [29,30], the learning process is decomposed into two stages: a hash codes learning stage followed by a hash functions inferring stage, where the corresponding optimization problems in each stage are relatively simple. Our DLH follows the two-stage paradigm. Fig. 2
                      gives an overview of the proposed DLH for CBIR. The framework consists of two components, namely hash codes learning via semi-supervised graph construction and hash functions inferring using CNN. Compared with Refs. [29,30], DLH learns an optimal similarity graph for hash coding learning and utilizes CNN to learn an image representation and hashing function simultaneously.

Suppose X
                        ={x
                        1,x
                        2,…,x
                        
                           N
                        } represents a set of N images, and 
                           
                              F
                           
                           =
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       N
                                    
                                 
                              
                           
                        , where f
                        
                           i
                        
                        ={0,1}
                           C
                         is the label for the i-th image (1 ≤ i ≤ N), and C is the number of classes. The task is to learn the hash codes Y based on X and F. Suppose Y
                        ={y
                        1,y
                        2,…,y
                        
                           n
                        }, where y
                        
                           i
                        
                        ={−1,1}
                           L
                         is the hash code for the i-th training image (1 ≤ i ≤ N), and L is the code length of the hash code. For supervised hashing methods, a good criteria for Y is that the similarity of a pair of hash codes y
                        
                           i
                         and y
                        
                           j
                         should be consistent with the similarity of their labels, which can be formulated as: 
                           
                              (2)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          Y
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                      m
                                                   
                                                
                                                
                                                   
                                                      S
                                                      u
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             −
                                             C
                                             ×
                                             
                                                
                                                   
                                                      s
                                                      i
                                                      m
                                                   
                                                
                                                
                                                   H
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where sim
                        
                           Sup
                         is usually defined as: 
                           
                              (3)
                              
                                 
                                    
                                       
                                          s
                                          i
                                          m
                                       
                                    
                                    
                                       
                                          S
                                          u
                                          p
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                +
                                                1
                                                ,
                                                
                                                
                                                   i
                                                   f
                                                
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      T
                                                   
                                                
                                                >
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                −
                                                1
                                                ,
                                                
                                                   e
                                                   l
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and f
                        
                           i
                         and f
                        
                           j
                         are the labels for the i-th and j-th images, and C is a constant.

For unsupervised hashing methods, a good criteria for Y is that the similarity of a pair of hash codes y
                        
                           i
                         and y
                        
                           j
                         should be consistent with their similarity in their original space, which can be formulated as: 
                           
                              (4)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          Y
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             s
                                             i
                                             
                                                
                                                   m
                                                
                                                
                                                   U
                                                   n
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             −
                                             C
                                             ×
                                             s
                                             i
                                             
                                                
                                                   m
                                                
                                                
                                                   H
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where sim
                        
                           Uns
                         is usually defined as: 
                           
                              (5)
                              
                                 
                                    
                                       
                                          s
                                          i
                                          m
                                       
                                    
                                    
                                       
                                          U
                                          n
                                          s
                                       
                                    
                                 
                                 
                                    
                                       x
                                       
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  ||
                                                                  
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  ||
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      /
                                                      2
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            f
                                                         
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               K
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            o
                                                            r
                                                         
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               K
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                
                                                   e
                                                   l
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 N
                              
                              
                                 K
                              
                           
                           (
                           ⋅
                           )
                         is the K-nearest-neighbor set and 1 ≤ (i,j) ≤ N.

For supervised hashing, the similarity between two data points is set to +1 or −1, which is too rigid. As is shown in Fig. 1, the image pair (a,b) has higher similarity than the pair (a,c), both visually and semantically. But they are assigned with the same value of similarity, which degrades the discriminative power of hashing. For unsupervised hashing methods, the variance σ will affect the performance significantly, and it is usually empirically tuned. In this work, we propose integrating supervised and unsupervised hashing into a single framework and automatically learning an optimal similarity graph by using both visual feature and image labels, which can more precisely encode the relationships between data points.

An optimal similarity graph S should be smooth on all these information cues, which can be formulated as: 
                           
                              (6)
                              
                                 
                                 
                                    
                                       min
                                    
                                    
                                       
                                          S
                                       
                                       ,
                                       
                                          Y
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    
                                       
                                          F
                                       
                                       ,
                                       
                                          S
                                       
                                    
                                 
                                 +
                                 α
                                 
                                    h
                                 
                                 
                                    
                                       
                                          X
                                       
                                       ,
                                       
                                          S
                                       
                                    
                                 
                                 +
                                 β
                                 
                                    r
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                 
                                 +
                                 γ
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             C
                                             ×
                                             
                                                
                                                   
                                                      s
                                                      i
                                                      m
                                                   
                                                
                                                
                                                   H
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where 
                           
                              g
                           
                           
                              
                                 
                                    F
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                         is the penalty function to measure the smoothness of S on the label information F and 
                           
                              h
                           
                           
                              
                                 
                                    X
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                         is the loss function to measure the smoothness of S on the feature X. 
                           
                              r
                           
                           
                              
                                 
                                    S
                                 
                              
                           
                         are regularizers defined on the target S. α, β and γ are balancing parameters.

The penalty function 
                           
                              g
                           
                           
                              
                                 
                                    F
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                         should be defined in the way such that close labels have high similarity and vice versa. In this paper, we define it as follows: 
                           
                              (7)
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          F
                                       
                                       ,
                                       
                                          S
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             ||
                                             
                                                
                                                   
                                                      f
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      f
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ||
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                        where f
                        
                           i
                         and f
                        
                           j
                         are the labels of data points x
                        
                           i
                         and x
                        
                           j
                        . Similarly, 
                           
                              h
                           
                           
                              
                                 
                                    X
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                         can be defined as: 
                           
                              (8)
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          X
                                       
                                       ,
                                       
                                          S
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             ||
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ||
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 .
                              
                           
                        
                     

Instead of preserving all the pairwise distances, we consider preserving the pair distances of the K-nearest neighbors here, i.e., if x
                        
                           i
                         and x
                        
                           j
                         (or f
                        
                           i
                         and f
                        
                           j
                        ) are not K-nearest neighbors of each other, their distance will be set to a large constant. The regularizer term 
                           
                              r
                           
                           
                              
                                 
                                    S
                                 
                              
                           
                         is defined as: 
                           
                              (9)
                              
                                 
                                    r
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ||
                                          
                                             
                                                S
                                             
                                             ||
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

We define 
                           
                              (10)
                              
                                 
                                    
                                       
                                          s
                                          i
                                          m
                                       
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       L
                                       −
                                       
                                          
                                             
                                                ||
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ||
                                                
                                             
                                          
                                          
                                             H
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       L
                                    
                                 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        and we further constraint that S ≥ 0 and S
                        1
                        =
                        1. Then we can obtain the objective function for learning hash codes by replacing 
                           
                              g
                           
                           
                              
                                 
                                    F
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                        , 
                           
                              h
                           
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    S
                                 
                              
                           
                        , 
                           
                              r
                           
                           
                              
                                 
                                    S
                                 
                                 ,
                                 α
                              
                           
                         and 
                           
                              
                                 
                                    s
                                    i
                                    m
                                 
                              
                              
                                 H
                              
                           
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         in Eq. (6) using Eqs. (7), (8), (9) and (10): 
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   S
                                                
                                                ,
                                                
                                                   Y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ||
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ||
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                α
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         ||
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ||
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                +
                                                β
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  2
                                                                  L
                                                               
                                                            
                                                            ×
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                γ
                                                
                                                   
                                                      
                                                         ||
                                                         
                                                            
                                                               S
                                                            
                                                            ||
                                                         
                                                      
                                                   
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         ≥
                                                         0
                                                         ,
                                                         
                                                            S
                                                            1
                                                         
                                                         =
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         ∈
                                                         
                                                            
                                                               
                                                                  
                                                                     −
                                                                     1
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               N
                                                               ×
                                                               L
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We propose an iterative method to minimize the above objective function (11). Once these initial values are given, we iteratively update S and Y. These steps are described below.

By fixing Y, we can obtain S by optimizing Eq. (11). It is equivalent to optimize the following objective function: 
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      S
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      ||
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ||
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             α
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      ||
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ||
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             β
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               2
                                                               L
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             γ
                                             
                                                
                                                   
                                                      ||
                                                      
                                                         
                                                            S
                                                         
                                                         ||
                                                      
                                                   
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      S
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             t
                                             
                                                r
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         α
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   γ
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                             +
                                             β
                                             
                                                
                                                   
                                                      ||
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ||
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                S
                                             
                                             ≥
                                             0
                                             ,
                                             
                                                S
                                                1
                                             
                                             =
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    1
                                    ≤
                                    j
                                    ≤
                                    N
                                 
                              
                            with 
                              
                                 
                                    a
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       ||
                                       
                                          
                                             
                                                
                                                   f
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   f
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ||
                                       
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    1
                                    ≤
                                    j
                                    ≤
                                    N
                                 
                              
                            with 
                              
                                 
                                    b
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       ||
                                       
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ||
                                       
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    1
                                    ≤
                                    j
                                    ≤
                                    N
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    1
                                    ×
                                    N
                                 
                              
                            with 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    2
                                    L
                                 
                              
                              ×
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    j
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           .

Since d
                           
                              i
                            is a constant, Eq. (12) can be reformulated as: 
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      S
                                                   
                                                   ,
                                                   
                                                      S
                                                      
                                                   
                                                   ≥
                                                   
                                                   0
                                                   ,
                                                   
                                                      S
                                                      1
                                                   
                                                   =
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             t
                                             
                                                r
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                         +
                                                         γ
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         α
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         2
                                                         β
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⇒
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      S
                                                   
                                                   ,
                                                   
                                                      S
                                                      
                                                   
                                                   ≥
                                                   
                                                   0
                                                   ,
                                                   
                                                      S
                                                      1
                                                   
                                                   =
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             t
                                             r
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         α
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         2
                                                         β
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               β
                                                               +
                                                               γ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and it is equivalent to: 
                              
                                 (14)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             S
                                          
                                          ,
                                          
                                             S
                                          
                                          
                                          ≥
                                          
                                          0
                                          ,
                                          
                                             S
                                             1
                                          
                                          =
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         α
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         2
                                                         β
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               β
                                                               +
                                                               γ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

The constraint in problem (14) is simplex [38,39]. We use the accelerated projected gradient method to linearly solve this problem. The critical step of the projected gradient method is to solve the following proximal problem: 
                              
                                 (15)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             x
                                             
                                          
                                          ≥
                                          
                                          0
                                          ,
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             1
                                          
                                          =
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ||
                                             
                                                
                                                   x
                                                
                                                −
                                                
                                                   c
                                                   ||
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

We will introduce an efficient approach to solve this problem. We write the Lagrangian function of problem (15) as 
                              
                                 (16)
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                −
                                                
                                                   c
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    τ
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          T
                                       
                                    
                                    1
                                    −
                                    1
                                    )
                                    −
                                    
                                       
                                          ρ
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    ,
                                 
                              
                           where τ and ρ are Lagrangian coefficients. Suppose that the optimal solution to the proximal problem (15) is x
                           *, the associated Lagrangian coefficients are τ
                           * and ρ
                           *. Then according to the KKT condition, we have the following equations:
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                ∀
                                                i
                                                ,
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      *
                                                   
                                                
                                                −
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                ∀
                                                i
                                                ,
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                                ∀
                                                i
                                                ,
                                                
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                                ∀
                                                i
                                                ,
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      *
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           Eq. (17) can be written as x
                           *
                           −c
                           −
                           τ
                           *1−
                           ρ
                           *
                           =0. According to the constraint 1
                              T
                           
                           x
                           *
                           =1, we have 
                              
                                 
                                    τ
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    1
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    c
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          *
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                           . So 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    *
                                 
                              
                              =
                              (
                              c
                              −
                              
                                 
                                    
                                       
                                          11
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              c
                              +
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              1
                              −
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          *
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              1
                              )
                              +
                              
                                 
                                    ρ
                                 
                                 
                                    *
                                 
                              
                           .

Denote 
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          *
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                            and 
                              
                                 u
                              
                              =
                              
                                 c
                              
                              −
                              
                                 
                                    
                                       
                                          11
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              
                                 c
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              1
                           , then we can write 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 u
                              
                              +
                              
                                 
                                    ρ
                                 
                                 
                                    *
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              
                                 1
                              
                           . So ∀i we have 
                              
                                 (21)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          *
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                       
                                          *
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             ¯
                                          
                                       
                                       
                                          *
                                       
                                    
                                    .
                                 
                              
                           
                        

According to Eqs. (18)–(21) we know 
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    *
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             ¯
                                          
                                       
                                       
                                          *
                                       
                                    
                                    )
                                 
                                 
                                    +
                                 
                              
                           . Then we have 
                              
                                 (22)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          *
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   ¯
                                                
                                             
                                             
                                                *
                                             
                                          
                                          )
                                       
                                       
                                          +
                                       
                                    
                                    .
                                 
                              
                           So we can obtain the optimal solution x
                           * if we know 
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                           .

We write Eq. (21) as 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    *
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              −
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           . Similarly, according to Eqs. (18)–(20) we know 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             ¯
                                          
                                       
                                       
                                          *
                                       
                                    
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    +
                                 
                              
                           . Suppose that c is a m-dimensional vector, then we have 
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             ¯
                                          
                                       
                                       
                                          *
                                       
                                    
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    +
                                 
                              
                           . Defining a function as: 
                              
                                 (23)
                                 
                                    f
                                    (
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                ρ
                                             
                                             ¯
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                    ,
                                 
                              
                           so 
                              
                                 f
                              
                              (
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                              )
                              =
                              0
                            and we can solve the root finding problem with the Newton method to obtain 
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       ¯
                                    
                                 
                                 
                                    *
                                 
                              
                           .

Then each s
                           
                              i
                            can be efficiently solved, and we will get the updated similarity graph S.

By fixing S, we can obtain Y by optimizing Eq. (11). It is equivalent to optimize the following objective function: 
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               L
                                                            
                                                            
                                                               C
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ⇒
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      Y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     S
                                                                  
                                                               
                                                               ¯
                                                            
                                                            −
                                                            
                                                               Y
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                  
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                Y
                                             
                                             ∈
                                             
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   L
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

This algorithm sequentially or randomly chooses one entry in Y to update while keeping other entries fixed. Let 
                              
                                 Y
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          .
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          .
                                          L
                                       
                                    
                                 
                              
                           , where y
                           .p
                            ∈ℝ
                              n
                              ×1 is the p-th column of Y (the p-th bit of all data). The objective function (24) can be rewritten as: 
                              
                                 (25)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      ¯
                                                   
                                                   −
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         ≠
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         l
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         p
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         .
                                                         p
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             Y
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                      p
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           where 
                              
                                 E
                              
                              =
                              
                                 
                                    
                                       S
                                    
                                 
                                 ‾
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    l
                                    ≠
                                    p
                                 
                              
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    .
                                    l
                                 
                              
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    .
                                    l
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 ‾
                              
                              =
                              
                                 
                                    2
                                    L
                                 
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           . Suppose that we want to update y
                           
                              qp
                            by fixing the other hash codes. Optimizing Eq. (24) is equivalent to: 
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   2
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   −
                                                   2
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      c
                                                      o
                                                      n
                                                      s
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and it is equivalent to: 
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         q
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         q
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⇒
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         q
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         j
                                                         ≠
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         q
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                         ,
                                                         i
                                                         ≠
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   q
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⇒
                                             
                                                
                                                   y
                                                
                                                
                                                   q
                                                   p
                                                
                                                
                                                   *
                                                
                                             
                                             =
                                             sgn
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         j
                                                         ≠
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         q
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                         p
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                         ,
                                                         i
                                                         ≠
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         p
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

We update S and Y iteratively until the objective function (11) converges.

In this section, we introduce hash functions learning via CNN, which consists of two stages: (i) feature extraction using CNN, (ii) hash functions learning on the features. Following Ref. [26], we use Caffe [31] for the implementation of deep CNN learning.

In general, the deep convolutional network, as shown in Fig. 2, consists of convolution/maxpooling layers, and fully connected/output layers. Specifically, the first layer is the input layer which adopts the mean-centered raw RGB pixels in intensity value. The first and second convolution layers are followed by response normalization layers and max pooling layers, while the third, fourth, and fifth convolution layers are connected to each other without any intervening pooling or normalization. Following the convolutional layers, there are two more fully connected layers and the output layer.

We make use of the generated hash codes and discrete class labels of the training images for training. Specifically, for n training images in c classes (an image may belong to multiple classes), we define a n
                        ×
                        c discrete label matrix F ∈{0,1}
                           N
                           ×C
                        , where F
                        
                           ij
                        
                        =1 if the i-th training image belongs to the j-th class, otherwise F
                        
                           ij
                        
                        =0. For the output layer in our network, in addition to defining the L output units (the blue nodes in the output layer), we add c output units (the red nodes in the output layer in Fig. 2) which correspond to the class labels of the training images. By incorporating the image class labels as a part in the output layer, we enforce the network to learn a shared image representation which matches both the approximate hash codes and the image labels. This can be regarded as a transfer learning case in which the incorporated image labels are expected to be helpful for learning a more accurate image representation (i.e. the hidden units in the fully connected layer). This image representation may be advantageous for hash functions learning. The convolutional network automatically learns the image representation (represented by the green nodes in the fully connected layer) as well as a set of hash functions (represented by the solid lines between the green nodes and the nodes in the last layer). In prediction, one can input a test image to the trained network and obtain the hash code from the values of the blue nodes in the output layer.

@&#EXPERIMENTS@&#

We evaluate our algorithm on the task of high-dimensional approximate nearest neighbor (ANN) search. Firstly, we study the influence of the parameters in our algorithm. Then, we compare our results with state-of-the-art supervised and unsupervised hashing methods on five popular datasets.

We evaluate the proposed method on five benchmark datasets with different kinds of images. 1) AWA dataset consists of 30,475 images of 50 animal classes with six pre-extracted feature representations for each image. 2) CIFAR consists of 60,000 32×32 color tinny images which are categorized into 10 classes (6K images per class).3) ESPGAME contains a wide variety of images including logos, drawings, and personal photos. Following Ref. [32], we use the subset of 20,000, out of the 60,000 images publicly available. 4) IAPR contains around 20,000 images, including logos, drawings, and personal photos.5) The NUS-WIDE dataset has nearly 270,000 images collected from the web. It is a multi-label dataset in which each image is annotated with one or multiple semantic tags (class labels) from 81 concept tags. For ESPGAME and IAPR, we use the features extracted by Ref. [33] and then reduce the dimensionality to 1000 by PCA. For the others, we utilize the features provided with the datasets.

The datasets are divided into training set, testing set and query set. For CIFAR, the provided split is adopted. For AWA and NUSWIDE, 10,000 data points are randomly selected for training and the rest for testing. For ESPGAME and IAPR, 10,000 data points are selected for training and the whole datasets are used for testing. 1000 queries are randomly selected from the training set.

ANN search is conducted to evaluate our proposed approaches, and two indicators are reported. 
                           
                              •
                              Recall: the proportion over all queries where the true nearest neighbor falls within the top ranked vectors by the approximate distance.

Mean Average Precision (MAP): for a single query, Average Precision (AP) is the average of the precision value obtained for the set of top-k results, and this value is then averaged over all the queries. The larger the MAP, the better the performance.

We compare our SSH with other state-of-the-art supervised and unsupervised hashing algorithms, such as spectral hashing (SH) [15], iterative quantization (ITQ) hashing [34] and K-means Hashing (KMH) [12]. We also compare with two supervised hashing methods KSH [35] and FastH [29].

All the experiments were conducted on a Linux server with NVIDIA Tesla K20 GPUs. K20 is featuring 13 active SMXes along with 5 memory controllers and 1.25MB of L2 cache, attached to 5GB of GDDR5. In our experiments, the CNN model was trained on only one K20 GPU which has enough memory for our training tasks.

There are several parameters, e.g., α, β, γ and the number of tagged training data, affecting the performance of our algorithm. In this subsection, we study the performance variation with different parameters. Due to the space limit, we only report the results on AWA dataset. The default settings for the parameters are: α
                        =1, β
                        =10
                           −1, γ
                        =101 and 40% of the training data points are with labels.

We tune α,β and γ from 10
                           −2,10
                           −1,100,101,102, and the results are shown in Fig. 3
                        a. When α is relatively large, e.g., α
                        =102, the worst performance is achieved. That is to say, if the impact of visual features is dominant in constructing the optimal graph S, the MAP is unsatisfactory. With the increase of α from α
                        =10
                           −2, the performance is slightly improved until reaching the peak at α
                        =100. Further raising α will result in a slight drop of the performance, which means that balancing the partial tags and multiple features is better than using only one of them. On the other hand, the performance keeps stable when β is relative small, e.g., β ≤ 10
                           −1, and it decreases quickly when β is set to a large value. Also, MAP is not very sensitive to γ when γ ≤ 101.

The size of labeled training dataset affects the accuracy of the model. We use 10%, 20%, 30%, 40%, 50%, 60%, 70%, 80%, 90% and 100% of the training data as labeled data and the rest as unlabeled data. The performance variation is illustrated in Fig. 3(b). There is an increasing trend with the rising of the number of labeled data. When 40%–50% of the training data are with labels, further increasing the number of the labeled data will not improve the MAP significantly.

@&#RESULTS@&#


                        Fig. 4
                        a–i shows the comparison on the five datasets and Table 1
                         presents the MAP for the different hashing methods. We have tested L
                        =32 and L
                        =64. From these figures, we have the following observations: 
                           
                              •
                              Our method consistently outperforms the other hashing methods in all datasets. KSH and FastH are competitive in most settings. However, great improvement of SSH over FastH is achieved on AWA dataset. This indicates that a good image representation and the CNN-generated hash functions can improve the performance of hashing methods.

With the increase of code length, the performance of different hashing methods is improved accordingly. Generally, MAP improvements of supervised hashing methods are more significant than that of unsupervised hashing methods. On ESPGAME and IAPR datasets, the performance even becomes worse when the code length increases.

The supervised hashing methods outperform their unsupervised counterparts significantly. More specifically, the MAP gap between the best supervised and unsupervised hashing methods is 12%, 14%, 6%, 5% and 10% respectively, for AWA, CIFAR, ESPGAME, IAPRTC and NUSWIDE datasets, with L
                                 =64. This indicates that exploiting the content information only cannot preserve the label-based similarity.

For all the unsupervised methods, similar performance is achieved. In general, SH performs the worst while ITQ and KMH are comparable to each other.

@&#CONCLUSIONS@&#

In this paper, we propose a general framework for semi-supervised deep learning hashing (DLH) method for fast multimedia retrieval. In this framework, we firstly utilize both visual feature and class labels to learn an optimal similarity graph to more precisely encode the relationship among training data. Based on this graph, the hash codes can be generated. Then, we apply the deep convolutional network to automatically learn a set of hash functions to get the hash codes for new data points. Extensive experiments on five popular datasets demonstrate the superiority of our DLH compared to both supervised and unsupervised hashing methods.

@&#REFERENCES@&#

