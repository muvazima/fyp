@&#MAIN-TITLE@&#Learning weighted part models for object tracking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Part models are formulated with a graph structure for object tracking.


                        
                        
                           
                           Weighted part models are used to handle target appearance change and occlusion.


                        
                        
                           
                           GMMs are used as weight models for describing dynamic evolution of object parts.


                        
                        
                           
                           Weight models are used to dynamically adjust the part appearance models.


                        
                        
                           
                           Weight models are used to control the sample selections for part model update.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Part graph model

Gaussian Mixture Model

Weighted model

@&#ABSTRACT@&#


               
               
                  Despite significant improvements have been made for visual tracking in recent years, tracking arbitrary object is still a challenging problem. In this paper, we present a weighted part model tracker that can efficiently handle partial occlusion and appearance change. Firstly, the object appearance is modeled by a mixture of deformable part models with a graph structure. Secondly, through modeling the temporal evolution of each part with a mixture of Gaussian distribution, we present a temporal weighted model to dynamically adjust the importance of each part by measuring the fitness to the historical temporal distributions in the tracking process. Moreover, the temporal weighted models are used to control the sample selections for the update of part models, which makes different parts update differently due to partial occlusion or drastic appearance change. Finally, the weighted part models are solved by structural learning to locate the object. Experimental results show the superiority of the proposed approach.
               
            

@&#INTRODUCTION@&#

Visual tracking is one of the fundamental problems in computer vision and serves as a preprocessing step for many applications including human machine interaction, video surveillance, or higher tasks like scene understanding and action recognition. In recent years, significant progress has been made for visual tracking. However, designing a robust tracker for general object tracking is still a major challenge, especially when object occlusion and appearance variation happen. Many approaches have been developed to address these problems, such as tracking-by-detection approaches proposed by Avidan [1]. This kind of solutions treats the tracking problem as a detection task and transfers some detection ideas to tracking as proposed in [3,20,22]. Through online training a classifier, the target is distinguished from the background. During the tracking process, the classifier is used to locate the object with maximum classification score and collect proper samples for parameter update. By leveraging the detection techniques into tracking, the tracking performance has yield great improvements in recent years. However, these kind of approaches can often hardly deal with the problems such as part occlusions or continuously appearance change.

Due to the success of the part based object detection approaches proposed by Felzenszwalb et al. [5], tracking object with parts also shows its advantage in [20]. During tracking, target object together with its related parts and the inherent structural relationship are modeled together in a uniform framework. The part based models show favorable properties such as robustness to partial occlusion and articulation. The existing part based tracking approaches as proposed in [20,22] often adapt same part sample selection strategies and update the part appearance parameters controlled by the appearance scores. However, object appearance variation is not a uniform process, and different parts may change significantly different over time from each other. The change rates of different parts also vary significantly. Therefore, it is not proper to treat each part’s contribution equally as this may cause the failure of tracking when drastic appearance variation occurs. Take the “lemming” sequence as an example, in the first row of Fig. 1
                      we can see that the appearances change differently for different parts with the target moving. This indicates that in the tracking process, different parts of the target should have different weights and update strategies based on the temporal evolution of the tracked target.

In this paper, we present a robust object tracking approach based on weighted part models. As illustrated in Fig. 2
                     , given an input sequence, the first frame with the target annotation is used for model initialization, and the object is modeled by a mixture of deformable part models with a graph structure. Then the weighted part model tracker is used to predict the target location during the tracking process. The prediction results are further used for parameter update, which includes the parameters for both discriminative appearance models and temporal weighted models.

As shown in Fig. 2, the weighted part models with spatial constrains effectively enhance the tracking robustness, the temporal dynamic evolution of each part is modeled with a Gaussian mixture distribution that serves as an important implementation. The proposed weighted part model tracker exceeds traditional part models for two reasons. On one hand, the weights of the parts assist to adjust the importance of the corresponding appearance models. On the other hand, they also help control the sample selections for model update by judging whether the samples are fit for the historical distributions. The second and the third row of Fig. 1 illustrate the weights and the final tracking results varied over time, respectively.

The main contribution of this paper is summarized as follows,

                        
                           1.
                           We propose a weighted part model based tracking approach to effectively deal with target appearance change and partial occlusion.

Through modeling the dynamic evolution of each part with a mixture of Gaussian distribution, we dynamically adjust the importance of each part by measuring the fitness to the historical distributions.

The temporal weighted model of each part is used to control the sample selections for the effective update of the corresponding part model, which makes different parts update differently under complex scenes.

@&#RELATED WORK@&#

Lots of the recent work in model-free tracking focus on tracking-by-detection methods. Avidan [1] used off-line SVM to detect the target vehicle. Grabner et al. [6] used online AdaBoost to update selected features incrementally. Babenko et al. [2] used online multiple instance boosting to collect training samples for online classifier update. Kalal et al. [10] combined tracking and detection results to refine the final tracking decision. Kwon and Lee [12] decomposed the tracker into multiple basic observation models and improved the tracking results by each of the tracker’s contribution. These approaches leverage the advantages of the detection methods, but they require careful design of the selection strategy of training samples for the reason that improper online update always causes object drift.

Structured learning approaches make predictions over large output spaces that have certain inherent structure, which can be considered as a developed form of Markov Random Fields (MRFs). Wang et al. [14] presented a comprehensive survey of MRFs in computer vision and image understanding, with respect to modeling, inference and learning. Blaschko and Lampert [3] detected object locations by structured output predictions. Hare et al. [7] further used structured SVM to predict object locations by modeling the problem as predicting the change of the bounding box between frames. Yao et al. [19] adjusted the importance of training samples by weighted reservoir sampling with a structural learning framework. These structured learning based methods achieve good performance in recent years. However, they neglect that the importance of each part is different for partial occlusion and appearance change in different time. Therefore, our approach benefits from the structured learning methods and introduces weighted part models to boost the tracking performance.

Early part based tracking approaches often required manual part initialization as mentioned by Hua and Wu [8] or prior knowledge as proposed by Kwon and Lee [11] before tracking. Deformable part models proposed by Felzenszwalb et al. [5] are well known in object detection task for the robustness to object appearance changes and generalization ability. The part models formulate the part appearances together with the spatial constrains between parts, where the model parameters were learned from a latent SVM framework. This spring form spatial constrains were further extended to pose estimation by [18], face landmark detection proposed by [23], and then was introduced to visual tracking. Yao et al. [20] used part models for visual tracking with an online latent structural learning method, which enhanced the struck tracker proposed by Hare et al. [7]. Zhang and van der Maaten [22] modeled the spatial relationships with slacked spatial constraints between multiple targets and proposed a multiple target tracking framework. Different from these part based approaches for object tracking, we use a graph structure to represent the deformable parts to track the object and also dynamically adjust the importance of the part appearance models by introducing a temporal weight for each part.

In this paper, we propose a novel approach for online tracking with weighted part models as illustrated in Fig. 2. These include model initialization, weighed part model learning, object prediction and model update. In the followings, we will explain the components of the proposed weighted part models tracker in detail.

The deformable part models (DPM) approach was first presented by Felzenszwalb et al. [5], which used HOG features proposed by Dalal and Triggs [4] to describe image patches and formulated the object together with its part appearance models with a graph structure. Similarly, in this paper we formulate object parts together with the spatial relationships with a structured graph model. We represent object part i by 
                           
                              
                                 B
                                 i
                              
                              =
                              
                                 {
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    w
                                    i
                                 
                                 ,
                                 
                                    h
                                    i
                                 
                                 }
                              
                           
                         with center location 
                           
                              
                                 x
                                 i
                              
                              =
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    y
                                    i
                                 
                                 )
                              
                              ,
                           
                         width and height. Together with the whole object as the root B
                        0, we can define a graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         to describe the object. The vertex set 
                           
                              V
                              =
                              {
                              
                                 B
                                 0
                              
                              ,
                              
                                 B
                                 1
                              
                              ,
                              …
                              ,
                              
                                 B
                                 n
                              
                              }
                           
                         stands for object parts together with the root. The edges (i, j) ∈ E between root and different parts represents the spatial relationship. Thus the final score of an object can be calculated as the sum of the root score and the part scores together with the spatial constrains,

                           
                              (1)
                              
                                 
                                    S
                                    
                                       (
                                       
                                          X
                                          t
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       F
                                       i
                                    
                                    ·
                                    ϕ
                                    
                                       (
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       d
                                       i
                                    
                                    ·
                                    
                                       ϕ
                                       d
                                    
                                    
                                       (
                                       δ
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        where ϕ(xi
                        ) means the appearance feature of part i, here stands for the HOG feature [4] extracted from the corresponding part. x0
                         stands for the root. As we only consider the part spatial layout to the root, δ(xi
                        ) means the spatial layout between part i and the root. The compatibility between part i and root ϕd
                        (δ(xi
                        )) is represented by the spatial layout of part i with respect to the root,

                           
                              (2)
                              
                                 
                                    
                                       ϕ
                                       d
                                    
                                    
                                       (
                                       δ
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       d
                                       x
                                       ,
                                       d
                                       y
                                       ,
                                       d
                                       
                                          x
                                          2
                                       
                                       ,
                                       d
                                       
                                          y
                                          2
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              δ
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 )
                              
                              =
                              
                                 (
                                 d
                                 x
                                 ,
                                 d
                                 y
                                 )
                              
                              =
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 −
                                 
                                    x
                                    0
                                 
                                 )
                              
                           
                         stands for the spatial constraint of the part i to the root. When the model is used for detection in the tracking process, the target parts together with the spatial distributions help to decide the final tracking score. The parameters in this model 
                           
                              w
                              =
                              {
                              
                                 F
                                 0
                              
                              ,
                              
                                 F
                                 1
                              
                              ,
                              …
                              ,
                              
                                 F
                                 n
                              
                              ,
                              
                                 d
                                 1
                              
                              ,
                              …
                              ,
                              
                                 d
                                 n
                              
                              }
                           
                         is updated with an online learning way. Yao et al. [20] proposed a two stage training approach to update the parameters. Zhang and van der Maaten [22] slacked the spatial constrains and used the part models for multiple object tracking. Different from their strategies, in the following, we will introduce a weighting strategy to assist the part appearance scores and the part update process, further to boost the tracker’s performance.

With the initial object position, we adopt a heuristic part selection approach. Similar to [22], parts are initialized at the location in which the weights of the initial global SVM parameters are large and positive. The overlap between parts cannot be more than 50%. Different with fixed part size in [22], we use an automatic size and shape selection strategy as proposed by Felzenszwalb et al.[5]. We first train a target root classifier F
                           0 using HOG and standard SVM. Given the number of parts, we use a small pool of rectangular part shapes to greedily cover the high-energy regions of the target area. Here “energy” is defined by the norm of the positive weights of within F
                           0. The highest-energy region is selected as the first part. And once a part is placed, the energy of the covered portion of the target area is set to zero, and we look for the next highest-energy region, until all the parts are located.

For the traditional part based detection models, the object parts are often modeled by the appearance features. They often neglect the temporal distributions of different part for the reason that they only rely on single frame to detect the object. However, in visual tracking, the appearances of the object vary at different times, parts of the object provide different level of discriminative information about the current appearance of the target object and background. To better leverage the contributions of different parts to the tracked object, we model the dynamic temporal distribution to timely adjust the weight of each part based on the fitness to the historical distributions. Therefore, we add a weight λi
                         for part i with appearance model Sai
                        . Additionally, the part weights also help to sustain a sample pool for parameter update of each part. Given the graph representation in Eq. (1), the weighted part models are formulated as follows,

                           
                              (3)
                              
                                 
                                    S
                                    
                                       (
                                       
                                          Y
                                          t
                                       
                                       ;
                                       I
                                       ,
                                       Θ
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          λ
                                          i
                                       
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       ·
                                       S
                                       
                                          a
                                          i
                                       
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          D
                                          i
                                       
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Y
                              =
                              (
                              
                                 B
                                 0
                              
                              ,
                              
                                 B
                                 1
                              
                              ,
                              …
                              ,
                              
                                 B
                                 n
                              
                              )
                           
                         is the output configuration the object together with its related parts. B
                        0 is the bounding box of the target (root box) and 
                           
                              
                                 B
                                 i
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         are the n part boxes. xi
                         is the relative part feature extracted from the input image I. Θ is the model parameter. 
                           
                              S
                              
                                 a
                                 i
                              
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 )
                              
                              =
                              
                                 F
                                 i
                              
                              ·
                              ϕ
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 D
                                 i
                              
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 )
                              
                              =
                              
                                 d
                                 i
                              
                              ·
                              
                                 ϕ
                                 d
                              
                              
                                 (
                                 δ
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 )
                              
                           
                         are the appearance score and the deformation cost respectively. λi
                        (xi
                        ) is the weight for the object part i. In this case, the weights serve two purposes: adjusting the importance of each part by measuring the fitness to the related temporal distributions of the parts, and selecting the proper training samples to update the related parameters. An illustration of weight change of part models during the tracking process is shown in Fig. 3
                        . λi
                        (xi
                        ) is used for modeling the temporal distribution of part i and used as weight to adjust the confidence score of part i.

Here we use the Gaussian Mixture Distributions (GMM models) proposed by [13] to learn the weight of each part. The GMM models describe temporal evolution for each part and serve as complements for the discriminative appearance models. In detail, for each part i, the weight λi
                            is calculated as,

                              
                                 (4)
                                 
                                    
                                       
                                          λ
                                          i
                                       
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          ω
                                          k
                                       
                                       ·
                                       
                                          N
                                          i
                                       
                                       
                                          (
                                          
                                             x
                                             i
                                          
                                          |
                                          
                                             μ
                                             k
                                          
                                          ,
                                          
                                             Σ
                                             k
                                          
                                          )
                                       
                                    
                                 
                              
                           where ωk
                            is the weight of the kth Gaussian component. 
                              
                                 N
                                 (
                                 
                                    x
                                    i
                                 
                                 |
                                 
                                    μ
                                    k
                                 
                                 ,
                                 
                                    Σ
                                    k
                                 
                                 )
                              
                            is the Normal distribution of the kth component represented by,

                              
                                 (5)
                                 
                                    
                                       N
                                       
                                          (
                                          x
                                          |
                                          
                                             μ
                                             k
                                          
                                          ,
                                          
                                             Σ
                                             k
                                          
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             2
                                             π
                                             
                                                
                                                   Σ
                                                   k
                                                
                                             
                                          
                                       
                                       e
                                       x
                                       p
                                       
                                          (
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   μ
                                                   k
                                                
                                                )
                                             
                                             T
                                          
                                          
                                             Σ
                                             k
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             x
                                             −
                                             
                                                μ
                                                k
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                           where μk
                            is the mean and 
                              
                                 
                                    Σ
                                    k
                                 
                                 =
                                 
                                    σ
                                    k
                                    2
                                 
                                 I
                              
                            is the covariance of the kth component of GMM. The GMM models build statistical sample distributions for related parts, which describe the temporal evolution of the appearance and response the confidence level of the parts in the current frame to the historical distributions. The probabilistic output of GMMs can be used as the weight of the part appearance scores and to select proper samples for parameter update. When object deformation and occlusion happen, the GMM models assign different weights to different parts in the appearance model by measuring the fitness to the historical temporal distributions. Here we use the raw gray pixel values of the target parts as the input features of the GMM models since the gray feature is more robust than the color feature.


                           GMM initialization. The initialization of GMM parameters are relatively sensitive. For a GMM model, we set one of its K Gaussian mixtures as the “main Gaussian”, the mean of which is initially computed from the mean of the initial training samples. The weight of the “main Gaussian” is set to be higher than other mixtures. Here we do not use the uniform weight value for initialization since the “main Gaussian” benefits most from the initial training samples and represents the initial distribution of the particular part. All the other 
                              
                                 K
                                 −
                                 1
                              
                            Gaussian mixtures are initialized with random generated means with a range of 0 ∼ 255. The variances define the capacities of the Gaussian mixtures, here we set the variance of the “main Gaussian” to be 60 and randomly generate the variances of other mixtures from 50 to 70. Details about GMM initial parameter settings will be discussed in Section 4.

For a new incoming frame, tracking the target is to find the optimized object configuration to maximize Eq. (3) as follows,

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             Y
                                             t
                                          
                                          ^
                                       
                                       =
                                       a
                                       r
                                       g
                                       
                                          max
                                          
                                             Y
                                             t
                                          
                                       
                                       S
                                       
                                          (
                                          
                                             Y
                                             t
                                          
                                          ;
                                          I
                                          ,
                                          Θ
                                          )
                                       
                                    
                                 
                              
                           
                        

The root together with the parts form a tree structure (star structure) as suggested by Felzenszwalb et al. [5], so the problem in Eq. (1) can be efficiently solved by dynamic programming. To find the best output configuration Y in Eq. (6), we use a modified distance transform approach in [5] with GMM based weight model of each part involved in. The GMM outputs serve as the weight of the part appearance scores of the target. When the object appearance changes drastically such as moving with occlusions or deformations, the GMM models help to adjust the importance of the part appearance model by measuring its fitness to the historical distributions. In addition, when finding the most suitable parts for the tracked target, GMM models help to decide whether the part samples can be used for parameter update.

With image I and the inferred object configuration Y in Eq. (6), we update the parameters using the sample pool sustained by the GMM models. The parameters in Eq. (3) can be denoted by Θ
                           
                              
                                 
                                    
                                       Θ
                                       =
                                       
                                          
                                             [
                                             
                                                λ
                                                1
                                                T
                                             
                                             ,
                                             …
                                             ,
                                             
                                                λ
                                                n
                                                T
                                             
                                             ,
                                             
                                                F
                                                0
                                                T
                                             
                                             ,
                                             
                                                F
                                                1
                                                T
                                             
                                             ,
                                             …
                                             ,
                                             
                                                F
                                                n
                                                T
                                             
                                             ,
                                             
                                                d
                                                1
                                                T
                                             
                                             ,
                                             …
                                             ,
                                             
                                                d
                                                n
                                                T
                                             
                                             ]
                                          
                                          T
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    λ
                                    i
                                 
                                 =
                                 
                                    ∑
                                    k
                                 
                                 
                                    (
                                    
                                       ω
                                       k
                                    
                                    ,
                                    
                                       μ
                                       k
                                    
                                    ,
                                    
                                       Σ
                                       k
                                    
                                    )
                                 
                                 ,
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 K
                              
                            stands for the GMM parameter of part i, Fi
                            and di
                            are related to appearance and deformation parameters in Eq. (1), respectively. For the tth frame, we learn the parameter Θt
                            with training samples from the sample pool. In our implementation, we found it more efficient to update the GMM and the part model parameters separately, here we update Θ with a two stage manner. By splitting parameters into 
                              
                                 
                                    Θ
                                    t
                                 
                                 =
                                 
                                    [
                                    
                                       Θ
                                       
                                          g
                                          m
                                          m
                                       
                                    
                                    ,
                                    
                                       Θ
                                       
                                          p
                                          a
                                          r
                                          t
                                          s
                                       
                                    
                                    ]
                                 
                                 ,
                              
                            where 
                              
                                 
                                    Θ
                                    
                                       g
                                       m
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          λ
                                          1
                                          T
                                       
                                       ,
                                       …
                                       ,
                                       
                                          λ
                                          n
                                          T
                                       
                                       ]
                                    
                                    T
                                 
                              
                            and 
                              
                                 
                                    Θ
                                    
                                       p
                                       a
                                       r
                                       t
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          F
                                          0
                                          T
                                       
                                       ,
                                       
                                          F
                                          1
                                          T
                                       
                                       ,
                                       …
                                       ,
                                       
                                          F
                                          n
                                          T
                                       
                                       ,
                                       
                                          d
                                          1
                                          T
                                       
                                       ,
                                       …
                                       ,
                                       
                                          d
                                          n
                                          T
                                       
                                       ]
                                    
                                    T
                                 
                              
                            are the GMM and part model parameters respectively.

In the first stage, the update of Θgmm
                            is inspired by the background modeling method proposed by [13]. For certain part sample 
                              
                                 x
                                 
                                    t
                                    +
                                    1
                                 
                                 i
                              
                            of part i that suits the part appearance model, it can be used to update the kth Gaussian model if meeting the following conditions,

                              
                                 (7)
                                 
                                    
                                       
                                          |
                                       
                                       
                                          x
                                          
                                             t
                                             +
                                             1
                                          
                                          i
                                       
                                       −
                                       
                                          μ
                                          k
                                          i
                                       
                                       
                                          |
                                          <
                                       
                                       
                                          δ
                                          i
                                       
                                       
                                          σ
                                          k
                                          i
                                       
                                    
                                 
                              
                           where δ is the matching threshold for part i. The Gaussian model is updated as,

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                
                                                   k
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                                i
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      α
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   ω
                                                   
                                                      k
                                                      ,
                                                      t
                                                   
                                                   i
                                                
                                                +
                                                
                                                   α
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                μ
                                                
                                                   k
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                                i
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      ρ
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   μ
                                                   
                                                      k
                                                      ,
                                                      t
                                                   
                                                   i
                                                
                                                +
                                                
                                                   ρ
                                                   i
                                                
                                                
                                                   x
                                                   t
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      
                                                         k
                                                         ,
                                                         t
                                                         +
                                                         1
                                                      
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      ρ
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         σ
                                                         
                                                            k
                                                            ,
                                                            t
                                                         
                                                         i
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   ρ
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         x
                                                         t
                                                         i
                                                      
                                                      −
                                                      
                                                         μ
                                                         
                                                            k
                                                            ,
                                                            t
                                                         
                                                         i
                                                      
                                                      )
                                                   
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                      i
                                                   
                                                   −
                                                   
                                                      μ
                                                      
                                                         k
                                                         ,
                                                         t
                                                      
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                i
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   α
                                                   i
                                                
                                                
                                                   ω
                                                   
                                                      k
                                                      ,
                                                      t
                                                   
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where αi
                            and ρi
                            are the learning rate of the model and the parameter respectively for the ith part GMM λi
                           . The new GMM score of the sample 
                              
                                 x
                                 t
                                 i
                              
                            is computed as Eq. (4) and then be used to update the sample pool of the part i.

The second stage is to update the root, part appearance and deformation parameters Θparts
                           , which can be updated by minimizing the following structured SVM objective function,

                              
                                 (9)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                g
                                                
                                                   (
                                                   
                                                      Θ
                                                      
                                                         p
                                                         a
                                                         r
                                                         t
                                                         s
                                                      
                                                   
                                                   ,
                                                   t
                                                   )
                                                
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      ∥
                                                      
                                                         Θ
                                                         
                                                            p
                                                            a
                                                            r
                                                            t
                                                            s
                                                         
                                                      
                                                      ∥
                                                   
                                                   2
                                                
                                                +
                                                
                                                   C
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   ξ
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                
                                                S
                                                
                                                   (
                                                   Y
                                                   ;
                                                   I
                                                   ,
                                                   
                                                      Θ
                                                      
                                                         p
                                                         a
                                                         r
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                −
                                                S
                                                
                                                   (
                                                   
                                                      Y
                                                      ^
                                                   
                                                   ;
                                                   I
                                                   ,
                                                   
                                                      Θ
                                                      
                                                         p
                                                         a
                                                         r
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                +
                                                Δ
                                                
                                                   (
                                                   Y
                                                   ,
                                                   
                                                      Y
                                                      ^
                                                   
                                                   )
                                                
                                                ≥
                                                1
                                                −
                                                
                                                   ξ
                                                   i
                                                
                                                
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                N
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 Δ
                                 (
                                 Y
                                 ,
                                 
                                    Y
                                    ^
                                 
                                 )
                              
                            measures the cost introduced by the predicted output configuration 
                              
                                 
                                    Y
                                    ^
                                 
                                 ,
                              
                            for the object with n parts with respective bounding boxes 
                              
                                 
                                    B
                                    i
                                 
                                 ,
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                              
                            (
                              
                                 i
                                 =
                                 0
                              
                            stands for the bounding box of the object). N is the number of training samples sustained by the sample pool. S(·) is the target score function in Eq. (3) with GMM based weight score λi
                            pre-computed (
                              
                                 
                                    λ
                                    0
                                 
                                 =
                                 1
                              
                            for the root),

                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                S
                                                (
                                                Y
                                                ;
                                                I
                                                ,
                                                
                                                   Θ
                                                   
                                                      p
                                                      a
                                                      r
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   n
                                                
                                                
                                                   λ
                                                   i
                                                
                                                
                                                   F
                                                   i
                                                
                                                ·
                                                
                                                   ϕ
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      i
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   d
                                                   i
                                                
                                                ·
                                                
                                                   ϕ
                                                   
                                                      d
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   δ
                                                   
                                                      (
                                                      
                                                         X
                                                         i
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   Θ
                                                   
                                                      p
                                                      a
                                                      r
                                                      t
                                                      s
                                                   
                                                   T
                                                
                                                ·
                                                Φ
                                                
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       Φ
                                       =
                                       
                                          
                                             [
                                             
                                                λ
                                                0
                                             
                                             
                                                ϕ
                                                0
                                                T
                                             
                                             ,
                                             …
                                             ,
                                             
                                                λ
                                                n
                                             
                                             
                                                ϕ
                                                n
                                                T
                                             
                                             ,
                                             
                                                ϕ
                                                
                                                   d
                                                   1
                                                
                                                T
                                             
                                             ,
                                             …
                                             ,
                                             
                                                ϕ
                                                
                                                   d
                                                   n
                                                
                                                T
                                             
                                             ]
                                          
                                          T
                                       
                                       .
                                    
                                 
                              
                           
                        

With the configuration cost 
                              
                                 Δ
                                 (
                                 Y
                                 ,
                                 
                                    Y
                                    ^
                                 
                                 )
                              
                            defined as,

                              
                                 (11)
                                 
                                    
                                       Δ
                                       
                                          (
                                          Y
                                          ,
                                          
                                             Y
                                             ^
                                          
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                
                                                   B
                                                   i
                                                
                                                ∩
                                                
                                                   
                                                      B
                                                      i
                                                   
                                                   ^
                                                
                                             
                                             
                                                
                                                   B
                                                   i
                                                
                                                ∪
                                                
                                                   
                                                      B
                                                      i
                                                   
                                                   ^
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           We can rewrite the structured SVM loss L for Eq. (9) as,

                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                (
                                                
                                                   Θ
                                                   
                                                      p
                                                      a
                                                      r
                                                      t
                                                   
                                                
                                                ;
                                                I
                                                ,
                                                Y
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   max
                                                   
                                                      Y
                                                      ^
                                                   
                                                
                                                
                                                   (
                                                   S
                                                   
                                                      (
                                                      
                                                         Y
                                                         ^
                                                      
                                                      ;
                                                      I
                                                      ,
                                                      
                                                         Θ
                                                         
                                                            p
                                                            a
                                                            r
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   S
                                                   
                                                      (
                                                      Y
                                                      ;
                                                      I
                                                      ,
                                                      
                                                         Θ
                                                         
                                                            p
                                                            a
                                                            r
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   Δ
                                                   
                                                      (
                                                      Y
                                                      ,
                                                      
                                                         Y
                                                         ^
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   max
                                                   
                                                      Y
                                                      ^
                                                   
                                                
                                                
                                                   (
                                                   
                                                      Θ
                                                      
                                                         p
                                                         a
                                                         r
                                                         t
                                                      
                                                      T
                                                   
                                                   
                                                      (
                                                      
                                                         Φ
                                                         ^
                                                      
                                                      −
                                                      Φ
                                                      )
                                                   
                                                   +
                                                   Δ
                                                   
                                                      (
                                                      Y
                                                      ,
                                                      
                                                         Y
                                                         ^
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The gradient of L with respect to θ ∈ Θpart
                            is given by,

                              
                                 (13)
                                 
                                    
                                       
                                          ▽
                                          θ
                                       
                                       L
                                       
                                          (
                                          
                                             Θ
                                             
                                                p
                                                a
                                                r
                                                t
                                             
                                          
                                          ;
                                          I
                                          ,
                                          Y
                                          )
                                       
                                       =
                                       
                                          ▽
                                          θ
                                       
                                       S
                                       
                                          (
                                          
                                             Y
                                             *
                                          
                                          ;
                                          I
                                          ,
                                          
                                             Θ
                                             
                                                p
                                                a
                                                r
                                                t
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          ▽
                                          θ
                                       
                                       S
                                       
                                          (
                                          Y
                                          ;
                                          I
                                          ,
                                          
                                             Θ
                                             
                                                p
                                                a
                                                r
                                                t
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           where the configuration Y
                           * is acquired by solving the revised inference problem,

                              
                                 (14)
                                 
                                    
                                       
                                          Y
                                          *
                                       
                                       =
                                       a
                                       r
                                       g
                                       
                                          max
                                          
                                             Y
                                             ^
                                          
                                       
                                       
                                          (
                                          S
                                          
                                             (
                                             
                                                Y
                                                ^
                                             
                                             ;
                                             I
                                             ,
                                             
                                                Θ
                                                
                                                   p
                                                   a
                                                   r
                                                   t
                                                
                                             
                                             )
                                          
                                          +
                                          Δ
                                          
                                             (
                                             Y
                                             ,
                                             
                                                Y
                                                ^
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Then the parameter can be updated by the passive-aggressive algorithm [9,22],

                              
                                 (15)
                                 
                                    
                                       θ
                                       =
                                       θ
                                       −
                                       
                                          
                                             L
                                             (
                                             
                                                Θ
                                                
                                                   p
                                                   a
                                                   r
                                                   t
                                                
                                             
                                             ;
                                             I
                                             ,
                                             Y
                                             )
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                ▽
                                                θ
                                             
                                             
                                                
                                                   L
                                                   
                                                      (
                                                      ·
                                                      )
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             0.5
                                          
                                       
                                       
                                          ▽
                                          θ
                                       
                                       L
                                       
                                          (
                                          ·
                                          )
                                       
                                    
                                 
                              
                           
                        

The proposed tracker sustains a pool of training samples of root and all the parts for the parameter update. We adopt two strategies to update the sample pool: the appearance scores of the root and the parts computed by the discriminative models, and the temporal distributions of each part indicated by the part weights. When the appearance score Sai
                        (xi
                        ) exceeds a certain threshold, the sample can be seen as a candidate of the pool for the root appearance model. Due to the different change and deformation rate for different parts during tracking, we further use the GMM outputs to control the candidate selection process for each part. For one part, all the training samples in the part sample pool are sorted by the GMM scores by Eq. (4) and the one with the lowest score is replaced by the incoming candidate sample. In this way, we can select the certain samples of the Gaussian mixture distributions that best suitable for parameter update in the current frame. Here the part appearance scores are responsible for the coarse sample selection while the GMM models adjust the selection by checking whether the samples are suitable for the part historical distributions.

The detailed algorithm of the weighted part model tracker is shown in Algorithm 1
                        . For the first frame, model initialization includes the initial part selection, initial sample pool construct, and initial model parameters. After the location of the root and parts are initialized, we sample training samples to construct the initial sample pool. The positive samples are sampled near the selected parts with 1–3 pixels shifted for the root and parts, and the negative samples are sampled on the background regions without overlapping to the object. Then we train the initial trackers with the initial sample pool.

@&#EXPERIMENTS@&#

To evaluate the performance of the proposed tracker, we run our tracker on thirteen challenging sequences [16]. These sequences contain varied tracking targets with different challenging situations in object tracking, which includes partial or full occlusion, shape deformation, illumination, and pose/scale variation. We evaluate the performance of the trackers with the following measures: (1) the mean center position error (CLE) per frame and (2) the correct detection rate (CDR), the average percentage of frames with correct detection. A correct detection is defined with the Pascal VOC overlap rate Roverlap
                      ≥ 0.5, where 
                        
                           
                              R
                              
                                 o
                                 v
                                 e
                                 r
                                 l
                                 a
                                 p
                              
                           
                           =
                           A
                           r
                           e
                           a
                           
                              (
                              
                                 B
                                 T
                              
                              ⋂
                              
                                 B
                                 
                                    G
                                    T
                                 
                              
                              )
                           
                           /
                           A
                           r
                           e
                           a
                           
                              (
                              
                                 B
                                 T
                              
                              ⋃
                              
                                 B
                                 
                                    G
                                    T
                                 
                              
                              )
                           
                           ,
                        
                      
                     BT
                      and BGT
                      are the tracking result and the ground truth bounding box, respectively. We first evaluate the part initialization strategy and the effectiveness of the part weight strategy, then we study the performance of our tracker for single object tracking compared with several state-of-the-art approaches.

The proposed tracker is implemented in MATLAB on a PC with an Intel Core i7 3.4 GHz processor and 4 G RAM. The average running time is about 10 frames per second. The number of Gaussians for each
                      part weighting model is set to be 3 and the part number is set to be 3 ∼ 4 for all the sequences.

Because only a single bounding box is provided to annotate the object in the first frame of the video, all parts need to be carefully selected for later use. Here we compared three approaches for initial part selection:


                        Init 1 – Heuristic part selection approach used by Zhang and van der Maaten [22]. Parts are initialized at the location in which the weights of the initial global SVM w are large and positive. The overlap between parts cannot be more than 50%. Part size is manually set to be 0.4 of the bounding box size.


                        Init 2 – Uniform part partition approach. Parts are selected by averagely splitting the bounding box into different sub-boxes.


                        Init 3 – Greedy heuristic part selection approach. Parts are selected similarly as the method of “Init 1”, but with an greedy size and shape selection strategy as described in Section 3.1.1.

All the features of the parts are extracted on the same scale as the root bounding box features as Zhang and van der Maaten [22] did.

We conduct two experiments to investigate the effect of different part selection methods. The experiment results are shown in Fig. 4. The left figure in Fig. 4 shows the CLE performance and the selected parts for different methods in sequence David while the right one shows the performance in sequence Sylvester. The results show that for most frames, the three initialization methods achieve similar performance, which indicates that the proposed tracker is robust to different part initialization strategies. We set the rest of our experiments run with init 3 selected parts since we don’t need to adjust the part size. Due to the recent success achieved by introducing context information such as recent works proposed by [15,17,21], we also allow the part box to cover the area around the target bounding box in the first frame. For the strategies of init1 and init2, the bounding box is enlarged to be 1.2 times of the root bounding box when selecting the object parts.

Here we discuss initialization strategy for the weighted part models tracker. As shown in Fig. 5, the experimental result shows that the difference of tracking performances is relatively small for different number of Gaussian mixtures of different parts. Thus we use three Gaussian mixtures for each part.


                        Table. 1
                         shows the
                         results for different GMM initialization strategies. For “mean” approach, we set the mean of each Gaussian of the GMM model to be the mean of part samples; for “random” approach, we randomly initialize the Gaussian means of the GMM model. In both settings, the weights of the Gaussian in each GMM model are equal. While in our solution, for a GMM model we set one of its K Gaussian mixtures as the “main Gaussian”, the mean of which is initially computed from the mean of the initial training samples. The weight of the “main Gaussian” is set to be higher than Gaussian mixtures. In our implementation, the number of Gaussian mixtures is set to three for each of the GMM weight models. The initial weights are set to be 0.4, 0.3, 0.3 for the “main Gaussian” and all the other Gaussian mixtures. We set the mean of the “main Gaussian” to be the mean of the initial positive training samples. All the other Gaussian mixtures are initialized with random generated means with a range of 0 ∼ 255. We also set the variance of the “main Gaussian” to be 60 and randomly generate the variances of other mixtures from 50 to 70.

To evaluate the effectiveness of the GMM based weighted strategy for each part, we compare the tracking performance with
                         and without GMM based part weight strategy on “Sylvester” sequence. As shown in Fig. 6, the weight of each part contributes to the final target score. With the GMM based weights involved in, the tracking results on the left figure in Fig. 6 are more robust than the one on the right without part weights. The left figure of the first row are the top 50 target scores at frame 455, which shows that with GMM based part weights, the bounding box of the sample with the highest score is more accurate (red bounding box on the left). While the right figure shows that without part weights, the sample with the highest score corresponds a shifted bounding box (red bounding box on the right), and the proper target location (blue bounding box) shows lower score due to the drift of part appearance models. The second row demonstrates the related locations of all the parts with respect to the root location, from which we can see that with weighted part models, the part related locations are relatively stable compared to the part related locations without part weights. This suggests that the proposed part weighted strategy makes the parts more stable during tracking when the object appearance changes such as occlusion and pose variation. Fig. 7, shows the changes of the part weights (GMM outputs) together with appearance scores of the four parts for first 100 frames. We can see that the part weights from GMM models show different distributions other than part appearance scores. The part weights response the fitness to historic distribution and serve as effective complements to the part appearances. The bottom row is the tracking results with part locations. The part weights help the tracker to get more stabled part appearance models and to capture more representative object parts. Thus more reliable samples for parameter update can be acquired.

More results for the comparison can be found in Fig. 8, where the CLE plots for eight sequences show that the weighted part models ensure the performance gain for most of the sequences. Based on our observation, certain parts may be confused with the background while the weighted part models can reduce these phenomena by sustaining a temporal distributions of parts during tracking and certain unreliable parts can be depressed with smaller part weights. The detailed average comparison results of CLE and CDR for part models with and without weights on these eight sequences are shown in Table 2. We can see that most performance gain brought by the weight models appears in the sequences with cluttered backgrounds such as “singler1” or “tiger1”. These results indicate that for those targets with poor appearance models caused by drastically appearance changes or strong background clutters, while the introduction of part weights with GMM could effectively select the important parts and accurately update each parts, the tracking performance is obviously improved.

We compare the performance of the proposed tracker with six state-of-the-art trackers: the SPOT tracker (SPOT) by Zhang and van der Maaten [22], the Struck tracker (struck) by Hare et al. [7], the MIL tracker (MIL) by Babenko et al. [2], the OAB tracker (OAB) by [6] and the TLD tracker (TLD) by Kalal et al. [10]. All trackers’ source code are available online, here we run all tracker with default configurations (all trackers but TLD are with single scale), we run each track for five rounds and report the average results below.


                        Tables 3
                         and 4
                         show the CLE and CDR results respectively. Our approach outperforms nine of the fourteen sequences with CLE measure. The relatively bad results compared to the state-of-the-arts in sequences girl and boy are mainly caused by the small target size since the HOG feature is not suitable for small targets. The proposed tracker achieves best or second best results for the rest of the tested sequences. For the CDR results, the proposed tracker also achieves reasonable results for most of the tested sequences. Visualized tracking results of different trackers can be seen in Fig. 9
                        , which reveal the potential benefit of weighted part models and effective update strategy.

@&#CONCLUSION@&#

In this paper, we present a novel approach for online object tracking with weighted part models. We model the object together with its part with a graph structure. To handle the varied change rate for different object parts, we introduce GMM models to dynamically adjust the contribution of the part appearance models and guarantee the proper sample selections for parameter update. GMM based part weights describe the dynamic evolution of the object parts in a temporal view which is an efficient complement to the discriminative part appearance models. Experimental results showed that the proposed weighted part models achieve the promising performance.

@&#ACKNOWLEDGMENT@&#

This work was supported by 863 Program 2014AA015104, and National Natural Science Foundation of China 
                  61273034, and 61332016.

@&#REFERENCES@&#

