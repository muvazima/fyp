@&#MAIN-TITLE@&#Interpretative reading of the antibiogram – a semi-naïve Bayesian approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Prediction of bacterial susceptibility to antibiotics not tested in the antibiogram.


                        
                        
                           
                           Predictions use the institutional antibiogram of in vitro susceptibilities.


                        
                        
                           
                           Predictions are based on data on cross-susceptibility and cross-resistance.


                        
                        
                           
                           Predictions are generated by different semi-naïve Bayesian approaches.


                        
                        
                           
                           Susceptibility predictions are improved compared to the institutional antibiogram.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bayes theorem

Bacterial infections

Antimicrobial therapy

Antibiogram

Cross-resistance

Antimicrobial Stewardship

@&#ABSTRACT@&#


               
               
                  Background
                  An antibiogram (ABG) gives the results of in vitro susceptibility tests performed on a pathogen isolated from a culture of a sample taken from blood or other tissues. The institutional cross-ABG consists of the conditional probability of susceptibility for pairs of antimicrobials. This paper explores how interpretative reading of the isolate ABG can be used to replace and improve the prior probabilities stored in the institutional ABG. Probabilities were calculated by both a naïve and semi-naïve Bayesian approaches, both using the ABG for the given isolate and institutional ABGs and cross-ABGs.
               
               
                  Methods and Material
                  We assessed an isolate database from an Israeli university hospital with ABGs from 3347 clinically significant blood isolates, where on average 19 antimicrobials were tested for susceptibility, out of 31 antimicrobials in regular use for patient treatment. For each of 14 pathogens or groups of pathogens in the database the average (prior) probability of susceptibility (also called the institutional ABG) and the institutional cross-ABG were calculated. For each isolate, the normalized Brier distance was used as a measure of the distance between susceptibility test results from the isolate ABG and respectively prior probabilities and posteriori probabilities of susceptibility. We used a 5-fold cross-validation to evaluate the performance of different approaches to predict posterior susceptibilities.
               
               
                  Results
                  The normalized Brier distance between the prior probabilities and the susceptibility test results for all isolates in the database was reduced from 37.7% to 28.2% by the naïve Bayes method. The smallest normalized Brier distance of 25.3% was obtained with the semi-naïve min2max2 method, which uses the two smallest significant odds ratios and the two largest significant odds ratios expressing respectively cross-resistance and cross-susceptibility, calculated from the cross-ABG.
               
               
                  Conclusion
                  A practical method for predicting probability for antimicrobial susceptibility could be developed based on a semi-naïve Bayesian approach using statistical data on cross-susceptibilities and cross-resistances. The reduction in Brier distance from 37.7% to 25.3%, indicates a significant advantage to the proposed min2max2 method (p<10 99).
               
            

@&#INTRODUCTION@&#

When a patient presents at a hospital with a bacterial infection, antimicrobials will be administered to the patient. Before the antimicrobials are administered, samples will be taken from the patient, usually both a blood sample and a “local” sample from the site of infection, for example a urine sample if the patient is suspected of a urinary tract infection. Within a day or two bacteria are successfully isolated from these samples in approximately 30% of the patients [1]. Once isolated, the bacteria are tested for their in vitro susceptibility to a range of antimicrobials. The test results are called an antibiogram (ABG), which specifies the susceptibility of the pathogen to each tested antimicrobial. These ABGs often make it relevant to change the initial “empirical” treatment given to the patient into a “definitive” treatment, where it is known from the susceptibility results that the isolated bacteria are susceptible to the antimicrobial(s) given in the definitive treatment.

At any given time a large number of antimicrobials are in use in a hospital. Out of these only a limited set of antimicrobials is tested due to practical and economic constraints. Therefore it occasionally happens that none of the tested antimicrobials are clinically acceptable. This may for example be due to allergies, to significant toxicity, to limited gastrointestinal absorption of the drug in severely septic patients, to preferences for bactericidal rather than bacteriostatic antimicrobials or due to preferences imposed by antimicrobial stewardship programs, where for example quinolones are considered a less desirable choice relative to cephalosporins (Danish Health and Medicines Authority, 2013) [2]. In such cases it is desirable to have additional information about the susceptibility of the isolated pathogens to antimicrobials for which no susceptibility results are available. Some information can be derived from the expert rules of the European Committee on Antimicrobial Susceptibility Testing (EUCAST) [3].

EUCAST expert rules come in three forms (edited in the interest of simplicity):

1. Intrinsic resistance: E.g. Rule 2.6: Pseudomonas aeruginosa is resistant to ampicillin.

2. Exceptional resistance phenotypes: E.g. Rule 6.1: Staphylococcus aureus is (almost always) susceptible to vancomycin, linezolid, quinupristin/dalfopristin, daptomycin and tigecycline.

3. Interpretive rules: E.g. Rule 8.6: If Enterococcus spp. is resistant to ampicillin, report as resistant to ureidopenicillins and carbapenems.

The first two forms extend the ABG with knowledge of respectively resistance and susceptibility for antimicrobials, which have not been tested. The third form extends the susceptibility results from the tested antimicrobials to some of those not tested.

These rules represent an improvement in the reporting of susceptibility results, but cover only a very limited number of pathogen/antimicrobial combinations.

It would therefore be desirable to have a computationally feasible method that retains the advantages of the EUCAST expert rules, but which may also provide some help when none of these apply. This will be achieved by compiling institutional ABGs from the isolate databases maintained by most clinical microbiology laboratories. For example, in the institutional ABG compiled from the isolate database used in this study, we can read that the prior probability of Escherichia coli (E. coli) isolates being susceptible to cefuroxime is 83%. This information indicates that prescription of cefuroxime against an E. coli infection may well be useful, even if the E. coli isolate's susceptibility to cefuroxime has not been tested. Institutional cross-ABGs, containing statistics on the conditional probabilities of susceptibility for pairs of antimicrobials can likewise be compiled. For example, in the cases where E. coli was susceptible to ofloxacin, we can read from the institutional cross-ABG that the conditional probability of susceptibility to cefuroxime given susceptibility to ofloxacin is 96%. This can be used to prescribe cefuroxime with good certainty (96%) that it will cover the E. coli infection. This particular case, where the quinolone, ofloxacin, may be replaced by the cephalosporin, cefuroxime, would be an example of antibiotic stewardship, in line with for example the Danish guidelines on prescribing of antibiotics [2], where the use of quinolones is more restricted than the use of cephalosporins. We will refer to the conditional probabilities as institutional cross-susceptibilities, or institutional cross-resistances, if conditional on resistance. Jointly, the institutional cross-susceptibilities and the cross-resistances will be referred to as the institutional cross-ABGs.

The purpose of this paper is to develop a method of interpretative reading of susceptibility test results where posterior probabilities of susceptibilities of an isolate to untested antimicrobials are calculated from the institutional ABG (the priors) and the institutional cross-ABG, given the tested isolate's ABG.

An isolate database of bacterial pathogens isolated from blood cultures taken from patients suspected of bacterial infections will be used to illustrate the methods for estimation of posterior probabilities of susceptibility. The database was compiled between 2002 and 2004 at Rabin Medical Center in Israel and includes 3347 clinically significant pathogens.

The isolate database contains the pathogen identity and an ABG for each isolate. The susceptibility results are reported in the so-called S-I-R system. If S (sensitive) is reported as the result of the susceptibility test, then the antimicrobial can eradicate the pathogen in vitro and with some exceptions this will also lead to clinical success, i.e. in vivo eradication of the pathogen. R (resistant) is expected to result in clinical failure and I (intermediate) may lead to either. For the purposes of this paper intermediate test results (I) will be considered as resistant (R).

For each of the 14 pathogen groups in the isolate database an institutional ABG was compiled, containing the (prior) probability of an isolate from a given group being susceptible to a given antimicrobial. From the isolate database the cross-susceptibility and cross-resistance tables can also be compiled, as previously described by Zalounina et al. (2007) [4]. These tables contain conditional probabilities of susceptibility for pairs of antimicrobials and they are called cross-susceptibilities when conditional on susceptibility and cross-resistances, when conditional on resistance. Table IV gives an example of the compilation of cross-susceptibilities and cross-resistances. The cross-susceptibilities and cross-resistances are joined into the institutional cross-ABG tables where they are expressed as odds ratios for increased or decreased susceptibility (Appendix Eq. (8)). Fisher's exact test is used to determine the significance of the odds ratios. When most isolates are tested with the same antimicrobials the observations are dependent, with missing values. Therefore Fisher's exact test may underestimate the significance of some odds ratios.

The posterior probabilities will be calculated by several versions of naïve and semi-naïve Bayesian methods. In the naïve Bayes method all significant odds ratios in the cross-ABG will be used. In the semi-naïve Bayesian methods only some of the significant odds ratios will be used.

Each method for calculation of posterior probabilities is validated by 5-fold cross-validation, where the isolate database is divided in a learning set and a validation set. The institutional ABGs and institutional cross-ABGs compiled from the learning set are used to calculate posterior probabilities in the validation set. The quality of the calculated probabilities will be assessed by deleting one susceptibility test result at a time for a given isolate in the validation set and then using the method to calculate the posterior probability of susceptibility given the remaining susceptibility test results for that particular isolate. This will be repeated for each of the test results for the given isolate and subsequently for all isolates in the 5-fold validation set. The accuracy of the posterior probabilities will be assessed by calculating the distance (Appendix Eq. (11)) between each test result in the ABG and its calculated posterior probability. The normalized Brier distances are then calculated by adding all distances and normalizing (Appendix Eq. (12)). The normalized Brier distance can be considered as the standard deviation in percent between calculated and tested susceptibilities.

The normalized Brier distances between susceptibility test results and respectively prior probabilities and posteriori probabilities of susceptibility were compared using the paired samples t-test (2-tailed).

@&#RESULTS@&#

The isolate ABGs contained a total of 63590 susceptibility test results. A segment of the isolate database is illustrated in Table 1
                        . As an example, susceptibility results are here shown for three antimicrobials: ofloxacin (OFL), meropenem (MER) and amikacin (AMK), but the database contains on average test results for 19 different antimicrobials per pathogen.

The ABGs in the isolate database were used to compile the institutional ABG of each pathogen. To avoid estimates based on very few results, the pathogens were placed in 14 groups with roughly similar susceptibilities (Table 2
                        ). Learning susceptibility of a pathogen using data from similar pathogens was previously described by Andreassen et al. (2009) [5].

The choice of antimicrobials used to test susceptibilities depended on the pathogen. Table 3
                         illustrates a total of five different typical sets of antimicrobials tested on:
                           
                              a)
                              Gram negative bacteria


                                 Staphylococci
                              


                                 Streptococci
                              


                                 Enterococci and

Other Gram positive bacteria


                        Table 3 shows a clear pattern in the sets of antimicrobials selected for susceptibility test against a pathogen. It reflects a strategy of:
                           
                              a)
                              Only testing antimicrobials known to have effect on the given pathogen. This is for example why the narrow spectrum β-lactam, methicillin, is not tested against Gram negative bacteria.

Using assumptions on cross-resistance and cross-susceptibility to minimize the number of tests. For example the choice of testing susceptibility to methicillin against staphylococci is based on knowledge of 100% cross-resistance to other β-lactam antibiotics.


                        Table 4
                        , column 2 gives an example of how the entry for the antimicrobial cefuroxime in the institutional ABG for E. coli is compiled. The column is labeled “Prior” contains the number of E. coli isolates tested against cefuroxime, NCEF
                        =705;Ncef
                        =582 is the number of isolates tested susceptible to cefuroxime; and P(cef)=0.83 is the prior probability of E. coli being susceptible to cefuroxime.

In Table 4, column 3 labeled “Cross-suscept.” NCEF|ofl
                        =522 is the number of isolates tested against cefuroxime that concurrently showed susceptibility to ofloxacin; Ncef|ofl
                        =501 is the number of isolates tested susceptible to cefuroxime and concurrently susceptible to ofloxacin, and P(cef|ofl)=0.96 is then the conditional probability of susceptibility to cefuroxime, given that the isolate is susceptible to ofloxacin. The column labeled “Cross-resistance” shows the corresponding counts and probabilities conditional on resistance to ofloxacin.

The change from the prior probability of 83% to the posterior probability of 96%, conditional on susceptibility to ofloxacin, corresponds to an odds ratio OR(cef|ofl)=5.0 (Eq. (9) in the Appendix) and the change to 44% conditional on resistance corresponds to OR(¬cef|ofl)=0.16. These two odds ratios are entered into the cross-ABG table for E. coli.
                     

In Table 5
                        , as an example we show the institutional ABG for E. coli in the column labelled “Prior”. The columns labeled “ORsus” and “ORres” give the odds ratios in the institutional E. coli cross-ABG for cefuroxime, conditional on susceptibility to the antimicrobials listed in the rows. For example, the odds ratios mentioned above of 5.0 and 0.16 can be found in the “Ofloxacin” row.

All odds ratios for the typically tested antimicrobials in the E. coli example in Table 5 are significant (with p<0.1), except the carbapenems and colistin. Carbapenems and colistin have prior susceptibilities close to 100%, which implies that resistance and thereby cross-resistance is very rarely or never observed (since the pathogen is almost always susceptible). It is also difficult to observe significant cross-susceptibility to these antimicrobials and also irrelevant since we already know that the pathogen is susceptible. The odds ratio conditional on susceptibility to cephalothin is infinity, which implies that susceptibility to cephalothin, which is a first generation cephalosporin guarantees susceptibility to cefuroxime, a second generation cephalosporin. The odds ratios, conditional to resistance to ceftazidime and ceftriaxone, both third generation cephalosporins, and to cefepime, a fourth generation cephalosporin, is zero or very close to zero. This means that resistance to one of these three cephalosporins implies resistance to cefuroxime as well.

The columns labeled ORsus and ORres in Table 5 shows only a small part of the cross-ABG for E. coli. The complete institutional ABG for E. coli contains Table 5, but also “ORsus” and “ORres” columns for all other antimicrobials besides cefuroxime. Such data are compiled for each of the 14 pathogen groups.

The EUCAST interpretative rules can be entered directly into tables of institutional cross-ABGs, as defined in the methods section. For the 14 groups of pathogens and 31 antimicrobials in the isolate database the cross-ABG tables have 14*31*31*2=26908 entries. The interpretative EUCAST rules only allow 70 or 0.26% of these entries to be filled. In comparison the statistical compilation from the isolate database of entries intro the institutional cross-ABG tables allow 4682 or 17.4% of the entries to be filled.

The institutional ABG and the odds ratios in the institutional cross-ABG can be used to calculate the posterior probability of susceptibility to an untested antimicrobial, given a susceptibility test result for another antimicrobial. If we consider a situation where susceptibility to cefuroxime of an E. coli isolate has not been tested, and that the E. coli isolate is tested susceptible to ofloxacin, then the posterior probability of susceptibility cefuroxime can be calculated. This is done by converting the prior probability of susceptibility to cefuroxime into odds (OD) for susceptibility:
                           
                              (1)
                              
                                 
                                    OD
                                    (
                                    cef
                                    )
                                    =
                                    0.83
                                    /
                                    (
                                    1
                                    −
                                    0.83
                                    )
                                    =
                                    4.88
                                 
                              
                           
                        
                     

in accordance with Eq. (6) in the Appendix.

The posterior odds for cefuroxime, given susceptibility to ofloxacin, is then calculated as:
                           
                              (2)
                              
                                 
                                    OD
                                    (
                                    cef| 
                                    ofl
                                    )
                                    =
                                    OR
                                    (
                                    cef| 
                                    ofl
                                    )
                                    *
                                    OD
                                    (
                                    cef
                                    )
                                    =
                                    5.0
                                    *
                                    4.88
                                    =
                                    24.41
                                 
                              
                           
                        
                     

in accordance with Eq. (9) in the Appendix.

Finally, the odds are converted back to a probability:
                           
                              (3)
                              
                                 
                                    P
                                    (
                                    cef| 
                                    ofl
                                    )
                                    =
                                    OD
                                    (
                                    cef| 
                                    ofl
                                    )
                                    /
                                    (
                                    1
                                    +
                                    OD
                                    (
                                    cef| 
                                    ofl
                                    )
                                    )
                                    =
                                    24.41
                                    /
                                    (
                                    1
                                    +
                                    24.41
                                    )
                                    =
                                    0.96
                                 
                              
                           
                        which can be recognized as the already known conditional probability from Table 4.

In the ABG presented in Table 6
                        , the susceptibility to cefuroxime was tested and the isolate was found to be susceptible to cefuroxime. If we again imagine that the susceptibility to cefuroxime had not been tested, then we can ask if we could have predicted the in vitro susceptibility to cefuroxime from the other 20 test results.

The straightforward solution is to compile the 20 dimensional probability matrix for cefuroxime, conditional on the other 20 results in the ABG. Bayes theorem can then be used directly to calculate the posterior probability of susceptibility to cefuroxime. This is far from a viable solution, because it would be impossible to populate the 220 elements in this matrix even with an isolate database compiled over many years in a large hospital.

If a naïve Bayes approach is used, then the posterior probability can be calculated from the data available in the susceptibility database, as shown in the Appendix. This is done by repeating the procedure given by Eqs. (1)–(3), except that the single odds ratio in Eq. (2) is replaced by ORall, which is the product of all the bolded odds ratios in Table 6. When the test result is “S”, we include the OR for cross-susceptibility and when the susceptibility result is “R”, we include the OR for cross-resistance. This results in the odds ratio product; ORall=7432 and the posterior probability P(cef|ABG)=100,00%. This result indicates a close to perfect prediction of the susceptibility to cefuroxime.

This attempt at estimating the posterior probabilities is repeated for the other tested antimicrobials, imagining one at a time that the test results are not available. The results are shown in Table 6 in the column labeled “Naïve”. For most of the antimicrobials the results of the susceptibility-estimation are as anticipated, but with a few exceptions, notably the susceptibility to ampicillin/clavulanate, which is estimated to 99%, even though the result was “R” (0%). A normalized Brier distance (Appendix Eq. (12)) is used as a measure of the quality of the posterior estimates. This distance can be interpreted as an average distance between the posterior probability and the actual test result. The naïve Bayes estimates gives a normalized Brier distance of 25.2% for the E. coli isolate considered (last row, Table 6). This can be considered as an improvement, relative to the normalized Brier distance for the prior estimates, which is 29.1%.

The naïve Bayes assumption is that the susceptibility test results are mutually independent. The naïve Bayes approach is known to produce overconfident results, i.e. results too close to 0% or 100%, if the underlying assumption of independence is not well met, and the naïve Bayes estimates in Table 6 could indicate that this is the case. To manage this, a semi-naïve approach is explored. In this approach a more modest number of odds ratios are used in the calculations. We define a version of semi-naïve Bayes, called min1max1, where only the largest and the smallest odds ratios from Table 5 are used to calculate the odds ratio in Eq. (2). Thus, using the odds ratios shaded gray in Table 5 we get:
                              
                                 
                                    
                                       ORmin
                                       1
                                       max
                                       1
                                       (
                                       cef| 
                                       ABG
                                       )
                                       =
                                       5.0
                                       *
                                       0.3
                                       =
                                       0.15
                                    
                                 
                              
                           
                        

From this odds ratio follows that the posterior probability of susceptibility to cefuroxime of 88%, which is a less extreme estimate than the estimate of 100% from the naïve Bayes method. The normalized Brier distance for this E. coli isolate over all antimicrobials is down to 18%, which supports the suspicion that the naïve Bayes results may be overconfident, and that the more modest semi-naïve approach may be better than the naïve Bayes approach. In the following section, we compare the performance of the naïve and different versions of semi-naïve methods.

To assess the quality of the naïve and semi-naïve posterior probabilities of susceptibility, one susceptibility result at a time is deleted from the isolate ABG and subsequently the posterior probability of susceptibility is calculated from the remaining ABG results. This is repeated for all the 3347 isolates in the database using a 5-fold cross-validation. For each isolate the normalized Brier distance is used to measure the distance between susceptibility test results and respectively prior probabilities and calculated posterior probabilities.


                        Table 7
                         shows these normalized Brier distances, averaged over all isolates in the five validation sets. The first row presents the normalized Brier distance for prior probabilities and the following rows presents the normalized Brier distance for different naïve or semi-naïve Bayesian methods. The methods are named after the number of odds ratios used to calculate posterior probabilities of susceptibility. For example, the method named min2max2 uses the two smallest significant odds ratios and the two largest significant odds ratios, and the min0max3 method includes zero odds ratios on cross-resistance and the three highest significant odds ratios on cross-susceptibility (if they exist).

The methods where the odds ratios for cross-resistance and cross-susceptibility were weighted equally (shaded gray in Table 7) performed better than both the naïve method and methods with an unequal weighting. For example, the min0max3 method has a normalized Brier distance, which is even larger than the normalized Brier distance of the prior probabilities (first row). The min2max2 method performed the best with a normalized Brier distance of 25.3% (Ranges from 24.8%–25.6% within the five validations sets). The min2max2 method gave a significant improvement (p<1099) when compared to the normalized Brier distance for the prior probabilities, and the distance was significantly smaller (p<10−9) than the distance for the min1max1 method.


                        Fig. 1
                         shows the performance of the min2max2 method on each pathogen group compared to the prior susceptibilities from the institutional ABG. Normalized Brier distances for each pathogen group were averaged over the five validation sets. For Gram negative bacteria the min2max2 method gave an average reduction in normalized Brier distance of 13.3% from the prior susceptibilities (from 37.3% to 23.9%). For Staphylococcus spp. the method reduced the distance by 12.0% (from 40.6% to 28.6%), and for the rest of the Gram positive bacteria the average reduction was 3.5% (from 33.0% to 29.5%).

In all the above calculations, the posterior probabilities were calculated from odds ratios, which are significantly different from 1. The limit of significance was arbitrarily chosen as p<0.1. Results will depend on the p value chosen and therefore the posterior susceptibility determinations were carried out with different p values, ranging from 0.02 to 0.5.


                        Fig. 2
                         shows the mean of estimated susceptibilities for the five validations sets, and the range the sets varied within (shaded grey). The ability to estimate susceptibilities was tested using 10 different p values (from 0.02 to 0.5) for inclusion of significant odds ratios. For most of the 63590 included susceptibility test results, posterior probabilities of susceptibility could be calculated from the other susceptibility test results. With a p value of 0.02 for significance of odds ratios, 71.9% of the susceptibilities could be calculated, and with a p value of 0.5, 89.7% of the susceptibilities could be calculated.


                        Fig. 3
                         illustrates that irrespective of p value the naïve Bayes method had lower normalized Brier distance than the prior probabilities and that the min2max2 method had lower normalized Brier distances than the naïve Bayes method.

The normalized Brier distance of the naïve Bayes method tended to increase a little with the p value while the normalized Brier distance of the min2max2 methods tended to decrease a little with the p value. The decrease of the normalized Brier distance of the min2max2 method with the p value could be seen as an argument for using a high p value. This should however be balanced against the risk of obtaining “strange” estimates due to spurious odds ratios derived from very few susceptibility results. Since the reduction in normalized Brier distance was very small for p values above 0.1, p=0.1 may be an appropriate choice.

@&#DISCUSSION@&#

This paper explores how interpretative reading of the isolate ABG can be used to replace the prior probabilities stored in the institutional ABG, with posterior probabilities, which are at least closer to susceptibility test results than the prior probabilities. We explored both a naïve and semi-naïve Bayesian approaches, where the posterior probabilities were calculated from the isolate ABG, using data stored in the institutional ABG and the institutional cross-ABG.

A 5-fold cross-validation showed that the goal was achieved. The normalized Brier distance between the prior probabilities and the susceptibility test results for all isolates in the database was reduced from 37.7% to 28.2% by the naïve Bayes method. The smallest normalized Brier distance of 25.3% was obtained with the semi-naïve min2max2 method. This illustrates that although the naïve Bayes method actually gave an improvement relative to the prior probabilities, the naïve Bayes assumption should for this purpose be used with restraint. The reason for a more poorly performance for methods including more than two odds ratios (min3max3, min4max4, and naïve) is probably related to the naïve Bayes assumption; that the susceptibility test results are mutually independent. The naïve Bayes approach is known to produce overconfident results, i.e. results too close to 0% or 100%, if the underlying assumption of independence is not well met. The E. coli example in Table 6 indicates that this is the case.

Not surprisingly, the methods where the odds ratios for cross-resistance and cross-susceptibility were weighted equally (shaded gray in Table 7) performed better than both the naïve method and methods with an unequal weighting. In other words, giving a higher weight to either cross-resistance or cross-susceptibility gives a distortion in the calculated susceptibilities.

When we looked into the performance of the min2max2 method on different pathogen groups, the results indicated a better performance on Gram negative isolates compared to Gram positive isolates. This is could be related to a higher fraction of the cross-ABG being filled for Gram negative pathogens, i.e. a higher fraction of significant cross-resistances and cross-susceptibilities. Further analysis could be done to investigate this correlation and the variability in the fraction of the cross-ABG being filled.

The proposed method can be seen as an extension of the EUCAST interpretive expert rules because:
                        
                           a)
                           The EUCAST rules are very scarce, covering only a very small part (0.26% in this study) of the large matrix of pathogens and pairs of antimicrobials. The naïve or semi-naïve Bayesian methods cover a much larger fraction of this matrix (17.4% in this study).

In contrast to EUCAST the proposed method provides an estimate of the probability of susceptibility, which is relevant since antimicrobials may be given, even when the probability of susceptibility is smaller than 100%.

The proposed method is based on statistics, local to the hospital, and will therefore adapt to local microbial susceptibilities, while EUCAST rules are based on international clinical and/or microbiological evidence of varying quality [3].

EUCAST interpretative expert rules gives advice on antibiotic susceptibility to antibiotics in the same antibiotic class as the ones tested (e.g within the β-lactam group) [3]. The proposed method works across antibiotic classes, as in the example with cefuroxime and ofloxacin.

This means that the proposed method and the interpretive EUCAST expert rules should be used in combination to get the best possible prediction of susceptibility of a pathogen. The EUCAST rules can be incorporated as an integrated part of the institutional ABG.

The min2max2 method will in combination with the EUCAST rules be incorporated into the TREAT system (a computerized decision support system for antimicrobial stewardship), which have been shown to reduce inappropriate antimicrobial treatments at hospitals [1,6]. Interpretative reading of susceptibility results is expected to further improve performance of the system.

A limitation of the study is that the methods developed are approximate methods. As pointed out already, an exact Bayesian approach would require population of multidimensional conditional probability matrices. This is far beyond reach and in practice the one-dimensional conditional probabilities in the cross-ABG represents a practical upper limit. It may therefore be considered a virtue, that useful posterior probabilities can be calculated from the limited information compiled in the susceptibility database.

It may also be considered a limitation that only probabilistic methods have been considered. Estimating susceptibilities could for example be considered as an imputation problem, where the missing susceptibilities should be imputed from the available susceptibilities [7]. Alternatively, classifiers could be build based on neural nets, fuzzy logic or rule induction. We suspect that the combinatorial explosion, which prevented a direct application of Bayes theorem, will also present problems for these other methods, and we have therefore refrained from using them.

The isolate database used in this paper provided a rather high number of susceptibility results - on average each isolate was tested with 19 antimicrobials. Further validation on isolates with sparser susceptibility test results would help to strengthen the results. In general, the ability of the method to predict the susceptibility to an antimicrobial depends on the quality of the relevant isolate ABG and the quality of the institutional ABG and cross-ABG.

To conclude, a practical method for predicting probability for antimicrobial susceptibility could be developed based on a semi-naïve Bayesian approach using statistical data on cross-susceptibilities and cross-resistances. By using this method, we achieved significantly more accurate predictions of pathogen in vitro susceptibility to antimicrobials, than the prior probabilities stored in the institutional ABG.

The authors Steen Andreassen and Line Sanden are employed part time at Treat Systems, a company developing the antimicrobial decision support system TREAT. Treat Systems did not financially support the work.

We assume that a given pathogen has an antibiogram presenting a set of T antimicrobials: T
                        ={1, … t, … T} and a corresponding set of susceptibility results: A
                        
                           T
                        
                        ={A1, … At, … AT}, where At is either S (a “susceptible” result) or R (a “resistant” result).

The prior probability of susceptibility to an antimicrobial B, which is not a member of the set of T antimicrobials, is denoted as P(b). The corresponding probability of resistance to B is denoted as P(¬b).

The aim is to calculate the posterior probability of susceptibility to antimicrobial B given a set of susceptibility results A
                        
                           T
                        , denoted as P(b|A
                        
                           T
                        ).

A step towards a simple approximation of P(b|A
                        
                           T
                        ) can be taken by using Bayes theorem to write:
                           
                              (1)
                              
                                 
                                    P
                                    (
                                    b
                                    |
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          |
                                          b
                                          )
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

If we make the “naïve Bayes” assumption of conditional independence within the set A
                        
                           T
                        , given b, then
                           
                              (2)
                              
                                 
                                    P
                                    (
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    |
                                    b
                                    )
                                    =
                                    
                                       ∏
                                       t
                                    
                                    
                                       P
                                       (
                                       
                                          
                                             A
                                          
                                          T
                                       
                                       |
                                       b
                                       )
                                    
                                 
                              
                           
                        
                     

A Bayes inversion of P(At|b) gives:
                           
                              (3)
                              
                                 
                                    P
                                    (
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    |
                                    b
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          b
                                          |
                                          
                                             A
                                             t
                                          
                                          )
                                          P
                                          (
                                          
                                             A
                                             t
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          b
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Insertion of Eqs. (2) and (3) in (1) gives:
                           
                              (4)
                              
                                 
                                    P
                                    (
                                    b
                                    |
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             P
                                             (
                                             
                                                A
                                                T
                                             
                                             |
                                             b
                                             )
                                          
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                         P
                                                         (
                                                         
                                                            A
                                                            t
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                         P
                                                         (
                                                         
                                                            A
                                                            t
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∏
                                             t
                                          
                                          
                                             [
                                             P
                                             (
                                             
                                                A
                                                T
                                             
                                             )
                                             ]
                                          
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

We now define the prior odds ODb for P(b) as:
                           
                              (5)
                              
                                 
                                    O
                                    
                                       R
                                       b
                                    
                                    =
                                    P
                                    (
                                    b
                                    )
                                    /
                                    P
                                    (
                                    ¬
                                    b
                                    )
                                 
                              
                           
                        and define the posterior odds for P(b|A
                        
                           T
                        ) as:
                           
                              (6)
                              
                                 
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    P
                                    (
                                    b
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    /
                                    P
                                    (
                                    ¬
                                    b
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

Inserting Eqs. (4) and (5) into (6) gives:
                           
                              (7)
                              
                                 
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             
                                                A
                                             
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∏
                                             t
                                          
                                          
                                             [
                                             P
                                             (
                                             
                                                A
                                                T
                                             
                                             )
                                             ]
                                          
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         ¬
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∏
                                             t
                                          
                                          
                                             [
                                             P
                                             (
                                             
                                                A
                                                T
                                             
                                             )
                                             ]
                                          
                                          P
                                          (
                                          ¬
                                          b
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          P
                                          (
                                          b
                                          )
                                       
                                       
                                          
                                             ∏
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                         (
                                                         ¬
                                                         b
                                                         |
                                                         
                                                            A
                                                            T
                                                         
                                                         )
                                                      
                                                      
                                                         P
                                                         (
                                                         ¬
                                                         b
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          P
                                          (
                                          ¬
                                          b
                                          )
                                       
                                    
                                    =
                                    O
                                    
                                       D
                                       b
                                    
                                    
                                       ∏
                                       t
                                    
                                    
                                       
                                          
                                             O
                                             
                                                D
                                                
                                                   b
                                                   |
                                                   
                                                      A
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             O
                                             
                                                D
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The odds ratio for susceptibility is defined as:
                           
                              (8)
                              
                                 
                                    O
                                    
                                       R
                                       
                                          b
                                          |
                                          
                                             A
                                             t
                                          
                                       
                                    
                                    =
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             A
                                             t
                                          
                                       
                                    
                                    /
                                    O
                                    
                                       D
                                       b
                                    
                                 
                              
                           
                        
                     

Hence eq.7 can be written as:
                           
                              (9)
                              
                                 
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             
                                                A
                                             
                                             T
                                          
                                       
                                    
                                    =
                                    O
                                    
                                       D
                                       b
                                    
                                    
                                       ∏
                                       t
                                    
                                    
                                       O
                                       
                                          R
                                          
                                             b
                                             |
                                             
                                                A
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Finally the posterior probability can be calculated from Eq. (6) as:
                           
                              (10)
                              
                                 
                                    P
                                    (
                                    b
                                    |
                                    
                                       A
                                       T
                                    
                                    )
                                    =
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             A
                                             T
                                          
                                       
                                    
                                    /
                                    (
                                    1
                                    +
                                    O
                                    
                                       D
                                       
                                          b
                                          |
                                          
                                             A
                                             T
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        using that P(¬b|A
                        
                           T
                        )=1- P(b|A
                        
                           T
                        ).

The ability of a method to accurately calculate posterior probabilities of susceptibility was tested by removing one susceptibility result At at a time from the susceptibility results A
                        
                           T
                         for a given isolate in the isolate database, leaving the set A
                        
                           T
                        \At. Then we use the methods to calculate P(At| A
                        
                           T
                        \At) and calculate the distance to the true result At as the Euclidian distance:
                           
                              (11)
                              
                                 
                                    D
                                    i
                                    s
                                    t
                                    =
                                    |
                                    
                                       A
                                       t
                                    
                                    −
                                    P
                                    (
                                    
                                       A
                                       t
                                    
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    \
                                    
                                       A
                                       t
                                    
                                    )
                                    |
                                 
                              
                           
                        where At has the value 1 (susceptible) or 0 (resistant).

The quality of the posterior probabilities provided by a given method was then assessed from the normalized Brier distance [8,9] across all antimicrobials A
                        
                           T
                         for which a susceptibility result was available:
                           
                              (12)
                              
                                 
                                    N
                                    o
                                    r
                                    m
                                    .
                                    B
                                    r
                                    i
                                    e
                                    r
                                     
                                    d
                                    i
                                    s
                                    t
                                    .
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         A
                                                         t
                                                      
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                                
                                                   D
                                                   i
                                                   s
                                                   
                                                      t
                                                      t
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   N
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where NAT was the number of members in the set A
                        
                           T
                        . The normalized Brier distance can be interpreted as a deviation in percent between the calculated posterior probability of susceptibility and the measured susceptibility test result.

@&#REFERENCES@&#

