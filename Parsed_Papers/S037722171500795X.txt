@&#MAIN-TITLE@&#Branch-and-price algorithms for the solution of the multi-trip vehicle routing problem with time windows

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Our exact methods based on the branch and price principle solve the multi-trip vehicle routing problem with time windows.


                        
                        
                           
                           Our contribution emphasises on the pricing algorithms which are based on dynamic programming.


                        
                        
                           
                           We investigate if scheduling of trips is best done within master problem or sub problem.


                        
                        
                           
                           With 25 customer instances derived from Solomon’s, scheduling in master problem allows solving more instances.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vehicle routing

Time windows

Multiple trips

Column generation

Branch-and-price

@&#ABSTRACT@&#


               
               
                  We investigate the exact solution of the vehicle routing problem with time windows, where multiple trips are allowed for the vehicles. In contrast to previous works in the literature, we specifically consider the case in which it is mandatory to visit all customers and there is no limitation on duration. We develop two branch-and-price frameworks based on two set covering formulations: a traditional one where columns (variables) represent routes, that is, a sequence of consecutive trips, and a second one in which columns are single trips. One important difficulty related to the latter is the way mutual temporal exclusion of trips can be handled. It raises the issue of time discretization when solving the pricing problem. Our dynamic programming algorithm is based on concept of groups of labels and representative labels. We provide computational results on modified small-sized instances (25 customers) from Solomon’s benchmarks in order to evaluate and compare the two methods. Results show that some difficult instances are out of reach for the first branch-and-price implementation, while they are consistently solved with the second.
               
            

@&#INTRODUCTION@&#

The Multi-Trip Vehicle Routing Problem with Time Windows (MTVRPTW) is a variant of the classical Vehicle Routing Problem with Time Windows (VRPTW) where multiple trips are allowed for vehicles within the planning time horizon. Multiple trips are beneficial to the carrier by limiting the number of vehicles and drivers necessary to the deliveries, especially in the cases where vehicle capacities, distances or time constraints naturally imply short routes.

Formally, the MTVRPTW is defined as follows. Let [0, T] be the planning time horizon. Let 
                           
                              G
                              =
                              (
                              V
                              ,
                              A
                              )
                           
                         be a directed graph where 
                           
                              V
                              =
                              {
                              0
                              ,
                              …
                              ,
                              n
                              }
                           
                         is the set of vertices and A is the set of arcs. Vertex 0 represents the depot and vertices 
                           
                              1
                              ,
                              …
                              ,
                              n
                           
                         the customers. A cost cij
                         and a travel time tij
                         are associated with each arc (i, j) ∈ A. Triangle inequality is assumed for times and costs. The fleet comprises U identical vehicles, with load capacity Q. For each customer 
                           
                              i
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         are defined a demand di
                        , a time window [ai, bi
                        ], a service time sti
                         and a loading time li
                        . Service of customers must start within their time window; however, vehicles may arrive earlier and wait. Service times relate to handling operations at the customers, while loading times concern loading of the vehicles at the depot, before departure.

The problem is to find a set of trips of minimal cost, using at most U vehicles, and such that (i) all customers are served, (ii) two trips cannot be assigned to the same vehicle if the schedules of these trips, including loading and return to the depot, overlap, (iii) loads comply with vehicle capacities and (iv) time constraints at customers and the depot are met.

In this paper, we propose to address the MTVRPTW with two set covering formulations and branch-and-price solution schemes. As far as we know, these are the first attempts to solve this problem exactly. Branch-and-price is a variant of branch-and-bound where LP-based lower bounds are computed through column generation, because of the huge number of variables. In column generation, two problems, called the restricted master problem and the pricing problem, are solved iteratively until the pricing problem fails to find new potentially improving columns for the restricted master problem. The interested reader is referred to Desrochers, Desrosiers, and Solomon (1992), Barnhart, Johnson, Nemhauser, Savelsbergh, and Vance (1996) or Feillet (2010) for details on column generation and branch-and-price.

@&#LITERATURE REVIEW@&#

There are few published papers about multi-trip vehicle routing problems. According to Battarra, Monaci, and Vigo (2009), Fleischmann (1990) is the first to consider the multi-trip feature in a vehicle routing problem. The author proposes a two-phase heuristic based on a savings algorithm to construct the trips and a bin packing heuristic to combine them and form routes. Following this line, most of the works published on multi-trip vehicle routing problems investigate heuristic or metaheuristic approaches. A few recent exceptions however exist that address exact methods. In Sen and Bülbül (2008), an extensive survey on heuristic and metaheuristic approaches can be found. In the rest of this section we survey exact methods.


                        Mingozzi, Roberti, and Toth (2013) propose an exact method based on column generation to solve the Multi-Trip Vehicle Routing Problem (without time-windows). It extends previous works from the same authors on different variants of vehicle routing problems. It combines two set partitioning formulations that are successively used to compute the best possible lower bound. In the first formulation, columns are trips, in the second columns are complete vehicle routes. Note that for the former, a single constraint per vehicle is sufficient to ensure that the time horizon is respected, and that for the latter new routes are obtained by combining trips previously computed. This work seems difficult to extend for the solution of the MTVRPTW, because of the time windows that complicate the packing of trips when forming vehicle routes. In our opinion, the difficulty of this packing actually increases a lot the difficulty of the problem.

In Ceselli, Righini, and Salani (2009), a column generation algorithm is used to solve a rich vehicle routing problem in which multi-trip routes are allowed. In this scheme, columns are vehicle routes, formed by sequences of consecutive trips. The pricing problem is solved with a bidirectional dynamic programming algorithm. The authors acknowledge two important limitations of their approach. First, they approximate the loading time at the depot by assuming that it is constant. Second, the proposed column generation scheme is not embedded in a branch-and-price algorithm. Instead, a general purpose ILP solver is run with the set of generated columns to find an integer solution. As indicated by the authors, the obtained solution is not proved optimal with this method.

Recently, three papers addressed the solution of the MTVRPTW when the duration of trips is constrained (Azi, Gendreau, & Potvin, 2010; Hernandez, Feillet, Giroudeau, & Naud, 2014; Macedo, Alves, de Carvalho, Clautiaux, & Hanafi, 2011). This problem is named MTVRPTW with Limited Duration (MTVRPTW-LD). Several variants are considered, where the visit of customers is compulsory or not. All these papers proceed in two phases. The first phase consists in listing all the candidate trips. The second phase aims at constructing the vehicle routes. While these approaches could theoretically be applied for the solution of the MTVRPTW, by defining a large duration limit for the trips, they strongly rely on the fact that enumerating all the trips is possible. Hence, they cannot be applied for the MTVRPTW in practice, except on very small instances. However, they constitute a first attempt for the exact solution of the MTVRPTW and deserve to be presented in more details.

In all three papers, the first phase is addressed with the same method, initially proposed in Azi, Gendreau, and Potvin (2007) for a single-vehicle version of the problem. This method, based on dynamic programming, generates all non-dominated trips. The three papers differ in the second phase.

In Azi et al. (2010), the second phase starts with the construction of an auxiliary graph. A vertex and a time window are introduced for each trip. Arcs represent possible successions of trips. Thanks to the limited duration of trips, the size of the graph does not explode. Phase 2 can then be tackled as a variant of the VRPTW: each vehicle visits a feasible sequence of vertices in the auxiliary graph, which represents a sequence of trips in the original setting. Note that contrary to the VRPTW, all vertices need not to be covered. This problem is solved with a branch-and-price method.

In Macedo et al. (2011), the second phase relies on a time-indexed graph. The nodes of this graph correspond to discrete time instants. A time instant is an abstraction on a discrete time scale of a certain continuous time duration. This duration is called granularity. The arcs of this graph are of two types. The first arc type models the waiting time by one vehicle at the depot between two successive trips. The second arc type models the elapsed time during a given trip, which starts at a specific time instant and ends at another. A solution is then obtained by solving a flow problem on this graph. Several enhancements are proposed to limit the size of the graph and accelerate the algorithm.

In Hernandez et al. (2014), the second phase implements a branch-and-price algorithm. A set covering formulation is proposed where each column represents a single trip with a fixed schedule. In this formulation, vehicle routes are not explicitly computed; instead, a set of constraints ensures that the number of vehicles used at each time instant is compatible with the fleet size. The pricing problem simply consists in finding a convenient starting date to trips and has a pseudo-polynomial complexity. Again, time granularity is an issue in this approach.

Computationally, Macedo et al. (2011) and Hernandez et al. (2014) obtain comparable results and significantly improve upon Azi et al. (2010). However, the method proposed in Hernandez et al. (2014) clearly outperforms the one describe in Macedo et al. (2011) when the number of trips generated in the first phase increases.

This article is devoted to the exact solution of the MTVRPTW with the following assumptions: it is mandatory to visit all customers, loading time depends on quantities delivered, and there is no a priori limitation on trip duration. As seen in Section 1.2, it constitutes the first study devoted to the exact solution of this problem. We propose two very different set covering formulations and branch-and-price solution approaches.

In the first formulation, following Ceselli et al. (2009), columns are vehicle routes, that is, sequences of consecutive trips. However, contrary to Ceselli et al. (2009) we develop the complete branch-and-price scheme and take into account actual loading times. With this formulation we are faced with the inconvenient that the combinatorics resulting from the succession of trips is not broken.

To circumvent this difficulty, variables of the second formulation are single trips instead of vehicle routes. This formulation follows the one previously proposed in Hernandez et al. (2014) and surveyed above. However, contrary to Hernandez et al. (2014), trips cannot be generated in advance and the pricing problem simultaneously manage the construction and the timing of the trips.

With this second formulation, the challenge is to design an efficient dynamic programming algorithm for the pricing problem. More precisely, the trip reduced cost depends on their timing, which prevents from applying traditional procedures. We propose several original concepts (groups of labels, representative label) that help dealing with this difficulty. Note that Liberatore, Righini, and Salani (2011) and Dabia, Ropke, Woensel, and De Kok (2013) face similar difficulties and investigate different solutions for the vehicle routing problem with soft time windows and the time-dependent vehicle routing problem, respectively.

The paper is organized as follows. In Section 2, we present our first set covering formulation and detail the corresponding branch-and-price algorithm. Section 3 introduces the second formulation and sketches the algorithm. Further details regarding the pricing problem are given in Section 4. Section 5 describes two additional accelerating methods. Computational results are provided in Section 6: the two methods are evaluated on a set of benchmark instances and the benefits of the second formulation are analyzed. Section 7 concludes the paper.

Hereafter, we call SSP formulation the first formulation (SSP stands for Scheduling in SubProblem) and SMP formulation the second (SMP stands for Scheduling in Master Problem).

In this section, we present our first set covering model, where variables represent vehicle routes. We introduce Ω the set of feasible vehicle routes, that is, routes composed of one or several consecutive trips, and such that time and capacity constraints are satisfied. As often when applying column generation to vehicle routing problems all the problem-specific features are moved to the pricing problem. In particular, routes returned by the pricing problem may be composed of several consecutive trips. As a consequence, the Master Problem takes the very standard following form:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                (
                                                Ω
                                                )
                                             
                                             =
                                             m
                                             i
                                             n
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                c
                                                k
                                             
                                             
                                                θ
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        subject to

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   k
                                                
                                             
                                             
                                                θ
                                                k
                                             
                                             ≥
                                             1
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             V
                                             ∖
                                             {
                                             0
                                             }
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                θ
                                                k
                                             
                                             ≤
                                             U
                                             ,
                                          
                                       
                                       
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             Ω
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                                k
                                             
                                             
                                             i
                                             n
                                             t
                                             e
                                             g
                                             e
                                             r
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             Ω
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where aik
                         indicates whether customer i is visited by route k or not, and θk
                         are decision variables. Constraints (2) require that every customer be visited at least once. Constraints (3) require that at most U vehicles be used.

The linear relaxation of (1)–(5) is computed by column generation. The pricing problem is detailed below. In order to get an integer solution, we use a classical branching scheme on arcs, applying again column generation at each node (see, e.g., Feillet (2010)).

The pricing problem consists in finding vehicle routes with a negative reduced cost 
                           
                              
                                 c
                                 k
                              
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    V
                                    ∖
                                    {
                                    0
                                    }
                                 
                              
                              
                                 a
                                 
                                    i
                                    k
                                 
                              
                              
                                 λ
                                 i
                              
                              +
                              ψ
                           
                         where λi
                         and ψ are dual variables corresponding to primal constraints (2) and (3), respectively.

This pricing problem can be addressed as an Elementary Shortest Path Problem with Resource Constraints (ESPPRC) and is 
                           NP
                        -hard in the strong sense (Dror, 1994). In a very standard fashion (Feillet, Dejax, Gendreau, & Gueguen, 2004), the role of resources is to handle capacity, time window and elementary path constraints. The graph on which the ESPPRC is solved and resource extension rules are defined such that feasible paths exactly match vehicle routes.

The ESPPRC can be solved by dynamic programming, where labels represent feasible partial paths. In a standard implementation, at each step of the algorithm, a vertex is selected and all its not-yet-processed labels are extended toward every possible successor vertex. Unfeasible labels, with respect to resource constraints, are rejected. Vertices of the graph are iteratively processed until no new labels are created. For the sake of efficiency, dominance rules need to be introduced to eliminate non-optimal labels (following Bellman’s principle).

A first important issue here concerns loading at the depot. As loading occurs at the beginning of the trips, extending one label to a further vertex delays the time of service for all vertices already present in the label, which requires a specific resource and makes dynamic programming complex. We chose instead to proceed to backward extension of labels, that is, from the moment a path returns to the depot to the moment the loading starts. Extension of a label then corresponds to pushing a new customer in front of the sequence of deliveries.

A second important issue is the possibility to come back to the depot at an intermediate step of the route. The graph and resource extension rules are adapted accordingly.

Details on the dynamic programming algorithm are given in the next subsection.

Let us introduce graph 
                           
                              
                                 G
                                 ′
                              
                              =
                              
                                 (
                                 
                                    V
                                    ′
                                 
                                 ,
                                 
                                    A
                                    ′
                                 
                                 )
                              
                              ,
                           
                         where 
                           
                              
                                 V
                                 ′
                              
                              =
                              V
                              ∪
                              
                                 {
                                 o
                                 ,
                                 d
                                 }
                              
                           
                         is the set of vertices and A′ the set of arcs. Vertices o and d are duplicates of the depot 0 that represent the origin and destination of paths, respectively. A′ is composed of three subsets of arcs: arcs (o, j), ∀j ∈ V; arcs (i, d), ∀i ∈ V; and arcs (i, j), ∀i, j ∈ V with (i, j) ∈ A. Note that vertices o and d serve as origin and destination of the paths and that vertex 0 will be traversed when the vehicle comes back to the depot between two trips. Labels are defined as follows.

                           Definition 2.1
                           A partial path from a vertex j ∈ V′ to the destination depot d is represented with a label of dimension 
                                 
                                    n
                                    +
                                    5
                                    ,
                                 
                              
                              
                                 
                                    
                                       L
                                       k
                                    
                                    
                                       =
                                       {
                                    
                                    
                                       c
                                       k
                                       ′
                                    
                                    ,
                                    p
                                    o
                                    
                                       s
                                       k
                                    
                                    ,
                                    
                                       h
                                       k
                                    
                                    ,
                                    
                                       q
                                       k
                                    
                                    ,
                                    c
                                    
                                       h
                                       k
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       V
                                       k
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       V
                                       k
                                       n
                                    
                                    
                                       }
                                       ,
                                    
                                 
                               where:

                                 
                                    •
                                    
                                       
                                          
                                             c
                                             k
                                             ′
                                          
                                        is the reduced cost of the partial path, including travel costs between j and d, and dual variables associated with customers present in the path;


                                       
                                          
                                             p
                                             o
                                             
                                                s
                                                k
                                             
                                             =
                                             j
                                          
                                        is the vertex from where the partial path starts (current “first client to visit”);


                                       hk
                                        is the starting time of service at j (not considering loading time and assuming that the path finishes at vertex d at time T); when posk
                                        ∈ {0, o}, hk
                                        is the starting time of the loading of the vehicle;


                                       chk
                                        represents the loading time required for the deliveries planned in the subpath between j and the next return to the depot (0 or d);


                                       qk
                                        is the total load induced by planned deliveries until the next return to the depot (0 or d);


                                       Vk
                                        (1 ≤ i ≤ n) is a binary vector, such that 
                                          
                                             
                                                V
                                                k
                                                i
                                             
                                             =
                                             1
                                          
                                        if node i is unreachable, 
                                          
                                             
                                                V
                                                k
                                                i
                                             
                                             =
                                             0
                                          
                                        otherwise. A vertex i is said unreachable if it has already been visited or if, because of time constraints, Lk
                                        cannot be extended to i. The capacity constraint is not considered here as the vehicle has the possibility to go back to the depot.

The dynamic programming algorithm is initialized with a unique label defined as follows: 
                           
                              
                                 c
                                 ′
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              p
                              o
                              s
                              =
                              d
                              ,
                           
                        
                        
                           
                              h
                              =
                              T
                              ,
                           
                        
                        
                           
                              q
                              =
                              0
                              ,
                           
                        
                        
                           
                              c
                              h
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 V
                                 1
                              
                              =
                              0
                              ,
                              …
                              ,
                              
                                 V
                                 n
                              
                              =
                              0
                           
                        . This label corresponds to an empty partial path ending as late as possible at the destination depot d. We now detail the resource extension and the dominance rules.


                        Resource extension rules:
                     

Let 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         be the label obtained by extending a label Lk
                         associated with vertex i ∈ V ∪ {d} (
                           
                              p
                              o
                              
                                 s
                                 k
                              
                              =
                              i
                           
                        ) to one if its predecessors j ∈ V ∪ {o}. We distinguish two cases: j is a customer (
                           
                              j
                              ∈
                              {
                              1
                              ,
                              ⋯
                              ,
                              n
                              }
                           
                        ) or j is the depot ( j ∈ {0, o}).

In the first case, label 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is constructed as follows (case 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              ⋯
                              ,
                              n
                              }
                           
                        ):

                           
                              •
                              
                                 
                                    
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                       =
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       
                                          c
                                          
                                             j
                                             i
                                          
                                       
                                       −
                                       
                                          λ
                                          j
                                       
                                    
                                  (reduced cost);


                                 
                                    
                                       p
                                       o
                                       
                                          s
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       j
                                    
                                 ;


                                 
                                    
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       min
                                       
                                          (
                                          
                                             h
                                             k
                                          
                                          −
                                          
                                             t
                                             
                                                j
                                                i
                                             
                                          
                                          −
                                          s
                                          
                                             t
                                             j
                                          
                                          ,
                                          
                                             b
                                             j
                                          
                                          )
                                       
                                    
                                  (starting time of service at j);


                                 
                                    
                                       c
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       c
                                       
                                          h
                                          k
                                       
                                       +
                                       
                                          l
                                          j
                                       
                                    
                                  (time required for loading goods corresponding to customers included in the trip);


                                 
                                    
                                       
                                          q
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          q
                                          k
                                       
                                       +
                                       
                                          d
                                          j
                                       
                                    
                                  (total load in the trip);


                                 
                                    
                                       
                                          V
                                          
                                             k
                                             ′
                                          
                                          j
                                       
                                       =
                                       1
                                    
                                  and reachability of customers is checked.

In the other case, label 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is constructed as follows (case j ∈ {0, o}):

                           
                              •
                              
                                 
                                    
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                       =
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       
                                          c
                                          
                                             j
                                             i
                                          
                                       
                                    
                                  if 
                                    
                                       j
                                       =
                                       0
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                       =
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       
                                          c
                                          
                                             j
                                             i
                                          
                                       
                                       +
                                       ψ
                                    
                                  if 
                                    
                                       j
                                       =
                                       o
                                    
                                  (reduced cost);


                                 
                                    
                                       p
                                       o
                                       
                                          s
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       j
                                    
                                 ;


                                 
                                    
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          h
                                          k
                                       
                                       −
                                       
                                          t
                                          
                                             j
                                             i
                                          
                                       
                                       −
                                       c
                                       
                                          h
                                          k
                                       
                                    
                                  (starting time of loading at j);


                                 
                                    
                                       c
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       0
                                    
                                  (time required for loading goods corresponding to customers included in the trip);


                                 
                                    
                                       
                                          q
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       0
                                    
                                  (total load in the trip);


                                 
                                    
                                       V
                                       
                                          k
                                          ′
                                       
                                       j
                                    
                                  is not defined, reachability of customers is checked.

In both cases, feasibility of label 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is evaluated with regards to resource constraints. Unfeasible labels are discarded.


                        Dominance rule:
                     

Considering two labels Lk
                         and 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         associated with the same vertex (
                           
                              p
                              o
                              
                                 s
                                 k
                              
                              =
                              p
                              o
                              
                                 s
                                 
                                    k
                                    ′
                                 
                              
                           
                        ), Lk
                         dominates 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         when the following conditions hold:

                           
                              •
                              
                                 
                                    
                                       
                                          c
                                          k
                                          ′
                                       
                                       ≤
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                    
                                 ;


                                 
                                    
                                       p
                                       o
                                       
                                          s
                                          k
                                       
                                       =
                                       p
                                       o
                                       
                                          s
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          h
                                          k
                                       
                                       ≥
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       ,
                                    
                                  time attainability of customers;


                                 
                                    
                                       
                                          h
                                          k
                                       
                                       −
                                       c
                                       
                                          h
                                          k
                                       
                                       ≥
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       −
                                       c
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       ,
                                    
                                  time attainability of the depot;


                                 
                                    
                                       
                                          q
                                          k
                                       
                                       ≤
                                       
                                          q
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          V
                                          k
                                          i
                                       
                                       ≤
                                       
                                          V
                                          
                                             k
                                             ′
                                          
                                          i
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       …
                                       n
                                    
                                 .

We do not give in this section any formal proof that the algorithm provides the route of minimal reduced cost. It can easily be derived from the proof given for the second branch-and-price algorithm, that involves more complex mechanisms (see next sections).

In this section, we present our second formulation, where variables are trips instead of complete vehicle routes. Before presenting the formulation, we have to make clear the definition of trips. Indeed, at least two interpretations are possible, depending on whether the timing of the travel is part of the definition of the trip (two identical travels at different times form two different trips) or not. In what follows we adopt the first of these two points of view. It is formalized with Definition 3.1. Furthermore we consider that a trip is optimal in a sense that will be clarified with the definition.

                           Definition 3.1
                           A trip k is composed of an ordered list of customers, a starting time 
                                 
                                    d
                                    k
                                    
                                       s
                                       t
                                       a
                                       r
                                       t
                                    
                                 
                               and a duration 
                                 
                                    d
                                    k
                                    
                                       m
                                       i
                                       n
                                    
                                 
                               such that:

                                 
                                    •
                                    the demand of the list of customers satisfies the vehicle capacity constraint,

the vehicle can start being loaded at time 
                                          
                                             
                                                d
                                                k
                                                
                                                   s
                                                   t
                                                   a
                                                   r
                                                   t
                                                
                                             
                                             ,
                                          
                                        serve the customers in the order of the list and return to the depot, satisfying time constraints and with a total duration 
                                          
                                             
                                                d
                                                k
                                                
                                                   m
                                                   i
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                    

no other starting time would allow to do the same with a shorter duration.

This last condition should be understood as follows. Given a list of vertices and a starting date, at most one trip exists: the one that finishes the earliest (no reason to wait more than needed). Also, this trip only exists if it is not possible to delay its departure time and finish at the same date (no reason to start before than needed). The cost of a trip is denoted ck
                        . The set of trips is denoted Ω. From this definition, optimal solutions of the MTVRPTW can be obtained by combining trips.

The MTVRPTW can thus be modeled as a set covering problem with mutual exclusion constraints, where variables represent trips, and the set to cover is the set of customer deliveries. Mutual exclusion constraints aim to enable the assignment of selected trips to U vehicles, while avoiding overlap of two trips assigned to the same vehicle.

We propose to model these constraints by stipulating that at most U vehicles are used at any time. One solution to achieve this is to discretize time and to define a boolean indicator utk
                         that would state if trip k includes instant t in its schedule. A time instant t represents a continuous time interval of unitary duration, which is defined according to the time precision of the instance. At each t, the sum ∑
                           k∈Ω
                        
                        utkθk
                         should then not be greater than the number of available vehicles.

The set covering problem can be written:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                (
                                                Ω
                                                )
                                             
                                             =
                                             m
                                             i
                                             n
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                c
                                                k
                                             
                                             
                                                θ
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        subject to

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   k
                                                
                                             
                                             
                                                θ
                                                k
                                             
                                             ≥
                                             1
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             V
                                             ∖
                                             {
                                             0
                                             }
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                u
                                                
                                                   t
                                                   k
                                                
                                             
                                             
                                                θ
                                                k
                                             
                                             ≤
                                             U
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                …
                                                ,
                                                T
                                                *
                                                
                                                   10
                                                   τ
                                                
                                                }
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             Ω
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                                k
                                             
                                             
                                             i
                                             n
                                             t
                                             e
                                             g
                                             e
                                             r
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             Ω
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where aik
                         indicates whether customer i is visited by trip k or not, τ is the number of decimal places that define the instance precision and θk
                         are decision variables. Constraints (7) require that every customer be visited at least once. Constraints (8) require that at most U vehicles be used at any time instant.

The linear relaxation (6)–(9) of the set covering formulation (6)–(10) is computed by column generation. Contrary to Hernandez et al. (2014), where the same model is solved in a highly constrained setting, this implies solving a complex pricing problem (in Hernandez et al. (2014) the set of feasible sequences of visits – list of vertices in the trip definition – is known and finding trips of negative reduced cost simply consists in finding a convenient timing).

In order to get an integer solution, column generation is embedded in branch-and-price. Again, the way to proceed is non-standard. The difficulty stems from the fact that different trips can share the same list of vertices (with a different timing). As a consequence, it may happen that a fractional solution is supported by an integer flow, which prevent from branching on flow variables. To circumvent this difficulty a repair procedure was proposed in Hernandez et al. (2014). We apply the same procedure. The reader is referred to Hernandez et al. (2014) for details.

The next subsection gives a general description of the pricing problem. Technical details are presented in length in Section 4.

The pricing problem consists in finding trips with a negative reduced cost 
                           
                              
                                 c
                                 k
                              
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    V
                                    ∖
                                    {
                                    0
                                    }
                                 
                              
                              
                                 a
                                 
                                    i
                                    k
                                 
                              
                              
                                 λ
                                 i
                              
                              +
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    T
                                    *
                                    
                                       10
                                       τ
                                    
                                    }
                                 
                              
                              
                                 u
                                 
                                    t
                                    k
                                 
                              
                              
                                 ψ
                                 t
                              
                           
                         where λi
                         and ψt
                         are dual variables corresponding to primal constraints (7) and (8), respectively. This subproblem can be addressed as an ESPPRC, that can be solved by dynamic programming.

An important issue to deal with is that the solution space explored in the pricing problem corresponds to trips. Indeed, because of dual variables ψt
                        , different starting times for an ordered sequence of customers possibly result in different reduced costs. In order to dodge this combinatorial issue, we introduced the notion of groups of labels and of a single representative label for each group. In Section 4, we show that this policy can be carried out without loss of optimality.

Like in the method developed for the SSP formulation (Section 2.2), a second important issue concerns loading at the depot. We also proceed to backward extension of labels in this case.

In this section, we detail the dynamic programming algorithm developed for the solution of the pricing problem. We introduce the idea of groups of labels in order to diminish the number of labels managed by the ESPPRC algorithm and to accelerate the extension step. Beforehand, we define useful notation and describe the ESPPRC to be solved. The following subsections detail the extension step and give validity proof of the specific dominance rule that makes it more efficient. In order to feed the restricted master problem with the labels that have most promising costs, a simple post-treatment is applied, which is given at the end of this section.

We introduce graph 
                           
                              
                                 G
                                 ′
                              
                              =
                              
                                 (
                                 
                                    V
                                    ′
                                 
                                 ,
                                 
                                    A
                                    ′
                                 
                                 )
                              
                              ,
                           
                         where 
                           
                              
                                 V
                                 ′
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                              ∪
                              
                                 {
                                 o
                                 ,
                                 d
                                 }
                              
                           
                         is the set of vertices and A′ the set of arcs. Vertices o and d are duplicates of the depot 0 that represent the origin and destination of paths, respectively. A′ is composed of three subsets of arcs: arcs (o, j), 
                           
                              ∀
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                        ; arcs (i, d), 
                           
                              ∀
                              i
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                        ; and arcs (i, j), 
                           
                              ∀
                              i
                              ,
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         with (i, j) ∈ A.

Labels and resource constraints are defined as follows.

                           Definition 4.1
                           A partial path from a vertex j ∈ V′ to the destination depot d is represented with a label of dimension 
                                 
                                    n
                                    +
                                    7
                                    ,
                                 
                              
                              
                                 
                                    
                                       L
                                       k
                                    
                                    
                                       =
                                       {
                                    
                                    
                                       c
                                       k
                                       ′
                                    
                                    ,
                                    p
                                    o
                                    
                                       s
                                       k
                                    
                                    ,
                                    
                                       h
                                       k
                                    
                                    ,
                                    
                                       q
                                       k
                                    
                                    ,
                                    
                                       d
                                       k
                                    
                                    ,
                                    c
                                    
                                       h
                                       k
                                    
                                    ,
                                    r
                                    
                                       t
                                       k
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       V
                                       k
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       V
                                       k
                                       n
                                    
                                    
                                       }
                                       ,
                                    
                                 
                               where:

                                 
                                    •
                                    
                                       
                                          
                                             c
                                             k
                                             ′
                                          
                                        is the reduced cost of the partial path, including travel costs between j and d, and dual variables associated with customers present in the path and time intervals occurring between the starting time of the label 
                                          
                                             
                                                h
                                                k
                                             
                                             −
                                             c
                                             
                                                h
                                                k
                                             
                                          
                                        and the arrival time dk
                                        (see definitions below);


                                       
                                          
                                             p
                                             o
                                             
                                                s
                                                k
                                             
                                             =
                                             j
                                          
                                        is the vertex from where the partial path starts (current “first client to visit”);


                                       hk
                                        is the starting time of service at j (not considering loading time); when 
                                          
                                             p
                                             o
                                             
                                                s
                                                k
                                             
                                             =
                                             o
                                             ,
                                          
                                        
                                       hk
                                        is the starting time of the vehicle;


                                       dk
                                        is the arrival date to destination d;


                                       chk
                                        represents the loading time required for the deliveries planned in the path;


                                       rtk
                                        is the amount of time that a label can be delayed and still be feasible; this resource allows to relate labels of the same group to each other and perform their extension, as explained in Sections 4.2 and 4.4;


                                       qk
                                        is the total load induced by planned deliveries;


                                       Vk
                                        (1 ≤ i ≤ n) is a binary vector, such that 
                                          
                                             
                                                V
                                                k
                                                i
                                             
                                             =
                                             1
                                          
                                        if node i is unreachable, 
                                          
                                             
                                                V
                                                k
                                                i
                                             
                                             =
                                             0
                                          
                                        otherwise. A vertex i is said unreachable if, because of resource constraints or while it already has been visited, Lk
                                        cannot be extended to i.

Note that the definition of 
                           
                              c
                              k
                              ′
                           
                         includes the contribution of dual variables associated with the time interval required for loading. In the definition, it is considered that loading occurs during time interval 
                           
                              [
                              
                                 h
                                 k
                              
                              −
                              c
                              
                                 h
                                 k
                              
                              ,
                              
                                 h
                                 k
                              
                              ]
                              ,
                           
                         that is just before starting the service of vertex posk
                        . During extension, both hk
                         and chk
                         are updated, and therefore the contribution of the loading time interval to the reduced cost needs also to be updated.

Parameters hk
                         to Vk
                         are considered as resources and are limited with the following constraints: hk
                         ∈ [aj, bj
                        ], dk
                         ∈ [0, T], 
                           
                              
                                 h
                                 k
                              
                              −
                              c
                              
                                 h
                                 k
                              
                              ≥
                              0
                              ,
                           
                         
                        qk
                         ∈ [0, Q], 
                           
                              
                                 V
                                 k
                                 i
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           
                         (1 ≤ i ≤ n). Description of extension rules is postponed to Section 4.4.

For the sake of simplifying further notation, we introduce function 
                           
                              g
                              (
                              
                                 
                                    h
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    h
                                    ¯
                                 
                                 2
                              
                              )
                           
                         evaluating the contribution of mutual exclusion constraints (8) to the reduced cost during time interval 
                           
                              [
                              
                                 
                                    h
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    h
                                    ¯
                                 
                                 2
                              
                              ]
                           
                        .

The function 
                           
                              g
                              (
                              
                                 
                                    h
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    h
                                    ¯
                                 
                                 2
                              
                              )
                           
                         is defined as follows:

                           
                              (11)
                              
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             h
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             h
                                             ¯
                                          
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          t
                                          =
                                          
                                             
                                                h
                                                ¯
                                             
                                             1
                                          
                                          *
                                          
                                             10
                                             τ
                                          
                                       
                                       
                                          t
                                          <
                                          
                                             
                                                h
                                                ¯
                                             
                                             2
                                          
                                          *
                                          
                                             10
                                             τ
                                          
                                       
                                    
                                    
                                       ψ
                                       t
                                    
                                 
                              
                           
                        
                     

Note that the reduced cost 
                           
                              c
                              k
                              ′
                           
                         of a trip represented by a label Lk
                         is then exactly 
                           
                              
                                 c
                                 k
                                 ′
                              
                              =
                              
                                 c
                                 k
                              
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    V
                                    ∖
                                    {
                                    0
                                    }
                                 
                              
                              
                                 a
                                 
                                    i
                                    k
                                 
                              
                              
                                 λ
                                 i
                              
                              +
                              g
                              
                                 (
                                 
                                    h
                                    k
                                 
                                 −
                                 c
                                 
                                    h
                                    k
                                 
                                 ,
                                 
                                    d
                                    k
                                 
                                 )
                              
                           
                        . We finally denote 
                           
                              
                                 
                                    c
                                    ˜
                                 
                                 k
                              
                              =
                              
                                 c
                                 k
                              
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    V
                                    ∖
                                    {
                                    0
                                    }
                                 
                              
                              
                                 a
                                 
                                    i
                                    k
                                 
                              
                              
                                 λ
                                 i
                              
                           
                         the part of the reduced cost that does not depend upon the time schedule: 
                           
                              
                                 c
                                 k
                                 ′
                              
                              =
                              
                                 
                                    c
                                    ˜
                                 
                                 k
                              
                              +
                              g
                              
                                 (
                                 
                                    h
                                    k
                                 
                                 −
                                 c
                                 
                                    h
                                    k
                                 
                                 ,
                                 
                                    d
                                    k
                                 
                                 )
                              
                           
                        .

This subsection is devoted to the definition of groups of labels and representative labels. These concepts will be used to reduce the number of labels in the dynamic programming.

                           Definition 4.2
                           A group of labels is a set of labels that represent the same partial path.

A direct consequence is that two labels L
                        1 and L
                        2 in a same group satisfy 
                           
                              
                                 
                                    c
                                    ˜
                                 
                                 1
                              
                              =
                              
                                 
                                    c
                                    ˜
                                 
                                 2
                              
                           
                        .

The following property aims at limiting groups of labels to a single representative label.

                           Property 4.1
                           Let L
                              1, L
                              2 and L
                              3 be three labels with:

                                 
                                    •
                                    
                                       
                                          
                                             p
                                             o
                                             
                                                s
                                                1
                                             
                                             =
                                             p
                                             o
                                             
                                                s
                                                2
                                             
                                             =
                                             p
                                             o
                                             
                                                s
                                                3
                                             
                                          
                                        (labels positioned at the same vertex),


                                       
                                          
                                             
                                                h
                                                1
                                             
                                             −
                                             c
                                             
                                                h
                                                1
                                             
                                             ≥
                                             
                                                h
                                                2
                                             
                                             −
                                             c
                                             
                                                h
                                                2
                                             
                                             ≥
                                             
                                                h
                                                3
                                             
                                             −
                                             c
                                             
                                                h
                                                3
                                             
                                          
                                        (decreasing order of starting times of labels);


                                       L
                                       2 and L
                                       3 in the same group with d
                                       2 ≥ d
                                       3 (decreasing order of arrival dates to destination).

The following property holds:

                                 
                                    (12)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                      1
                                                      ′
                                                   
                                                   +
                                                   g
                                                   
                                                      (
                                                      
                                                         h
                                                         3
                                                      
                                                      −
                                                      c
                                                      
                                                         h
                                                         3
                                                      
                                                      ,
                                                      
                                                         h
                                                         1
                                                      
                                                      −
                                                      c
                                                      
                                                         h
                                                         1
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      c
                                                      3
                                                      ′
                                                   
                                                   ⇒
                                                   
                                                      c
                                                      1
                                                      ′
                                                   
                                                   +
                                                   g
                                                   
                                                      (
                                                      
                                                         h
                                                         2
                                                      
                                                      −
                                                      c
                                                      
                                                         h
                                                         2
                                                      
                                                      ,
                                                      
                                                         h
                                                         1
                                                      
                                                      −
                                                      c
                                                      
                                                         h
                                                         1
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      c
                                                      2
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Fig. 1
                         illustrates this property. In this figure, we consider three labels that visit two customers 3 and 4 where line length, rectangle length and length of dotted rectangles represent respectively the travel time, the customer service time and the loading time at the depot. The positive dual values associated with constraints (8) are represented by the red squares with 
                           
                              
                                 ψ
                                 10
                              
                              =
                              
                                 ψ
                                 11
                              
                              =
                              
                                 ψ
                                 12
                              
                              =
                              
                                 ψ
                                 13
                              
                              =
                              
                                 ψ
                                 14
                              
                              =
                              1
                           
                        . The three labels L
                        1, L
                        2 and L
                        3 have the following costs: 
                           
                              
                                 c
                                 1
                                 ′
                              
                              =
                              2
                              ,
                           
                        
                        
                           
                              
                                 c
                                 2
                                 ′
                              
                              =
                              7
                           
                         and 
                           
                              
                                 c
                                 3
                                 ′
                              
                              =
                              3
                           
                        . The short dotted arrow marks the duration between 
                           
                              
                                 h
                                 2
                              
                              −
                              c
                              
                                 h
                                 2
                              
                           
                         and 
                           
                              
                                 h
                                 1
                              
                              −
                              c
                              
                                 h
                                 1
                              
                           
                         and the other arrow marks the duration between 
                           
                              
                                 h
                                 3
                              
                              −
                              c
                              
                                 h
                                 3
                              
                           
                         and 
                           
                              
                                 h
                                 1
                              
                              −
                              c
                              
                                 h
                                 1
                              
                           
                        . The values of function g are 
                           
                              g
                              (
                              
                                 h
                                 2
                              
                              −
                              c
                              
                                 h
                                 2
                              
                              ,
                              
                                 h
                                 1
                              
                              −
                              c
                              
                                 h
                                 1
                              
                              )
                              =
                              4
                           
                         and 
                           
                              g
                              (
                              
                                 h
                                 3
                              
                              −
                              c
                              
                                 h
                                 3
                              
                              ,
                              
                                 h
                                 1
                              
                              −
                              c
                              
                                 h
                                 1
                              
                              )
                              =
                              4
                           
                        .

                           Proof
                           The proof relies on some simple remarks. First, as seen above, the 
                                 
                                    
                                       c
                                       ˜
                                    
                                    k
                                 
                               part in reduced costs for labels of the same groups is identical: 
                                 
                                    
                                       
                                          c
                                          ˜
                                       
                                       2
                                    
                                    =
                                    
                                       
                                          c
                                          ˜
                                       
                                       3
                                    
                                 
                              . Second, function g is non negative and has the following characteristic: given h ≤ h′ ≤ h′′, 
                                 
                                    g
                                    
                                       (
                                       h
                                       ,
                                       
                                          h
                                          
                                             ′
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       h
                                       ,
                                       
                                          h
                                          ′
                                       
                                       )
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          ′
                                       
                                       ,
                                       
                                          h
                                          
                                             ′
                                             ′
                                          
                                       
                                       )
                                    
                                 
                               (trivial from the definition of g).

Let us now assume that 
                                 
                                    
                                       c
                                       1
                                       ′
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                       −
                                       c
                                       
                                          h
                                          1
                                       
                                       )
                                    
                                    ≤
                                    
                                       c
                                       3
                                       ′
                                    
                                 
                              . On the one hand, 
                                 
                                    
                                       c
                                       1
                                       ′
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                       −
                                       c
                                       
                                          h
                                          1
                                       
                                       )
                                    
                                    =
                                    
                                       c
                                       1
                                       ′
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          h
                                          2
                                       
                                       −
                                       c
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          2
                                       
                                       −
                                       c
                                       
                                          h
                                          2
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                       −
                                       c
                                       
                                          h
                                          1
                                       
                                       )
                                    
                                 
                              . On the other hand, 
                                 
                                    
                                       c
                                       3
                                       ′
                                    
                                    =
                                    
                                       
                                          c
                                          ˜
                                       
                                       3
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          d
                                          3
                                       
                                       )
                                    
                                    ≤
                                    
                                       
                                          c
                                          ˜
                                       
                                       3
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          d
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          c
                                          ˜
                                       
                                       2
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          h
                                          2
                                       
                                       −
                                       c
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          2
                                       
                                       −
                                       c
                                       
                                          h
                                          2
                                       
                                       ,
                                       
                                          d
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       c
                                       2
                                       ′
                                    
                                    +
                                    g
                                    
                                       (
                                       
                                          h
                                          3
                                       
                                       −
                                       c
                                       
                                          h
                                          3
                                       
                                       ,
                                       
                                          h
                                          2
                                       
                                       −
                                       c
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    ,
                                 
                               which demonstrates the property.□

Thanks to this property, we can now define representative labels.

                           Definition 4.3
                           A label Lk
                               is said representative of a group of labels if it belongs to that group and it has the minimal arrival date dk
                               in the group.

Thanks to Property 4.1 and parameter rtk
                         (delay time) of labels, the dynamic programming recursion can be restricted to representative labels. Parameter rtk
                         concerns feasibility, it permits to delay a representative label to obtain each label in its group. When extension is not feasible for a representative label, according to time constraints, but would have been possible for a label of the same group, extension is applied even so and the label is delayed (see extension rule in Section 4.4). During the application of the dominance relation, when a label dominates a representative label, Property 4.1 assures that all labels of the group are also dominated (see dominance rule in Section 4.5).

Note that the concept of groups of labels is different from the concept of buckets introduced in Desrochers and Soumis (1988). The purpose of buckets for solving the Shortest Path Problem with Time Windows is to guide the order in which labels are extended. The purpose of groups of labels is to avoid extending numerous labels by treating a label that is representative of a group of potential labels.

The dynamic programming algorithm is initialized with a unique label. This label is the representative label of the empty path {d, d} and is defined as follows: 
                           
                              
                                 c
                                 ′
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              p
                              o
                              s
                              =
                              d
                              ,
                           
                        
                        
                           
                              h
                              =
                              0
                              ,
                           
                        
                        
                           
                              q
                              =
                              0
                              ,
                           
                        
                        
                           
                              d
                              =
                              0
                              ,
                           
                        
                        
                           
                              c
                              h
                              =
                              0
                              ,
                           
                        
                        
                           
                              r
                              t
                              =
                              T
                              ,
                           
                        
                        
                           
                              
                                 V
                                 1
                              
                              =
                              0
                              ,
                              …
                              ,
                              
                                 V
                                 n
                              
                              =
                              0
                           
                        .

Let 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         be the label obtained by extending a label Lk
                         associated with vertex i ∈ V′ (
                           
                              p
                              o
                              
                                 s
                                 k
                              
                              =
                              i
                           
                        ) to one predecessor j ∈ V′. We note 
                           
                              h
                              =
                              
                                 h
                                 k
                              
                              −
                              
                                 t
                                 
                                    j
                                    i
                                 
                              
                              −
                              s
                              
                                 t
                                 j
                              
                           
                         the theoretical starting date of service at vertex j and distinguish two cases. Either h ≥ aj
                         and the label will be defined with starting time of service 
                           
                              
                                 h
                                 
                                    k
                                    ′
                                 
                              
                              =
                              min
                              
                                 (
                                 h
                                 ,
                                 
                                    b
                                    j
                                 
                                 )
                              
                           
                         or h < aj
                         and the label will be delayed and start at time 
                           
                              
                                 h
                                 
                                    k
                                    ′
                                 
                              
                              =
                              
                                 a
                                 j
                              
                           
                        .

In the first case, label 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is constructed as follows (case h ≥ aj
                        ):

                           
                              •
                              
                                 
                                    
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                       =
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       
                                          c
                                          
                                             j
                                             i
                                          
                                       
                                       −
                                       
                                          λ
                                          j
                                       
                                       +
                                       g
                                       
                                          (
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          −
                                          c
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          ,
                                          
                                             h
                                             k
                                          
                                          −
                                          c
                                          
                                             h
                                             k
                                          
                                          )
                                       
                                    
                                  (reduced cost);


                                 
                                    
                                       p
                                       o
                                       
                                          s
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       j
                                    
                                 ;


                                 
                                    
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       min
                                       
                                          (
                                          h
                                          ,
                                          
                                             b
                                             j
                                          
                                          )
                                       
                                    
                                  (starting time of service at j);


                                 
                                    
                                       
                                          d
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          d
                                          k
                                       
                                    
                                  (arrival date to destination d);


                                 
                                    
                                       c
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       c
                                       
                                          h
                                          k
                                       
                                       +
                                       
                                          l
                                          j
                                       
                                    
                                  (time required for loading goods corresponding to customers included in the path);


                                 
                                    
                                       r
                                       
                                          t
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       m
                                       i
                                       n
                                       
                                          (
                                          r
                                          
                                             t
                                             k
                                          
                                          ,
                                          
                                             b
                                             j
                                          
                                          −
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                  (allowable delay time);


                                 
                                    
                                       
                                          q
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          q
                                          k
                                       
                                       +
                                       
                                          d
                                          j
                                       
                                    
                                  (total load);


                                 
                                    
                                       
                                          V
                                          
                                             k
                                             ′
                                          
                                          j
                                       
                                       =
                                       1
                                    
                                 ; reachability of customers is checked taking into account delay 
                                    
                                       r
                                       
                                          t
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 .

Parameter rtk
                         is updated taking account of the time constraint added with the extension: 
                           
                              
                                 h
                                 
                                    k
                                    ′
                                 
                              
                              +
                              r
                              
                                 t
                                 
                                    k
                                    ′
                                 
                              
                              ≤
                              
                                 b
                                 j
                              
                           
                        .

In the second case, the maximal delay for label Lk
                         is rtk
                        . If 
                           
                              h
                              +
                              r
                              
                                 t
                                 k
                              
                              <
                              
                                 a
                                 j
                              
                              ,
                           
                         the extension fails. Otherwise, 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is constructed as explained above, apart from the following modifications (case h < aj
                         and 
                           
                              h
                              +
                              r
                              
                                 t
                                 k
                              
                              ≥
                              
                                 a
                                 j
                              
                           
                        ):

                           
                              •
                              
                                 
                                    
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                       =
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       
                                          c
                                          
                                             j
                                             i
                                          
                                       
                                       −
                                       
                                          λ
                                          j
                                       
                                       −
                                       g
                                       
                                          (
                                          
                                             h
                                             k
                                          
                                          −
                                          c
                                          
                                             h
                                             k
                                          
                                          ,
                                          
                                             d
                                             k
                                          
                                          )
                                       
                                       +
                                       g
                                       
                                          (
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          −
                                          c
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          ,
                                          
                                             d
                                             
                                                k
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          a
                                          j
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          d
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       
                                          d
                                          k
                                       
                                       +
                                       
                                          (
                                          
                                             a
                                             j
                                          
                                          −
                                          h
                                          )
                                       
                                    
                                 ;


                                 
                                    
                                       r
                                       
                                          t
                                          
                                             k
                                             ′
                                          
                                       
                                       =
                                       m
                                       i
                                       n
                                       
                                          (
                                          r
                                          
                                             t
                                             k
                                          
                                          −
                                          
                                             (
                                             
                                                a
                                                j
                                             
                                             −
                                             h
                                             )
                                          
                                          ,
                                          
                                             b
                                             j
                                          
                                          −
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 .

In both cases, feasibility of label 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         is evaluated with regard to resource constraints.

Considering two labels Lk
                         and 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         associated with the same vertex (
                           
                              p
                              o
                              
                                 s
                                 k
                              
                              =
                              p
                              o
                              
                                 s
                                 
                                    k
                                    ′
                                 
                              
                           
                        ), Lk
                         dominates 
                           
                              L
                              
                                 k
                                 ′
                              
                           
                         when following conditions hold:

                           
                              •
                              
                                 
                                    
                                       p
                                       o
                                       
                                          s
                                          k
                                       
                                       =
                                       p
                                       o
                                       
                                          s
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          h
                                          k
                                       
                                       ≥
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                       +
                                       r
                                       
                                          t
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       c
                                       
                                          h
                                          k
                                       
                                       ≤
                                       c
                                       
                                          h
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          c
                                          k
                                          ′
                                       
                                       +
                                       g
                                       
                                          (
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          −
                                          c
                                          
                                             h
                                             
                                                k
                                                ′
                                             
                                          
                                          ,
                                          
                                             h
                                             k
                                          
                                          −
                                          c
                                          
                                             h
                                             k
                                          
                                          )
                                       
                                       ≤
                                       
                                          c
                                          
                                             k
                                             ′
                                          
                                          ′
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          q
                                          k
                                       
                                       ≤
                                       
                                          q
                                          
                                             k
                                             ′
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          V
                                          k
                                          i
                                       
                                       ≤
                                       
                                          V
                                          
                                             k
                                             ′
                                          
                                          i
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       …
                                       n
                                    
                                 
                              

Regarding the condition on reduced costs, note that the preceding conditions imply that 
                           
                              
                                 h
                                 
                                    k
                                    ′
                                 
                              
                              −
                              c
                              
                                 h
                                 
                                    k
                                    ′
                                 
                              
                              ≤
                              
                                 h
                                 k
                              
                              −
                              c
                              
                                 h
                                 k
                              
                           
                        . Lemma 4.1 demonstrates the validity and the correctness of the dominance rule: no non-dominated label can be discarded before reaching origin vertex o.

                           Lemma 4.1
                           
                              Suppose a label L
                              1 
                              dominates another label L
                              2 
                              and let L
                              4 
                              be an extension of L
                              2
                              . Then, there exists a label L
                              3 
                              extended from L
                              1 
                              that dominates label L
                              4
                              .
                           

Let us introduce label 
                                 
                                    
                                       L
                                       1
                                    
                                    
                                    =
                                    
                                    
                                       {
                                       
                                          c
                                          1
                                          ′
                                       
                                       ,
                                       p
                                       o
                                       
                                          s
                                          1
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                       ,
                                       
                                          q
                                          1
                                       
                                       ,
                                       
                                          d
                                          1
                                       
                                       ,
                                       c
                                       
                                          h
                                          1
                                       
                                       ,
                                       r
                                       
                                          t
                                          1
                                       
                                       ,
                                       
                                          V
                                          1
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          V
                                          1
                                          n
                                       
                                       }
                                    
                                 
                               that dominates label 
                                 
                                    
                                       L
                                       2
                                    
                                    
                                    =
                                    
                                    
                                       {
                                       
                                          c
                                          2
                                          ′
                                       
                                       ,
                                       p
                                       o
                                       
                                          s
                                          2
                                       
                                       ,
                                       
                                          h
                                          2
                                       
                                       ,
                                       
                                          q
                                          2
                                       
                                       ,
                                       
                                          d
                                          2
                                       
                                       ,
                                       c
                                       
                                          h
                                          2
                                       
                                       ,
                                       r
                                       
                                          t
                                          2
                                       
                                       ,
                                       
                                          V
                                          2
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          V
                                          2
                                          n
                                       
                                       }
                                    
                                 
                              . We will prove here that any (single) extension of label L
                              2 can be reproduced for L
                              1 and that the extension of L
                              1 will dominate the extension of L
                              2. By recursion, it shows the lemma.

From the dominance definition, we have:

                                 
                                    •
                                    
                                       
                                          
                                             p
                                             o
                                             
                                                s
                                                1
                                             
                                             =
                                             p
                                             o
                                             
                                                s
                                                2
                                             
                                          
                                       
                                    


                                       
                                          
                                             
                                                h
                                                1
                                             
                                             ≥
                                             
                                                h
                                                2
                                             
                                             +
                                             r
                                             
                                                t
                                                2
                                             
                                          
                                       
                                    


                                       ch
                                       1 ≤ ch
                                       2
                                    


                                       
                                          
                                             
                                                c
                                                1
                                                ′
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   2
                                                
                                                −
                                                c
                                                
                                                   h
                                                   2
                                                
                                                ,
                                                
                                                   h
                                                   1
                                                
                                                −
                                                c
                                                
                                                   h
                                                   1
                                                
                                                )
                                             
                                             ≤
                                             
                                                c
                                                2
                                                ′
                                             
                                          
                                       
                                    


                                       q
                                       1 ≤ q
                                       2
                                    


                                       
                                          
                                             
                                                V
                                                1
                                                i
                                             
                                             ≤
                                             
                                                V
                                                2
                                                i
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             …
                                             n
                                          
                                       
                                    

Let L
                              4 be an extension of label L
                              2 to a given vertex j ∈ V′. As detailed in Section 4.4, two cases should be considered.

Let us first assume that no delay is needed (case 
                                 
                                    
                                       h
                                       2
                                    
                                    −
                                    
                                       t
                                       
                                          j
                                          p
                                          o
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    −
                                    s
                                    
                                       t
                                       j
                                    
                                    ≥
                                    
                                       a
                                       j
                                    
                                 
                              ). Let then L
                              3 be the extension of L
                              1 to j. Seeing that h
                              1 ≥ h
                              2 and that 
                                 
                                    p
                                    o
                                    
                                       s
                                       1
                                    
                                    =
                                    p
                                    o
                                    
                                       s
                                       2
                                    
                                    ,
                                 
                               it follows that 
                                 
                                    
                                       h
                                       1
                                    
                                    −
                                    
                                       t
                                       
                                          j
                                          p
                                          o
                                          
                                             s
                                             1
                                          
                                       
                                    
                                    −
                                    s
                                    
                                       t
                                       j
                                    
                                    ≥
                                    
                                       a
                                       j
                                    
                                 
                               and no delay is either needed for label L
                              3.

We now demonstrate that every condition required by the dominance rule is satisfied:

                                 
                                    •
                                    
                                       
                                          
                                             p
                                             o
                                             
                                                s
                                                3
                                             
                                             =
                                             p
                                             o
                                             
                                                s
                                                4
                                             
                                             =
                                             j
                                          
                                       ;


                                       
                                          
                                             
                                                h
                                                3
                                             
                                             =
                                             min
                                             
                                                (
                                                
                                                   h
                                                   1
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      
                                                      p
                                                      o
                                                      
                                                         s
                                                         1
                                                      
                                                   
                                                
                                                −
                                                s
                                                
                                                   t
                                                   j
                                                
                                                ,
                                                
                                                   b
                                                   j
                                                
                                                )
                                             
                                             ,
                                          
                                        it follows:

                                          
                                             –
                                             if 
                                                   
                                                      
                                                         h
                                                         3
                                                      
                                                      =
                                                      
                                                         h
                                                         1
                                                      
                                                      −
                                                      
                                                         t
                                                         
                                                            j
                                                            
                                                            p
                                                            o
                                                            
                                                               s
                                                               1
                                                            
                                                         
                                                      
                                                      −
                                                      s
                                                      
                                                         t
                                                         j
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                         3
                                                      
                                                      ≥
                                                      
                                                         h
                                                         2
                                                      
                                                      −
                                                      
                                                         t
                                                         
                                                            j
                                                            
                                                            p
                                                            o
                                                            
                                                               s
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      s
                                                      
                                                         t
                                                         j
                                                      
                                                      +
                                                      r
                                                      
                                                         t
                                                         2
                                                      
                                                      ≥
                                                      min
                                                      
                                                         (
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         
                                                            t
                                                            
                                                               j
                                                               
                                                               p
                                                               o
                                                               
                                                                  s
                                                                  2
                                                               
                                                            
                                                         
                                                         −
                                                         s
                                                         
                                                            t
                                                            j
                                                         
                                                         ,
                                                         
                                                            b
                                                            j
                                                         
                                                         )
                                                      
                                                      +
                                                      r
                                                      
                                                         t
                                                         2
                                                      
                                                      ≥
                                                      
                                                         h
                                                         4
                                                      
                                                      +
                                                      r
                                                      
                                                         t
                                                         4
                                                      
                                                   
                                                 (noting that rt
                                                4 ≤ rt
                                                2);

if 
                                                   
                                                      
                                                         h
                                                         3
                                                      
                                                      =
                                                      
                                                         b
                                                         j
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      r
                                                      
                                                         t
                                                         4
                                                      
                                                      ≤
                                                      
                                                         b
                                                         j
                                                      
                                                      −
                                                      
                                                         h
                                                         4
                                                      
                                                      =
                                                      
                                                         h
                                                         3
                                                      
                                                      −
                                                      
                                                         h
                                                         4
                                                      
                                                   
                                                ; so, again, 
                                                   
                                                      
                                                         h
                                                         3
                                                      
                                                      ≥
                                                      
                                                         h
                                                         4
                                                      
                                                      +
                                                      r
                                                      
                                                         t
                                                         4
                                                      
                                                   
                                                ;


                                       
                                          
                                             c
                                             
                                                h
                                                3
                                             
                                             =
                                             c
                                             
                                                h
                                                1
                                             
                                             +
                                             
                                                l
                                                j
                                             
                                             ≤
                                             c
                                             
                                                h
                                                2
                                             
                                             +
                                             
                                                l
                                                j
                                             
                                             =
                                             c
                                             
                                                h
                                                4
                                             
                                          
                                       ;

we have 
                                          
                                             
                                                c
                                                3
                                                ′
                                             
                                             =
                                             
                                                c
                                                1
                                                ′
                                             
                                             +
                                             
                                                c
                                                
                                                   j
                                                   
                                                   p
                                                   o
                                                   
                                                      s
                                                      1
                                                   
                                                
                                             
                                             −
                                             
                                                λ
                                                j
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   3
                                                
                                                −
                                                c
                                                
                                                   h
                                                   3
                                                
                                                ,
                                                
                                                   h
                                                   1
                                                
                                                −
                                                c
                                                
                                                   h
                                                   1
                                                
                                                )
                                             
                                          
                                        and 
                                          
                                             
                                                c
                                                4
                                                ′
                                             
                                             =
                                             
                                                c
                                                2
                                                ′
                                             
                                             +
                                             
                                                c
                                                
                                                   j
                                                   
                                                   p
                                                   o
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             −
                                             
                                                λ
                                                j
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   4
                                                
                                                −
                                                c
                                                
                                                   h
                                                   4
                                                
                                                ,
                                                
                                                   h
                                                   2
                                                
                                                −
                                                c
                                                
                                                   h
                                                   2
                                                
                                                )
                                             
                                          
                                       ;

                                          
                                             –
                                             then 
                                                   
                                                      
                                                         c
                                                         1
                                                         ′
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      ≤
                                                      
                                                         c
                                                         2
                                                         ′
                                                      
                                                   
                                                 writes equivalently 
                                                   
                                                      
                                                         c
                                                         3
                                                         ′
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            j
                                                            
                                                            p
                                                            o
                                                            
                                                               s
                                                               1
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         j
                                                      
                                                      −
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      ≤
                                                      
                                                         c
                                                         4
                                                         ′
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            j
                                                            
                                                            p
                                                            o
                                                            
                                                               s
                                                               2
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         j
                                                      
                                                      −
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         )
                                                      
                                                   
                                                ;

that is, 
                                                   
                                                      
                                                         c
                                                         3
                                                         ′
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         )
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      −
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      ≤
                                                      
                                                         c
                                                         4
                                                         ′
                                                      
                                                   
                                                ;

seeing that 
                                                   
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         )
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            2
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            2
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      −
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      =
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      −
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         ,
                                                         
                                                            h
                                                            1
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            1
                                                         
                                                         )
                                                      
                                                      =
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                             

we can conclude 
                                                   
                                                      
                                                         c
                                                         3
                                                         ′
                                                      
                                                      +
                                                      g
                                                      
                                                         (
                                                         
                                                            h
                                                            4
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            4
                                                         
                                                         ,
                                                         
                                                            h
                                                            3
                                                         
                                                         −
                                                         c
                                                         
                                                            h
                                                            3
                                                         
                                                         )
                                                      
                                                      ≤
                                                      
                                                         c
                                                         4
                                                         ′
                                                      
                                                   
                                                ;


                                       
                                          
                                             
                                                q
                                                3
                                             
                                             =
                                             
                                                q
                                                1
                                             
                                             +
                                             
                                                d
                                                j
                                             
                                             ≤
                                             
                                                q
                                                2
                                             
                                             +
                                             
                                                d
                                                j
                                             
                                             =
                                             
                                                q
                                                4
                                             
                                          
                                       ;

seeing previous conditions and resource constraints, 
                                          
                                             
                                                V
                                                3
                                                i
                                             
                                             ≤
                                             
                                                V
                                                4
                                                i
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             …
                                             n
                                          
                                       .

We now show that these conditions are satisfied in the case L
                              4 is delayed.

First, conditions 
                                 
                                    p
                                    o
                                    
                                       s
                                       3
                                    
                                    =
                                    p
                                    o
                                    
                                       s
                                       4
                                    
                                    ,
                                 
                               
                              ch
                              3 ≤ ch
                              4 and q
                              3 ≤ q
                              4 are not affected by the delay and trivially still hold. Let us examine remaining conditions. From 
                                 
                                    
                                       h
                                       1
                                    
                                    ≥
                                    
                                       h
                                       2
                                    
                                    +
                                    r
                                    
                                       t
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       h
                                       2
                                    
                                    −
                                    
                                       t
                                       
                                          j
                                          
                                          p
                                          o
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    −
                                    s
                                    
                                       t
                                       j
                                    
                                    +
                                    r
                                    
                                       t
                                       2
                                    
                                    ≥
                                    
                                       a
                                       j
                                    
                                    ,
                                 
                               we know that 
                                 
                                    
                                       h
                                       1
                                    
                                    −
                                    
                                       t
                                       
                                          j
                                          
                                          p
                                          o
                                          
                                             s
                                             1
                                          
                                       
                                    
                                    −
                                    s
                                    
                                       t
                                       j
                                    
                                    ≥
                                    
                                       a
                                       j
                                    
                                 
                              ; hence, label L
                              3 is not delayed.

                                 
                                    •
                                    
                                       
                                          
                                             
                                                h
                                                4
                                             
                                             +
                                             r
                                             
                                                t
                                                4
                                             
                                             =
                                             
                                                a
                                                j
                                             
                                             +
                                             r
                                             
                                                t
                                                4
                                             
                                             ≤
                                             r
                                             
                                                t
                                                2
                                             
                                             +
                                             
                                                h
                                                2
                                             
                                             −
                                             
                                                t
                                                
                                                   j
                                                   
                                                   p
                                                   o
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             −
                                             s
                                             
                                                t
                                                j
                                             
                                             ≤
                                             
                                                h
                                                1
                                             
                                             −
                                             
                                                t
                                                
                                                   j
                                                   
                                                   p
                                                   o
                                                   
                                                      s
                                                      1
                                                   
                                                
                                             
                                             −
                                             s
                                             
                                                t
                                                j
                                             
                                          
                                       ; also, 
                                          
                                             
                                                h
                                                4
                                             
                                             +
                                             r
                                             
                                                t
                                                4
                                             
                                             ≤
                                             
                                                b
                                                j
                                             
                                          
                                       ; hence, 
                                          
                                             
                                                h
                                                4
                                             
                                             +
                                             r
                                             
                                                t
                                                4
                                             
                                             ≤
                                             m
                                             i
                                             n
                                             
                                                (
                                                
                                                   h
                                                   1
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      
                                                      p
                                                      o
                                                      
                                                         s
                                                         1
                                                      
                                                   
                                                
                                                −
                                                s
                                                
                                                   t
                                                   j
                                                
                                                ,
                                                
                                                   b
                                                   j
                                                
                                                )
                                             
                                             =
                                             
                                                h
                                                3
                                             
                                          
                                       ;


                                       Property 4.1 proves that the inequality on reduced costs proved for the non delayed version holds. To make this clear, let us rename labels L
                                       3 and L
                                       4: 
                                          
                                             
                                                L
                                                3
                                             
                                             =
                                             
                                                
                                                   L
                                                   1
                                                
                                                ¯
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                L
                                                4
                                             
                                             =
                                             
                                                
                                                   L
                                                   2
                                                
                                                ¯
                                             
                                          
                                       ; let us also introduce the fictive (non-feasible) label 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                        that would have been obtained from the extension of L
                                       2 to j applying the extensions rules defined when no delay is needed; 
                                          
                                             
                                                
                                                   L
                                                   1
                                                
                                                ¯
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                L
                                                2
                                             
                                             ¯
                                          
                                        and 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                        satisfy the assumptions of Property 4.1; we thus know that Eq. (12) holds for these three labels (note that the fact 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                        is not feasible does not interfere with this part of the proof). Additionally, we proved just above that when the extension of L
                                       2 is not delayed (that corresponds to 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                       ) the inequality on reduced costs holds; that means the inequality 
                                          
                                             
                                                c
                                                1
                                                ′
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   3
                                                
                                                −
                                                c
                                                
                                                   h
                                                   3
                                                
                                                ,
                                                
                                                   h
                                                   1
                                                
                                                −
                                                c
                                                
                                                   h
                                                   1
                                                
                                                )
                                             
                                             ≤
                                             
                                                c
                                                3
                                                ′
                                             
                                          
                                        between 
                                          
                                             
                                                L
                                                1
                                             
                                             ¯
                                          
                                        and 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                        is satisfied (again the fact that 
                                          
                                             
                                                L
                                                3
                                             
                                             ¯
                                          
                                        is not feasible does not invalidate the proof). Thank to the property we can deduce that the inequality 
                                          
                                             
                                                c
                                                1
                                                ′
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   2
                                                
                                                −
                                                c
                                                
                                                   h
                                                   2
                                                
                                                ,
                                                
                                                   h
                                                   1
                                                
                                                −
                                                c
                                                
                                                   h
                                                   1
                                                
                                                )
                                             
                                             ≤
                                             
                                                c
                                                2
                                                ′
                                             
                                          
                                        between 
                                          
                                             
                                                L
                                                1
                                             
                                             ¯
                                          
                                        and 
                                          
                                             
                                                L
                                                2
                                             
                                             ¯
                                          
                                        is also satisfied. We can deduce that the inequality 
                                          
                                             
                                                c
                                                3
                                                ′
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   h
                                                   4
                                                
                                                −
                                                c
                                                
                                                   h
                                                   4
                                                
                                                ,
                                                
                                                   h
                                                   3
                                                
                                                −
                                                c
                                                
                                                   h
                                                   3
                                                
                                                )
                                             
                                             ≤
                                             
                                                c
                                                4
                                                ′
                                             
                                          
                                        between L
                                       3 and L
                                       4 is holds;

seeing previous conditions and resource constraints, 
                                          
                                             
                                                V
                                                3
                                                i
                                             
                                             ≤
                                             
                                                V
                                                4
                                                i
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             …
                                             n
                                          
                                       .□

Considering a non-dominated representative label at origin vertex o, it is important to note that labels in the same group might have a different reduced cost, possibly better than the one of the representative label. Hence, an extra step is needed to compute the set of labels to be added to the restricted master problem. The procedure is defined as follows:

Every representative label is delayed to its best time position (regarding dual variables) and resulting labels are kept if having a negative reduced cost.

In this section we propose two methods that increase the performance of our column generation scheme. The benefits of these methods is analyzed in Section 6.

In order to cope with the precision of instances at hand, the discretization should be fine-grained. This means that the number of mutual exclusion constraints of the set covering formulation (6)–(10) may lead to combinatorial explosion.

To limit this problem, we propose to apply a surrogate relaxation of these constraints considering coarser time intervals than the time instants defined in Section 3.1 according to the time precision of the problem. For this, we propose to partition the planning horizon [0, T] in the following way. Let lmin
                         be a small value guaranteeing that the duration of any feasible trip is greater than lmin
                        . We can then partition [0, T] into a set of time intervals 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                         such that 
                           
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              =
                              
                                 [
                                 
                                    l
                                    
                                       m
                                       i
                                       n
                                    
                                 
                                 ×
                                 
                                    t
                                    ˜
                                 
                                 ,
                                 
                                    l
                                    
                                       m
                                       i
                                       n
                                    
                                 
                                 ×
                                 
                                    (
                                    
                                       t
                                       ˜
                                    
                                    +
                                    1
                                    )
                                 
                                 [
                              
                           
                         for 
                           
                              
                                 t
                                 ˜
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌊
                                    
                                       T
                                       
                                          l
                                          
                                             m
                                             i
                                             n
                                          
                                       
                                    
                                    ⌋
                                 
                                 −
                                 1
                                 }
                              
                              ,
                           
                        
                        
                           
                              
                                 Δ
                                 
                                    ⌊
                                    
                                       T
                                       
                                          l
                                          
                                             m
                                             i
                                             n
                                          
                                       
                                    
                                    ⌋
                                 
                              
                              =
                              
                                 [
                                 
                                    ⌊
                                    
                                       T
                                       
                                          l
                                          
                                             m
                                             i
                                             n
                                          
                                       
                                    
                                    ⌋
                                 
                                 
                                    l
                                    
                                       m
                                       i
                                       n
                                    
                                 
                                 ,
                                 T
                                 ]
                              
                           
                        . With this planning horizon partition, we construct a surrogate constraint for each time interval 
                           
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              ,
                           
                         obtained by summing all the constraints defined for the time instants in 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                        . The resulting constraints are:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                b
                                                
                                                   
                                                      t
                                                      ˜
                                                   
                                                   k
                                                
                                             
                                             
                                                θ
                                                k
                                             
                                             ≤
                                             U
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   t
                                                   ˜
                                                
                                                ∈
                                                
                                                   {
                                                   0
                                                   ,
                                                   ⋯
                                                   ,
                                                   
                                                      ⌊
                                                      
                                                         T
                                                         
                                                            l
                                                            
                                                               m
                                                               i
                                                               n
                                                            
                                                         
                                                      
                                                      ⌋
                                                   
                                                   }
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 b
                                 
                                    
                                       t
                                       ˜
                                    
                                    k
                                 
                              
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                         is the proportion of occupation of 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                         by trip k.

The solution of the surrogate relaxation (6), (7), (9), (13) involves some modifications of the algorithm. Indeed, the reduced cost of a trip k becomes 
                           
                              
                                 c
                                 k
                                 ′
                              
                              =
                              
                                 c
                                 k
                              
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    V
                                    ∖
                                    {
                                    0
                                    }
                                 
                              
                              
                                 a
                                 
                                    i
                                    k
                                 
                              
                              
                                 λ
                                 i
                              
                              +
                              
                                 ∑
                                 
                                    
                                       t
                                       ˜
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       ⋯
                                       ,
                                       
                                          ⌊
                                          
                                             T
                                             
                                                l
                                                
                                                   m
                                                   i
                                                   n
                                                
                                             
                                          
                                          ⌋
                                       
                                       }
                                    
                                 
                              
                              
                                 b
                                 
                                    
                                       t
                                       ˜
                                    
                                    k
                                 
                              
                              
                                 Ψ
                                 
                                    t
                                    ˜
                                 
                              
                              ,
                           
                         where λi
                         and 
                           
                              Ψ
                              
                                 t
                                 ˜
                              
                           
                         are dual variables respectively corresponding to primal constraints (7) and (13). Extension rules are not modified, except that the definition of function g is redefined as follows:

                           
                              (14)
                              
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             h
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             h
                                             ¯
                                          
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             t
                                             ˜
                                          
                                          =
                                          i
                                          n
                                          d
                                          
                                             (
                                             
                                                
                                                   h
                                                   ¯
                                                
                                                1
                                             
                                             )
                                          
                                       
                                       
                                          
                                             t
                                             ˜
                                          
                                          =
                                          i
                                          n
                                          d
                                          
                                             (
                                             
                                                
                                                   h
                                                   ¯
                                                
                                                2
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          min
                                          
                                             (
                                             
                                                
                                                   h
                                                   ¯
                                                
                                                2
                                             
                                             ,
                                             sup
                                             
                                                (
                                                
                                                   Δ
                                                   
                                                      t
                                                      ˜
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          −
                                          max
                                          
                                             (
                                             
                                                
                                                   h
                                                   ¯
                                                
                                                1
                                             
                                             ,
                                             inf
                                             
                                                (
                                                
                                                   Δ
                                                   
                                                      t
                                                      ˜
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          max
                                          (
                                          ϵ
                                          ,
                                          sup
                                          
                                             (
                                             
                                                Δ
                                                
                                                   t
                                                   ˜
                                                
                                             
                                             )
                                          
                                          −
                                          inf
                                          
                                             (
                                             
                                                Δ
                                                
                                                   t
                                                   ˜
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       Ψ
                                       
                                          t
                                          ˜
                                       
                                    
                                 
                              
                           
                        where 
                           
                              i
                              n
                              d
                              (
                              
                                 h
                                 ¯
                              
                              )
                           
                         indicates the index of the time interval that contains 
                           
                              h
                              ¯
                           
                         (
                           
                              
                                 h
                                 ¯
                              
                              ∈
                              
                                 Δ
                                 
                                    i
                                    n
                                    d
                                    (
                                    
                                       h
                                       ¯
                                    
                                    )
                                 
                              
                           
                        ), 
                           
                              inf
                              (
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              )
                           
                         and 
                           
                              sup
                              (
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              )
                           
                         are the lower and the upper bound of time interval 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                        . ϵ is introduced in order to avoid a division by 0 when 
                           
                              
                                 Δ
                                 
                                    ⌊
                                    
                                       T
                                       
                                          l
                                          
                                             m
                                             i
                                             n
                                          
                                       
                                    
                                    ⌋
                                 
                              
                              =
                              
                                 [
                                 T
                                 ,
                                 T
                                 ]
                              
                           
                        . With this definition, dual variables 
                           
                              Ψ
                              
                                 t
                                 ˜
                              
                           
                         are counted according to the proportion of time interval 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                         included in 
                           
                              [
                              
                                 
                                    h
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    h
                                    ¯
                                 
                                 2
                              
                              ]
                           
                        
                     

According to the hypothesis that lmin
                         is smaller than any possible trip (in practice, the shortest travel time between two vertices in the set A), the definition of 
                           
                              b
                              
                                 
                                    t
                                    ˜
                                 
                                 k
                              
                           
                         allows us to calculate the precise starting time of any trip selected in a solution for any time granularity needed. Hence, any solution of the surrogate relaxation can be transformed to a solution (not necessarily feasible) of the initial master problem. Furthermore, if the solution is feasible, it is optimal. If the obtained solution is not feasible then we solve (1)–(5) initialized with the set of generated trips.

A second accelerating method consists in starting the dynamic programming algorithm with many representative labels. To initialize the process, a representative label of the empty path {d, d} is constructed for each time interval 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                        . For a given interval 
                           
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              ,
                           
                         the label is defined as follows: 
                           
                              
                                 c
                                 ′
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              p
                              o
                              s
                              =
                              d
                              ,
                           
                        
                        
                           
                              h
                              =
                              i
                              n
                              f
                              (
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              )
                              ,
                           
                        
                        
                           
                              q
                              =
                              0
                              ,
                           
                        
                        
                           
                              d
                              =
                              i
                              n
                              f
                              (
                              
                                 Δ
                                 
                                    t
                                    ˜
                                 
                              
                              )
                              ,
                           
                        
                        
                           
                              c
                              h
                              =
                              0
                              ,
                           
                        
                        
                           
                              r
                              t
                              =
                              s
                              u
                              p
                              
                                 (
                                 
                                    Δ
                                    
                                       t
                                       ˜
                                    
                                 
                                 )
                              
                              −
                              i
                              n
                              f
                              
                                 (
                                 
                                    Δ
                                    
                                       t
                                       ˜
                                    
                                 
                                 )
                              
                              
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 V
                                 1
                              
                              =
                              0
                              ,
                              …
                              ,
                              
                                 V
                                 n
                              
                              =
                              0
                           
                         where 
                           
                              inf
                              
                                 (
                                 
                                    Δ
                                    
                                       t
                                       ˜
                                    
                                 
                                 )
                              
                              =
                              
                                 l
                                 
                                    m
                                    i
                                    n
                                 
                              
                              ×
                              
                                 t
                                 ˜
                              
                           
                         and 
                           
                              sup
                              
                                 (
                                 
                                    Δ
                                    
                                       t
                                       ˜
                                    
                                 
                                 )
                              
                              =
                              
                                 l
                                 
                                    m
                                    i
                                    n
                                 
                              
                              ×
                              
                                 (
                                 
                                    t
                                    ˜
                                 
                                 +
                                 1
                                 )
                              
                           
                        .

Please note that if the surrogate relaxation presented above is not used, this second accelerating method can still be applied by replacing 
                           
                              Δ
                              
                                 t
                                 ˜
                              
                           
                         with t in the label construction and setting parameter 
                           
                              r
                              t
                              =
                              0
                           
                        .

@&#RESULTS@&#

In this section, results obtained on instances based on Solomon’s benchmark are reported. First, we introduce the instances. Then the impact of our accelerating methods is evaluated. Finally, we compare the two branch-and-price algorithms.

The computing platform is an Intel Core i7 2670QM with 8 gigabyte of RAM using GLPK to solve the master problem. The computing time limit was set to 12 hours per instance.

Our experiments were performed using instances based on the well-known VRPTW benchmark instances created by Solomon (1987). These instances are divided into six classes that are a combination of two criteria. The first criterion concerns the spatial position of customers. There are three different spatial layouts: customers in clusters (“C” type), customers randomly located (“R” type), and intermediate case with part of customers clustered and the rest randomly located (“RC” type). The second criterion concerns the tightness of time constraints at customers. There are two types: tight time windows and small planning time horizon (type “1”) and large time windows and planning time horizon (type “2”). By combining these two criteria, there are six basic classes which are denominated: “C1”, “C2”, “R1”, “R2”, “RC1” and “RC2”. In total, there are 56 instances with 100 customers. Please note that for a given class, there are several instances with different customer time windows, but the spatial layout of customers is the same for the whole class. Instances are denoted as in the following example: C201-XX corresponds to the first instance of class “C2” where only the first XX customers are considered.
                        
                     

Note that, in the benchmark instances, only the customer and depot coordinates are given. Implicitly, the induced graph is considered complete and each edge receives a travel time that corresponds to the Euclidean distance between the corresponding nodes truncated to one decimal place.

In this study, instances with tight planning time horizon were discarded. Indeed, the short time horizon does not allow a significant number of routes to be assigned to the same vehicle. Loading times were introduced as follows: for every instance and every customer i, loading time 
                           
                              
                                 l
                                 i
                              
                              =
                              0.2
                              s
                              
                                 t
                                 i
                              
                           
                        . To obtain a multi trip feature the vehicle capacity was set to 100. Finally, we considered instances with 25 customers, and restricted the number of vehicles to two.


                        Table 1 shows the impact of the two accelerating methods presented in Section 5. For this analysis, the computing time limit was set to 2 hours per instance. In this table, for each instance in class C2, column IB gives the value of the optimal integer solution, column SMP gives the results obtained without the surrogate relaxation and column Surrogate SMP gives the results obtained with this relaxation. For these two columns are given the value of the linear relaxation at the root node (LB), the total computing time obtained when only one label is created during the initialization of the pricing problem (T
                        1L
                        ) and the total computing time obtained when many labels are created (
                           
                              T
                              
                                 +
                                 L
                              
                           
                        ). When T
                        1L
                        , 
                           
                              T
                              
                                 +
                                 L
                              
                           
                         or LB is left blank, the instance could not be solved by the corresponding method.

Solutions obtained with the branch-and-price based on the surrogate relaxation happened to be always feasible, and thus optimal. For this reason column IB could be completed each time one of the two variants succeeded.

As expected, the decrease of the quality of the lower bound applying the surrogate relaxation is very limited. Conversely, the relaxation results in a huge improvement in terms of computing times. The use of several representative labels at the initialization of the algorithm permits another important additional speedup.

In this section we compare the two branch-and-price algorithms. For the sake of simplicity, we identify the formulation and the algorithm: we call SMP algorithm (resp., SSP algorithm) the branch-and-price algorithm based on the SMP formulation (resp., SSP formulation).

Additionally, we compare the two algorithms with the best available algorithm for the MTVRPTW-LD. The latter comparison aims at evaluating the possibility of solving the MTVRPTW with an algorithm designed for the MTVRPTW-LD. As indicated in Section 1.2, three algorithms are candidates but the most efficient when the number of trips is large is the branch-and-price algorithm developed by Hernandez et al. (2014). We use this algorithm and call it MTVRPTW-LD algorithm for short. Seeing that no trip duration limit is defined in the instances, we proceed as follows. We first solve the problem using the SMP algorithm. We then compute the largest trip duration in the optimal solution. We set the trip duration limit to this value. Note that selecting the smallest possible value as we do, plays in favor of MTVRPTW-LD. In case no solution is found with the SMP algorithm, the duration limit is set to 
                           
                              +
                              ∞
                           
                        .

Results are given in Table 2. Column IB indicates the value of the optimal solution. Series of columns are defined for each solution method: SMP, SSP, MTVRPTW-LD. In each case, column Time provides the total computing time in second to obtain the optimal integer solution.

For SMP and SSP, column GAP percent indicates the gap between the values of the optimal solution and the linear relaxation at the root node. For SMP, a “√” in column Feas. means that the surrogate relaxation provides a feasible (optimal) solution. For MTVRPTW-LD, column Limit gives the value of the trip duration limit.

Two additional series of columns give ratios on computing times. Given two methods, ratios are given with two columns: depending on which method is the fastest, the ratio is reported in one column or in the other. A value 
                           
                              +
                              ∞
                           
                         is reported when a single method solves the instance. Columns 
                           
                              R
                              
                                 S
                                 M
                                 P
                              
                              
                                 S
                                 S
                                 P
                              
                           
                         and 
                           
                              R
                              
                                 S
                                 S
                                 P
                              
                              
                                 S
                                 M
                                 P
                              
                           
                         compare the computing times of the SMP and SSP algorithms. Columns 
                           
                              R
                              
                                 S
                                 M
                                 P
                              
                              
                                 L
                                 D
                              
                           
                         and 
                           
                              R
                              
                                 L
                                 D
                              
                              
                                 S
                                 M
                                 P
                              
                           
                         compare the computing times of the SMP and MTVRPTW-LD algorithms.

Several conclusions can be drawn from this table.

First of all, the results observed with the experiments described in Table 1 are confirmed. The solution returned by the surrogate SMP algorithm is consistently feasible. One can definitely conclude that the speedup obtained from the surrogate relaxation worth the risk to fail in solving the instance.

Second, both the SMP and SSP algorithms outperform the algorithm dedicated to the MTVPRTW-LD. The latter only close 5 instances, compared to 25 and 19 for the others. This observation proves the limits of the two-phase methods developed for the MTVPRTW-LD and validates the interest of developing new methods with a different design, as those proposed in this paper. A few instances however demonstrate the interest of specialized methods when the trip duration is strongly limited (RC207 and RC203).

Regarding the two algorithms developed in this study, the SMP algorithm globally outperforms the SSP algorithm: more instances are solved (25 against 19) and computing times can be severely decreased. However, if the superiority of the SMP algorithm is clear on the R instances, it can be discussed for the two other classes of instances, especially the RC instances.

A final interesting observation is that the tightness of the relaxation can be significantly better for the SSP formulation. However, no clear correlation appears between the difference in gap and the difference in computing times.

@&#CONCLUSION@&#

In this paper, we proposed and compared two exact solution methods for the MTVRPTW. As far as we know, these are the first exact solution approaches for this important problem.

Both methods are based on branch-and-price, but with different set covering formulations. In the first formulation, called SSP, columns are complete routes. In the second formulation, called SMP, columns are trips. Mutual temporal exclusion constraints were then needed (at the master problem level) to manage the combination of trips to routes. To deal with these constraints, the concepts of groups of labels and representative labels were introduced and a surrogate relaxation was proposed.

Another difficulty we were confronted to, was the non-constant loading time. To deal with it, we proposed a backward labeling strategy for the pricing problem.

Experiments show that the SMP-based approach globally outperforms the other approach. This method proved capable of consistently solving instances with 25 customers. In addition, the results give evidence of the efficiency of the surrogate relaxation.

Additional experiments demonstrate that previous methods developed for the solution of the MTVRPTW-LD, that could theoretically be applied (fixing a large trip duration limit), are not satisfactory, which confirm the interest of the methods developed in this paper.

Future works are however needed to address larger instances. It will be considered to include some relaxation to the sub-problem like the ng-route relaxation and the strong degree constraints respectively introduce in Baldacci, Mingozzi, and Roberti (2011) and Contardo, Cordeau, and Gendron (2014). It will also be considered to initialize the methods with good solutions provided by heuristic approaches.

@&#ACKNOWLEDGMENT@&#

The authors acknowledge the Cemagref and the Région Languedoc-Roussillon in France for providing the basic funding of this research, as well as contributions from LIRMM, PNRB MOBIPE project supported by french ANR, and A2PV SyDeReT project. We thank Professor J.C. König for his support in this research.

@&#REFERENCES@&#

