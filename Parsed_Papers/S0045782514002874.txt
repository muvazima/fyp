@&#MAIN-TITLE@&#Structural topology and shape optimization using a level set method with distance-suppression scheme

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A level set method with distance-suppression scheme is developed.


                        
                        
                           
                           An energy functional is developed and built into the level set equation.


                        
                        
                           
                           The need for re-initialization can be eliminated.


                        
                        
                           
                           The initialization of the level set function can be simplified.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topology optimization

Structural optimization

Level set method

Re-initialization

Energy functional

Shape optimization

@&#ABSTRACT@&#


               
               
                  In level set methods for structural topology and shape optimization, the level set function gradients at the design interface need to be controlled in order to ensure stability of the optimization process. One popular way to do this is to enforce the level set function to be a signed distance function by periodically using initialization schemes, which is commonly known as re-initialization. However, such re-initialization schemes are time-consuming, as additional partial differential equations need to be solved in every iteration step. Furthermore, the use of re-initialization brings some undesirable problems; for example, it may move the zero level set away from the expected position. This paper presents a level set method with distance-suppression scheme for structural topology and shape optimization. An energy functional is introduced into the level set equation to maintain the level set function to close to a signed distance function near the structural boundaries, meanwhile forcing the level set function to be a constant at locations far away from the structural boundaries. As a result, the present method not only can avoid the need for re-initialization but also can simplify the setting of the initial level set function. The validity of the proposed method is tested on the mean compliance minimization problem and the compliant mechanisms synthesis problem. Different aspects of the proposed method are demonstrated on a number of benchmarks from the literature of structural optimization.
               
            

@&#INTRODUCTION@&#

Topology optimization is concerned with seeking the optimum distribution of material in a given design domain that minimizes a given cost function while satisfies a series of constraints  [1]. By now, topology optimization has been exhaustively explored and has become one of the most important topics of engineering applications (see  [2] for a review).

Starting with the seminal work of Bendsøe and Kikuchi  [3], numerical methods for continuum structural topology optimization have been extensively investigated, and several approaches have been developed. The most common approaches are density-based. In such methods, the design domain is discretized using finite elements, and then the material property of each element is controlled. The optimum topology is obtained by restricting the material property value of a certain number of elements approaching zero  [4,1]. Density-based topology optimization approaches include the homogenization methods  [3,5,6], the SIMP (Solid Isotropic Microstructure with Penalization) method [7–9] and the ESO (Evolutionary Structural Optimization) method  [10–12]. Among these, the SIMP method has been generally accepted and reached the stage of application in industrial software due to its computational efficiency and conceptual simplicity. We refer readers to  [13,14] and the references therein for a state-of-the-art review of established density-based methods. Unfortunately, density-based methods tend to suffer from numerical instabilities such as the mesh dependency, checkerboard patterns and grayscales  [15–17]. Several methods have been developed to mitigate these instabilities  [18,16,19].

The other major class of topology optimization approaches uses structural boundaries as the design variables. Structural boundaries can be either represented using explicit boundary descriptions (e.g., spline-based)  [20] or represented implicitly as iso-contours of a level set function  [21–25]. In the context of spline-based methods, non-gradient methods (such as the genetic algorithm) are often adopted to obtain the optimum configuration  [20]. The disadvantage is that they are computationally inefficient.

Recently, level set methods have become powerful schemes for solving topology optimization problems  [26–28]. The level set method was originally introduced by Osher and Sethian  [29]. Readers interested in level set methods for their applications are encouraged to read  [30,31]. The seminal work incorporating level set methods into structural optimization can be found in  [32,33]. In the conventional level set method, the optimization process is implicitly accomplished by evolving a level set equation, i.e., a so-called Hamilton–Jacobi type PDE (partial differential equation). Note that the level set function is a scalar function, which greatly reduces the complexity of describing structural boundaries, especially when undergoing topological changes such as pinching and merging. Furthermore, the results of most level set-based topology optimization methods do not suffer mesh-dependency, which is often encountered in density-based topology optimization methods  [16].

However, in conventional level set methods, the level set function typically develops irregularities, which may destroy the stability of the optimization process. To overcome this difficulty, regularization schemes, e.g., Tikhonov regularization  [34–37] and perimeter regularization  [38,22], are often applied to smooth the level set function to obtain a well-posed optimization problem. Many level set-based methods maintain the level set function as a signed distance function by periodically stopping the optimization and reshaping the degraded level set function, which is commonly known as the re-initialization procedure  [39,31]. A standard re-initialization procedure solves a specific PDE, such as are adopted in  [23,22,40]. However, use of re-initialization introduces some fundamental problems yet to be solved, such as 
                        
                           (1)
                           when and how to perform the re-initialization  [41];

re-initialization will slow the optimization process as additional PDEs need to be solved  [28];

re-initialization will slightly move the zero level set (structural boundaries) and cause inconsistencies during the optimization process  [31,42].

To avoid re-initialization, methods derived from image segmentation have been developed in  [43–46]. In those methods, the level set function is defined as a piecewise continuous function over the whole design domain. This keeps the advantages of implicit level set representation and avoids solving the Hamilton–Jacobi equation. However, values of parameters of the constraint functional for the piecewise constant level set function can be difficult to determine.

In addition, diffusive terms have been introduced into the level set equation to regularize the level set function to stabilize the optimization process  [35,34,28]. Li et al.  [47] proposed a variational level set method for image signature by introducing an energy functional into the level set equation. This energy functional has an intrinsic mechanism of maintaining the signed distance property of the level set function. However, the velocity, which is generated by the energy function, affects numerical accuracy and has limited control of the level set function gradients, especially at locations far away from the zero level set. Li et al.  [48] proposed a distance-regularized level set method for image segmentation by introducing a double-well potential function for distance regularization. The idea of intrinsically maintaining the property of the level set function during the optimization process is adopted in  [28], where a level set method without re-initialization is developed for topology optimization of compliant mechanisms. Linear anisotropic diffusion terms  [35,36] have been introduced into a reaction–diffusion equation to regularize the level set function. However, such a linear anisotropic diffusion tends to flatten the level set function, leading to a vanishing of the zero level set. Thus, special attention must be paid for setting the penalty factor of such a linear anisotropic diffusion. In addition, diffusion in a streamline direction has been introduced to control the mean curvature of the design interfaces  [23,49]. However, this will not eliminate the requirement of re-initialization. The smoothness of the level set function can be increased by using different types of diffusions. However, this can cause overly smooth designs and the loss of important details of a design  [25].

This paper presents a level set method with distance-suppression scheme for structural topology and shape optimization. An energy functional is introduced into the level set equation to maintain the level set function to close to a signed distance function near the zero level set, meanwhile forcing the level set function to be a constant at locations far away from the zero level set. The proposed method has the advantage of allowing not only shape but also topological changes. Furthermore, the present method not only can avoid the need for re-initialization and thereby avoid its induced numerical difficulties, but also can simplify the initialization of the level set function. To demonstrate the validity of the proposed method, we apply it to the minimum mean compliance problem and the compliant mechanisms synthesis problem.

The remainder of the paper is organized as follows. In Section  2, a level set method with distance-suppression scheme is developed. In Section  3, optimization problems to be considered are introduced. Velocity field is constructed based on the shape sensitivity analysis method. In Section  4, a number of numerical issues, which are of concern in the implementation of the proposed method, are addressed. In Section  5, several numerical examples are presented to demonstrate the effectiveness of the proposed method. Conclusions are documented in Section  6.

Suppose that 
                           D
                         is the design domain that completely contains the material domain 
                           Ω
                        , and 
                           D
                           ∖
                           Ω
                         represents the void area. The underlying idea behind the level set method is to represent the structural boundaries 
                           Γ
                         as the zero level set of one higher dimensional function 
                           ϕ
                        . The reference (design) domain 
                           D
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         (
                           d
                           =
                           2
                         or 3), the material domain 
                           Ω
                        , the void domain 
                           D
                           ∖
                           Ω
                         and the boundary 
                           Γ
                         can be defined as 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             ϕ
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             >
                                             0
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             ϕ
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             =
                                             0
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             Γ
                                          
                                       
                                       
                                          
                                             ϕ
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             <
                                             0
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             D
                                             ∖
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              x
                           
                         is a point in the design domain and 
                           t
                         is the pseudo-time  [32,23,22]. By differentiating the structural boundary 
                           ϕ
                           
                              (
                              
                                 x
                              
                              ,
                              t
                              )
                           
                           =
                           0
                         on both sides with respect to 
                           t
                        , the following Hamilton–Jacobi PDE can be obtained: 
                           
                              (2)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 =
                                 0
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                         determines the motion of the interface and can be derived from shape sensitivity analysis  [23,22].

This study considers a minimization problem of an objective functional 
                           J
                         under a constraint on material usage 
                           V
                           o
                           l
                        . The optimization problem can be formulated as 
                           
                              (3)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          J
                                          
                                             (
                                             u
                                             ,
                                             ϕ
                                             )
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                D
                                             
                                          
                                          j
                                          
                                             (
                                             u
                                             )
                                          
                                          H
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          d
                                          Ω
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          V
                                          o
                                          l
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                D
                                             
                                          
                                          H
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          d
                                          Ω
                                          ≤
                                          V
                                          o
                                          
                                             
                                                l
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           V
                           o
                           
                              
                                 l
                              
                              
                                 m
                                 a
                                 x
                              
                           
                         denotes the upper limit value of 
                           V
                           o
                           l
                        , and 
                           u
                         is the state variable. 
                           H
                           
                              (
                              ϕ
                              )
                           
                         is the Heaviside function and is defined as 
                           
                              (4)
                              
                                 H
                                 
                                    (
                                    ϕ
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             ϕ
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             ϕ
                                             <
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The above Heaviside function cannot be directly differentiated and therefore is often replaced with a smoothed Heaviside function  [23]
                        
                           
                              (5)
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 
                                    (
                                    ϕ
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             if  
                                             ϕ
                                             <
                                             −
                                             Δ
                                          
                                       
                                       
                                          
                                             0.75
                                             
                                                (
                                                1
                                                −
                                                ϵ
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      Δ
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   1
                                                   +
                                                   ϵ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             if  
                                             −
                                             Δ
                                             ≤
                                             ϕ
                                             ≤
                                             Δ
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             ϕ
                                             >
                                             Δ
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           ϵ
                         is a small value and is set to 
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                        . 
                           Δ
                         is set to 
                           0.75
                           Δ
                           x
                        , where 
                           Δ
                           x
                         is the mesh size.

Define a Lagrangian function 
                           L
                        , and let 
                           λ
                         be the Lagrange multiplier for the constraint. The optimization problem can be reformulated as 
                           
                              (6)
                              
                                 L
                                 
                                    (
                                    u
                                    ,
                                    ϕ
                                    )
                                 
                                 =
                                 J
                                 
                                    (
                                    u
                                    ,
                                    ϕ
                                    )
                                 
                                 +
                                 λ
                                 
                                    (
                                    V
                                    o
                                    l
                                    −
                                    V
                                    o
                                    
                                       
                                          l
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           λ
                         changes with each iteration 
                           k
                         of the optimization algorithm using the scheme  [27,50]
                        
                           
                              (7)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    (
                                    V
                                    o
                                    l
                                    −
                                    V
                                    o
                                    
                                       
                                          l
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                    )
                                 
                              
                           
                         and 
                           Λ
                         is updated using 
                           
                              (8)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 χ
                                 
                                    
                                       Λ
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         where 
                           χ
                           ∈
                           
                              (
                              0
                              ,
                              1
                              )
                           
                         is a fixed parameter and is set to 0.9  [27]. This implements the augmented Lagrangian multiplier method for constrained optimization.

The concept of shape derivative  [51,52] is employed as a gradient method to solve the optimization problem. The shape derivative of 
                           L
                         at 
                           Ω
                         (
                           ϕ
                        ) is defined as 
                           
                              (9)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 l
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 d
                                 s
                              
                           
                         where 
                           l
                         is known as the shape gradient density  [53]. To update the level set function, the velocity field can be simply set to be the negative of the shape gradient density, i.e.,  
                           
                              (10)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 −
                                 l
                                 .
                              
                           
                        
                     

This choice guarantees a decreasing of 
                           L
                           [23,22]. Because 
                           l
                         is computed everywhere in 
                           D
                        , 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                         is actually provided throughout the domain  [21].

We define the initial level set function to be 
                           
                              (11)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             c
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             Γ
                                          
                                       
                                       
                                          
                                             −
                                             c
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             D
                                             ∖
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           c
                           >
                           0
                         is a constant.

The level set function gradients at the design interface need to be controlled, not only for the stability of the optimization process but also for the crispness of the material interface  [25]. One popular way is to enforce the level set function to be a signed distance function by periodically using re-initialization schemes  [23,22]. This method also can be applied to the initial data (Eq. (11)) to initialize 
                           ϕ
                         to a signed distance function  [31]. For a not particularly flat (
                           
                              |
                              ∇
                              ϕ
                              |
                           
                           <
                           1
                        ) or steep (
                           
                              |
                              ∇
                              ϕ
                              |
                           
                           >
                           1
                        ) level set function, optimum topologies can also be obtained, although the magnitude of 
                           
                              |
                              ∇
                              ϕ
                              |
                           
                         affects the convergence rate  [54,25].

To ensure the stability of the optimization process, the level set function 
                           ϕ
                         (or at least one in the vicinity of the design interface) must satisfy the property 
                           
                              (12)
                              
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 =
                                 q
                              
                           
                         where 
                           q
                           >
                           0
                         is a constant and generally is not far away from 1. Thus, we introduce an energy functional 
                           ℜ
                           
                              (
                              ϕ
                              )
                           
                         into the evolution process to inherently maintain the necessary property of the level set function. 
                           ℜ
                           
                              (
                              ϕ
                              )
                           
                         is defined as 
                           
                              (13)
                              
                                 ℜ
                                 
                                    (
                                    ϕ
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 r
                                 
                                    (
                                    
                                       |
                                       ∇
                                       ϕ
                                       |
                                    
                                    )
                                 
                                 d
                                 Ω
                              
                           
                         where 
                           r
                           
                              (
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              )
                           
                         is energy density.

Combining with 
                           ℜ
                           
                              (
                              ϕ
                              )
                           
                        , the optimization problem (3) is modified to 
                           
                              (14)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          J
                                          
                                             (
                                             u
                                             ,
                                             ϕ
                                             )
                                          
                                          +
                                          ω
                                          ℜ
                                          
                                             (
                                             ϕ
                                             )
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          V
                                          o
                                          l
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                D
                                             
                                          
                                          H
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          d
                                          Ω
                                          ≤
                                          V
                                          o
                                          
                                             
                                                l
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           ω
                         is defined as 
                           
                              (15)
                              
                                 ω
                                 =
                                 
                                    
                                       Δ
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   ℜ
                                                
                                             
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                              
                           
                         where 
                           Δ
                           t
                         is the time step and is restrained by the CFL (Courant–Friedrichs–Lewy) condition  [31]
                        
                           
                              (16)
                              
                                 Δ
                                 t
                                 ≤
                                 
                                    
                                       Δ
                                       x
                                    
                                    
                                       max
                                       
                                          (
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                                
                                                   n
                                                
                                             
                                             |
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         and 
                           Δ
                           
                              
                                 t
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       ℜ
                                    
                                 
                              
                           
                         is the time step and is restrained by the CFL condition 
                           
                              (17)
                              
                                 Δ
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ℜ
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       Δ
                                       x
                                    
                                    
                                       max
                                       
                                          (
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                                
                                                   ℜ
                                                
                                             
                                             |
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 ℜ
                              
                           
                         is the velocity field caused by 
                           ℜ
                           
                              (
                              ϕ
                              )
                           
                        . As a result, there is no need to set 
                           ω
                         artificially. In reality, Eqs. (16) and (17) are often enforced by using 
                           
                              
                                 (18)
                                 
                                    Δ
                                    t
                                    
                                       
                                          max
                                          
                                             (
                                             
                                                |
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                             
                                             )
                                          
                                       
                                       
                                          Δ
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          ϑ
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (19)
                                 
                                    Δ
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                ℜ
                                             
                                          
                                       
                                    
                                    
                                       
                                          max
                                          
                                             (
                                             
                                                |
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ℜ
                                                   
                                                
                                                |
                                             
                                             )
                                          
                                       
                                       
                                          Δ
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          ϑ
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                ℜ
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           0
                           <
                           
                              
                                 ϑ
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           <
                           1
                         and 
                           0
                           <
                           
                              
                                 ϑ
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       ℜ
                                    
                                 
                              
                           
                           <
                           1
                         are CFL numbers. A common choice is 
                           
                              
                                 ϑ
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           =
                           
                              
                                 ϑ
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       ℜ
                                    
                                 
                              
                           
                           =
                           0.5
                           [31].

The Fréchet derivative of 
                              ℜ
                            with respect to 
                              ϕ
                            in the 
                              ψ
                            direction is 
                              
                                 (20)
                                 
                                    
                                       〈
                                       
                                          
                                             ∂
                                             ℜ
                                          
                                          
                                             ∂
                                             ϕ
                                          
                                       
                                       ,
                                       ψ
                                       〉
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          ∂
                                          r
                                          
                                             (
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          ϕ
                                       
                                    
                                    ψ
                                    d
                                    Ω
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             d
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                r
                                                
                                                   (
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             d
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                r
                                                
                                                   (
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ψ
                                    d
                                    Ω
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             d
                                             x
                                          
                                       
                                       
                                          [
                                          
                                             
                                                ∂
                                                r
                                                
                                                   (
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          ]
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             d
                                             y
                                          
                                       
                                       
                                          [
                                          
                                             
                                                ∂
                                                r
                                                
                                                   (
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          ]
                                       
                                       )
                                    
                                    ψ
                                    d
                                    Ω
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       (
                                       d
                                       i
                                       v
                                       
                                          (
                                          
                                             
                                                ∂
                                                r
                                                
                                                   (
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                ∇
                                                ϕ
                                             
                                             
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ψ
                                    d
                                    Ω
                                    .
                                 
                              
                           
                        

To minimize the energy functional 
                              ℜ
                           , a standard method is to find the steady state solution of the gradient flow 
                              
                                 (21)
                                 
                                    
                                       
                                          ∂
                                          ϕ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    −
                                    d
                                    i
                                    v
                                    
                                       (
                                       
                                          
                                             ∂
                                             r
                                             
                                                (
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                          
                                       
                                       
                                          
                                             ∇
                                             ϕ
                                          
                                          
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    −
                                    d
                                    i
                                    v
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                       ∇
                                       ϕ
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                            is the diffusive rate.

Thus, a generalized Hamilton–Jacobi PDE is used to update the level set function. 
                              
                                 (22)
                                 
                                    
                                       
                                          ∂
                                          ϕ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          V
                                       
                                       
                                          n
                                       
                                    
                                    
                                       |
                                       ∇
                                       ϕ
                                       |
                                    
                                    +
                                    ω
                                    d
                                    i
                                    v
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                       ∇
                                       ϕ
                                       )
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        

To maintain the distance property of the level set function 
                              ϕ
                            in the entire design domain 
                              D
                           , we only have to make the energy density 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                            in Eq. (13) have an unique minimum point, i.e.,  
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              q
                           . There are many possibilities for 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                           ; a possible choice is 
                              
                                 (23)
                                 
                                    r
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       )
                                    
                                    =
                                    
                                       |
                                       |
                                    
                                    ∇
                                    ϕ
                                    
                                       |
                                       −
                                       q
                                       |
                                    
                                 
                              
                            which yields 
                              
                                 (24)
                                 
                                    ℜ
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       |
                                       |
                                    
                                    ∇
                                    ϕ
                                    
                                       |
                                       −
                                       q
                                       |
                                    
                                    d
                                    Ω
                                 
                              
                            such that the functional 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            is minimized when 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              q
                              [28]. According to Eq. (22), during the optimization process, the zero level set of 
                              ϕ
                            will be moved by the velocity 
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                           . Meanwhile, due to the penalizing effect of 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                           , the property of 
                              ϕ
                           , i.e.,  
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              q
                           , can be automatically maintained. Therefore, the re-initialization procedure is eliminated. For the case where 
                              q
                            is set to 1, the diffusive rate of Eq. (23) is 
                              
                                 (25)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                             
                                             
                                                if  
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                                >
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                             
                                             
                                                if  
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                                <
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            which indicates two possible effects of 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            on 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            (Fig. 1
                           ): 
                              
                                 (1)
                                 for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       >
                                       1
                                    , 
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                     is positive, and the diffusive in Eq. (22) is forward, which decreases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     down to 1;

for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       <
                                       1
                                    , 
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                     is negative, and the diffusive in Eq. (22) is backward, which increases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     to 1.

However, as reported in  [28], velocity 
                              
                                 
                                    V
                                 
                                 
                                    ℜ
                                 
                              
                            only has limited control of level set function gradients, especially at locations far away from the zero level set. Furthermore, as shown in Fig. 1, the magnitude of diffusive rate for 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            close to 0 is extremely large. This will cause oscillations in the level set function, which can distort the structural boundaries. These points will be further demonstrated in Section  5.

To overcome this issue, we can maintain distance property 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              q
                            in the vicinity of the zero level set, meanwhile forcing the level set function to be a constant at locations far away from the zero level set. That is, 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                            should have two minimum points: 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              0
                            and 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                              =
                              q
                           . The definition of 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            (or 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                           ) is not unique, i.e., all functions which have two minimum points of 0 and 
                              q
                            can be used as 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                           . One possible choice of 
                              r
                              
                                 (
                                 
                                    |
                                    ∇
                                    ϕ
                                    |
                                 
                                 )
                              
                            is 
                              
                                 (26)
                                 
                                    r
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                             −
                                             q
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            which yields 
                              
                                 (27)
                                 
                                    ℜ
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                             −
                                             q
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    Ω
                                    .
                                 
                              
                           
                        

The functional 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            is minimized such that 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            can be increased or decreased to be close to one of the minimum points. The diffusive rate is calculated as 
                              
                                 (28)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       −
                                       q
                                       )
                                    
                                    
                                       (
                                       2
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       −
                                       q
                                       )
                                    
                                    .
                                 
                              
                           
                        

The property of the diffusive rate indicates three possible effects of 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            on 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                           : 
                              
                                 (1)
                                 for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       <
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                    , 
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                     is positive, and the diffusive in Eq. (22) is forward, which decreases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     down to 0;

for the case where 
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       <
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       <
                                       q
                                    , 
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                     is negative, and the diffusive in Eq. (22) is backward, which increases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     to 
                                       q
                                    ;

for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       >
                                       q
                                    , 
                                       
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                          )
                                       
                                     is positive, and the diffusive in Eq. (22) is forward, which decreases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     down to 
                                       q
                                    .

To make clear the comparison with reported results in other references where re-initialization procedures are employed, we set 
                              q
                            to 1. Therefore, the used functional is 
                              
                                 (29)
                                 
                                    ℜ
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                |
                                                ∇
                                                ϕ
                                                |
                                             
                                             −
                                             1
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    Ω
                                 
                              
                            and the corresponding diffusive rate is 
                              
                                 (30)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       (
                                       2
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       −
                                       1
                                       )
                                    
                                    .
                                 
                              
                           
                        

This implies the following, as shown in Fig. 2
                           : 
                              
                                 (1)
                                 for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       <
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    , the diffusive decreases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     down to 0;

for the case where 
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       <
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       <
                                       1
                                    , the diffusive increases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     to 1;

for the case where 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                       >
                                       1
                                    , the diffusive decreases 
                                       
                                          |
                                          ∇
                                          ϕ
                                          |
                                       
                                     down to 1.

To further demonstrate the effect of 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                            on maintaining the desired shape of 
                              ϕ
                           , we evolve the level set function (11) by using only the diffusive term, i.e.,  
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                            in Eq. (22) is set to 0. The level set function 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            is defined on an 80×160 grid, and 
                              c
                            is set to 10, as shown in Fig. 3
                           (a). The final level set functions after evolution of 50, 100 and 200 iterations are shown in Fig. 3(b), (c) and (d), respectively. At the zero level set of the initial level set function, the value of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            is greater than 1. Therefore, the diffusion is forward, which decreases the value of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            to 1. At other areas of the level set function, the value of 
                              ϕ
                            is constant. As a result, the diffusion is forward, which keeps the value of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            equal to 0.


                           Fig. 3(d) shows that the final level set function becomes a signed distance function in a band around the zero level set. The width of the band is controlled by the constant 
                              c
                           , and equals 
                              2
                              c
                            (theoretically). In a real application, the magnitude of 
                              c
                            must be controlled. A very small 
                              c
                            may make the zero level set disappear. The effect of 
                              c
                            on the final topology will be explored later.

A most commonly used optimization problem for structural topology optimization is the minimum compliance design, the purpose of which is to find the optimal layout so that the mean compliance is minimized while satisfying the volume constraint. The optimization problem can be specified as 
                           
                              (31)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          J
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                D
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                u
                                             
                                             )
                                          
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                u
                                             
                                             )
                                          
                                          H
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          d
                                          Ω
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          V
                                          o
                                          l
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                D
                                             
                                          
                                          H
                                          
                                             (
                                             ϕ
                                             )
                                          
                                          d
                                          Ω
                                          ≤
                                          V
                                          o
                                          
                                             
                                                l
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          a
                                          
                                             (
                                             
                                                u
                                             
                                             ,
                                             
                                                v
                                             
                                             ,
                                             ϕ
                                             )
                                          
                                          =
                                          l
                                          
                                             (
                                             
                                                v
                                             
                                             ,
                                             ϕ
                                             )
                                          
                                          ,
                                          
                                          f
                                          o
                                          r
                                          
                                          a
                                          l
                                          l
                                          
                                          
                                             v
                                          
                                          ∈
                                          U
                                       
                                    
                                 
                              
                           
                         where 
                           U
                         denotes the space of kinematically admissible displacement fields, 
                           
                              v
                           
                         denotes the arbitrary virtual displacement in the space 
                           U
                        , and 
                           
                              u
                           
                         denotes the actual displacement field. 
                           a
                           
                              (
                              
                                 u
                              
                              ,
                              
                                 v
                              
                              ,
                              ϕ
                              )
                           
                         and 
                           l
                           
                              (
                              
                                 u
                              
                              ,
                              ϕ
                              )
                           
                         are the energy bilinear form and linear form, respectively, which can be expressed as 
                           
                              
                                 (32)
                                 
                                    l
                                    
                                       (
                                       
                                          u
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       f
                                    
                                    
                                       u
                                    
                                    H
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    d
                                    Ω
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       b
                                    
                                    
                                       u
                                    
                                    δ
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       |
                                       ∇
                                       ϕ
                                       |
                                    
                                    d
                                    Ω
                                 
                              
                              
                                 (33)
                                 
                                    a
                                    
                                       (
                                       
                                          u
                                       
                                       ,
                                       
                                          v
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          v
                                       
                                       )
                                    
                                    H
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    d
                                    Ω
                                 
                              
                           
                         where 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                         and 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                              
                           
                         denote the elasticity tensor and the strain tensor, respectively. 
                           
                              f
                           
                         and 
                           
                              b
                           
                         are the body forces and the boundary tractions, respectively on the boundary 
                           Γ
                           ≡
                           ∂
                           Ω
                        . 
                           δ
                           
                              (
                              ϕ
                              )
                           
                         is the Dirac delta function defined as 
                           
                              (34)
                              
                                 δ
                                 
                                    (
                                    ϕ
                                    )
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             H
                                          
                                          
                                             ϵ
                                          
                                       
                                       
                                          (
                                          ϕ
                                          )
                                       
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 .
                              
                           
                        
                     

In our case, there are no body forces, i.e.,  
                           
                              f
                           
                           =
                           0
                        . The surface load 
                           
                              
                                 F
                              
                              
                                 i
                                 n
                              
                           
                        , which is fixed, is applied at point 
                           i
                         (Fig. 4
                        ). Thus, the sensitivity of Lagrangian 
                           L
                         for the minimum compliance problem can be expressed as  [22]
                        
                           
                              (35)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Γ
                                    
                                 
                                 
                                    (
                                    λ
                                    −
                                    
                                       
                                          E
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 d
                                 s
                              
                           
                         which yields 
                           
                              (36)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 −
                                 λ
                                 +
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

The design domain of a compliant mechanism with single input–output behavior is illustrated in Fig. 5
                        . The displacement is fixed at boundary 
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                         with a unit force 
                           
                              
                                 F
                              
                              
                                 i
                                 n
                              
                           
                         is applied at input port 
                           i
                        . The displacement 
                           
                              
                                 u
                              
                              
                                 o
                                 u
                                 t
                              
                           
                         at output port 
                           o
                         due to 
                           
                              
                                 F
                              
                              
                                 i
                                 n
                              
                           
                         is maximized. For topology optimization of compliant mechanisms, several available objective functions have been established, although a universally accepted formulation does not exist  [55,56]. However, applying those formulations to design compliant mechanisms has a strong tendency to produce de facto hinges. Such de facto hinges make the obtained designs very difficult to fabricate, especially for micro-scale mechanical systems. To lead automatically to the absence of de facto hinges, we introduce the input and output mean compliances into the objective function  [57]. Thus, the optimization problem of compliant mechanisms can be defined as 
                           
                              
                                 (37)
                                 
                                    min
                                    
                                    J
                                    =
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          o
                                          u
                                          t
                                       
                                    
                                    +
                                    α
                                    
                                       
                                          C
                                       
                                       
                                          i
                                          n
                                       
                                    
                                    +
                                    β
                                    
                                       
                                          C
                                       
                                       
                                          o
                                          u
                                          t
                                       
                                    
                                 
                              
                              
                                 (38)
                                 
                                    s.t.
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    H
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    d
                                    Ω
                                    ≤
                                    V
                                    o
                                    
                                       
                                          l
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                 
                              
                              
                                 (39)
                                 
                                    a
                                    
                                       (
                                       
                                          u
                                       
                                       ,
                                       
                                          v
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    l
                                    
                                       (
                                       
                                          v
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    ,
                                    
                                    f
                                    o
                                    r
                                    
                                    a
                                    l
                                    l
                                    
                                    
                                       v
                                    
                                    ∈
                                    U
                                 
                              
                           
                         where 
                           α
                         and 
                           β
                         change with each iteration 
                           k
                         using 
                           
                              (40)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    |
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                o
                                                u
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                                n
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    |
                                 
                                 ,
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    |
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                o
                                                u
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                o
                                                u
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    |
                                 
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                                 n
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 o
                                 u
                                 t
                              
                           
                         are defined as 
                           
                              (41)
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       i
                                    
                                 
                                 d
                                 Ω
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       o
                                       u
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       o
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       o
                                    
                                 
                                 d
                                 Ω
                              
                           
                         where 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 o
                              
                           
                         are displacement fields due to 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 o
                              
                           
                        , respectively. 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 i
                              
                           
                         is the load vector of 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                        , which is a unit force applied at input port 
                           i
                         of the design domain when output port 
                           o
                         is unrestrained. 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 o
                              
                           
                         is the load vector of 
                           
                              
                                 f
                              
                              
                                 o
                              
                           
                        , which is a unit force applied at output port 
                           o
                         of the design domain when input port 
                           i
                         is unrestrained.

The shape sensitivity of the Lagrangian 
                           L
                         can be simply obtained as 
                           
                              (42)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Γ
                                    
                                 
                                 
                                    (
                                    λ
                                    +
                                    
                                       
                                          E
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    −
                                    α
                                    
                                       
                                          E
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    −
                                    β
                                    
                                       
                                          E
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 d
                                 s
                              
                           
                         which yields 
                           
                              (43)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 −
                                 λ
                                 −
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 +
                                 α
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 +
                                 β
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For more details, please refer to  [57].

The ENO2 (second order essentially nonoscillatory scheme)  [31] is employed for the discrete solution of the Hamilton–Jacobi equation with the following update equation 
                        
                           (44)
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                              +
                              Δ
                              t
                              
                                 [
                                 max
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       +
                                    
                                 
                                 +
                                 min
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       −
                                    
                                 
                                 ]
                              
                           
                        
                      in which the specific forms of 
                        
                           
                              ∇
                           
                           
                              +
                           
                        
                      and 
                        
                           
                              ∇
                           
                           
                              −
                           
                        
                      can be found in  [30] (p. 66).

The proposed method not only eliminates the costly re-initialization but also simplifies the initialization of the level set function, i.e., more general functions can be used as the level set function. Here we use the binary step function (11) as 
                        
                           
                              ϕ
                           
                           
                              0
                           
                        
                     . To avoid the value of the level set function at a certain area becoming uncontrollable, peak values of the level set function are controlled using 
                        
                           (45)
                           
                              ϕ
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          c
                                       
                                       
                                          if  
                                          ϕ
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          >
                                          c
                                       
                                    
                                    
                                       
                                          −
                                          c
                                       
                                       
                                          if  
                                          ϕ
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          <
                                          c
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Note that if a 
                        
                           
                              H
                           
                           
                              1
                           
                        
                     -regularization operator is applied to regularize the velocity field  [22], the above mentioned peak values control scheme might be unnecessary.

In this section, examples are presented to demonstrate the validity of the proposed method. The artificial material properties are described as follows. Young’s modulus for solid material is 
                        E
                        =
                        1
                      and Poisson’s ratio is 
                        υ
                        =
                        0.3
                     . The void area is assumed with a Young’s modulus 
                        E
                        =
                        0.001
                      and the same Poisson’s ratio 
                        υ
                        =
                        0.3
                     . The design domain is discretized by square finite elements. Both the values of 
                        Δ
                        x
                      and 
                        Δ
                        y
                      are set to 1.

For the convergence criteria, the optimization terminates if all of the following three conditions are satisfied: 
                        
                           (1)
                           The difference between the current volume and the required value 
                                 V
                                 o
                                 
                                    
                                       l
                                    
                                    
                                       m
                                       a
                                       x
                                    
                                 
                               is within 0.005;

The previous five objective function values are all within a 1% tolerance of the current objective value;

The current loop number equals a pre-defined number of steps 
                                 
                                    
                                       k
                                    
                                    
                                       l
                                       o
                                       o
                                       p
                                    
                                 
                              . Unless stated, 
                                 
                                    
                                       k
                                    
                                    
                                       l
                                       o
                                       o
                                       p
                                    
                                 
                               is set to 100.

A Michell type structure with fixed–fixed supports, which is called the bridge structure, is considered in this section. The design domain is shown in Fig. 6
                        . The ratio of the length and height of the design domain is 
                           2
                           :
                           1
                        . The left bottom corner and the right bottom corner are fixed. A single vertical load 
                           
                              
                                 F
                              
                              
                                 i
                                 n
                              
                           
                           =
                           1
                         is applied at the center point of the bottom of the design domain. A volume ratio of 0.2 is considered. The design domain is discretized using 100×50 finite elements for the elastic analysis.

Optimized results obtained using other methods, such as the discrete level set method (DLSM)  [27] and the SIMP method  [58], are shown in Fig. 7
                        .

In this section, the effect of the initial level set function 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            on the performance optimal structure is explored. We first use a signed distance function as 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                           , and then the binary step function. 
                              
                                 •
                                 
                                    Signed distance function
                                 

For the case where 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            is a signed distance function, Fig. 8
                            displays the optimization process of the bridge problem. The corresponding evolution process of the level set function is shown in Fig. 9
                           . The initial topological guess with 18 holes is shown in Fig. 8(a). The corresponding level set function is initialized as a signed distance function (Fig. 9(a)) using the re-initialization scheme proposed in  [31]. Compared to Fig. 7, the use of the proposed method can obtain nearly identical topology, as shown in Fig. 8(f).


                           Fig. 9 shows that, due to the energy functional 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                           , the level set function converges to a signed distance in a band around its zero level set, and it is enforced to be a constant at the area far away from its zero level set. The need for a re-initialization procedure has been eliminated.


                           Fig. 10
                            shows the convergence histories of the mean compliance and volume ratio. The actual material usage 
                              V
                              o
                              l
                            can meet the constraint exactly because the Lagrange multiplier 
                              λ
                            is adapted iteratively. Using the proposed method, the mean compliance of the final design is 19.6043. The proposed method can eliminate the need for re-initialization with minimum affect on the outcome of the optimization process. 
                              
                                 •
                                 
                                    Binary step function with different 
                                    
                                       c
                                    
                                 

This section is devoted to the examination of the effect of 
                              c
                            on the final topology when Eq. (11) is used as 
                              ϕ
                           . For the first case, 
                              c
                            is set to 2. The initial topology, which is shown in Fig. 8(a), is reused. Its corresponding binary step function is shown in Fig. 12(a).


                           Fig. 11
                            illustrates the optimization process of the bridge problem. The corresponding evolution process of the level set function is shown in Fig. 12
                           . Comparing Fig. 8(f) to Fig. 11(f), a nearly identical topology is obtained. Fig. 13
                            shows the convergence histories of the mean compliance and volume ratio. The mean compliance of the final design is 19.6722.

The evolution from a binary step function to an optimized design (Fig. 12(f)) can be described as follows. The velocity 
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                            drives the motion of the zero level set toward desired locations, which represent the optimal topology and shape of the structure. Meanwhile, the shape of the level set function is controlled by the velocity 
                              
                                 
                                    V
                                 
                                 
                                    ℜ
                                 
                              
                           . At the beginning of the optimization process, the values of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            are greater than 1 at the structural boundaries. As a result, the diffusion rate is positive, which decreases the values of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                           . For the areas where the values of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            are 0, the diffusion rate is positive, maintaining the values of 
                              
                                 |
                                 ∇
                                 ϕ
                                 |
                              
                            as 0. At the end of the optimization, the level set function converges to a signed distance function in a band around the structural boundaries. This example, again, confirms that the need for a re-initialization procedure has been eliminated.

To demonstrate the advantage of the proposed method over the method proposed in  [28], the bridge problem is resolved by using 
                              ℜ
                              
                                 (
                                 ϕ
                                 )
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    D
                                 
                              
                              
                                 |
                                 |
                              
                              ∇
                              ϕ
                              
                                 |
                                 −
                                 1
                                 |
                              
                              d
                              Ω
                           . 
                              c
                            is set to 2. Fig. 14
                            illustrates the optimization process. The corresponding evolution process of the level set function is shown in Fig. 15
                           . The advantage of the proposed method can be clearly seen when compared to the results shown in Figs. 11, 12, 14 and 15. When using a binary step function as 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                           , the method proposed in  [28] will cause oscillations in the level set function. There are peaks in the final level set function, and these peaks have reduced the smoothness of the structural boundaries, as shown in Fig. 14(f).

To further demonstrate the effect of 
                              c
                            on the optimal results, three cases are studied, in which 
                              c
                            is set to 4, 8 and 16. The three cases generate the same topology structures, which are shown in Fig. 16
                           .

The magnitude of 
                              c
                            does have a significant effect on the shape of the final design, mainly near the boundary of design domain 
                              D
                           . The reason is that, during the optimization procedure, the numerical solution of the strain energy has sharp peaks on the fixed and loaded areas. This makes the velocities in such areas quite large  [59]. As a result, with a large 
                              c
                           , the values of the level set function in such areas will be very large along with the evolution of the optimization process and will ultimately equal 
                              c
                           . The values of the level set function in other areas are less than 
                              c
                           . The converged level set function becomes a signed distance function in a band around the zero level set. The width of the structure is affected by the value of the level set function 
                              c
                           , which makes 
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                            and leads to small changes in the optimized structure, as shown in Fig. 16(c). This can be solved by restricting 
                              c
                            to a limited value, or by cutting off peak values of the sensitivity of a compliance response function  [59].

For the case where 
                              c
                              =
                              4
                           , the optimized design is obtained with a compliance value of 
                              19.7525
                           , better that the one obtained with a large 
                              c
                           , e.g.,  
                              c
                              =
                              8
                            (20.3060) and 
                              c
                              =
                              16
                            (21.2142). A natural question is, what is the range of 
                              c
                            that will ensure an accurate optimal solution? From our experiments, we have found that 
                              c
                            can be set to 
                              2
                              Δ
                              x
                              ≤
                              c
                              ≤
                              6
                              Δ
                              x
                            to maintain the stability and accuracy of the optimization process.

Note that the proposed method lacks the ability to generate new holes in the design domain. However, in implementing the proposed method, the ability to nucleate holes can be accomplished using hole nucleation schemes. As an example, we use the bidirectional scheme proposed in  [60] to resolve the bridge problem.

The bi-directional evolutionary level set method proposed in  [60] is developed by integrating the standard level set method with an adjusting algorithm inspired by the evolutionary structural optimization method  [12]. In level set-based topology optimization, the level set function can be discretized with grid points centered on the elements of the mesh. The underlying idea of the bi-directional evolutionary level set method is that the plus–minus of the level set function values in specific areas will be adjusted according to a specific criteria. When the topology of the structure contains an excess of material, a nibbling scheme is adopted to change the value of the level set function 
                              
                                 
                                    ϕ
                                 
                                 
                                    j
                                 
                              
                            defined on a specific element 
                              j
                            to be negative if element 
                              j
                            is regarded as an ineffectively used element. This allows new holes to be generated automatically. Furthermore, when the topology of the structure contains very little material, i.e., the volume is much smaller than the required volume, an additive scheme will be adopted to extend the structural boundary.

The nibbling scheme is mainly used to insert holes in a separate step of the optimization process. In this manner, topological complexity will be altered. The nibbling scheme will be performed, i.e., the topological complexity will be altered, only if the current volume is considerably greater than the required volume, i.e.,  
                              V
                              o
                              l
                              ≥
                              
                                 (
                                 1
                                 +
                                 ζ
                                 )
                              
                              V
                              o
                              
                                 
                                    l
                                 
                                 
                                    m
                                    a
                                    x
                                 
                              
                           . In this section, 
                              ζ
                            is set to 0.1, 
                              c
                            is set to 3, and 
                              
                                 
                                    k
                                 
                                 
                                    l
                                    o
                                    o
                                    p
                                 
                              
                            is set to 200.

The optimization process is shown in Fig. 17
                           , and the corresponding level set function evolution process is shown in Fig. 18
                           . Fig. 19
                            shows the convergence histories of the mean compliance and the volume ratio. When incorporating with hole nucleation schemes, optimized configurations can be obtained without the need for an initial topology with a certain number of holes.

As a very weak initial topology is used (Fig. 17(a)), the compliance is very large in the first iteration. The compliance function decreases with the increasing usage of material for the first 50 iterations. Due to drastic topology changes, such as boundary merging or breaking, there are fluctuations in both compliance and volume ratio for the first 80 iterations. However, the function finally converges in a smooth and stable manner.

This optimization problem is also a well-known example in the literature of topology optimization. The design domain is shown in Fig. 20
                        . The ratio of the length and height of the design domain is 1:1. The left side of the design domain is fixed. A single vertical load 
                           
                              
                                 F
                              
                              
                                 i
                                 n
                              
                           
                           =
                           1
                         is applied at the right bottom corner of the design domain. A volume ratio 0.3 is considered. 
                           c
                         is set to 3.

This section is devoted to examining the effect of the finite element mesh size on the optimization configurations obtained. Three cases are examined in which the mesh size is restricted to 40×40, 80×80 and 150×150, respectively.


                           Fig. 21
                            displays the optimized configuration and the corresponding level set surface plot for each case. All obtained optimized configurations are smooth, clear and have the same topology. The final level set surface of each case exhibits the shape of a signed distance function in a band around the structural boundaries and a flat shape outside the band. An appropriate optimized topology can be obtained by using the proposed method regardless of which mesh size is used.

Eqs. (15)–(17) indicate that coefficient 
                              ω
                            of the energy functional 
                              ℜ
                            is determined by the CFL number 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                           . According to  [31], a common choice for 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                            is 0.5 to ensure the stability of the optimization process.

To further demonstrate the effect of 
                              ω
                            (or 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                           ) on the optimization process, we perform the topology optimization of a short cantilever for two different cases with values of 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              0.2
                           , and 1. The mesh size is restricted to 80×80.

For the case where 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              0.2
                           , the optimization process is shown in Fig. 22
                           , and the corresponding level set functions are shown in Fig. 23
                           . For the case where 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              1
                           , the optimization process is shown in Fig. 24
                           , and the corresponding level set functions are shown in Fig. 25
                           . The final optimized solutions are nearly identical to that those obtained in Section  5.2.1 by using 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              0.5
                           .

However, when 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                            is set to 0.2, the signed distance property of the level set function cannot be precisely maintained (Fig. 23). This has a direct impact on the smoothness of the structural boundaries (Fig. 22(f)). However, a large 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                           , e.g.,  
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              1
                           , can cause oscillations in the level set function (such as shown in Fig. 25(c)), which may affect the stability of the optimization process. To ensure both the stability and the regularizing effects of the energy functional, 
                              
                                 
                                    ϑ
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ℜ
                                       
                                    
                                 
                              
                              =
                              0.5
                            is recommended.

The effect of different initial configurations upon the resulting optimized configuration is examined by using the initial configurations with different number of holes inserted. The fixed design domain is discretized using 80×80 elements for finite element analysis. Two cases are studied in which the number of holes inserted is set to 4 and 64, respectively. Fig. 26
                            shows two cases and their obtained optimized configurations.

For all studied cases, the obtained optimized configurations are clear and almost the same. Thus, the dependency of the obtained optimized configurations upon the initial configurations is extremely low.

For the compliant mechanisms design problem, a push gripper is considered. The design domain of the push gripper is shown in Fig. 27
                        . The ratio of the length and height of the design domain is 
                           2
                           :
                           1
                        . The left top corner is fixed. A single horizontal load 
                           F
                           =
                           1
                         is applied at the left bottom corner of the design domain. A vertical displacement of the outer jaw is maximized. The whole design domain is discretized with 100×50 finite elements in which the gap occupies 40×15 finite elements. Maximal material usage is restricted to 0.25, and 
                           c
                         is set to 3.


                        Fig. 28
                         illustrates the optimization process. Fig. 28(a) represents the initial topology which is defined by using a binary step function as shown in Fig. 29
                        (a). Because we do not use any holes nucleation schemes for this example, a certain number of holes have been preset in the initial design.


                        Fig. 28(f) represents the final topology. Fig. 28(b)–(e) represent some intermediate designs. Topology change is mainly concentrated in the first 20 iterations. Fig. 29(a)–(f) represent the level set surfaces of the intermediate designs. With the evolving level set function, a topology change such as merging can be naturally obtained. The signed distance property of the level set function can be naturally maintained near the structural boundaries without using re-initialization. This demonstrates the ability of the proposed method to eliminate the need for re-initialization.

The optimization model for designing compliant mechanisms can prevent the de facto hinges in the resulting compliant mechanisms not only in the final design but also during the optimization process. There is no doubt that for a given structural material and a given material usage constraint, the hinged compliant mechanisms generally feature much higher flexibility than the family of hinge-free designs. However, hinge-free compliant mechanisms are believed to be superior to the compliant mechanisms that contain hinges in a sense of manufacturability and durability. If a hinge-free compliant mechanism with higher flexibility is required, the designer can resort to using more compliant structural material as proposed in Ref.  [55].


                        Fig. 30
                         shows the convergent curves of 
                           
                              
                                 u
                              
                              
                                 o
                                 u
                                 t
                              
                           
                         and 
                           V
                           o
                           l
                        . Fig. 31
                         shows the convergent curves of 
                           
                              
                                 C
                              
                              
                                 i
                                 n
                              
                           
                        , 
                           
                              
                                 C
                              
                              
                                 o
                                 u
                                 t
                              
                           
                        , 
                           α
                         and 
                           β
                        . When 
                           
                              
                                 u
                              
                              
                                 o
                                 u
                                 t
                              
                           
                         increases too high due to the violation of the volume constraint, 
                           
                              
                                 u
                              
                              
                                 o
                                 u
                                 t
                              
                           
                         will change in an opposite direction due to the violation of the input and output mean compliances to avoid generating a disconnected structure.

@&#CONCLUSIONS@&#

A level set method for structural topology optimization with distance-suppression scheme has been developed in this paper. An energy functional is developed and built into the level set equation. This functional is designed to encourage the level set function to be close to a signed distance function near the zero level set. Further from the zero level set, the energy functional maintains the level set function at a constant value. Use of this scheme removes the need for level set re-initialization schemes and allows more efficient and simple initialization of the level set function, i.e., generating a signed distance function as the initial level set function is unnecessary. The validity of the proposed method is examined by solving the mean compliance minimization problem and the compliant mechanisms synthesis problem. The inability to generate new holes still exists when using the proposed method. However, it can be overcome using some hole nucleation schemes.

@&#ACKNOWLEDGMENTS@&#

This research was supported by the National Natural Science Foundation of China (Grant No. 91223201), the Natural Science Foundation of Guangdong Province (Grant No. S2013030013355), Project GDUPS (2010), and the Fundamental Research Funds for the Central Universities (2012ZP0004). This support is greatly acknowledged.

@&#REFERENCES@&#

