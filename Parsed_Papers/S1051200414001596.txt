@&#MAIN-TITLE@&#Reducing over- and under-estimation of the a priori SNR in speech enhancement techniques

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel approach based on two steps, training and correction of a priori SNR.


                        
                        
                           
                           We have applied this proposed approach to the DD and the TS-NR algorithms.


                        
                        
                           
                           This new approach has given two new algorithms for noise reduction and speech enhancement.


                        
                        
                           
                           The new algorithms are based on a bias-compensated of the a priori SNR estimate.


                        
                        
                           
                           Intensive experiments have shown the efficiency of the proposed algorithms and approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Speech enhancement

Noise reduction




                     A priori SNR




                     A posteriori SNR

SNR cells

Spectral distortion

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

The problem of enhancing speech degraded by uncorrelated additive noise has been widely studied in the past and is still an active field of research. Although background and applications differ largely, a specific class of these methods is essentially based on the SNR estimation that is used with a gain function to correct the corrupted speech signal. In practice, the deficiency of speech acquisition and transmission system results a speech signal commonly corrupted by noise. The contamination of the speech not only affects its audio quality but also reduces the performance of high-level speech processing applications such as voice communication and automatic speech recognition where efficient noise reduction techniques are required. Depending of the application, the goal of the speech enhancement techniques is to reduce the noise to make the speech intelligible, to decrease annoyance or to improve the overall sound quality. The most challenging case is the single-channel speech enhancement where only a single noisy speech recording is available for recovering the clean speech. Many algorithms have been proposed to solve this problem, such as spectral subtraction (SS) [1], minimum-mean square error (MMSE) estimator [2,3], and Wiener filter based algorithms [4,5]. Such noise reduction techniques rely mainly on the estimation of a short-time spectral gain which is a function of the a priori SNR and/or the a posteriori SNR computed on each frequency component. In [6], the authors highlighted the interest of estimating the a priori SNR thanks to the “decision-directed” (DD) approach initially proposed in [2]. This DD approach has then received a lot of attention due to its low computational complexity and good performance in various noise reduction applications. Unfortunately, the DD approach suffers from inherent errors (or bias) in estimating the spectral SNRs. Such errors affect directly the estimation of the short-time spectral gain, and inaccuracies in estimating the gain function often lead to spectral attenuation (i.e., enhanced spectral components are smaller in magnitude than corresponding clean spectral components) and/or spectral amplification (i.e., enhanced spectral components are larger in magnitude than corresponding clean spectral component). Consequently, the output speech intelligibility may be impacted by the presence of these two kinds of distortions.

A first source of bias in the a priori SNR estimate is due to the one-frame delay bias introduced by the decision-directed estimator. This behavior has been analyzed in [5] where the authors have demonstrated that the a priori SNR estimate follows the shape of the a posteriori SNR with a one frame delay in regions of high a priori SNR. Consequently, since the spectral gain depends on the a priori SNR, it does not match the current frame and thus the performance of the noise suppression system is degraded especially at transient periods (speech to non-speech or non-speech to speech). To reduce this effect, a Two-Step Noise Reduction algorithm (TS-NR) has been proposed in [7] that refines the estimation of the a priori SNR. By suppressing the frame delay bias, the TS-NR algorithm removes some of the drawbacks of the DD approach while maintaining its advantage, i.e. a highly reduced musical noise level. Such algorithm has been selected by ITU-T in 2008 as the optional post-filter in the standardized G.711.1 (multi-rate wide-band extension for the well-known ITU-T G.711) to reduce the lower band quantization noise at the decoder [8].

Recently, a second source of bias in the a priori SNR estimate has been identified in [9]. To assess the impact of SNR and gain over- and under-estimation on speech intelligibility, the authors in [9] conducted listening tests with different biased spectral gain function. More precisely, by assuming perfect a priori knowledge of the short-time versions of the a priori SNR, such a bias was introduced by including a bias in the a priori SNR estimation. Listening tests indicated that SNR and gain-function over-estimation errors in frequency bins with negative SNR are particularly harmful to speech intelligibility. Furthermore, the authors suggested that better methods are needed to estimate the spectral SNR from noisy observations, particularly at low input SNR levels. Such methods hold promise for improving speech intelligibility.

In this work, we focus on the problem of over- and under- estimation of the spectral SNR from noisy observations. The proposed correction technique is applied to DD- and TS-SNR Wiener filters but it could also be applied to any recent MMSE based techniques relying on more than the a priori and a posteriori SNR estimates [10–13]. Starting with the same experiments as those presented in [9]. We consider a baseline noise reduction filter which is implemented as a short-time Wiener filter combined with a DD approach for the estimation of the a priori SNR. By assuming perfect a priori knowledge of the evolution of the short-time SNR, we have analyzed the over- and under-estimation errors of the a priori SNR. However, as oppose to [9], we do not introduce a known bias in the a priori SNR estimation. Instead we use a well-known technique such as the DD approach for the estimation of the a priori SNR and we analyze the SNR bias by comparing this SNR estimate with the perfect a priori knowledge of the evolution of the short-time SNR. By processing several noisy speech sentences from a training database and analyzing the SNR bias for all frequency bins within all short-time frames, we thus obtain an empirical estimate of the 2-dimensional distribution of the SNR bias as a function of two main parameters: the a priori and the a posteriori SNRs. Once this 2-D bias distribution is available, we applied a k-means clustering method (Lloyd's algorithm) to segment the 2-D plane (a priori SNR and a posteriori SNR parameters) into m clusters in which each observation (i.e. the bias) belongs to the cluster with the nearest mean. This results into a partitioning of the a priori-a posteriori SNR space in m Voronoi cells. The mean estimation error in each cluster is then used as bias correction terms of the a priori SNR for all features belonging to that cluster in the 2-D-space. Moreover, it might be worth mentioning that each frequency bin of the estimated SNR is corrected independently according to the estimated bias by the new method that we propose in this paper.

The remainder of this paper is organized as follows. Section 2 presents a brief description of speech enhancement techniques that operate in the frequency domain. Then, we focus our analysis on the considered approach which corresponds to a combination of the DD approach and the two step noise reduction (TS-NR) algorithm. The bias effect in the DD a priori SNR estimator is then studied in Section 3. The probability density function of this bias is analyzed in a 2-D space driven by the a posteriori and a priori SNR parameters. Also in this same Section 3, we deal with the partition of the 2-D plane into m clusters in order to retain the main properties of the bias information. We then proposed in Section 4 a refinement of the noise reduction technique in which the DD and TS-NR a priori SNR estimates are modified according to the mean value (i.e. bias) of the error observed in the corresponding cluster. Simulations are carried out in Section 5 to assess the performance of the proposed technique. Objective evaluation in various environmental conditions show that the proposed modification approach is advantageous, particularly for low input SNRs. Excellent noise reduction can be achieved even in the most adverse noise conditions, while avoiding musical residual noise and the attenuation of weak speech components.

In the additive noise model, the clean speech 
                        s
                        (
                        n
                        )
                      is corrupted by an independent noise signal 
                        d
                        (
                        n
                        )
                      with zero-mean. The resulting noisy speech 
                        y
                        (
                        n
                        )
                      is given in the time domain by
                        
                           (1)
                           
                              y
                              (
                              n
                              )
                              =
                              s
                              (
                              n
                              )
                              +
                              d
                              (
                              n
                              )
                           
                        
                      where n is the discrete time index. To obtain the clean speech from the noisy one, conventional noise reduction techniques used a noise reduction filter whose impulse response 
                        g
                        (
                        n
                        )
                      is designed to produce an enhanced speech 
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                        (
                        n
                        )
                      corresponding to a trade-off between noise reduction and speech distortion. At the output of this filter, the enhanced speech is expressed as
                        
                           (2)
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              n
                              )
                              =
                              g
                              (
                              n
                              )
                              ⁎
                              y
                              (
                              n
                              )
                           
                        
                      where ⁎ is the convolution operator. The residual noise signal 
                        e
                        (
                        n
                        )
                      is defined as the difference between clean and enhanced speech. Incorporating (1) and (2), the residual noise signal is defined as:
                        
                           (3)
                           
                              e
                              (
                              n
                              )
                              =
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              n
                              )
                              −
                              s
                              (
                              n
                              )
                              =
                              
                                 [
                                 g
                                 (
                                 n
                                 )
                                 −
                                 δ
                                 (
                                 n
                                 )
                                 ]
                              
                              ⁎
                              s
                              (
                              n
                              )
                              +
                              g
                              (
                              n
                              )
                              ⁎
                              d
                              (
                              n
                              )
                              ,
                           
                        
                      where 
                        δ
                        (
                        n
                        )
                      is the Kronecker delta function. Considering that the observed signal 
                        y
                        (
                        n
                        )
                      is divided into overlapping frames by the application of a window function, and analyzed using the short-time Fourier transform (STFT), the time domain residual noise can be equivalently expressed in the frequency domain as:
                        
                           (4)
                           
                              e
                              (
                              p
                              ,
                              k
                              )
                              =
                              
                                 
                                    
                                       
                                          [
                                          G
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          −
                                          1
                                          ]
                                       
                                       S
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                    ︸
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          S
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                 
                              
                              +
                              
                                 
                                    
                                       G
                                       (
                                       p
                                       ,
                                       k
                                       )
                                       D
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                    ︸
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                 
                              
                           
                        
                      where k represents the frequency bin index, and p the frame index. 
                        S
                        (
                        p
                        ,
                        k
                        )
                     , 
                        D
                        (
                        p
                        ,
                        k
                        )
                      and 
                        G
                        (
                        p
                        ,
                        k
                        )
                      represent the kth spectral component of the short-time frame p of the speech signal 
                        s
                        (
                        n
                        )
                     , noise 
                        d
                        (
                        n
                        )
                     , and noise reduction filter 
                        g
                        (
                        n
                        )
                     , respectively. The two quantities 
                        
                           
                              e
                           
                           
                              s
                           
                        
                        (
                        p
                        ,
                        k
                        )
                      and 
                        
                           
                              e
                           
                           
                              D
                           
                        
                        (
                        p
                        ,
                        k
                        )
                      represent respectively, the Kth spectral components of the short-time frame p of the speech and the noise distortions amounts. From (4), it can be seen that the spectral gain function 
                        G
                        (
                        p
                        ,
                        k
                        )
                      has a significant impact on the speech signal and the noise components energies. This relation (4) does well highlight the trade-off between speech and noise reduction. This is because 
                        G
                        (
                        p
                        ,
                        k
                        )
                      affects such speech components and noise equally. The higher the degree of noise suppression, the higher is the amount of speech distortion 
                        
                           
                              e
                           
                           
                              s
                           
                        
                        (
                        p
                        ,
                        k
                        )
                     . The choice of the distortion measure (which can be modeled by the a priori SNR estimation methods) determines the gain behavior, i.e. the trade-off between noise reduction factor and speech distortion. Such a trade-off is found in the so-called spectral subtraction technique [1] that produces low distortion in the enhanced speech signal at the expense of a high level of musical noise leading to a very poor global quality from a subjective point of view.

However, most noise reduction techniques based on short-time spectral modifications of the noisy speech spectra require the evaluation of two main parameters: the a posteriori and the a priori SNRs, respectively defined by:
                        
                           (5)
                           
                              γ
                              (
                              p
                              ,
                              k
                              )
                              =
                              
                                 
                                    
                                       |
                                       Y
                                       (
                                       p
                                       ,
                                       k
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                 
                              
                           
                        
                      and
                        
                           (6)
                           
                              ξ
                              (
                              p
                              ,
                              k
                              )
                              =
                              
                                 
                                    
                                       |
                                       S
                                       (
                                       p
                                       ,
                                       k
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                 
                              
                           
                        
                      where 
                        
                           
                              λ
                           
                           
                              D
                           
                        
                        (
                        p
                        ,
                        k
                        )
                        =
                        E
                        [
                        
                           
                              |
                              D
                              (
                              p
                              ,
                              k
                              )
                              |
                           
                           
                              2
                           
                        
                        ]
                      stands for the noise power spectral density (PSD), and the notation 
                        E
                        [
                        •
                        ]
                      denotes the expectation operator. As usually assumed when considering spectral modification based noise reduction techniques, the DFT coefficients are considered as independent across time and frequency. In practical implementations of speech enhancement systems, the speech and noise PSDs are unknown since only the noisy speech spectrum 
                        Y
                        (
                        p
                        ,
                        k
                        )
                      is available. Thus, both the a posteriori and the a priori SNRs have to be estimated. The estimation of the noise PSD is beyond the scope of this paper. It can be practically estimated during speech pauses using a conventional recursive estimator [1] or continuously using either the Minimum Statistics [14] technique or the Minima Controlled Recursive Averaging approach [15] to get a more accurate estimate in case of noise level fluctuations. In the following we will assume that such noise PSD is available for each short-time frame and that it will be denoted 
                        
                           
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              D
                           
                        
                        (
                        p
                        ,
                        k
                        )
                     . Once a noise power spectral density estimate is available, the spectral gain 
                        G
                        (
                        p
                        ,
                        k
                        )
                      is obtained in most noise reduction techniques by a function
                        
                           (7)
                           
                              G
                              (
                              p
                              ,
                              k
                              )
                              =
                              f
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 )
                              
                           
                        
                      depending on the chosen distortion measure (which can be modeled by the a priori SNR estimation). The function 
                        f
                        (
                        •
                        )
                      can be selected among the different spectral gain functions proposed in the literature (e.g. amplitude or power spectral subtraction [1], MMSE STSA [2], MMSE LSA [3], Wiener filtering [4], OM LSA [16]. The resulting speech spectrum is then estimated by applying the spectral gain to the noisy spectrum
                        
                           (8)
                           
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              p
                              ,
                              k
                              )
                              =
                              G
                              (
                              p
                              ,
                              k
                              )
                              Y
                              (
                              p
                              ,
                              k
                              )
                              .
                           
                        
                     
                  

It should be noted that conventional noise reduction techniques hold some shortcomings. It has been shown that the spectral gain 
                        G
                        (
                        p
                        ,
                        k
                        )
                      will reach the asymptotic values of 0 or 1 when the SNR is 0 or infinity. However, it is extremely unlikely that the gain will ever reach the value of 1. Therefore, for a given frame, if noise is not present in a frequency component, this component will still be attenuated. This is especially true for speech components that are well below the noise level. They are suppressed along with the noise by conventional noise reduction techniques.

In the rest of the paper, we will focus our analysis on a specific noise reduction scheme combining the “decision directed estimator” (DD) and the two step noise reduction (TS-NR) algorithm. The main properties of these two techniques will be briefly recalled in the following subsections.

Assuming an estimate 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 D
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         of the noise PSD is available at each short-time frame, we define the a posteriori SNR estimate as follows
                           
                              (9)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          |
                                          Y
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                         This relation to corresponds to a local SNR computed from the data in the current short-time frame. It can be noted that given the noise variance, the a posteriori SNR is not estimated but known at each frame. The so-called a priori SNR estimator represents the information on the unknown spectrum magnitude gathered from previous frames and is evaluated in the “decision-directed” approach [2] by
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       
                                          DD
                                       
                                       )
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 max
                                 
                                 
                                    {
                                    β
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             p
                                             −
                                             1
                                             ,
                                             k
                                             )
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                D
                                             
                                          
                                          (
                                          p
                                          ,
                                          k
                                          )
                                       
                                    
                                    +
                                    (
                                    1
                                    −
                                    β
                                    )
                                    P
                                    
                                       [
                                       
                                          (
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          −
                                          1
                                          )
                                       
                                       ]
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          min
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         As 
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         defined by (9), is not necessarily greater than one, the operator 
                           P
                           [
                           .
                           ]
                        , in (10), is a function which guarantees that 
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 (
                                 
                                    DD
                                 
                                 )
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         is always non-negative. In the first term of (10), 
                           
                              
                                 S
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           −
                           1
                           ,
                           k
                           )
                         corresponds to the noiseless signal spectrum value as estimated in the previous frame from relation (8). The a priori SNR estimator (10) represents the information on the unknown spectrum magnitude gathered from previous frames. 
                           
                              
                                 ξ
                              
                              
                                 min
                              
                           
                         is a threshold that limits the a priori SNR of (10) to −20 dB. The choice of the value of parameter β is guided by a trade-off between the degree of smoothing of parameter 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         in noisy areas and the acceptable level of transient distortion brought to the signal (typically this parameter is set to about 0.98). Without loss of generality, in the following, the spectral gain function 
                           f
                           (
                           •
                           )
                         in (7) is selected as the Wiener filter, and then
                           
                              (11)
                              
                                 
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          DD
                                       
                                       )
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             
                                                DD
                                             
                                             )
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             
                                                DD
                                             
                                             )
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                         The approach defined by (9), (10) and (11) is called the DD estimator algorithm. It has been demonstrated in [5] that the DD estimator has interesting properties (the musical noise phenomenon is greatly reduced) but suffers from a one-frame delay. This delay inherent to the DD algorithm is a drawback especially in the speech transients, e.g., speech onsets and offsets. It introduces a bias in gain estimation which limits noise reduction performance and generates either speech distortions (for onsets) or an annoying reverberation effect (for offsets) because the level of the enhanced speech in the previous frame is artificially maintained in the current one due to this one-frame delay.

To enhance the noise reduction process, it is proposed in [5] to refine the a priori SNR estimate in a two-step procedure. This technique is based on the observation that the DD algorithm introduces a one frame delay when the parameter β is close to one. Consequently, the spectral gain computed at current frame p matches the previous frame 
                           p
                           −
                           1
                        . Based on this fact, it is proposed in [7] to compute the spectral gain for the next frame 
                           p
                           +
                           1
                         using the DD approach and to apply it to the current frame because of the frame delay. This leads to a two step procedure algorithm. The first step consists exactly of the decision directed algorithm and a spectral gain 
                           
                              
                                 G
                              
                              
                                 DD
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         is computed as described in (11). In the second step, this gain is re-used to refine the estimate of the a priori SNR as:
                           
                              (12)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             
                                                G
                                             
                                             
                                                (
                                                
                                                   DD
                                                
                                                )
                                             
                                          
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          Y
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

We can notice that the TS-NR approach uses the DD estimator as an intermediate step to compute the output spectral gain (12) that is used in the refinement a priori SNR estimate. Finally, another spectral gain is computed:
                           
                              (13)
                              
                                 
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          TS
                                       
                                       -
                                       
                                          NR
                                       
                                       )
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 h
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    )
                                 
                                 ,
                              
                           
                         which is used to enhance the noisy speech
                           
                              (14)
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          TS
                                       
                                       -
                                       
                                          NR
                                       
                                       )
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 Y
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 .
                              
                           
                         By taking the inverse Fourier transform of (14), the enhanced speech signal is then reconstructed in the time-domain signal using the overlap-add method. Note that function 
                           h
                           (
                           •
                           )
                         may be different from the function 
                           f
                           (
                           •
                           )
                         defined in (7). However, without loss of generality, in the following, this gain will be selected as a Wiener filter, and then
                           
                              (15)
                              
                                 
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          TS
                                       
                                       -
                                       
                                          NR
                                       
                                       )
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ˆ
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             ξ
                                          
                                          
                                             ˆ
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

This algorithm in two steps defined by (9), (10), (12), and (15), is called the TS-NR algorithm. This technique improves the noise reduction performance since the gain matches to the current frame whatever the SNR. The main advantages of this approach are the ability to preserve speech onsets and offsets, and to successfully remove the annoying reverberation effect typical of the DD approach [2,3,5,16,19]. Note that in practice this reverberation effect can be reduced by increasing the overlap between successive frames but cannot be suppressed whereas the TS-NR approach [7] makes it possible with a typical overlap of 50%. Such solution has been selected by ITU-T [8] in 2008 as the optional non-parametric post-filter in the standardized G.711.1.

In this section, we concentrate our analysis on several important properties of the a priori SNR estimate as this parameter plays a central role in spectral noise reduction techniques. As described previously, estimating the a priori SNR through the “decision-directed” approach is widely used (instead of the a posteriori SNR) because it reduces the musical noise to an acceptable level. However, as we shall see, this a priori SNR estimate often leads to an under- or over-estimation of the SNR on each frequency component thus reducing the output speech quality. From a subjective point of view, this SNR's over- or under-estimation is at similar to the same effect as in the onset/offset distortions that are created by the one-frame delayed SNR estimation. It should be noted that the a posteriori SNR is a known quantity (that is, given the noise statistics), and it appears to be simply used in this work as an indicator on how to adjust the a priori SNR estimate - which is unknown.

To better understand the impact of errors in the estimation of these SNRs, we show in Figs. 1 and 2
                        
                         scatter plots of the a posteriori and the estimated a priori SNRs versus the ‘true’ short-time values of the SNR defined as:
                           
                              (16)
                              
                                 ξ
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          |
                                          S
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       p
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

To provide this parameter available for the analysis, we assumed knowledge of the magnitude spectrum of the clean speech signal. It should be stated that the true ideal SNR is unobtainable due to the non-stationarity of the speech signal. In this paper, due to the unavailability of this true SNR, we define the ground truth as given by (16), which is appropriate because any noise reduction filter that uses (16) will provide an enhanced speech signal with high noise reduction level and minimum spectral distortions. As a result, let us consider that the a posteriori SNR (Fig. 1) is obtained from (9), and the a priori SNR estimate (Fig. 2) is obtained by relations (10), (11) and (12) using the TS-NR approach (with 
                           β
                           =
                           0.98
                        ). In these figures, for each frame and each frequency, we have represented features (or 2-tuples) considered as a point in the two-dimensional space defined by the two SNRs, namely the SNR (estimated a priori or known a posteriori) and ‘true’ SNR defined by (16) which is considered as a reference. Moreover, to focus the analysis on the behavior of the SNR estimators for speech components, only features (about 
                           900
                           ×
                           257
                         features) corresponding to speech activity periods are represented on this figure. In this experiment, the frame length is 
                           L
                           =
                           256
                         for a sampling frequency of 8 kHz. Each of the noisy signal frames are Hanning windowed with a 50% overlap and transformed in the frequency domain with a 2L-point FFT to avoid distortions resulting from the circular convolution effect [27]. The overall input SNR is 13 dB and the background noise is babble. To evaluate the performance of each estimator, the bold line corresponds to a perfect SNR estimator (i.e. zero estimation error) that can be used as a reference. The upper triangular part of this figure corresponds to an over-estimation of the true SNR (respectively under-estimation in the lower-triangular part).

From Figs. 1 and 2, it is obvious that the features corresponding to the a posteriori SNR parameter are closer to the reference bold line and are less dispersed than the a priori SNR estimator ones. This is especially true for high signal-to-noise ratio values. Furthermore, to provide mean behavior analysis, we have also represented on Fig. 1 and Fig. 2 the conditional expectations of the two estimated SNRs given the knowledge of the true SNR 
                           ξ
                           (
                           p
                           ,
                           k
                           )
                         which are obtained as follows:
                           
                              (17)
                              
                                 
                                    E
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                    |
                                    ξ
                                    )
                                    =
                                    
                                       ∫
                                       R
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          Ξ
                                          |
                                          P
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                    |
                                    ξ
                                    )
                                    d
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              
                                 
                                    E
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                    |
                                    ξ
                                    )
                                    =
                                    
                                       ∫
                                       R
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ϒ
                                          |
                                          P
                                       
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                    |
                                    ξ
                                    )
                                    d
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 Ξ
                                 |
                                 P
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 ϒ
                                 |
                                 P
                              
                           
                         are the conditional probability density functions of the estimated SNR knowing the true SNR. We can observe that the conditional mean of the estimated SNR is closer to the perfect estimator for the a posteriori SNR parameter than for the a priori SNR estimator. The available a posteriori SNR values can be viewed as slightly underestimated for high SNR whereas for the a priori SNR the underestimation is large for SNR greater than −17 dB. However, since the dispersion is high for the a priori SNR features, even if the mean is largely underestimated, the case where SNR features are overestimated exists. Furthermore, for SNR smaller than −17 dB, the a priori SNR is overestimated.

Let us now examine the behavior of the bias in the a priori SNR estimate as a function of the value of the parameter β in the decision-directed loop (10). To do so, Fig. 3
                         compares for speech activity periods the conditional mean (17) of the a priori SNR estimate for β ranging from 0.3 to 0.98.

For frequency bins with low SNR values, we see that the bias increases with decreasing β. The 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                         value is over-estimated by as much as 20–40 dB at extremely low (<40 dB) SNR levels. A value of β near one provides the highest noise reduction, while avoiding the musical noise. However, it comes at the expense of a reduction in intelligibility, because important speech transitions are excessively smoothed [6]. On the other end, as β tends to zero, the behavior of the conditional mean curve of the a priori SNR estimate tends to mimic the one of the a posteriori SNR presented in Fig. 1 but this is obtained at the expense of a musical noise which is introduced in the enhanced speech. On the contrary, for frequency bins with high SNR (greater than 0 dB) the bias in the a priori SNR estimate is decreasing with increasing values of β. This bias analysis provides a more comprehensive understanding of the important role of the a priori SNR estimate in noise reduction problems and is in agreement with other experimental observations [5,17].

The results confirm that the a posteriori SNR parameter is more reliable than the a priori SNR estimator for high SNR frequency bins (i.e. speech components) but this behavior is obtained at the expense of the insertion of the musical noise in the enhanced speech signal. From these curves, we can predict that the estimation of the spectral gain function (15) will be particularly affected by the perturbations in the a priori SNR values especially in the negative region of the SNR as inaccuracies in the estimation of a priori SNR values (such as under-estimation) directly cause a bias in the gain function (a lower value), thus generating distortion in the output speech.

To go further insight the analysis of the role of a priori SNR estimation within the TS-NR algorithm, we now concentrate on the probability density function of this SNR estimate through its corresponding empirical 2-D histogram which is obtained by counting in Fig. 2 the number of features (or 2-tuples) that fall within each 3 dB × 3 dB area. The obtained normalized histograms are represented in Fig. 4
                         as a function of the a priori SNR estimate and true SNR values.

One can see in Fig. 4 that the 2-D-histogram of the a priori SNR estimate exhibits two distinct kernels or clusters (denoted by the letters A and B) that are defined as maximal sets of connected dense units in the 2-D plane.

In this sense, the empirical histogram corresponds to a mixture density that can be interpreted as being derived in a simple way from an underlying set of other random variables. The connection between these clusters and the inherent properties of the corresponding time-frequency components 
                           Y
                           (
                           p
                           ,
                           k
                           )
                         is made clearer by plotting in Fig. 5
                         the spectrogram corresponding to the same speech segment as the one considered in Fig. 4. On this figure, all frequency components corresponding to cluster B (i.e. 
                           −
                           30
                            dB
                           <
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           <
                           −
                           10
                            dB
                        ) are represented in ‘red’. Note from (15) that such low values of the a priori signal-to-noise ratio may result in a mean value of −20 dB for the short-time spectral gains 
                           
                              
                                 G
                              
                              
                                 (
                                 
                                    TS
                                 
                                 -
                                 
                                    NR
                                 
                                 )
                              
                           
                           (
                           p
                           ,
                           k
                           )
                        . Thus, we can assume that the corresponding frequency bins will be suppressed within the enhanced speech spectrum. From Fig. 4, we can consider that the remaining features belong to cluster A. However, we can conclude from Fig. 5 that the features corresponding to kernel A are mainly related to speech harmonics (rather than noise components) that should be preserved by the spectral noise reduction filter. From the previous analysis of Figs. 4 and 5, we can expect that the performance of the amplitude estimator (14) will greatly depend on the inherent properties of the a priori SNR estimator used. In the TS-NR approach different behaviors may appear when we estimate the a priori SNR from the nonlinear recursive relation (10) in combination with (11) and (12). When 
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         stays below 0 dB, the a priori SNR corresponds to a highly smoothed version of the a posteriori SNR over successive short-time frames. The spectral gain 
                           
                              
                                 G
                              
                              
                                 (
                                 
                                    TSNR
                                 
                                 )
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         in such conditions is lower than −24 dB (as seen for cluster B) and does not exhibit large variations over successive short-time frames. As a consequence, the musical noise phenomenon is reduced. On the contrary, when 
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         is much larger than 0 dB, the a priori SNR is no longer a smoothed SNR estimate. Its short-time evolution follows the one of the a posteriori SNR (cluster A). Such property is particularly important in the case of non-stationary signals.

It should be noted that this behavior of the noise reduction filter remains true if the spectral noise reduction gain function 
                           
                              
                                 G
                              
                              
                                 (
                                 
                                    TSNR
                                 
                                 )
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         in (15) is replaced by another suppression rules ([2–4], and [14]), evaluated as a function of the decision-directed a priori SNR estimate.

In this section, we address the problem of improving the SNR estimation. Several attempts have been made in the past to modify noise reduction techniques. Some of them have tried to modify the short-time spectral gain in a data-driven approach [18,19], or to propose alternative analytical suppression rules [20,21]. Other studies propose new approaches for the a priori SNR estimate such as robust estimators [22,23], or noncausal estimators [24]. However, as seen previously, the a priori SNR estimation represents a crucial parameter and suffers from over- or under-estimation errors thus leading to a local sub-optimal solution for the noise reduction filter. In this section, we aim to design a more accurate a priori SNR estimator that solves the drawbacks of the conventional estimator in order to reduce speech distortion while retaining a high level of noise attenuation in speech absence. In this section, we describe our strategy that relies on the optimization of the mean square error (MSE) in the a priori SNR estimate.

As the two contributing SNR components of the conventional decision-directed approach are two direct observations of the true SNR 
                           ξ
                           (
                           p
                           ,
                           k
                           )
                        , we can symbolically write
                           
                              (18)
                              
                                 ξ
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 T
                                 
                                    {
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    }
                                 
                                 .
                              
                           
                         where the analytical expression of function 
                           T
                           (
                           •
                           )
                         is unknown. However, its main properties can be recovered from the analysis of the correspondence between the experimental time-frequency series 
                           z
                           (
                           p
                           ,
                           k
                           )
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           )
                         and the true a priori SNR 
                           ξ
                           (
                           p
                           ,
                           k
                           )
                        . Assuming a priori knowledge of the short-time versions of 
                           ξ
                           (
                           p
                           ,
                           k
                           )
                         in a training phase, we can thus consider in the rest of the analysis that function 
                           T
                           (
                           •
                           )
                         is known from an experimental point of view. To investigate the impact of the estimation errors, we consider the error in the a priori SNR estimate:
                           
                              (19)
                              
                                 e
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 ξ
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 −
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 T
                                 
                                    {
                                    z
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    }
                                 
                                 −
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 p
                                 ,
                                 k
                                 )
                                 =
                                 H
                                 
                                    {
                                    z
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    }
                                 
                              
                           
                         which is expressed as a function 
                           H
                           (
                           •
                           )
                         of the available a posteriori and the estimated a priori SNRs parameters. For the same reason as previously discussed for 
                           T
                           (
                           •
                           )
                        , the function 
                           H
                           (
                           •
                           )
                         can be assumed known from an experimental point of view. The optimization process can be realized by minimizing the mean-squared error (MSE), defined as 
                           J
                           =
                           E
                           {
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           }
                           =
                           ∬
                           d
                           J
                         where 
                           d
                           J
                         stands for the infinitesimal MSE defined as:
                           
                              (20)
                              
                                 d
                                 J
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 z
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       Z
                                    
                                 
                                 (
                                 z
                                 )
                                 d
                                 σ
                                 ,
                              
                           
                         where 
                           d
                           σ
                         is the area differential and 
                           
                              
                                 f
                              
                              
                                 Z
                              
                           
                           (
                           z
                           )
                         denotes a probability density function (that will be estimated by its corresponding normalized 2-D-histogram). By integrating locally the infinitesimal MSE (20) on small surfaces (of 3 dB × 3 dB), we obtain in Fig. 6
                         the behavior of the parameter 
                           d
                           J
                         in the 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           )
                         plane. Notice, that the infinitesimal MSE is represented in decibel in this figure. We can see that the random variable 
                           e
                           (
                           p
                           ,
                           k
                           )
                         is dominated by two main behaviors: over-estimation errors are introduced for negative values of 
                           d
                           J
                         (expressed in dB) in spectral components with negative a priori and a posteriori SNR. In contrast, for spectral components with 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           >
                           10
                            dB
                        , the decision-directed and/or TS-NR approaches cause over-estimation errors (positive values in dB). These results are in agreement with the conditional mean analysis presented previously in Fig. 1. On the high-left and low-right corners in Fig. 6, we note that some combinations of the SNRs are highly unlikely and may not often enough have occurred during the training (for clarity of the representation, these points have been assigned a 0 dB value in this figure).

To describe our strategy, our goal is to propose a new a priori estimator 
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           =
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           −
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         which reduces over- and under-estimation errors 
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                           =
                           E
                           {
                           
                              
                                 ε
                              
                              
                                 2
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           }
                         where 
                           ε
                           (
                           p
                           ,
                           k
                           )
                           =
                           ξ
                           (
                           p
                           ,
                           k
                           )
                           −
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           (
                           p
                           ,
                           k
                           )
                        . The correction term 
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         can be viewed as a bias compensation mechanism for the conventional a priori SNR estimate 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                        . However, for each frequency bin within each frame, deriving an analytical optimal expression for the compensation factor 
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         is difficult. As pointed in [18], correcting fully for the bias is difficult because of the nonlinear feedback loop in the decision-directed approach. Instead, our strategy consists in searching in the 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           )
                         plane for the centroidal Voronoi tessalation 
                        
                           
                              
                                 {
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                         (with generators 
                           
                              
                                 z
                              
                              
                                 i
                              
                           
                        ) and bias compensation factors 
                           
                              
                                 Δ
                              
                              
                                 i
                              
                           
                         that constitute the set 
                           {
                           (
                           
                              
                                 Δ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                           )
                           ∈
                           R
                           ×
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           ⋯
                           ,
                           m
                           }
                         such that
                           
                              (21)
                              
                                 
                                    
                                       J
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       ∫
                                       ∫
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 z
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       Z
                                    
                                 
                                 (
                                 z
                                 )
                                 d
                                 σ
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       ∫
                                       ∫
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                 
                                    
                                       (
                                       e
                                       (
                                       z
                                       )
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       Z
                                    
                                 
                                 (
                                 z
                                 )
                                 d
                                 σ
                              
                           
                         is minimized.

A sub-optimal solution to this problem can be obtained by using an iterative procedure such as the Lloyd–Max algorithm [25]. Starting, at time 
                           t
                           =
                           0
                        , with an initial set of generators 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                        , we iterate the following steps:


                        Step 1: Construct the Voronoi constellation 
                        
                           
                              
                                 {
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                         from previous generators 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       t
                                       −
                                       1
                                       )
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       z
                                       (
                                       p
                                       ,
                                       k
                                       )
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                    
                                       ‖
                                       z
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       ‖
                                    
                                    <
                                    
                                       ‖
                                       z
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       ‖
                                    
                                    ,
                                    j
                                    ≠
                                    i
                                    }
                                 
                              
                           
                         
                        Step 2: Compute the new bias compensation factors such that 
                           ∂
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                           /
                           ∂
                           
                              
                                 Δ
                              
                              
                                 i
                              
                           
                           =
                           0
                        . The optimal solution is obtained as the mean value of the error 
                           e
                           (
                           p
                           ,
                           k
                           )
                        :
                           
                              (23)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 E
                                 
                                    [
                                    
                                       e
                                       (
                                       z
                                       )
                                       |
                                    
                                    z
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    ]
                                 
                              
                           
                         
                        Step 3: Take the mass centroids of 
                           
                              
                                 {
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                         as the new set of generators:
                           
                              (24)
                              
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 +
                                 1
                                 )
                                 =
                                 E
                                 
                                    [
                                    
                                       z
                                       (
                                       p
                                       ,
                                       k
                                       )
                                       |
                                    
                                    z
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∬
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       z
                                       
                                          
                                             f
                                          
                                          
                                             Z
                                          
                                       
                                       (
                                       z
                                       )
                                       d
                                       σ
                                    
                                    
                                       
                                          
                                             ∬
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             Z
                                          
                                       
                                       (
                                       z
                                       )
                                       d
                                       σ
                                    
                                 
                                 .
                              
                           
                        
                     

This procedure is continued until global convergence is reached, i.e. until some stopping test criterion is fulfilled. In this work, the algorithm is stopped when further iteration no longer produce any changes in the mean-squared error 
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                           =
                           E
                           {
                           
                              
                                 ε
                              
                              
                                 2
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           }
                         or when changes are below a suitable threshold fixed by the user. In this case, an extra-computation time can be observed as the run time is depending on the selected number of clusters. As for all Lloyd–Max algorithms, the initialization of generator's values plays an important role for both the convergence speed and the asymptotic precision and many solutions have been proposed in the literature to initialize the Lloyd–Max's algorithm. As our main interest in this work is not related to the optimization of the convergence speed of the training phase, we used a simple uniform 2-D-rectangular grid (from −30 to +30 dB on each dimension, 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                         and 
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                        ) for the initial set of generators at time 
                           t
                           =
                           0
                        .

It should be noted that the considered approach is expected to improve the MMSE estimates as far as the SNR values that have been used as reference informations are perceptually better than the estimated values, In addition, as there is a bias between the estimated and the reference SNRs, we attempt to correct for this bias so that we get closer to these desirable reference values, whether or not they are the true/optimal values.

In the previous sections (even in Section 4.2), we have studied the estimation inaccuracies in the a priori SNR by assuming that speech is almost always present in the observation signal. As a consequence, all the previous figures were obtained from noisy speech samples corresponding to speech activity periods (we used a handmade ideal speech detector). However, in reality, speech pauses are always present in the observation signal and this uncertainty should be taken into account in the proposed bias compensation approach. Given two hypotheses, 
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         and 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         which indicate respectively speech absence and presence in the kth frequency bin of the pth frame, we have:
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             :
                                          
                                          
                                             Y
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             =
                                             D
                                             (
                                             p
                                             ,
                                             k
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             :
                                          
                                          
                                             Y
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             =
                                             S
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             +
                                             D
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         The problem we face now is how to incorporate this information into the bias-corrected noise reduction algorithm that has been described in the previous Section 4.1. This problem can be easily solved by considering two different sets of parameters 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                         during the training procedure, each being optimized during speech absence 
                           (
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           )
                         or presence 
                           (
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           )
                         in the observed frequency bins. A pseudocode program of the complete training algorithm including uncertainty of speech observation is shown in Algorithm 1
                        . In this algorithm, we use the following definition:
                           
                              
                                 
                                    
                                       x
                                       (
                                       t
                                       )
                                    
                                    ¯
                                 
                                 
                                    
                                       |
                                    
                                    
                                       t
                                       ∈
                                       A
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       |
                                       A
                                       |
                                    
                                 
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       A
                                    
                                 
                                 x
                                 (
                                 t
                                 )
                              
                           
                         to express the arithmetic mean operating on a given set of indices (
                           |
                           A
                           |
                         denotes the cardinality of 
                           A
                        ).

As previously described, a learning procedure is proposed to estimate the bias compensation parameters 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                        . For training, we used a speech material which consists of 30 phonetically-balanced sentences recorded for the NOIZEUS database and freely available from the Website of the University of Texas at Dallas. These sentences (15 males and 15 females) were originally sampled at 25 kHz and downsampled to 8 kHz. Noisy speech files were generated by artificially adding noise to the original clean speech. Noticing that in the previous Sections 4.1 and 4.2, the time-varying Fourier coefficients of each process (noise, clean and noisy speech) were considered as (zero-mean) statistically independent random variables (as this is usually the case for a majority of speech-enhancement algorithms operating in the frequency domain), the previous assumptions are actually equivalent to the assumption that the Fourier coefficients are uncorrelated (in practice they will be correlated to a certain degree). Consequently, in the learning phase, only stationary white noise was added to the clean speech data to generate noisy speech at overall SNRs ranging from −15 dB to +25 dB, in steps of 5 dB.

Once the training database is available, the previously described training procedure consisting of the combination of (22), (23) and (24) is run on the entire noisy speech database in order to estimate the parameters 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                           
                        . The block diagram of this procedure is depicted in Fig. 7
                        .

An illustration of the resulting Voronoi partition available at the end of training phase is depicted in Fig. 6 for 
                           m
                           =
                           100
                         clusters. To obtain this figure, we used the following experimental parameters: a Hamming window with a 50% overlap for spectral analysis, and a rectangular window for synthesis for the DFT-based noise reduction algorithm. One notes in Fig. 6 that the previous training procedure generates dense areas of cells that occur when the a posteriori SNR approaches 0 dB.

Once the parameters 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                         are known at the end of the ‘training’ phase, our aimed is to propose a bias-compensated noise reduction approach that can be implemented as an enhancement in the DD noise reduction (Proposition I) or in the TS-NR noise reduction algorithm (Proposition II). As shown in the top-level block diagram of Fig. 8
                        , the proposed system is built on a two-stream procedure [18].

It consists in running two algorithms in parallel. From relations (10), (9) or (12), a conventional DD (Proposition I) or TS-NR (Proposition II) algorithm is first run in the background to obtain a pair of estimated SNRs 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           )
                         in each frame and in each frequency bin. Then, a second a priori estimate 
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           =
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           −
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         is computed leading to a bias-corrected SNR estimate. For each frequency bin k in each short-time frame p, the value of the bias compensation factor 
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         is selected according to the current value 
                           z
                           (
                           p
                           ,
                           k
                           )
                         of the estimated SNRs in the z-plane but also on the absence/presence of speech in the considered frequency bin. A pseudocode for the computation of 
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         is given by,
                           
                              
                                 If 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    p
                                    ,
                                    k
                                    )
                                    =
                                    ‘
                                    
                                       true
                                    
                                    ’
                                  
                                 then
                                 
                                    
                                       
                                          i
                                          =
                                          
                                             arg
                                          
                                          
                                          
                                             
                                                min
                                             
                                             
                                                j
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                m
                                             
                                          
                                          
                                          
                                             |
                                             z
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                             |
                                          
                                          
                                          and
                                          
                                          Δ
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          =
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              


                                 Else
                                 
                                    
                                       
                                          i
                                          =
                                          
                                             arg
                                          
                                          
                                          
                                             
                                                min
                                             
                                             
                                                j
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                m
                                             
                                          
                                          
                                          
                                             |
                                             z
                                             (
                                             p
                                             ,
                                             k
                                             )
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             |
                                          
                                          
                                          and
                                          
                                          Δ
                                          (
                                          p
                                          ,
                                          k
                                          )
                                          =
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              


                                 End
                              

Once the bias correction factor 
                           Δ
                           (
                           p
                           ,
                           k
                           )
                         is known, the final spectral noise reduction filter and the output speech reconstruction is another stream that uses 
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         in (15) in place of 
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                        . This procedure guarantees an improvement in terms of the 
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                         error criterion (21), because the first stream which performs the DD or TS-NR a priori SNR estimate is left untouched (free-running algorithm). Without loss of generality, we present hereafter results obtained for the Wiener spectral gain. A pseudocode program of the complete testing algorithm including uncertainty of speech observation is described in Algorithm 2
                        . All computations are embedded into loops over all frequency indices k and all frame indices p. During our first quality test experiments under various noise conditions, we note that, in non-stationary babble noise, the SNR estimator with bias compensation factors (23) was sensitive to noise bursts that are not tracked by the noise power estimation algorithm. To obtain full potential of the proposed method, we replace (23) by the following rule which tracks the minimum value of the error estimate within each cluster:
                           
                              (25)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    min
                                    
                                       z
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 
                                 H
                                 (
                                 z
                                 )
                                 .
                              
                           
                        
                     

Using these modified compensation factors, informal listening tests demonstrate that the enhanced signals had much less speech distortion. It should also be noted that the specific properties of the spectral gain are automatically taken into account during the ‘training/learning’ phase of the proposed bias-compensation approach (see Section 4.3). The degree of compensation of the a-priori SNR bias is indeed adjusted according to the experimental differences observed between the true a priori-SNR values and the a-priori SNR estimates obtained by the considered speech enhancement estimator. In that sense, the proposed bias-compensation mechanism can be considered as a global optimization method that takes into account the intrinsic properties of the speech enhancement estimator, i.e. the gain function (Wiener gain, .... etc).

@&#EXPERIMENTAL RESULTS@&#

In this section, the performance of the two proposed approaches is compared to that of the ‘conventional’ DD as well as TS-NR approaches. The bias-compensated approach is applied in two configurations, namely the ‘conventional’ DD and the TS-NR a priori SNR estimators previously described in Section 2. These two new techniques will be hereafter called Propositions I and II corresponding to the combination of the bias-compensated approach together with respectively (10) or (12). For testing, the speech material consists of a different set of speech sentences in comparison with the learning database. We have used different noise/speech samples in the learning/testing parts to show that the proposed method can work even in the worst case when different databases are used in the learning (Section 4.3) and testing phases. Doing so, general conclusions could be drawn in this section (without bias due to a specific choice of the learning/validation databases).

For testing, the sentences were taken from the AURORA database [26] (different from the training one). The performance of the two proposed approaches (Propositions I and II) is evaluated in different noise environments with noise signals (white, babble, street and F16-aircraft noise) taken from the Signal Processing Information Base (SPIB) and freely available on the Rice University homepage. These noise files were originally sampled at 19.98 kHz and recorded from 
                        1
                        /
                        
                           
                              2
                           
                           
                              ″
                           
                        
                      B&K condenser microphone onto digital audio tape (DAT). Combining the clean speech and the noise test signals, noisy speech utterances in each environment are obtained for testing. The noisy speech signals were sampled at 8 kHz and all the test sets are prepared for 0, 5, 10, 15, 20 dB SNR conditions, respectively. In this section, the parameters of the noise reduction system are kept unchanged (256 samples per frame, overlap between frames of 50%, Hanning windowing, FFT length of 512 points and overlap-add technique for reconstruction). For all experiments, the decision-directed a priori SNR estimate (10) is computed with a parameter β set to 0.98.

We recall here that the training procedure that it will be used to correct the conventional DD and TS-NR algorithms (Proposed I and Proposed II) corresponds to the different steps that have been previously described in Section 4.3 (Also, see block diagram in Fig. 7 for more understanding of the training phase).

To highlight the influence of the number of cells on the behavior of the proposed noise reduction approach, we show in Figs. 9 and 10
                        
                         scatter plots of the proposed a priori SNR estimate vs. true a priori SNR values for two different values of the global input SNR, respectively 0 dB and 10 dB.

For the sake of brevity, results are given for the bias compensated TS-NR approach (Proposition II) but similar results have been observed when combining the proposed bias compensation approach with the ‘conventional’ DD a priori estimator (Proposition I). On these figures, the gray points represent the features 
                           u
                           =
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           ξ
                           )
                         corresponding to 850 frames of speech activity periods. Only frames corresponding to speech activity periods are represented. As discussed earlier, the proposed bias-compensated a priori SNR given by 
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           =
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                           −
                           
                              
                                 Δ
                              
                              
                                 i
                              
                           
                         is obtained by introducing the two sets of compensation factors 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                         into the ‘conventional’ a priori SNR estimators (DD or TS-NR) as previously described in Sections 2.1 and 2.2 respectively, (for the training phase, refer to Section 4.2).

The diagonal bold solid line corresponds to a perfect SNR estimator that can be used as a reference and the thin lines represent the conditional mean of the proposed bias-compensated a priori SNR estimates obtained through (17). These curves are given for different number of cells, i.e. 5, 10, 50, 150, 350 and 500 cells.

We may note in Fig. 9 that increasing the number of cells in the 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           )
                         plane provides a significant improvement of the a priori SNR estimation. By comparing Figs. 9 and 10 with the conditional mean obtained previously with the “conventional” TS-NR method (see Fig. 2), it is clear that increasing the number of cells drastically reduces the bias in the a priori SNR estimate. For example, in the case of 150 cells, one notes that the proposed a priori SNR estimate is getting closer to the perfect SNR estimator (bold line). However, the estimated values are slightly over-estimated for true SNR values in the range −40 dB to −12 dB, whereas they are slightly under-estimated for SNR values greater than 20 dB. Referring to Figs. 9 and 10, we see that this behavior still holds for lower values of the input global SNR. It is clear that the obtained conditional mean behaviors of the a priori SNR are closer to the perfect estimator line as the number of cells is large (i.e. case of 150–500 classes). In the following, the total number of cells will be set to 
                           m
                           =
                           150
                         as this value realize an efficient trade-off between performance (i.e. low bias) and complexity.

We now compare the proposed bias-compensated a priori SNR estimates (Propositions I and II) computed as described in Section 4 with conventional approaches such as the decision-directed (DD) [2] and TS-NR techniques [7]. We first consider in Fig. 11
                         an experiment with a USASI (United States of America Standards Institute) noise that has been added to the speech signal at a SNR of 0 dB. On this figure, we have plotted the conditional mean evaluated from (17) for the estimated a priori SNRs obtained with the DD, the TS-NR and our proposed bias-compensated approaches (Propositions I and II) versus the true a priori SNR for 100 frames of speech activity periods. It is obvious that the proposed techniques provide a significant improvement of the a priori SNR estimation when the number of used cells is chosen sufficiently large. We can also notice that the proposed method outperforms conventional algorithms such that the DD and TS-NR techniques. This is mainly due to fine segmentation of the 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           )
                         plane in the bias-compensated approach that allows for the estimation of the local bias in each cell to be more accurate and thus the new a priori SNR to be very close to the true value (i.e. the error shift values tend to zero) for instantaneous SNR ranging from −20 dB to +10 dB. Moreover, as far as the local SNR on a frequency bin is greater than −15 dB, the proposed bias-compensated approach yielded the best performance compared to competitive algorithms that can be considered as the state of the art in the noise reduction field (i.e. the conventional DD estimator and the TS-NR algorithm).

In a second experiment (see Fig. 12
                        ), we consider a high SNR condition. The scaling factor between the clean speech and noise signals was changed to reach a global input SNR of 15 dB. Here again we observe the same behavior as the one described previously for the case of low input SNR (Fig. 11). Similar improvements were also noted with other input SNR levels (i.e. input SNR = 0 dB, 3 dB, 10 dB … , etc), and with different types of noise (white noise, USASI noise, F16 aircraft noise, street noise, and babble noise). We can thus conclude on the superiority of the proposed bias-compensated technique in comparison with the two other conventional techniques, i.e. DD and TS-NR. This superiority will be confirmed in Section 5.3 by through the evaluation of four objective criteria of the proposed approach (i.e. Proposed I and Proposed II).

We now concentrate on the influence of a priori SNR estimation accuracy in the output speech quality of the corresponding noise reduction systems. To do so, we have conducted intensive experiments to compare the proposed bias-compensated approach with the ‘conventional’ TS-NR [7] and DD algorithms [2]. To compare these algorithms, several objective criteria are considered: the Normalized Covariance Metric (NCM) criterion, the Coherence Speech Intelligibility Index (CSII) criterion, the Signal-to-Noise Ratio loss (SNRloss) [30], and the Perceptual Evaluation of Speech Quality (PESQ) measure [28,29], which has been found to correlate highly with speech quality in the context of noise-corrupted speech processed via noise suppression algorithms. To evaluate these four criteria, we have used different segments of randomly selected speech sentences from a wide real corpus measured in France Telecom audio research laboratory (testing database) which is commonly used for evaluating the output speech quality of speech coders for ITU-T tests. This speech database consists in phonetically balanced double sentences (input level −26 dBovl) with relatively low word-context predictability. Clean speech utterance sequences were composed of 6 utterances from 4 speakers (2 male and 2 female) totaling 24 utterances. The speech segments were originally sampled at 16 kHz and then downsampled to 8 kHz with silence periods at the beginning (to estimate the noise PSD) and at the end of each sentence. These sentences were corrupted by the previously described noises, namely, white noise, USASI noise, F16 aircraft noise, babble noise, and street noise. All theses noises were downsampled at 8 kHz and quantized at 16 bits. The signal to noise ratio was adjusted by means of the speech voltmeter (ITU-T Recomill.yahoo.frmendation P.56). All the parameters of the noise reduction systems (frame length, overlap, FFT size, ...) are kept unchanged (see Section 5).


                        Table 1
                         compares a modified version of the normalized covariance metric (NCM) measure which corresponds to a speech-based transmission index (STI) measure that has been specifically modified to predict the intelligibility of nonlinearly-processed speech via hearing-aid algorithms or noise-suppression. The SNR in each frequency band is computed from the estimate of the normalized covariance determined from the envelopes of the noise-free and enhanced signals (output of the speech enhancement system) in each frequency band. We select the modified implementation of the NCM measure proposed in [29] which uses signal-dependent weighting functions and performed substantially better than the conventional NCM measure which uses fixed (for all speech stimuli) weights.


                        Table 1 provides the modified NCM criterion values obtained with the four noise reduction approaches (DD and TS-NR with/without bias compensation) and for three levels of the global input SNR, i.e. 0 dB, 5 dB, and 10 dB. The column indicated as “UN” shows the scores obtained with noise-corrupted (unprocessed) stimuli, the columns indicated as “DD” and “TS-NR” show the baseline scores obtained with the ‘conventional’ enhancement algorithms, while the columns indicated as “PropI” and “PropII” show the results obtained with the proposed bias compensated approaches, respectively DD compensated and TS-NR compensated. We observe a large gap between the NCM measures obtained with the two conventional techniques and the NCM measures obtained with the proposed algorithms. Moreover, in comparison with the ‘conventional’ algorithms, we see that the two proposed bias-compensated noise reduction algorithms (Propositions I and II) produce an enhanced speech signal with the highest speech intelligibility for all five types of noise tested and for all SNR levels proposed. These results are in agreement with the fact that the enhanced signals sounded much clearer and with much less speech distortion than output speech signals provided by conventional techniques. According to a listening test, the output speech signal quality, obtained with the two proposed algorithms (Proposed I and II), is more harmonic with high frequency content and more vowels sounds.

The previous conclusions, obtained from the NCM criterion evaluation (see Table 1), are also confirmed when examining the results obtained with the center-clipping intelligibility index (CSII) [29]. The CSII measure is a spectral-based speech intelligibility measure, which is computed by using the magnitude squared coherence between the noise-free and enhanced signals (output of the speech enhancement system) in each frequency band. The results are presented in Table 2
                         for the considered noise reduction algorithms and for global input SNRs of 0 dB, 5 dB and 10 dB. As for the previous NCM measure, the proposed bias-compensated noise reduction algorithms (PropI and PropII) outperform the conventional DD and TS-NR approaches. As the modified CSII and NCM measures incorporating signal-specific weighting information have been found to perform the best in terms of predicting speech intelligibility in noise, the obtained speech signals with the proposed methods, i.e. Proposed I and Proposed II, have been highly improved in terms of intelligibility. This is one of the good characteristic of the proposed methods which provide enhanced speech signals very correlated with the original one.

In Table 3
                        , we have collected the results for the average SNR loss criterion obtained for the previous noise reduction algorithms. The recently proposed SNR loss in [30], corresponds to the difference (expressed in dB) between the excitation spectrum of the clean signal (noise-free speech) in a given frequency band before processing to the excitation of the processed signal (enhanced) in the same critical band [30]. The average SNRloss is finally computed by averaging the critical-band spectral representation of the SNRloss values over all frames and across all bands. One should also note that it is reasonable to expect that as the averaged SNR level increases, the estimated spectrum 
                           
                              
                                 S
                              
                              
                                 ˆ
                              
                           
                           (
                           p
                           ,
                           k
                           )
                         approaches the clean spectrum 
                           S
                           (
                           p
                           ,
                           k
                           )
                         and consequently the average SNR loss tends towards zero. These values are given in Table 3, for three conditions of global input SNR, i.e. 0 dB, 5 dB, and 10 dB. The noisy speech condition has not been evaluated since there is no SNRloss that is introduced by noise suppression algorithm in this case (or equivalently the SNRloss is not meaningful). We can see that the SNRloss characteristics are directly proportional to the level of the input SNR, i.e. the SNRloss decreases as a function of the input SNR. According to these results, it is clear that the proposed bias-compensated algorithms (PropI and PropII) lead to lowest SNRloss at the processing output for all five types of noise tested and for all SNR levels proposed. From the definition of the SNRloss measure, the previous results provide evidence that the estimated spectrum available at the output of the proposed bias-compensated noise reduction technique is much closer to the original speech spectrum (clean speech).

Finally, we consider the perceptual evaluation of speech quality (PESQ) objective measure which has been recommended by ITU-T (Recommendation P. 862) for speech quality assessment of narrow-band handset telephony and speech codecs [31]. Recently, the PESQ measure has also been shown in [28,29], to correlate well with subjective ratings of speech distortion introduced by noise-suppression algorithms. The PESQ is computed as follows. The original signal (clean) and the speech component available at the output of the noise reduction system are first level equalized to a standard listening level and the signals are time aligned to correct for time delays, and then processed through an auditory transform to obtain the loudness spectra.


                        Table 4
                         presents the results of the PESQ measures obtained with the five considered noise reduction algorithms. This experiment was carried out with three levels of the global input SNR, i.e. 0 dB, 5 dB, and 10 dB. From these results, we can easily see that the two proposed bias-compensated noise reduction algorithms perform better than the two others ones. We can say that the results obtained with the PESQ criterion confirm the accuracy and the efficiency of the proposed technique to positively enhance the estimation of the a priori SNR and hence improve the overall quality of the output speech signal.

To conclude this section dedicated to the characterization of the inherent properties of the enhanced speech available at the output of the considered noise reduction algorithms, it is clear that the proposed bias compensated approaches performed the best in terms of speech quality and intelligibility assessments. For all types of noise tested, for all SNR levels proposed and for all objective measures considered in this study, these algorithms performed substantially better than the considered conventional approaches. Such result confirms the interest of the proposed a priori SNR estimation technique which is based on the compensation of the bias over several cells in the two-dimensional 
                           z
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 ˆ
                              
                           
                           )
                         plane. Informal listening tests confirmed that the proposed bias-compensated noise reduction algorithm yielded the highest quality, consistent with the different objective results presented in this section.

@&#CONCLUSION@&#

In this paper we have proposed an original method to analyze and to compensate for the over- and under-estimation of the a priori signal-to-noise-ratio in noise reduction systems. Starting with the conventional decision-directed approach coupled with the two step noise reduction algorithm, we have shown that a large bias can be observed in the estimated a priori SNR which causes serious speech distortion when the weight factor approaches one in speech activity periods when the spectral gain is a Wiener filter [5]. Then, we proposed a new strategy to design a more accurate a priori SNR estimator that solves the drawbacks of the conventional estimator in order to reduce speech distortion while retaining a high level of noise attenuation in speech absence. For each frame and for each frequency bin, this strategy is based on the introduction of a bias compensation mechanism which is implemented on small cells partitioning the two-dimensional plane defined by the estimated a priori and the available a posteriori SNRs. Implemented as two-stream approach in conjunction with the DD or the TS-NR algorithm, this new procedure possess a good ability in predicting the bias term with accuracy and efficiency within each small cell. The proposed strategy is thus able to correct the shortcomings of the DD and TS-NR algorithms. Objective tests confirm that the proposed bias-compensated algorithm performs better than the conventional approaches both in terms of speech quality and intelligibly. Moreover, we believe that the proposed bias-compensation mechanism can be used with any short-time spectral attenuation function in the context of audio and speech enhancement. Further studies will focus on the minimization of the mean-square error in the a priori SNR estimate by optimizing within each cell the tradeoff between the bias term and the variance of the estimator.

@&#REFERENCES@&#

