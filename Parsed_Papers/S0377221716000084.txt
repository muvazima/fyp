@&#MAIN-TITLE@&#Integer programming formulations for the elementary shortest path problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We compare integer programming formulations for the elementary shortest path problem.


                        
                        
                           
                           We describe IP formulations with exponentially-many SECs and MIP extended formulations of polynomial size.


                        
                        
                           
                           We study the polyhedral structure of the two strongest formulations and prove their LP bounds are equivalent.


                        
                        
                           
                           We report computational results for the LP relaxations and for the full branch-and-cut.


                        
                        
                           
                           Formulation with dynamically generated cutset inequalities is the most effective.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Integer programming

Elementary shortest path

Branch-and-cut

Extended formulations

Subtour elimination constraints

@&#ABSTRACT@&#


               
               
                  Given a directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      with arbitrary arc costs, the Elementary Shortest Path Problem (ESPP) consists of finding a minimum-cost path between two nodes s and t such that each node of G is visited at most once. If negative costs are allowed, the problem is 
                        NP
                     -hard. In this paper, several integer programming formulations for the ESPP are compared. We present analytical results based on a polyhedral study of the formulations, and computational experiments where we compare their linear programming relaxation bounds and their behavior within a branch-and-cut framework. The computational results show that a formulation with dynamically generated cutset inequalities is the most effective.
               
            

@&#INTRODUCTION@&#

Given a directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      and arc costs cij
                      for each (i, j) ∈ A, the shortest path problem consists of finding a minimum-cost path between two nodes s and t.

Often, an implicit assumption is that such path has to be elementary. A path is elementary if it does not visit any node more than once, i.e., if it does not contain subtours. When the costs cij
                      induce no negative cycles on G, the problem can be solved efficiently via ad-hoc polynomial time algorithms, like Bellman–Ford’s or Dijikstra’s algorithm (if cij
                      ≥ 0). However, if negative cycles do arise, subtours must be explicitly prevented, leading to the so-called Elementary Shortest Path Problem (ESPP).

The ESPP is clearly 
                        NP
                     -hard due to a simple reduction from the Hamiltonian path problem. Its equivalent maximization counterpart, where one seeks a longest path over a graph with positive cycles, has been vastly discussed in the literature, usually referred to as the Longest Path Problem (LPP). Björklund, Husfeldt, and Khanna (2004) prove that the LPP is hard to approximate on unweighted directed graphs within a ratio of 
                        
                           n
                           
                              1
                              −
                              ϵ
                           
                        
                      for any ϵ, unless 
                        
                           P
                           =
                           NP
                        
                     . For undirected graphs, approximation algorithms are described by, e.g., Karger, Motwani, and Ramkumar (1997) and Gabow (2007).

Related to the ESPP are variants of the Travelling Salesman Problem (TSP) with profits, such as the Prize Collecting TSP (Balas, 1989), the Orienteering Problem (Vansteenwegen, Souffriau, & Oudheusden, 2011) and the Capacitated Profitable Tour Problem (Jepsen, Petersen, Spoorendonk, & Pisinger, 2014), that involve prizes on each node, which can be visited at most once.

While an interesting problem in its own right, the ESPP also arises in the pricing subproblems of branch-and-price algorithms (Amaldi, Coniglio, & Taccari, 2014). Often, the pricing phase in Vehicle Routing Problems (VRP) involves resource-constrained variants of the elementary shortest path problem (ESPPRC) (Irnich & Desaulniers, 2005). These problems are usually solved with fast dynamic programming-based label algorithms, e.g., see Boland, Dethridge, and Dumitrescu (2006); Feillet, Dejax, Gendreau, and Gueguen (2004); Righini and Salani (2006). It is possible to adapt this kind of approach to the unconstrained ESPP by considering an artificial resource for each node which is consumed when the node is visited, and imposing that no more than one unit of each resource is used, as already proposed by Beasley and Christofides (1989); Boland et al. (2006). However, this is a rather weak constraint, in the sense that it allows for very long paths, so that approaches based on label algorithms become very time consuming, as noted by Drexl and Irnich (2014). This limitation is already highlighted for the ESPP with a capacity constraint by Jepsen, Petersen, and Spoorendonk (2008b), that propose a branch-and-cut algorithm that significantly outperforms label algorithms. In the context of a branch-and-price algorithm, where the ESPP is solved repeatedly in the pricing phase, another desirable feature of an integer programming approach is its flexibility, that allows one to easily incorporate general branching decisions or valid inequalities (e.g., the subset-row inequalities by Jepsen, Petersen, Spoorendonk, and Pisinger (2008a)) that would change the structure of the pricing subproblem. These reasons motivate the study of integer programming techniques for the ESPP.

Several branch-and-cut approaches can be found in the literature for related problems (Bauer, Linderoth, & Savelsbergh, 2002; Fischetti, Gonzalez, & Toth, 1998; Gendreau & Laporte, 1998; Jepsen et al., 2014). However, not much previous work has appeared on integer programming approaches tailored specifically for the ESPP. Ibrahim, Maculan, and Minoux (2009) provide computational results on the linear programming (LP) bounds of a flow-based extended formulation, but give no details on its behavior in a branch-and-bound algorithm. Another extended formulation is proposed by Haouari, Maculan, and Mrad (2013). Drexl and Irnich (2014) describe a branch-and-cut approach and compare its efficiency with the extended formulation by Ibrahim et al. (2009), while Drexl (2013) studies the efficient separation of subtour elimination constraints for the ESPP.

In the context of integer programming, the choice of a formulation is crucial for the effectiveness of methods based on branch-and-cut. In this article we present a thorough comparison between different formulations for the ESPP, which are described in detail in Section 2. We include integer programming formulations with exponentially many subtour elimination constraints, and mixed-integer programming extended formulations with a polynomial number of variables and constraints. In Section 3 we provide some analytical results, including a proof of equivalence between the polyhedra described by the two strongest formulations. Section 4 reports computational experiments where we compare the LP relaxation bounds and branch-and-cut results. Finally, in Section 5, we give some concluding remarks and discuss further research topics.

Let us consider a directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      with the set of nodes V and the set of arcs A. Let n and m be the cardinality of V and A, respectively. A path is a sequence of nodes 
                        
                           
                              v
                              1
                           
                           ,
                           …
                           ,
                           
                              v
                              k
                           
                           ,
                        
                      and is said to be elementary if no node appears in the path more than once. A cycle, or tour, is a path with 
                        
                           
                              v
                              1
                           
                           =
                           
                              v
                              k
                           
                        
                     . We denote by 
                        
                           
                              δ
                              +
                           
                           
                              (
                              i
                              )
                           
                        
                      and 
                        
                           
                              δ
                              −
                           
                           
                              (
                              i
                              )
                           
                        
                      the set of outgoing and incoming arcs of node i, by 
                        
                           
                              δ
                              +
                           
                           
                              (
                              S
                              )
                           
                        
                      and 
                        
                           
                              δ
                              −
                           
                           
                              (
                              S
                              )
                           
                        
                      the arcs leaving/entering the set S ⊆ V, and by A(S) the set of arcs with both ends in S ⊆ V. Let us also define Vi
                      ≔ V∖{i}, Vij
                      ≔ V∖{i, j}, and, for any arc set B ⊆ A, we define x(B) ≔ ∑
                        b ∈ B
                     
                     xb
                     . In all the formulations, it is assumed w.l.o.g. that 
                        
                           
                              |
                           
                           
                              δ
                              −
                           
                           
                              
                                 (
                                 s
                                 )
                              
                              |
                              =
                              |
                           
                           
                              δ
                              +
                           
                           
                              
                                 (
                                 t
                                 )
                              
                              |
                              =
                              0
                           
                        
                     .

A standard integer programming formulation to determine a shortest path from node s to node t is the following:

                        
                           (1)
                           
                              
                                 min
                                 
                                    ∑
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                                 
                                    c
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    ∑
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   j
                                                   ,
                                                   i
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                if
                                                
                                                i
                                                =
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                if
                                                
                                                i
                                                =
                                                t
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             else
                                          
                                       
                                    
                                 
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 V
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 1
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 V
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                 
                                 ∀
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 A
                                 ,
                              
                           
                        
                     where 
                        
                           
                              c
                              
                                 i
                                 j
                              
                           
                           ∈
                           R
                        
                      are the arc costs, and xij
                      are binary arc variables that take value 1 if the arc (i, j) belongs to the path. Constraints (2) are flow conservation constraints, while Constraints (3) ensure that the outgoing degree of each node is at most one. When the costs cij
                      induce negative cycles on G, i.e., there is a subtour such that the total cost of its arcs is negative, this system of inequalities is not sufficient to guarantee the elementarity of the path. Thus, additional constraints (and possibly variables) are necessary to prevent subtours.

Notice that the crucial difference with respect to problems in which the path has to be Hamiltonian is the absence of the degree constraints:

                        
                           
                              
                                 
                                    ∑
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       
                                          (
                                          j
                                          ,
                                          i
                                          )
                                       
                                       ∈
                                       
                                          δ
                                          −
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       i
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    V
                                    
                                       s
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     
                  

We now describe different sets of constraints and variables that can be added to Formulation (1)–(4) to obtain a valid integer programming formulation for the ESPP.

For the TSP, success has been achieved with strong formulations with exponentially many constraints. It is possible to write a formulation for the ESPP based on the classical Dantzig–Fulkerson–Johnson subtour elimination constraints (Dantzig, Fulkerson, & Johnson, 1954), adding to the basic formulation (1)–(4) the following inequalities:

                           
                              (5)
                              
                                 
                                    
                                       ∑
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          (
                                          S
                                          )
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       |
                                       S
                                       |
                                    
                                    −
                                    1
                                    
                                    
                                    ∀
                                    S
                                    ⊆
                                    
                                       V
                                       
                                          s
                                          t
                                       
                                    
                                    ,
                                    
                                       |
                                       S
                                       |
                                    
                                    ≥
                                    2
                                    .
                                 
                              
                           
                        In each subset S, subtours are prevented ensuring that the number of arcs in S which are selected is smaller than the number of nodes in S. This formulation includes O(m) variables and O(2
                           n
                        ) constraints.

For Hamiltonian path problems, due to the degree constraints, the DFJ subtour eliminations constraints can be equivalently written in the cutset form:

                                 
                                    (6)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          1
                                          
                                          
                                          ∀
                                          S
                                          ⊂
                                          V
                                          ,
                                          
                                             |
                                             S
                                             |
                                          
                                          ≥
                                          2
                                          .
                                       
                                    
                                 
                              
                           

For the ESPP, Constraints (6) are valid only for subsets S with s ∈ S and t ∉ S. Moreover, they are not sufficient to prevent all subtours.

                                 Example 1
                                 Consider the solution depicted in Fig. 1
                                    , assuming it is a complete graph and that only the arcs with 
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                       
                                     are drawn. The solution does not violate any inequality (6) for any set S containing s, since 
                                       
                                          x
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                          =
                                          1
                                       
                                     for any such S, although it contains a (disconnected) subtour. On the other hand, notice that the inequality (6) is not valid for S′, although it does not contain subtours, due to 
                                       
                                          x
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             
                                                S
                                                ′
                                             
                                             )
                                          
                                          )
                                          =
                                          0
                                       
                                    .

DFJ Constraints (6) can be adapted to the ESPP by replacing the constant right-hand side with a variable expression. This approach is used for a symmetric version of ESPPRC by Jepsen et al. (2008b) and applied to the asymmetric ESPP by Drexl and Irnich (2014). Similar subtour elimination constraints are also used in branch-and-cut algorithms for the VRP (Naddef & Rinaldi, 2002) or variants of the TSP with profits (Fischetti et al., 1998; Jepsen et al., 2014). We refer to them as generalized cutset inequalities (GCS):

                           
                              (7)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    
                                       ∑
                                       
                                          
                                             (
                                             k
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          k
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    S
                                    ,
                                    ∀
                                    S
                                    ⊆
                                    
                                       V
                                       
                                          s
                                          t
                                       
                                    
                                    ,
                                    
                                    
                                       |
                                       S
                                       |
                                    
                                    ≥
                                    2
                                    .
                                 
                              
                           
                        Constraints (7) prevent subtours by ensuring that, for each subset S, the number of selected arcs leaving S is not smaller than the number of selected arcs outgoing from any node in S. In an integer solution, this means that the cut induced by S must contain at least one arc if at least one node in S belongs to the s–t path, while, if S does not contain any node in the s–t path, the constraint is the trivial inequality. The number of variables in the formulation is O(m), while the number of constraints is O(n2
                           n
                        ).

Constraints (7) can be shown to be equivalent to a strengthened version of (5).

                           Proposition 2
                           
                              Constraints 
                              
                                 (7)
                               
                              can be rewritten as:
                              
                                 
                                    (8)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         ∈
                                                         A
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                                ∖
                                                {
                                                k
                                                }
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          S
                                          ,
                                          ∀
                                          S
                                          ⊆
                                          
                                             V
                                             
                                                s
                                                t
                                             
                                          
                                          ,
                                          
                                          
                                             |
                                             S
                                             |
                                          
                                          ≥
                                          2
                                          .
                                       
                                    
                                 
                              
                           

For all k ∈ S, 
                                 
                                    x
                                    
                                       (
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                       )
                                    
                                    ≤
                                    x
                                    
                                       (
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                    =
                                    x
                                    
                                       (
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                    +
                                    x
                                    
                                       (
                                       A
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                    −
                                    x
                                    
                                       (
                                       A
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    x
                                    
                                       (
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       )
                                    
                                    −
                                    x
                                    
                                       (
                                       A
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                 
                              .□

These inequalities can be interpreted as imposing that the number of selected arcs in a subset S is strictly smaller than the number of nodes in S that belong to the s–t path.

To derive an extended formulation à la Miller, Tucker, and Zemlin (1960) (hereafter MTZ) it is enough to introduce, for each node, an auxiliary variable that can be viewed as the position of the node along the path and a constraint for each arc:

                           
                              (9)
                              
                                 
                                    
                                       t
                                       j
                                    
                                    ≥
                                    
                                       t
                                       i
                                    
                                    +
                                    1
                                    +
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                    ,
                                    
                                    i
                                    ≠
                                    s
                                    ,
                                    j
                                    ≠
                                    t
                                    .
                                 
                              
                           
                        For the Asymmetric TSP (ATSP), this formulation is well-known to give poor linear relaxation bounds. However, it is very compact, as it requires only O(m) additional constraints and O(n) auxiliary variables.

From the following nonlinear reformulation of the MTZ formulation:

                           
                              (10)
                              
                                 
                                    
                                       t
                                       j
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          t
                                          i
                                       
                                       +
                                       1
                                       )
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                    ,
                                    i
                                    ≠
                                    s
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       t
                                       j
                                    
                                    
                                       x
                                       
                                          s
                                          j
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          s
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       s
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    
                                       δ
                                       +
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    1
                                    ≤
                                    
                                       t
                                       i
                                    
                                    ≤
                                    n
                                    −
                                    1
                                    
                                    
                                    i
                                    ∈
                                    
                                       V
                                       s
                                    
                                    ,
                                 
                              
                           
                        
                        Haouari et al. (2013) apply a partial Sherali–Adams reformulation-linearization technique (Sherali & Adams, 1990) to obtain the following stronger formulation for the ESPP:

                           
                              (13)
                              
                                 
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       x
                                       
                                          s
                                          j
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      −
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                   ≠
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      ,
                                                      i
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      +
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       β
                                       
                                          j
                                          i
                                       
                                    
                                    =
                                    0
                                    
                                    
                                    
                                       
                                          
                                             
                                                ∀
                                                j
                                                ∈
                                                
                                                   V
                                                   t
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   s
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      −
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      ,
                                                      i
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      +
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       β
                                       
                                          j
                                          i
                                       
                                    
                                    =
                                    0
                                    
                                    
                                    
                                       
                                          
                                             
                                                ∀
                                                j
                                                ∈
                                                
                                                   V
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   s
                                                   ,
                                                   j
                                                   )
                                                
                                                ∉
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                    ,
                                    i
                                    ≠
                                    s
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                    ,
                                    i
                                    ≠
                                    s
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    0
                                    ,
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    0
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                    ,
                                 
                              
                           
                        where the bilinear terms are linearized introducing the variables αij
                         ≔ tjxij
                         and βij
                         ≔ tixij
                         and Constraints (16)–(17). On a given selected arc (i, j) ∈ A, the variables βij
                         and αij
                         can be interpreted respectively as the position of the nodes i and j along the path. This extended formulation requires O(m) constraints and O(m) auxiliary variables.

A formulation similar to the single-flow ATSP formulation of Gavish and Graves (1978) can be obtained introducing an auxiliary flow q to be delivered to the nodes belonging to the s–t path. In addition, variables zk
                         are added to the formulation:

                           
                              (19)
                              
                                 
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             s
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    
                                       q
                                       
                                          s
                                          j
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          
                                             V
                                             s
                                          
                                       
                                    
                                    
                                       z
                                       k
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             i
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       q
                                       
                                          i
                                          k
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          
                                             (
                                             k
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       q
                                       
                                          k
                                          j
                                       
                                    
                                    =
                                    
                                       z
                                       k
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             i
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       z
                                       k
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    0
                                    
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       z
                                       k
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                    .
                                 
                              
                           
                        Constraints (19) impose that the auxiliary flow is positive only over the arcs where 
                           
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              =
                              1
                           
                        . The auxiliary flow leaving from the node s has value equal to the number of nodes that are reached by the s–t path. Constraints (21) ensure that the balance of the auxiliary flow on each node is equivalent to zk
                        , which, according to Constraint (22), is either 1, if node k is in the s–t path, or 0 otherwise.

An extension of the single-flow formulation is obtained by disaggregating the auxiliary flow into 
                           
                              n
                              −
                              1
                           
                         unitary flows. Subtours are prevented by enforcing one unit of a distinct auxiliary flow from s to each node that belongs to the s–t path:

                           
                              (25)
                              
                                 
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                    ≤
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                    ,
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      +
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                    −
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      ,
                                                      i
                                                      )
                                                   
                                                   ∈
                                                   
                                                      δ
                                                      −
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       q
                                       
                                          j
                                          i
                                       
                                       k
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   z
                                                   k
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   i
                                                   =
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      z
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   i
                                                   =
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                else
                                             
                                          
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                ∀
                                                i
                                                ∈
                                                V
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∀
                                                k
                                                ∈
                                                
                                                   V
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             i
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       z
                                       k
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             s
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          s
                                          j
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             (
                                             i
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                    ≥
                                    0
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                    ,
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       z
                                       k
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    
                                       V
                                       s
                                    
                                    .
                                 
                              
                           
                        The formulation includes O(nm) additional variables and constraints. This extended formulation is introduced, for the ESPP, by Ibrahim et al. (2009), and it is very similar to classic multi-commodity flow formulations for the ATSP proposed by Wong (1980) and Claus (1984).

@&#OVERVIEW@&#

In Table 1
                         we summarize the presented formulations. To the best of our knowledge, formulations MTZ and SF have not been previously considered for the ESPP, although similar ones are well known for TSP or VRP variants.

Let us describe some analytical results for the considered ESPP formulations.

                        Proposition 3
                        Formulation MCF is stronger than formulation SF.

Constraints (19)–(21) can be obtained from MCF simply aggregating Constraints (25)–(26) over k ∈ Vs
                           , and then substituting 
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       
                                          V
                                          s
                                       
                                    
                                 
                                 
                                    q
                                    
                                       i
                                       j
                                    
                                    k
                                 
                              
                            with qij
                           . The example in Fig. 2
                            shows that the inclusion is strict.□

Formulation GCS is stronger than formulation DFJ.

The result follows by considering GCS as stated in (8), whose right-hand side is obviously smaller or equal to 
                              
                                 |
                                 S
                                 |
                                 −
                                 1
                                 ,
                              
                            right-hand side in (5), and the inclusion is strict by the example in Fig. 2.□

Showing that formulation MCF is as tight as GCS requires to calculate the projection of the MCF extended formulation into the space of the x variables. We will make use of a strong result presented by Padberg and Sung (1991), and follow a similar approach to the equivalence proofs therein.

                        Theorem 5
                        The projection of the MCF-polytope onto the x-space is equivalent to the GCS-polytope.

Recall that 
                              
                                 
                                    |
                                 
                                 
                                    δ
                                    −
                                 
                                 
                                    
                                       (
                                       s
                                       )
                                    
                                    |
                                    =
                                    |
                                 
                                 
                                    δ
                                    +
                                 
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                    |
                                    =
                                    0
                                 
                              
                           . The variables zk
                            can be projected out of (25)–(31) so that MCF can be rewritten as:

                              
                                 (32)
                                 
                                    
                                       
                                          q
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       ≤
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       
                                       
                                       ∀
                                       k
                                       ∈
                                       
                                          V
                                          s
                                       
                                       ,
                                       
                                       ∀
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       A
                                    
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          q
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       −
                                       
                                          ∑
                                          
                                             
                                                (
                                                j
                                                ,
                                                i
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          q
                                          
                                             j
                                             i
                                          
                                          k
                                       
                                       =
                                       0
                                       
                                       
                                       
                                          
                                             
                                                
                                                   ∀
                                                   i
                                                   ∈
                                                   
                                                      V
                                                      s
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   k
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∀
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                s
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          q
                                          
                                             s
                                             j
                                          
                                          k
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             k
                                          
                                       
                                       
                                       
                                       ∀
                                       k
                                       ∈
                                       
                                          V
                                          s
                                       
                                    
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                j
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          q
                                          
                                             j
                                             k
                                          
                                          k
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             k
                                          
                                       
                                       
                                       ∀
                                       k
                                       ∈
                                       
                                          V
                                          s
                                       
                                    
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             k
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             k
                                          
                                       
                                       
                                       
                                       ∀
                                       k
                                       ∈
                                       
                                          V
                                          
                                             s
                                             t
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                s
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             s
                                             j
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                (
                                                i
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             t
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (39)
                                 
                                    
                                       
                                          q
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       ≥
                                       0
                                       ,
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       0
                                       
                                       
                                       ∀
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       A
                                       ,
                                       k
                                       ∈
                                       
                                          V
                                          s
                                       
                                       .
                                    
                                 
                              
                           
                        

In order to compare MCF and GCS, we need to project out also the q-variables of the MCF formulation. Let us define the sets:

                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   x
                                                   ̲
                                                
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                                
                                                |
                                                
                                                
                                                   x
                                                   ̲
                                                
                                                
                                                satisfies
                                                
                                                (36),
                                                
                                                (37)
                                                
                                                and
                                                
                                                (38)
                                                }
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                                
                                                   G
                                                   C
                                                   S
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   x
                                                   ̲
                                                
                                                ∈
                                                X
                                                
                                                |
                                                
                                                
                                                   x
                                                   ̲
                                                
                                                
                                                satisfies
                                                
                                                (7)
                                                }
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                                
                                                   M
                                                   C
                                                   F
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   (
                                                   
                                                      x
                                                      ̲
                                                   
                                                   ,
                                                   
                                                      q
                                                      ̲
                                                   
                                                   )
                                                
                                                ∈
                                                
                                                   R
                                                   
                                                      m
                                                      n
                                                   
                                                
                                                
                                                |
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      ̲
                                                   
                                                   ,
                                                   
                                                      q
                                                      ̲
                                                   
                                                   )
                                                
                                                
                                                satisfies
                                                
                                                (32)--(39)
                                                }
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                                r
                                                o
                                                
                                                   j
                                                   x
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      
                                                         M
                                                         C
                                                         F
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   x
                                                   ̲
                                                
                                                ∈
                                                X
                                                
                                                |
                                                
                                                ∃
                                                
                                                
                                                   q
                                                   ̲
                                                
                                                
                                                s.t.
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      ̲
                                                   
                                                   ,
                                                   
                                                      q
                                                      ̲
                                                   
                                                   )
                                                
                                                ∈
                                                
                                                   P
                                                   
                                                      M
                                                      C
                                                      F
                                                   
                                                
                                                }
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where PGCS
                            is the GCS-polytope, PMCF
                            is the MCF-polytope and Projx
                           (PMCF
                           ) is its projection onto the x-space. It is convenient to rewrite Constraints (32)–(35) in matrix form as follows:

                              
                                 (40)
                                 
                                    
                                       B
                                       
                                          x
                                          ̲
                                       
                                       +
                                       M
                                       
                                          q
                                          ̲
                                       
                                       =
                                       
                                          0
                                          ̲
                                       
                                    
                                 
                              
                           
                           
                              
                                 (41)
                                 
                                    
                                       −
                                       D
                                       
                                          x
                                          ̲
                                       
                                       +
                                       I
                                       
                                          q
                                          ̲
                                       
                                       ≤
                                       
                                          0
                                          ̲
                                       
                                    
                                 
                              
                           
                           
                              
                                 (42)
                                 
                                    
                                       
                                          x
                                          ̲
                                       
                                       ,
                                       
                                          q
                                          ̲
                                       
                                       ≥
                                       
                                          0
                                          ̲
                                       
                                       .
                                    
                                 
                              
                           
                        


                           Eq. (40) corresponds to (33)–(35), while (41) corresponds to (32). The matrices B, M, D and I can be decomposed according to the index k. Each block Mk
                            represents the node-arc incidence matrix of the graph G. Ik
                            are identity matrices of dimension m × m. Each submatrix Bk
                            has zeros everywhere, except for the row corresponding to node s, with entries of value 
                              
                                 −
                                 1
                              
                            for each arc in 
                              
                                 
                                    δ
                                    −
                                 
                                 
                                    (
                                    k
                                    )
                                 
                                 ,
                              
                            and the row corresponding to node k, with 
                              
                                 +
                                 1
                              
                            entries for each arc in 
                              
                                 
                                    δ
                                    −
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           . Each row of Dk
                            corresponds to a variable 
                              
                                 q
                                 
                                    i
                                    j
                                 
                                 k
                              
                            and has zeros everywhere, except for a 
                              
                                 +
                                 1
                              
                            in the column associated with variable xij
                           .

The projection onto the x-space of the polytope PMCF
                            defined by (40)–(41) can be obtained as follows (see, e.g., Balas (2005)):

                              
                                 (43)
                                 
                                    
                                       P
                                       r
                                       o
                                       
                                          j
                                          x
                                       
                                       
                                          (
                                          
                                             P
                                             
                                                M
                                                C
                                                F
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             x
                                             ̲
                                          
                                          ∈
                                          X
                                          
                                          |
                                          
                                          
                                             (
                                             
                                                u
                                                ̲
                                             
                                             B
                                             −
                                             
                                                v
                                                ̲
                                             
                                             D
                                             −
                                             
                                                w
                                                ̲
                                             
                                             )
                                          
                                          
                                             x
                                             ̲
                                          
                                          ≤
                                          0
                                          
                                          ∀
                                          
                                             (
                                             
                                                u
                                                ̲
                                             
                                             ,
                                             
                                                v
                                                ̲
                                             
                                             ,
                                             
                                                w
                                                ̲
                                             
                                             )
                                          
                                          ∈
                                          C
                                          }
                                       
                                       ,
                                    
                                 
                              
                           where C is the cone defined as:

                              
                                 
                                    
                                       C
                                       =
                                       {
                                       
                                          (
                                          
                                             u
                                             ̲
                                          
                                          ,
                                          
                                             v
                                             ̲
                                          
                                          ,
                                          
                                             w
                                             ̲
                                          
                                          )
                                       
                                       
                                       |
                                       
                                       
                                          u
                                          ̲
                                       
                                       M
                                       +
                                       
                                          v
                                          ̲
                                       
                                       I
                                       ≥
                                       0
                                       ,
                                       
                                          v
                                          ̲
                                       
                                       ≥
                                       0
                                       ,
                                       
                                          w
                                          ̲
                                       
                                       ≥
                                       0
                                       }
                                       .
                                    
                                 
                              
                           The result allows us to carry out the comparison between PGCS
                            and Projx
                           (PMCF
                           ) simply by finding a system of generators for the cone C.

From the inequalities 
                              w
                            ≥ 0 we obtain extreme rays of the form 
                              
                                 
                                    u
                                    ̲
                                 
                                 =
                                 
                                    0
                                    ̲
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    v
                                    ̲
                                 
                                 =
                                 
                                    0
                                    ̲
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    w
                                    ̲
                                 
                                 =
                                 
                                    
                                       e
                                       ̲
                                    
                                    i
                                 
                                 ,
                              
                            where 
                              e
                           
                           
                              i
                            is the ith standard basis vector of 
                              
                                 
                                    R
                                    m
                                 
                                 ,
                              
                            that yield the nonnegativity constraints

                              
                                 (44)
                                 
                                    
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       0
                                       
                                       ∀
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       A
                                       .
                                    
                                 
                              
                           
                        

This allows us to restrict our following study to the cone C′ defined as:

                              
                                 
                                    
                                       
                                          C
                                          ′
                                       
                                       =
                                       
                                          {
                                          
                                             (
                                             
                                                u
                                                ̲
                                             
                                             ,
                                             
                                                v
                                                ̲
                                             
                                             )
                                          
                                          
                                          |
                                          
                                          
                                             u
                                             ̲
                                          
                                          M
                                          +
                                          
                                             v
                                             ̲
                                          
                                          I
                                          ≥
                                          0
                                          ,
                                          
                                             v
                                             ̲
                                          
                                          ≥
                                          0
                                          }
                                       
                                       .
                                    
                                 
                              
                           Exploiting the decomposition of M, we can work on the even smaller cones:

                              
                                 (45)
                                 
                                    
                                       
                                          C
                                          k
                                       
                                       =
                                       
                                          {
                                          
                                             (
                                             
                                                
                                                   u
                                                   ̲
                                                
                                                k
                                             
                                             ,
                                             
                                                
                                                   v
                                                   ̲
                                                
                                                k
                                             
                                             )
                                          
                                          
                                          |
                                          
                                          
                                             
                                                u
                                                ̲
                                             
                                             k
                                          
                                          
                                             M
                                             k
                                          
                                          +
                                          
                                             
                                                v
                                                ̲
                                             
                                             k
                                          
                                          ≥
                                          0
                                          ,
                                          
                                             
                                                v
                                                ̲
                                             
                                             k
                                          
                                          ≥
                                          0
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        

Due to (43), once we have the system of generators ( 
                              u
                            
                           
                              k
                           , 
                              v
                            
                           
                              k
                           ) for each cone Ck
                           , the constraints in the x-space are obtained by calculating 
                              
                                 
                                    (
                                    
                                       
                                          u
                                          ̲
                                       
                                       k
                                    
                                    
                                       B
                                       k
                                    
                                    −
                                    
                                       
                                          v
                                          ̲
                                       
                                       k
                                    
                                    
                                       D
                                       k
                                    
                                    )
                                 
                                 
                                    x
                                    ̲
                                 
                                 ≤
                                 
                                    0
                                    ̲
                                 
                              
                            for each k ∈ Vs
                           .

According to Proposition 6 by Padberg and Sung (1991), a full system of generators of a cone Ck
                            defined as in (45), where Mk
                            is a node-arc incidence matrix of a digraph, is given by:

- a basis of its lineality space, of the form:

                              
                                 
                                    
                                       
                                          
                                             u
                                             ̲
                                          
                                          k
                                       
                                       =
                                       ±
                                       
                                          e
                                          ̲
                                       
                                       ,
                                       
                                       
                                          
                                             v
                                             ̲
                                          
                                          k
                                       
                                       =
                                       
                                          0
                                          ̲
                                       
                                       ,
                                    
                                 
                              
                           where 
                              e
                            is the all-ones vector, that in our case translate to the trivial equality 
                              
                                 
                                    0
                                    ̲
                                 
                                 =
                                 
                                    0
                                    ̲
                                 
                                 ,
                              
                            and

- the extreme rays, given by all the positive multiples of the vector ( 
                              u
                            
                           
                              k
                           , 
                              v
                            
                           
                              k
                           ) such that:

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                
                                                
                                                   u
                                                   i
                                                   k
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                
                                                ∀
                                                i
                                                ∈
                                                V
                                                ,
                                                
                                                
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               for
                                                               
                                                               one
                                                               
                                                               
                                                                  (
                                                                  i
                                                                  ,
                                                                  j
                                                                  )
                                                                  ∈
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   i
                                                   i
                                                   )
                                                
                                                
                                                
                                                   u
                                                   i
                                                   k
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               ∀
                                                               i
                                                               ∈
                                                               S
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               ∀
                                                               
                                                               i
                                                               ∈
                                                               
                                                                  S
                                                                  ¯
                                                               
                                                               ,
                                                               j
                                                               ∈
                                                               S
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   i
                                                   i
                                                   i
                                                   )
                                                
                                                
                                                
                                                   u
                                                   i
                                                   k
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               ∀
                                                               i
                                                               ∈
                                                               S
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               ∀
                                                               
                                                               i
                                                               ∈
                                                               S
                                                               ,
                                                               j
                                                               ∈
                                                               
                                                                  S
                                                                  ¯
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for any S ⊆ V, where 
                              
                                 
                                    S
                                    ¯
                                 
                                 =
                                 V
                                 ∖
                                 S
                              
                           . The extreme rays of the form (i) give rise to non-negativity constraints.

From the extreme rays given by (ii) and (iii) we obtain the inequalities:

                              
                                 (46)
                                 
                                    
                                       −
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                       
                                       +
                                       
                                          u
                                          k
                                       
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       −
                                       
                                          u
                                          s
                                       
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       ≤
                                       0
                                    
                                 
                              
                           
                           
                              
                                 (47)
                                 
                                    
                                       −
                                       x
                                       
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                       
                                       −
                                       
                                          u
                                          k
                                       
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       +
                                       
                                          u
                                          s
                                       
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       ≤
                                       0
                                    
                                 
                              
                           where 
                              
                                 
                                    u
                                    i
                                 
                                 =
                                 1
                              
                            if i ∈ S, and 0 otherwise. For both (46) and (47), we can distinguish four cases depending on whether s and k are in S, thus whether us, uk
                            are 0 or 1. If both s and k are in S, or neither of them is, the inequality is implied by the nonnegativity constraints (44). If only the coefficient with negative sign is nonzero, the corresponding inequality is, again, redundant. Therefore, the only meaningful cases are the following:

                              
                                 (48)
                                 
                                    
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                       
                                       ≥
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       
                                       
                                       ∀
                                       S
                                       ⊆
                                       V
                                       ,
                                       s
                                       ∉
                                       S
                                       ,
                                       ∀
                                       k
                                       ∈
                                       S
                                    
                                 
                              
                           
                           
                              
                                 (49)
                                 
                                    
                                       x
                                       
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                       
                                       ≥
                                       x
                                       
                                          (
                                          
                                             δ
                                             −
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       
                                       
                                       ∀
                                       S
                                       ⊆
                                       V
                                       ,
                                       s
                                       ∈
                                       S
                                       ,
                                       ∀
                                       k
                                       ∉
                                       S
                                       .
                                    
                                 
                              
                           We have established so far that Projx
                           (PMCF
                           ) is fully described by the nonnegativity constraints and Constraints (48)–(49). This set of inequalities can be shown to be equivalent to:

                              
                                 (50)
                                 
                                    
                                       x
                                       
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             S
                                             )
                                          
                                          )
                                       
                                       ≥
                                       x
                                       
                                          (
                                          
                                             δ
                                             +
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                          )
                                       
                                       
                                       
                                       ∀
                                       S
                                       ⊆
                                       
                                          V
                                          
                                             s
                                             t
                                          
                                       
                                       ,
                                       k
                                       ∈
                                       S
                                       .
                                    
                                 
                              
                           
                        

Constraints (48) and (49) are equivalent, due to the fact that 
                              
                                 x
                                 
                                    (
                                    
                                       δ
                                       +
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    )
                                 
                                 =
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       
                                          S
                                          ¯
                                       
                                       )
                                    
                                    )
                                 
                              
                           . Let us then consider only (48). For 
                              
                                 k
                                 =
                                 t
                                 ,
                              
                            the inequality is trivially satisfied by all x ∈ X, thus redundant. For k ≠ t and t ∉ S, we obtain exactly the inequalities in (50), since by (36)–(38), we have that 
                              
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                    )
                                 
                                 =
                                 x
                                 
                                    (
                                    
                                       δ
                                       +
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                    )
                                 
                              
                            and 
                              
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    )
                                 
                                 =
                                 x
                                 
                                    (
                                    
                                       δ
                                       +
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    )
                                 
                              
                            for any S containing neither s nor t. If k ≠ t and t ∈ S, it suffices to observe that, since 
                              
                                 
                                    δ
                                    +
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            the inequality 
                              
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    )
                                 
                                 ≥
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                    )
                                 
                              
                            is implied by 
                              
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       S
                                       ∖
                                       
                                          {
                                          t
                                          }
                                       
                                       )
                                    
                                    )
                                 
                                 ≥
                                 x
                                 
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                    )
                                 
                                 ,
                              
                            which, again, can be rewritten in the form (50).

Hence, the projection of PMCF
                            onto the x-space is given by

                              
                                 
                                    
                                       P
                                       r
                                       o
                                       
                                          j
                                          x
                                       
                                       
                                          (
                                          
                                             P
                                             
                                                M
                                                C
                                                F
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             x
                                             ̲
                                          
                                          ∈
                                          X
                                          
                                          |
                                          
                                          
                                             x
                                             ̲
                                          
                                          
                                          satisfies
                                          
                                          (36)--(38)
                                          
                                          and
                                          
                                          (50)
                                          }
                                       
                                       ,
                                    
                                 
                              
                           and it follows that 
                              
                                 P
                                 r
                                 o
                                 
                                    j
                                    x
                                 
                                 
                                    (
                                    
                                       P
                                       
                                          M
                                          C
                                          F
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    P
                                    
                                       G
                                       C
                                       S
                                    
                                 
                              
                           .□

From this result and Proposition 4, it also follows that formulation MCF is stronger than formulation DFJ.

Let us now compare the described formulations with respect to their LP relaxation bounds and their behavior within an exact branch-and-cut framework. Formulation DFJ is not included in the tests, as it is clearly dominated by GCS.

Four types of instances are considered in the tests. The first benchmark set consists of instances from the pricing phase of the unsplittable flow problem considered by Amaldi et al. (2014); Taccari (2015) on small-sized networks from the SNDlib (Orlowski, Wessäly, Pióro, & Tomaszewski, 2010), namely, the topologies atlanta, france, geant, germany and nobel-us.

The second one is a set of small to medium-sized random-cost graphs, either sparse (rnd-s) or dense (rnd-d). The graphs for the instances in rnd-s are generated by building a connected component including all the nodes, and then randomly adding arcs until the desired density is reached. The instances in rnd-d are the dense instances by Drexl (2013), with random arc costs on a complete graph.

The third benchmark set (prc) contains the pricing instances by Drexl (2013). It consists of small and medium-size pricing problems from a column generation algorithm for the asymmetric m-salesmen TSP at the first (f), penultimate (p) and last (l) pricing iterations.

The fourth set (rome99) contains a part of the directed road network of the city of Rome, Italy, used in the 9th DIMACS Implementation Challenge on Shortest Paths (Demetrescu, Goldberg, & Johnson, 2009). Since all the arcs have a positive cost, representing the distance in meters, we flip their sign (i.e., we solve a longest path problem over the original graph). To generate distinct instances over the same graph, we sample randomly 30 (s, t) pairs from V.


                     Table 2
                      summarizes the features of the test instances. For each subset, we have 30 instances, for a total of 690.

The LP relaxation bounds are computed constructing the complete model for the extended formulations MTZ, RLT and SF. For formulations GCS and MCF we use a Min Cut-based separation procedure (its implementation details are left to the next section). Note that we use a delayed row-generation algorithm also to solve MCF since its size is rather large, although polynomial, and preliminary experiments indicated this is an effective strategy. The tests are carried out with IBM Ilog Cplex 12.6 on an Intel Xeon E5645 @2.40 GHz.


                        Table 3 reports the average gap of the linear relaxation bounds with respect to the optimal integer values, computed as 
                           
                              100
                              
                                 
                                    |
                                    L
                                    B
                                    −
                                    O
                                    p
                                    t
                                    |
                                 
                                 
                                    |
                                    L
                                    B
                                    |
                                 
                              
                              ,
                           
                         the number of optimal integer solutions, and the average computing time. The results confirm that the LP bounds of MCF and GCS are equivalent, and show that they are by far the tightest formulations. MCF and GCS have gap 0 on 40% of the instances and find an optimal integer solution on almost 30% of the instances. The remaining formulations have a relaxation with gap 0 in less than 10% of the considered instances, and find an optimal integer solution in less than 2% of the cases. Formulations RLT and SF provide similar bounds. Considering the computing time, MTZ is solved more quickly than all the other formulations, while RLT and SF are challenging for large networks. On the largest instances, the LP relaxation of the MCF formulation could not be solved within the time limit of 1200 seconds.

It is worthwhile to point out that, even in the cases where the bounds are very good with all the formulations (e.g., on the prc-f instances), weaker formulations provide solutions with many more fractional values, as reflected by the smaller number of optimal integer solutions.

Since we aim at integer solutions, let us compare the behavior of a state-of-the-art MIP solver using the considered formulations. The formulations and the separation procedures are implemented in C++ with IBM Ilog Cplex/Concert 12.6, using default settings for the branch-and-cut.

For the polynomial-size extended formulations MTZ, RLT and SF, the full model is built.

For GCS, we report results obtained with two different separation routines. In the approach denoted by GCS-StrongComp, the separation is carried out, on both fractional and integer solutions, identifying the strongly connected components in the support graph induced by the variables xij
                        . This can be done in a 
                           
                              O
                              (
                              n
                              +
                              m
                              )
                           
                         running time with Tarjan’s algorithm (Tarjan, 1972). Once a strong component S has been found, it is enough to check if Constraint (7) is violated for any of the nodes in S. This separation procedure is efficient, but not guaranteed to find all the violated inequalities on fractional solutions. Correctness is preserved by the fact that the procedure is exact for integer solutions. In the approach denoted by GCS-MinCut, the separation is carried out on fractional solutions by solving a sequence of Min Cut (or Max Flow) problems between each node and t. Solving 
                           
                              n
                              −
                              1
                           
                         Min Cut problems yields an overall worst-case complexity of 
                           
                              O
                              (
                              
                                 n
                                 3
                              
                              
                                 m
                              
                              )
                           
                         using Goldberg–Tarjan’s highest-label preflow-push algorithm (Goldberg & Tarjan, 1988). This way, all violated inequalities are identified, although with a higher computational cost. Note that, on integer solutions, the faster strong component-based procedure is sufficient, and, on fractional solutions, it is computationally convenient to try the strong components procedure first, and resort to the Min-Cut separation only if the heuristic finds no violated inequality. The same separation procedures are also used for MCF: when a violation is found for a node k, we add the full set of Constraints (25)–(27) corresponding to that node.

To solve the Min-Cut problems and identify the strongly connected components, we use the efficient implementations in the open-source LEMON Graph Library 1.3 (Dezső, Jüttner, & Kovács, 2011). We refer the interested reader to Drexl (2013) for additional considerations on the separation of subtour elimination constraints for the ESPP.

A remark is in order. In a branch-and-cut algorithm, the generation of the cutting planes must be balanced with respect to the branching: adding too many inequalities may hinder the solution of the LPs in the nodes, although better bounds result in fewer explored nodes. We use two parameters to control the trade-off between the quality of the lower bounds and the computing time to solve the LPs. Specifically, given a solution 
                           x
                        , we only consider the inequalities with a violation not smaller than ε (correctness is preserved on integer solutions for ε < 1), and we add at most ν of them (in particular, we select the first ν maximally violated). In Tables 4
                         and 5
                        , we summarize a tuning procedure that is carried out on a subset of 120 medium-size instances to identify the best parameters for GCS-StrongComp and GCS-MinCut. We report the geometric mean of the time to optimality, the number of nodes and the number of added cuts. The values are normalized, for each instance, with respect to the results with 
                           
                              
                                 ɛ
                              
                              =
                              0.001
                           
                         and 
                           
                              ν
                              =
                              1
                           
                        . The tables indicate that, in both cases, it is convenient to add all the inequalities that are violated by the given tolerance ε. According to these results, in the following experiments, we use 
                           
                              
                                 ɛ
                              
                              =
                              0.8
                           
                         and 
                           
                              m
                              =
                              all
                           
                         for GCS-MinCut, and 
                           
                              
                                 ɛ
                              
                              =
                              0.2
                              ,
                              m
                              =
                              all
                           
                         for GCS-StrongComp.

Concerning the row generation for MCF, recall that for every violation we need to add a set of O(m) constraints. For this reason, we decide to add only the inequalities corresponding to the node with maximum violation. The choice of the separation algorithm and of ε does not have a significant impact; in the following experiments, we set 
                           
                              
                                 ɛ
                              
                              =
                              0.2
                           
                         and use the strong component-based separation procedure.

In Table 6
                         we summarize the results over the whole set of test instances. Column “opt” reports the number of instances that are solved to proven optimality within the time limit of 1200 seconds. Column “time” reports the average computing time. Column “nodes” reports the average number of explored nodes in the branch-and-bound tree. Column “cuts” reports the average number of GCS inequalities added by the separation procedures.

First of all, we can observe that the small-size pricing instances from the SNDlib are easy for all the formulations. It is also worth noting that, for graphs of similar size, the rnd instances are typically much easier than the prc ones. For the TSP, instances with random costs are known to be rather easy to solve (Applegate, Bixby, Cook, & Chvátal, 2006), and a similar effect may take place for the ESPP. None of the approaches is able to solve to proven optimality any of the instances in rome99.


                        GCS-StrongComp solves to optimality all the instances in the set, except for those in rome99, and proves to be by far the best choice for the largest instances. The GCS-MinCut approach has difficulties on large-size instances, where most of the computing time is spent in the separation phase. In particular, optimality cannot be proven on 4 instances of rand-1000, and 2 instances of prc-l-100.

Compared to the extended formulations, GCS-StrongComp is a clear winner on all benchmark sets, where it is often more than one order of magnitude faster. Despite the typically better linear relaxation bounds, formulation RLT is usually not faster than SF, that allows the solver to reach proven optimality for a larger number of instances. Interestingly, while rather ineffective overall, formulation MTZ yields good results on the rnd instances. This might be due to the fact that, on the rnd set, all the extended formulations have similarly good linear relaxation bounds, and it probably pays off to have an LP of smaller size.

Formulation MCF, despite the tight linear relaxation, appears to be too heavy to be of practical interest. On small-sized instances, very few B&B nodes are necessary. However, this is not enough to overcome the computational load required by solving the linear relaxation: even with a row-generation approach, the size of the LP grows quickly. On graphs with 100 or more nodes, only a small fraction of the instances can be solved within the time limit. On the largest graphs, the instances in rnd-s-1000 and rome99, the solver quickly reaches the memory limit of 16 GB.


                        Fig. 3
                         summarizes the computational experiments with a performance profile. On the y-axis, we report the fraction of all the instances that are solved to optimality within the time on the x-axis (in logarithmic scale).


                        GCS-StrongComp is the topmost curve, solving more than 85% of the instances within 10 seconds. GCS-MinCut is not far behind, although it is generally slower. Both solve around 95% of the instances within 1200 seconds. Formulations RLT, SF and MTZ yield similar results on the easiest instances, although, overall, only less than 70% of the instances are solved to optimality with MTZ, while SF and RLT reach, respectively, 90% and 87%. With the MCF approach (bottom curve), Cplex is already significantly slower on the easiest instances, and solves the smallest fraction of the instances (around 65%).

@&#CONCLUSIONS@&#

We have analyzed integer programming formulations for the ESPP, including formulations not yet appeared in the literature.

The polyhedral results in Section 3 provide a partial hierarchy among the ESPP formulations, and prove that the strong extended formulation MCF has a projection on the space of the arc variables which is equivalent to the polytope of the GCS formulation, that has exponentially many subtour elimination constraints.

It is also important to understand how effective the formulations are from a computational point of view. In this regard, we report a set of extensive computational experiments, suggesting that the extended formulations are inferior for all practical purposes, and the dynamic separation of subtour elimination constraints appears to be the best option when tackling the ESPP as an integer program. The GCS approach with the strong component-based separation procedure is able to solve small-sized instances in a few seconds and medium-sized instances, with up to 1000 nodes, within a minute, but it is still not sufficient to solve large-scale problems. When the implementation of a separation procedure is not possible or convenient, formulation SF is probably the best choice.

It seems likely that the development of good primal heuristics and additional strong valid inequalities, possibly extended from of the ATSP (e.g., 2-matching or comb inequalities), might further speed up the computing times and allow the solution of larger-sized instances. It might also be useful to borrow techniques from the typical approaches used for the ESPPRC, such as a preprocessing phase with the aim of reducing the search space.

@&#ACKNOWLEDGMENT@&#

The author would like to thank the two anonymous referees for the useful comments that helped improve the quality of the manuscript.

@&#REFERENCES@&#

