@&#MAIN-TITLE@&#The single-item green lot-sizing problem with fixed carbon emissions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Single-item lot sizing problem with periodic carbon emission constraints.


                        
                        
                           
                           Fixed carbon emissions.


                        
                        
                           
                           Complexity analysis.


                        
                        
                           
                           Dynamic programming algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Lot sizing

Periodic carbon emission constraint

Multi-mode

Dynamic programming

Complexity analysis

@&#ABSTRACT@&#


               
               
                  We consider in this paper a single-item lot sizing problem with a periodic carbon emission constraint. In each period, the carbon emission constraint defines an upper limit on the average emission per product. Different modes are available, each one is characterized by its own cost and carbon emission parameters. The problem consists in selecting the modes used in each period such that no carbon emission constraint is violated, and the cost of satisfying all the demands on a given time horizon is minimized. This problem has been introduced in Absi et al. (2013), and has been shown polynomially solvable when only unit carbon emissions are considered. In this paper, we extend the analysis for this constraint to the realistic case of a fixed carbon emission associated with each mode, in addition to its unit carbon emission. We establish that this generalization renders the problem NP-hard. Several dominant properties are presented, and two dynamic programming algorithms are proposed. We also establish that the problem can be solved in polynomial time for a fixed number of modes when carbon emission parameters are stationary.
               
            

@&#INTRODUCTION@&#

Considering sustainability issues in Supply Chain Management is becoming more and more important (Linton, Klassen, & Jayaraman, 2007). In particular, optimizing environmental objectives or managing environmental constraints are associated with the concept of Green Supply Chain (Srivastava, 2007). Recently, various researchers have studied how to consider carbon emissions in production and distribution planning problems. One of the seminal work in the domain can be found in Benjaafar, Li, and Daskin (2013), where the authors propose a mathematical model which includes a global carbon emission constraint on the planning horizon. They perform a numerical study to derive some managerial insights. Based on the same type of constraints, Helmrich, Jans, van den Heuvel, and Wagelmans (2015) show that the problem is NP-hard and propose various solution methods, including a Lagrangian heuristic and a Fully Polynomial Time Approximation Scheme (FPTAS). A global carbon emission constraint is also considered in Velázquez-Martínez, Fransoo, Blanco, and Mora-Vargas (2014), and models for different scenarios are discussed. Carbon emission constraints are taken into account in static inventory and distribution problems (such as in Arıkan & Jammernegg, 2014; Konur, 2014). Various authors have also studied how to take carbon emissions into account in the objective function, either in static inventory models (such as in Bouchery, Ghaffari, Jemai, & Dallery, 2012; Chen, Benjaafar, & Elomri, 2013; Konur & Schaefer, 2014; Toptal, Özlü, & Konur, 2014) or in dynamic lot-sizing models (such as in Palak, Ekşioğlu, & Geunes, 2014; Romeijn, Morales, & Van den Heuvel, 2014).


                     Absi et al. (2013) propose four types of carbon emission constraints in multi-mode dynamic lot sizing: (1) Periodic carbon emission constraint, (2) Cumulative carbon emission constraint, (3) Global carbon emission constraint and (4) Rolling carbon emission constraint. Compared to the carbon emission constraints considered in most papers, these constraints impose a maximum value not on the carbon emissions, but on the average carbon emission per product. This type of constraints is particularly relevant to the firms who want to display the carbon footprint of their products. Notice that these type of constraints do not limit the supply capacity since it is always possible to select a supply mode that can satisfy the constraints. Another advantage, except for the global carbon emission constraint, is that the constraints do not strongly depend on the length of the horizon (see Absi et al., 2013 for a more extensive discussion). The uncapacitated single-item problem with Periodic Carbon emission constraint, called ULS-PC in this paper, is shown polynomial, and a dynamic programming algorithm is proposed (Absi et al., 2013).

In this paper, we analyze how fixed carbon emissions impact the problem with periodic carbon emission constraints. A fixed carbon emission is incurred at each period a mode is selected, and corresponds for instance to the activities associated with packaging the products for the associated mode. A mode corresponds to the combination of a production facility and a transportation mode for supplying products. This problem is called ULS-FPC in the following. The problem consists in selecting in each period the modes to use and the quantities to order such that the supplying costs and the inventory costs are minimized, while satisfying in each period a carbon emission constraint per product.

The paper is organized as follows. The problem is formally introduced and modeled in Section 2. It is important structural properties are presented in Section 3. We show in Section 4 that the problem is NP-hard. The special case where carbon emission parameters are stationary is studied in Section 5, and two dynamic programming algorithms are proposed. Finally, the paper ends with some conclusions and perspectives in Section 6.

We are interested in optimizing the supply (production and transportation) plan (when and how much to supply) of an item to satisfy a deterministic time-dependent demand over a planning horizon of T periods. Let us consider M different supplying modes associated with different available production locations and transportation modes. Costs to be minimized include holding cost and unitary and fixed supplying costs which depend on the supplying mode. We study the problem with periodic carbon emission constraints considering 
                        
                           
                              ef
                              
                                 t
                              
                              
                                 
                                 m
                              
                           
                           ,
                        
                      which is the fixed environmental impact associated with mode m in period t. This parameter is independent of the supplied quantity.

The parameters and variables of the multi-sourcing lot-sizing problem are formally defined below.


                     Parameters:
                     
                        
                           
                              dt
                              : Demand in period t, 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    T
                                    ,
                                 
                              
                           


                              ht
                              : Unitary holding cost at the end of period t,


                              
                                 
                                    p
                                    
                                       t
                                    
                                    m
                                 
                              : Unitary supplying cost of mode m in period t,


                              
                                 
                                    f
                                    
                                       t
                                    
                                    m
                                 
                              : Supplying setup cost of mode m in period t,


                              
                                 
                                    e
                                    
                                       v
                                       
                                          t
                                       
                                       m
                                    
                                 
                              : Environmental impact (carbon emission) related to supplying one unit using mode m in period t,


                              
                                 
                                    ef
                                    
                                       t
                                    
                                    
                                       
                                       m
                                    
                                 
                               Fixed environmental impact related to using mode m in period t,


                              
                                 
                                    E
                                    t
                                    max
                                 
                              : Maximum unitary environmental impact allowed in period t.


                              
                                 
                                    
                                       
                                          
                                             e
                                             v
                                          
                                          ¯
                                       
                                       
                                          t
                                       
                                       m
                                    
                                    =
                                    e
                                    
                                       v
                                       
                                          t
                                       
                                       m
                                    
                                    −
                                    
                                       E
                                       t
                                       max
                                    
                                 
                              : Relative environmental impact for mode m in period t (negative for ecological modes, positive for non-ecological modes).


                     Variables:
                     
                        
                           
                              
                                 
                                    x
                                    
                                       t
                                    
                                    m
                                 
                              : Quantity supplied in period t using mode m,


                              
                                 
                                    y
                                    
                                       t
                                    
                                    m
                                 
                              : Binary variable which is equal to 1 if mode m is used in period t, and 0 otherwise,


                              st
                              : Inventory carried from period t to period 
                                 
                                    t
                                    +
                                    1
                                 
                              .

The carbon emission constraint of the ULS-FPC problem is a generalization of the one defined by Absi et al. (2013) for the ULS-PC. It ensures that the average amount of carbon emission at any period t in addition to the fixed consumption is lower than or equal to the maximum unitary carbon emission. Hence, the unused amount of carbon emission in a given period cannot be used in the following periods. More formally, this tight constraint can be defined as follows for each period t:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   M
                                                
                                                
                                                   (
                                                   e
                                                   
                                                      v
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   
                                                      x
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   +
                                                   
                                                      ef
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                         m
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   M
                                                
                                                
                                                   x
                                                   
                                                      t
                                                   
                                                   m
                                                
                                             
                                          
                                          ≤
                                          
                                             E
                                             t
                                             max
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The mathematical formulation of the multi-sourcing lot-sizing problem, with fixed and periodic carbon emission constraints, is given below:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   M
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   
                                                      x
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   +
                                                   
                                                      f
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   T
                                                
                                                
                                                   h
                                                   t
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             x
                                             
                                                t
                                             
                                             m
                                          
                                          −
                                          
                                             s
                                             t
                                          
                                          +
                                          
                                             s
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          =
                                          
                                             d
                                             t
                                          
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             
                                                t
                                             
                                             m
                                          
                                          ≤
                                          B
                                          
                                             y
                                             
                                                t
                                             
                                             m
                                          
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          T
                                          ,
                                          m
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          M
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                m
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      e
                                                      v
                                                   
                                                   ¯
                                                
                                                
                                                   t
                                                
                                                m
                                             
                                             
                                                x
                                                
                                                   t
                                                
                                                m
                                             
                                             +
                                             
                                                ef
                                                
                                                   t
                                                
                                                
                                                   
                                                   m
                                                
                                             
                                             
                                                y
                                                
                                                   t
                                                
                                                m
                                             
                                             )
                                          
                                          ≤
                                          0
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          T
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             
                                                t
                                             
                                             m
                                          
                                          ∈
                                          
                                             R
                                             +
                                          
                                          ,
                                          
                                             y
                                             
                                                t
                                             
                                             m
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          T
                                          ,
                                          m
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          M
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             s
                                             t
                                          
                                          ∈
                                          
                                             R
                                             +
                                          
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                  

The objective function (1) minimizes the fixed and variable production and transportation costs and the total holding cost. Constraints (2) are the inventory balance equations, and Constraints (3), in which B is a big value, ensure that an item cannot be supplied using mode m at period t if m is not one of the selected modes. The parameter B must be calculated according to the sum of the demands (
                        
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              d
                              t
                           
                        
                     ) and threshold parameters that will be introduced later. The carbon emission constraints are defined by (4).

Due to Constraints (4), the existence of a feasible solution cannot be guaranteed.

                        Property 1
                        A feasible solution exists if and only if at least one of the following conditions holds for periods t′ ≤ t where t is the first period with a strictly positive demand:

                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                   v
                                                
                                                ¯
                                             
                                             
                                                
                                                   t
                                                   ′
                                                
                                             
                                             m
                                          
                                          <
                                          0
                                       
                                     for at least one t′


                                    
                                       
                                          
                                             
                                                
                                                   e
                                                   v
                                                
                                                ¯
                                             
                                             
                                                
                                                   t
                                                   ′
                                                
                                             
                                             m
                                          
                                          =
                                          0
                                       
                                     and 
                                       
                                          
                                             ef
                                             
                                                
                                                   t
                                                   ′
                                                
                                             
                                             
                                                
                                                m
                                             
                                          
                                          =
                                          0
                                       
                                     for at least one t′

If one of the two conditions is verified, it is always possible to satisfy the total demand from period t′ by setting 
                              
                                 
                                    x
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 ≥
                                 
                                    ∑
                                    
                                       k
                                       =
                                       t
                                    
                                    T
                                 
                                 
                                    d
                                    k
                                 
                              
                            such that 
                              
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 
                                    x
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 +
                                 
                                    ef
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    
                                       
                                       m
                                    
                                 
                                 ≤
                                 0
                              
                           . Conversely, if 
                              
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 >
                                 0
                              
                            for all m and t′, 
                              
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 
                                    x
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 +
                                 
                                    ef
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    
                                       
                                       m
                                    
                                 
                                 >
                                 0
                              
                            whatever m, t′ and 
                              
                                 
                                    x
                                    
                                       
                                          t
                                          ′
                                       
                                    
                                    m
                                 
                                 >
                                 0
                              
                           .□

In the remainder of the paper, we consider that the feasibility of the problem is always guaranteed.

The ULS-PC problem is a particular case of the ULS-FPC problem, with no fixed carbon emission (Absi et al., 2013). In this section, we recall properties that hold for both ULS-PC and ULS-FPC, and state new ones. These properties will be used in Section 5 to derive dynamic programming algorithms to solve the ULS-PC problem in the stationary case.

Recall that the periodic carbon emission constraint ensures that, in each period t, the average amount of carbon emission per product ordered does not exceed the impact limit 
                        
                           E
                           t
                           max
                        
                     . As we assume that the fixed carbon emission parameter is non-negative, clearly, at least one ecological mode m must be chosen if a quantity is supplied in period t. In Absi et al. (2013), it was shown that solutions using at most two modes in each period are dominant for ULS-PC. This dominance property still holds when considering fixed carbon emissions.

                        Theorem 1
                        
                           There exists an optimal solution for the ULS-FPC problem that uses at most two modes in each period.
                        

Consider an optimal solution (
                              
                                 x
                                 ^
                              
                           ), and let t be a period where a positive quantity is supplied. Let 
                              
                                 M
                                 t
                              
                            be the set of mode used in period t, that is 
                              
                                 {
                                 m
                                 |
                                 
                                    
                                       x
                                       ^
                                    
                                    t
                                    m
                                 
                                 >
                                 0
                                 }
                              
                            and let 
                              
                                 
                                    
                                       X
                                       ^
                                    
                                    t
                                 
                                 =
                                 
                                    ∑
                                    m
                                 
                                 
                                    
                                       x
                                       ^
                                    
                                    t
                                    m
                                 
                              
                            be the quantity supplied. If the total quantity produced at period t is unchanged, then the stock levels are unchanged. We can then discard holding costs from the objective function (5). Clearly the quantities 
                              
                                 (
                                 
                                    
                                       x
                                       ^
                                    
                                    t
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    
                                       x
                                       ^
                                    
                                    t
                                    M
                                 
                                 )
                              
                            must be an optimal solution (and can be replaced by any optimal solution) of the following linear program:

                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            
                                                               M
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            
                                                               t
                                                            
                                                            m
                                                         
                                                         
                                                            x
                                                            
                                                               t
                                                            
                                                            m
                                                         
                                                         +
                                                         
                                                            f
                                                            
                                                               t
                                                            
                                                            m
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         t
                                                      
                                                   
                                                
                                                
                                                   x
                                                   
                                                      t
                                                   
                                                   m
                                                
                                                =
                                                
                                                   
                                                      X
                                                      ^
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         t
                                                      
                                                   
                                                
                                                
                                                   (
                                                   e
                                                   
                                                      v
                                                      
                                                         t
                                                      
                                                      m
                                                   
                                                   −
                                                   
                                                      E
                                                      t
                                                      max
                                                   
                                                   )
                                                
                                                
                                                   x
                                                   
                                                      t
                                                   
                                                   m
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      
                                                         M
                                                         t
                                                      
                                                   
                                                
                                                
                                                   ef
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                      m
                                                   
                                                
                                                ≤
                                                0
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   x
                                                   
                                                      t
                                                   
                                                   m
                                                
                                                ∈
                                                
                                                   R
                                                   +
                                                
                                                ,
                                                
                                                m
                                                ∈
                                                
                                                   M
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Due to elementary LP theory, there exists an optimal solution 
                              
                                 (
                                 
                                    
                                       x
                                       ¯
                                    
                                    t
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    
                                       x
                                       ¯
                                    
                                    t
                                    M
                                 
                                 )
                              
                            with only two positive variables since the above LP has only two constraints.□

We can also notice that if two modes are actually used in a period, then the carbon emission constraint must be saturated in a dominant solution:

                        Property 2
                        There exists an optimal solution for the ULS-FPC problem such that if two modes are used in a period, then the carbon emission constraint is saturated. In addition, the optimal cost to supply a quantity X using two modes m and m′, if feasible, is an affine function 
                              
                                 
                                    α
                                    t
                                    
                                       m
                                       ,
                                       
                                          m
                                          ′
                                       
                                    
                                 
                                 X
                                 +
                                 
                                    β
                                    t
                                    
                                       m
                                       ,
                                       
                                          m
                                          ′
                                       
                                    
                                 
                              
                            of X.

Considering the LP in the proof of Theorem 1, the proof follows from complementary slackness and strong duality theorems.□

Notice that using an ecological mode is not sufficient to ensure that a quantity X can be supplied without violating the carbon constraint. Indeed, the quantity ordered must be large enough to balance the fixed carbon emission associated with the mode. For this reason we introduce the threshold order associated with a mode (or a couple of modes) and representing the minimum amount of units to order using this mode such that the periodic emission Constraints (4) can be satisfied.

                        Definition 1
                        The minimum threshold order 
                              
                                 Q
                                 t
                                 m
                              
                            of an ecological mode m is defined as 
                              
                                 min
                                 {
                                 X
                                 |
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    t
                                    m
                                 
                                 X
                                 +
                                 
                                    ef
                                    
                                       t
                                    
                                    
                                       
                                       m
                                    
                                 
                                 ≤
                                 0
                                 }
                                 ,
                              
                            and is equal to

                              
                                 
                                    
                                       
                                          Q
                                          t
                                          m
                                       
                                       =
                                       −
                                       
                                          
                                             ef
                                             
                                                t
                                             
                                             
                                                
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   e
                                                   v
                                                
                                                ¯
                                             
                                             t
                                             m
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The minimum threshold order 
                              
                                 Q
                                 t
                                 
                                    
                                       m
                                       1
                                    
                                    
                                       m
                                       2
                                    
                                 
                              
                            of two modes m
                           1 and m
                           2 (with at least one ecological mode) is defined as 
                              
                                 min
                                 {
                                 X
                                 |
                                 min
                                 
                                    {
                                    
                                       
                                          
                                             e
                                             v
                                          
                                          ¯
                                       
                                       t
                                       
                                          m
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             e
                                             v
                                          
                                          ¯
                                       
                                       t
                                       
                                          m
                                          2
                                       
                                    
                                    }
                                 
                                 X
                                 +
                                 
                                    ef
                                    
                                       t
                                    
                                    
                                       
                                       
                                          m
                                          1
                                       
                                    
                                 
                                 +
                                 
                                    ef
                                    
                                       t
                                    
                                    
                                       
                                       
                                          m
                                          2
                                       
                                    
                                 
                                 ≤
                                 0
                                 }
                                 ,
                              
                            and is equal to

                              
                                 
                                    
                                       
                                          Q
                                          t
                                          
                                             
                                                m
                                                1
                                             
                                             
                                                m
                                                2
                                             
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                ef
                                                
                                                   t
                                                
                                                
                                                   
                                                   
                                                      m
                                                      1
                                                   
                                                
                                             
                                             +
                                             
                                                ef
                                                
                                                   t
                                                
                                                
                                                   
                                                   
                                                      m
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             min
                                             {
                                             
                                                
                                                   
                                                      e
                                                      v
                                                   
                                                   ¯
                                                
                                                t
                                                
                                                   m
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      e
                                                      v
                                                   
                                                   ¯
                                                
                                                t
                                                
                                                   m
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        

Clearly an amount X can be ordered using two modes m
                     1 and m
                     2 if and only if 
                        
                           X
                           ≥
                           
                              Q
                              t
                              
                                 
                                    m
                                    1
                                 
                                 
                                    m
                                    2
                                 
                              
                           
                        
                     . Note that the inventory at the end of the horizon is not necessary equal to zero in optimal solutions. Indeed, a trivial example where the total demand over the horizon is smaller than the smallest minimum threshold order, i.e. 
                        
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              d
                              t
                           
                           <
                           
                              min
                              
                                 m
                                 ,
                                 t
                              
                           
                           
                              Q
                              t
                              m
                           
                           ,
                        
                      illustrates this situation.

Using the definition of the threshold, we can now determine a value for parameter B used in the mathematical model in Section 2, choosing 
                        
                           B
                           ≥
                           max
                           {
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              d
                              t
                           
                           ;
                           
                              ∑
                              
                                 m
                                 =
                                 1
                              
                              M
                           
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              Q
                              t
                              m
                           
                           +
                           
                              ∑
                              
                                 
                                    m
                                    1
                                 
                                 =
                                 1
                              
                              M
                           
                           
                              ∑
                              
                                 
                                    m
                                    2
                                 
                                 =
                                 1
                              
                              M
                           
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              Q
                              t
                              
                                 
                                    m
                                    1
                                 
                                 
                                    m
                                    2
                                 
                              
                           
                           }
                        
                     .

In Absi et al. (2013), it was noticed that, if in a given period two different modes are used, then one mode should be ecological (
                        
                           
                              
                                 e
                                 v
                              
                              ¯
                           
                           <
                           0
                        
                     ) and the other one not 
                        
                           (
                           
                              
                                 e
                                 v
                              
                              ¯
                           
                           >
                           0
                           )
                        
                     . Taking into account fixed carbon emissions, this property is no more dominant, that is, an optimal solution may use two ecological modes in the same period.

                        Property 3
                        The property that states that at most one ecological mode is used in each period is not dominant for ULS-FPC.

Consider an instance with a single period and two modes. We have a demand of 2 to satisfy. Emission and cost parameters are given in Table 1
                           . The solution using both modes by ordering one unit using each mode is feasible and has a cost of 6. Since both modes are ecological, if one wants to use only one ecological mode, he has either to order 2 units using mode 2, or 10 units using mode 1 (since its minimum threshold is 10). Both solutions have a cost of 10 and thus are not optimal.□

Due to Theorem 1, we can restrict our attention to 2-mode policies, that use at most two modes in each period. Since a minimum threshold order is defined for each couple of modes, see Definition 2, for this class of policies we can introduce the following definition:

                        Definition 3
                        An ordering period is a Threshold Ordering Period (TOP) if and only if the quantity ordered is equal to the minimum threshold order of the single mode (or the couple of modes) used.

If an ordering period is not a TOP, we simply say that it is a NOP (Non-threshold Ordering Period). TOP will be useful to characterize dominant subplans. Recall that a period t is a regeneration period if its entering inventory is null, that is, 
                        
                           
                              s
                              
                                 t
                                 −
                                 1
                              
                           
                           =
                           0
                        
                     . A subplan is a sequence of periods between two consecutive regeneration periods such that the stock levels are positive. We have the following property that has similarities with some properties in the literature of lot-sizing with minimum order quantities (see for example Okhrin & Richter, 2011b; Park & Klabjan, 2013).

                        Property 4
                        Between two consecutive regeneration periods, there exists at most one NOP, and, if it exists, it is the last ordering period of the subplan. In other words, there exists an optimal solution such that in each subplan, all the ordering periods except possibly the last one are TOP.

Consider an optimal solution (
                              
                                 
                                    x
                                    ^
                                 
                                 ,
                                 
                                    y
                                    ^
                                 
                                 ,
                                 
                                    s
                                    ^
                                 
                              
                           ), and let k and l be two ordering periods occurring in the subplan defined by two consecutive regeneration periods u and v (we have u ≤ k < l < v). Let 
                              M
                            and 
                              N
                            be the modes used in period k and l, respectively. If a single mode m is used in a period t, then the unit supplying cost is simply 
                              
                                 p
                                 t
                                 m
                              
                            at this period. If two modes are used in a period t, then the unit supplying cost in an optimal schedule is 
                              
                                 
                                    α
                                    
                                       m
                                       
                                          m
                                          ′
                                       
                                    
                                 
                                 ,
                              
                            see Property 2. Hence we can define the unit supplying cost 
                              
                                 c
                                 M
                              
                            as 
                              
                                 p
                                 t
                                 m
                              
                            if 
                              
                                 M
                                 =
                                 {
                                 m
                                 }
                              
                            and 
                              
                                 α
                                 t
                                 
                                    m
                                    
                                       m
                                       ′
                                    
                                 
                              
                            if 
                              
                                 M
                                 =
                                 {
                                 m
                                 ,
                                 
                                    m
                                    ′
                                 
                                 }
                              
                           . In the same way we can define the minimum threshold order 
                              
                                 Q
                                 M
                              
                            which can be supplied as Qm
                            if 
                              
                                 M
                                 =
                                 {
                                 m
                                 }
                              
                            and 
                              
                                 Q
                                 
                                    m
                                    
                                       m
                                       ′
                                    
                                 
                              
                            if 
                              
                                 M
                                 =
                                 {
                                 m
                                 ,
                                 
                                    m
                                    ′
                                 
                                 }
                              
                           . With these notations, any quantity 
                              
                                 X
                                 ≥
                                 
                                    Q
                                    M
                                 
                              
                            can be ordered with the modes of 
                              
                                 M
                                 ,
                              
                            at a unit cost 
                              
                                 c
                                 M
                              
                           .

                              
                                 •
                                 If 
                                       
                                          
                                             c
                                             M
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                =
                                                k
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             h
                                             t
                                          
                                          ≤
                                          
                                             c
                                             N
                                          
                                          ,
                                       
                                     then it is cheaper to order a unit at time k and to store it until period l than ordering it at period l using modes of 
                                       N
                                    . Hence we can derive a new (optimal) solution from (
                                       
                                          
                                             x
                                             ^
                                          
                                          ,
                                          
                                             y
                                             ^
                                          
                                          ,
                                          
                                             s
                                             ^
                                          
                                       
                                    ) by ordering all the units of period l in period k. In this new solution period k is no longer an ordering period.

Otherwise, we have 
                                       
                                          
                                             c
                                             N
                                          
                                          <
                                          
                                             c
                                             M
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                =
                                                k
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             h
                                             t
                                          
                                       
                                    . Notice that the solution in which the supplied quantity at period k is decreased by a quantity 
                                       
                                          y
                                          =
                                          min
                                          {
                                          
                                             ∑
                                             m
                                          
                                          
                                             
                                                x
                                                ^
                                             
                                             k
                                             m
                                          
                                          −
                                          
                                             Q
                                             M
                                          
                                          ,
                                          
                                             
                                                s
                                                ^
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          }
                                       
                                     and the quantity ordered in period l is increased by the same amount y is feasible. If y > 0, the cost of this solution is strictly lower than the cost of (
                                       
                                          
                                             x
                                             ^
                                          
                                          ,
                                          
                                             y
                                             ^
                                          
                                          ,
                                          
                                             s
                                             ^
                                          
                                       
                                    ), which contradicts the choice of an optimal solution. Thus we should have 
                                       
                                          y
                                          =
                                          0
                                          ,
                                       
                                     which implies, since the stocks are positive within a subplan, that 
                                       
                                          
                                             ∑
                                             m
                                          
                                          
                                             
                                                x
                                                ^
                                             
                                             k
                                             m
                                          
                                          =
                                          
                                             Q
                                             M
                                          
                                       
                                    . We can conclude that period k is necessarily a TOP.

The property immediately follows by comparing the last ordering period l of a subplan with any other ordering periods within the subplan.□

In this section we first analyze the complexity of the ULS-FPC problem. Then we show that the ULS-FPC problem is a special case of the ULS with Minimum Order Quantities (ULS-MOQ) which proves that this problem is also NP-Hard.

                        Theorem 2
                        
                           The ULS-FPC problem is NP-hard, even if only two modes are available and the holding costs are null.
                        

The reduction is done from the Partition problem which, given n integers such that 
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    t
                                 
                                 =
                                 2
                                 A
                                 ,
                              
                            consists in answering the question: Is there a set S⊆{1, ⋅⋅⋅, n} such that 
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 =
                                 A
                              
                           ?

The key idea of the reduction is to define an instance for the ULS-FPC problem where the demands are increasing and the unit ordering costs are decreasing such that there is no demand anticipation in an optimal solution. In this case, in an optimal plan, an order will be set at each period except possibly the last one. In a period t, the choice between the two modes will correspond to selecting period t in the Partition problem.

More precisely, let us consider 
                              
                                 T
                                 =
                                 n
                                 +
                                 1
                              
                            periods with demands 
                              
                                 
                                    d
                                    t
                                 
                                 =
                                 
                                    4
                                    t
                                 
                                 D
                              
                            for 
                              
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            and 
                              
                                 
                                    d
                                    T
                                 
                                 =
                                 A
                                 ,
                              
                            where 
                              
                                 D
                                 =
                                 2
                                 A
                              
                           . We have two (ecological) modes f and g, with the same unit carbon parameter 
                              
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    t
                                 
                                 =
                                 −
                                 1
                              
                            for all periods. The supplying costs are defined as follows: 
                              
                                 
                                    p
                                    t
                                    f
                                 
                                 =
                                 2
                                 
                                    (
                                    
                                       4
                                       
                                          T
                                          −
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    f
                                    t
                                    f
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 
                                    p
                                    t
                                    g
                                 
                                 =
                                 
                                    4
                                    
                                       T
                                       −
                                       t
                                    
                                 
                              
                            and 
                              
                                 
                                    f
                                    t
                                    g
                                 
                                 =
                                 
                                    K
                                    t
                                    g
                                 
                                 ,
                              
                            where 
                              
                                 K
                                 t
                                 g
                              
                            is positive and defined in the following. The fixed emission parameters are 
                              
                                 
                                    ef
                                    t
                                    
                                       
                                       f
                                    
                                 
                                 =
                                 
                                    4
                                    t
                                 
                                 D
                              
                            and 
                              
                                 
                                    ef
                                    t
                                    
                                       
                                       g
                                    
                                 
                                 =
                                 
                                    4
                                    t
                                 
                                 D
                                 +
                                 
                                    a
                                    t
                                 
                              
                           .

The cost of supplying 
                              
                                 Q
                                 t
                                 f
                              
                            units in period t using mode f is equal to 2 × 4
                              T
                           
                           D for each period t < T. The cost of supplying 
                              
                                 Q
                                 t
                                 g
                              
                            units in period t using mode g is 
                              
                                 
                                    K
                                    t
                                    g
                                 
                                 +
                                 
                                    4
                                    T
                                 
                                 D
                                 +
                                 
                                    4
                                    
                                       T
                                       −
                                       t
                                    
                                 
                                 
                                    a
                                    t
                                 
                              
                           . It is always possible to define the setup cost 
                              
                                 K
                                 t
                                 g
                              
                            such that the cost of supplying 
                              
                                 Q
                                 t
                                 g
                              
                            units using mode g is equal to 
                              
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 +
                                 
                                    a
                                    t
                                 
                              
                            for each period t < T. Therefore, 
                              
                                 
                                    K
                                    t
                                    g
                                 
                                 =
                                 
                                    4
                                    T
                                 
                                 D
                                 −
                                 
                                    4
                                    
                                       T
                                       −
                                       t
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 +
                                 
                                    a
                                    t
                                 
                                 >
                                 0
                              
                           .

The instance is represented in Table 2
                           .

We want to show that an instance I of partition is positive if and only if there exists a feasible plan of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                              
                           .

If I is a positive instance, then it exists S such that 
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 =
                                 A
                              
                           . We can build a valid solution for the ULS-FPC problem by ordering a minimum order quantity using mode g if t ∈ S or using mode f otherwise. For 
                              
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                            it is possible to see that the demands are satisfied and to check that 
                              
                                 
                                    s
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 =
                                 A
                              
                           . The cost of the solution is 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                              
                           .

Conversely, assume that there exists a feasible supplying plan (x) of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                              
                           . We define S as the set of periods in which mode g is used, that is 
                              
                                 S
                                 =
                                 {
                                 t
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 T
                                 
                                 |
                                 
                                 
                                    x
                                    t
                                    g
                                 
                                 >
                                 0
                                 }
                              
                           . We want to show S defines a valid partition.

First, notice that the cost of satisfying the demand at a period t < T is at least 2 × 4
                              T
                           
                           D, since unit costs are decreasing. Notice also that if a policy orders in the last period, it incurs a cost of at least 2A whatever mode f or g is used. As a consequence, no quantity is supplied in the last period T in a solution of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                                 ,
                              
                            and thus we must have 
                              
                                 
                                    s
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 ≥
                                 A
                              
                           .

Moreover, in any solution of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                                 ,
                              
                            a supplying order must occur at each period 0 ≤ t < T. Indeed, assume that k is the first period such that 
                              
                                 
                                    x
                                    k
                                    f
                                 
                                 =
                                 
                                    x
                                    k
                                    g
                                 
                                 =
                                 0
                                 ,
                              
                            then 
                              
                                 
                                    s
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ≥
                                 
                                    4
                                    k
                                 
                                 D
                              
                           . Supplying the 4
                              k
                           
                           D units of demand costs at least 
                              
                                 
                                    4
                                    
                                       T
                                       −
                                       (
                                       k
                                       −
                                       1
                                       )
                                    
                                 
                                 =
                                 4
                                 ×
                                 
                                    4
                                    
                                       T
                                       −
                                       k
                                    
                                 
                                 >
                                 2
                                 ×
                                 
                                    4
                                    
                                       T
                                       −
                                       k
                                    
                                 
                                 ,
                              
                            which is the cost of supplying the demand at period k. Consequently, at least one mode is used in each period 0 ≤ t < T.

We show that in any solution of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                                 ,
                              
                            exactly one mode is used in each period 0 ≤ t < T. If we assume that two modes are used in period k, then the total cost would be at least the sum of the lowest cost of supplying the demand using a single mode and a lower bound on the cost induced by using the two modes in period k, i.e. 
                              
                                 n
                                 
                                    (
                                    2
                                    ×
                                    
                                       4
                                       T
                                    
                                    D
                                    )
                                 
                                 +
                                 4
                                 D
                                 >
                                 n
                                 
                                    (
                                    2
                                    ×
                                    
                                       4
                                       T
                                    
                                    D
                                    )
                                 
                                 +
                                 A
                              
                           . Therefore, only one mode is used in each period 0 ≤ t < T.

In addition, in any solution of cost at most 
                              
                                 n
                                 (
                                 2
                                 ×
                                 
                                    4
                                    T
                                 
                                 D
                                 )
                                 +
                                 A
                                 ,
                              
                            there is no incentives to order a quantity larger than the threshold of the chosen mode, except for the period 
                              
                                 n
                                 =
                                 T
                                 −
                                 1
                              
                           . Let y be the difference between xn
                            and the threshold of the mode used in period n. Notice that the unit cost in period n is at least 4. Hence the total cost of solution x is at least 
                              
                                 n
                                 
                                    (
                                    2
                                    ×
                                    
                                       4
                                       T
                                    
                                    D
                                    )
                                 
                                 +
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 +
                                 4
                                 y
                                 ,
                              
                            which implies that 
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 +
                                 4
                                 y
                                 ≤
                                 A
                              
                           . However, the entering stock level at period T is equal to 
                              
                                 
                                    s
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 +
                                 y
                              
                            and must be greater or equal than A. It results that 
                              
                                 y
                                 =
                                 0
                              
                            and 
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       S
                                    
                                 
                                 
                                    a
                                    t
                                 
                                 =
                                 A
                              
                           . We can conclude that S defines a valid partition for I.□

Considering the results of Section 3, one can see the ULS-FPC problem as a multi-mode lot-sizing problem with a minimum order quantity for each mode or combination of two modes. These minimum order quantities correspond to the minimum threshold orders defined in Section 3. Only specific versions (with a single mode) of the ULS with Minimum Order Quantities (ULS-MOQ) were studied in the literature. Okhrin and Richter (2011b) propose an O(T
                     3) dynamic programming algorithm to solve the ULS-MOQ with constant capacity and minimum order quantities, constant holding costs and no setup and production costs. Hellion, Mangione, and Penz (2012) and Hellion, Mangione, and Penz (2013) address the same problem of Okhrin and Richter (2011b) by considering concave production costs. The authors propose an O(T
                     6) dynamic programming algorithm to solve this problem. Okhrin and Richter (2011a) develop an O(T
                     2) dynamic programming algorithm to solve the ULS-MOQ with constant minimum order quantities, constant holding costs and no setup and production costs. Park and Klabjan (2013) develop an O(T
                     7) dynamic programming algorithm to solve the ULS-MOQ with constant capacity, non-increasing linear costs and non-increasing minimum order quantities. To the best of our knowledge, the complexity of ULS-MOQ was not studied in the literature.

                        Theorem 3
                        
                           The ULS-FPC is an instance of the ULS with Minimum Order Quantities (ULS-MOQ).
                        

Suppose that the number of modes plus the number of combinations of two modes (called sources) for each period t is equal to Mt
                           . We can construct an instance of the ULS-MOQ with 
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    M
                                    t
                                 
                              
                            periods. Each period t of the ULS-FPC problem is associated with a set of Mt
                            consecutive periods 
                              
                                 
                                    Δ
                                    t
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       t
                                       ,
                                       1
                                       )
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                       (
                                       t
                                       ,
                                       
                                          M
                                          t
                                       
                                       )
                                    
                                    }
                                 
                              
                           . Each period (t, j) ∈ Δt
                            is associated with a source (denoted j). At each period (t, j), it is possible to produce from a single source j with a minimum order quantity 
                              
                                 
                                    Q
                                    t
                                    j
                                 
                                 ,
                              
                            corresponding to the use of a single ecological mode or a combination of two modes. The inventory cost at the end of each period (t, j) such that 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    M
                                    t
                                 
                                 −
                                 1
                              
                            is set to zero. For the last sub-period (t, Mt
                           ), the inventory cost is set to ht
                           . Fig. 1
                            illustrates the construction of the instance of the ULS-MOQ problem. The dashed rounded rectangles correspond to the ULS-FPC periods and the normal nodes to the ULS-MOQ periods. The flow in arc (X, (t, j)) corresponds to the quantity produced in period t using source j, the flow in arc 
                              
                                 (
                                 
                                    (
                                    t
                                    ,
                                    
                                       M
                                       t
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    t
                                    +
                                    1
                                    ,
                                    1
                                    )
                                 
                                 )
                              
                            corresponds to the stock at the end of period t and the arc 
                              
                                 (
                                 (
                                 t
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 t
                                 ,
                                 j
                                 +
                                 1
                                 )
                                 )
                              
                            corresponds to a stock with a zero cost. The demand is null for each period (t, j) with j < Mt
                           , and dt
                            for period (t, Mt
                           ).

In an optimal solution of the ULS-MOQ problem, at most one 
                              
                                 x
                                 t
                                 j
                              
                            is strictly greater than 0 for each set of periods Δt
                           . This is due to null inventory costs within each set of periods Δt
                           . Indeed, for every supplied quantity x, the best ordering period j is such that 
                              
                                 
                                    Q
                                    t
                                    j
                                 
                                 ≤
                                 x
                              
                            at lowest cost.

Then, solving the ULS-FPC problem with T periods is thus equivalent to solving an instance of the ULS-MOQ problem with 
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    M
                                    t
                                 
                              
                            periods. 
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    M
                                    t
                                 
                              
                            is bounded by O(TM
                           2) since the number of sources at each period is in O(M
                           2).□

The corollary below can be derived from Theorems 2 and 3.

                        Corollary 1
                        
                           The ULS with minimum order quantities (ULS-MOQ) is NP-Hard even with null holding costs.
                        

In this section, we develop a first dynamic programming algorithm to solve the problem where only carbon emission parameters do not vary over time. We propose a second pseudo-polynomial dynamic programming algorithm to solve ULS-FPC problem in the stationary case, where carbon emission parameters and costs do not vary over time. Proposing an efficient solution is challenging. In particular, the Zero-Inventory-Ordering (ZIO) policy is not dominant for ULS-FPC, contrary to the case where the fixed carbon emissions are null, see Absi et al. (2013). In fact the best ZIO policy may be arbitrarily bad comparing to the optimal policy. This property is not dominant for several lot-sizing problems such as lot-sizing with minimum order quantities.

                        Theorem 4
                        
                           For the ULS-FPC problem, the cost of the best ZIO policy may be arbitrarily large compared to the cost of an optimal policy.
                        

Let us consider an instance with 
                              
                                 T
                                 =
                                 2
                              
                            and 
                              
                                 M
                                 =
                                 1
                              
                           . The parameters of the ecological mode are 
                              
                                 e
                                 
                                    v
                                    t
                                    1
                                 
                                 =
                                 1
                              
                            and 
                              
                                 
                                    ef
                                    t
                                    
                                       
                                       1
                                    
                                 
                                 =
                                 2
                              
                           . The maximum carbon emission per product is 
                              
                                 
                                    E
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                                 =
                                 2
                              
                           . Consequently 
                              
                                 
                                    
                                       
                                          e
                                          v
                                       
                                       ¯
                                    
                                    t
                                    1
                                 
                                 =
                                 −
                                 1
                              
                            and 
                              
                                 
                                    Q
                                    t
                                    1
                                 
                                 =
                                 −
                                 
                                    2
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                 
                                 =
                                 2
                              
                           . Demands and costs are given in Table 3
                           .

It is easy to see that the cost of the best ZIO solution is D while the cost of an optimal (non-ZIO) solution is 1 as shown in Table 4
                           . □

In this section we suppose that only carbon emission parameters are stationary. The following dynamic programming approach is based on the efficient calculation of the cost of subplans Suv
                         for which 
                           
                              
                                 s
                                 u
                              
                              =
                              
                                 s
                                 
                                    v
                                    −
                                    1
                                 
                              
                              =
                              0
                           
                        . A supplying plan consists of a sequence of subplans. The solution is obtained in O(T
                        2) when the costs of subplans are given (see for example Florian & Klein, 1971). Since the inventory at the end of the horizon sT
                         can be positive, we introduce a dummy period 
                           
                              T
                              +
                              1
                           
                         with a very high demand, the same stationary emission parameters and the following costs: 
                           
                              
                                 f
                                 T
                                 m
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 p
                                 T
                                 m
                              
                              =
                              0
                              
                              ∀
                              m
                           
                         and 
                           
                              
                                 h
                                 
                                    T
                                    −
                                    1
                                 
                              
                              =
                              0
                           
                        . This ensures a zero stock at the end of period 
                           
                              T
                              +
                              1
                           
                        .

In a subplan Suv
                        , an optimal supplying plan is a sequence of TOP periods following by a NOP period, possibly interrupted by periods without orders. If 
                           
                              
                                 Q
                                 1
                              
                              ,
                              …
                              ,
                              
                                 Q
                                 
                                    M
                                    
                                       u
                                       v
                                    
                                 
                              
                              ≤
                              
                                 ∑
                                 
                                    t
                                    =
                                    u
                                 
                                 
                                    v
                                    −
                                    1
                                 
                              
                              
                                 d
                                 t
                              
                           
                         are the possible thresholds for the subplan, the demand can be expressed as follows:

                           
                              
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          u
                                       
                                       
                                          v
                                          −
                                          1
                                       
                                    
                                    
                                       d
                                       t
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                          
                                             u
                                             v
                                          
                                       
                                    
                                    
                                       a
                                       m
                                    
                                    
                                       Q
                                       m
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       
                                          (
                                          
                                             a
                                             1
                                          
                                          ,
                                          ⋯
                                          ,
                                          
                                             a
                                             m
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Where 
                           
                              0
                              ≤
                              
                                 a
                                 m
                              
                              <
                              v
                              −
                              u
                           
                         are non negative integers, such that 
                           
                              
                                 ∑
                                 
                                    m
                                    =
                                    1
                                 
                                 
                                    M
                                    
                                       u
                                       v
                                    
                                 
                              
                              
                                 a
                                 m
                              
                              ≤
                              v
                              −
                              u
                           
                        . The number of vectors a is in O(TM
                        ) as each component is in O(T).

For a given vector 
                           
                              
                                 a
                                 ^
                              
                              ,
                           
                         we have to find the best supplying plan. As we know 
                           
                              
                                 
                                    ɛ
                                 
                                 
                                    (
                                    
                                       
                                          a
                                          ^
                                       
                                       1
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                       
                                          a
                                          ^
                                       
                                       m
                                    
                                    )
                                 
                              
                              ,
                           
                         the NOP period t′ can be determined. We have to calculate the best supplying plan from u to 
                           
                              
                                 t
                                 ′
                              
                              −
                              1
                              ,
                           
                         knowing the number of each mode to use (
                           
                              
                                 
                                    a
                                    ^
                                 
                                 1
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                    ^
                                 
                                 m
                              
                           
                        ). The recursive formula of the dynamic program, based on the best cost to reach period t with a cumulative ordering 
                           
                              
                                 x
                                 t
                              
                              ^
                           
                         is as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             H
                                             (
                                             t
                                             ,
                                             
                                                
                                                   x
                                                   t
                                                
                                                ^
                                             
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   Q
                                                   m
                                                
                                             
                                             
                                                (
                                                H
                                                
                                                   (
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   
                                                      
                                                         x
                                                         t
                                                      
                                                      ^
                                                   
                                                   )
                                                
                                                +
                                                
                                                   h
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                         t
                                                      
                                                      ^
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         u
                                                      
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      d
                                                      k
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             H
                                             
                                                (
                                                t
                                                −
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                      t
                                                   
                                                   ^
                                                
                                                −
                                                
                                                   Q
                                                   m
                                                
                                                )
                                             
                                             +
                                             
                                                h
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      t
                                                   
                                                   ^
                                                
                                                −
                                                
                                                   Q
                                                   m
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      u
                                                   
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   k
                                                
                                                )
                                             
                                             +
                                             
                                                p
                                                t
                                                m
                                             
                                             
                                                Q
                                                m
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Each state can be evaluated in O(M) and we have O(TM
                        ) states because 
                           
                              v
                              −
                              u
                           
                         is in O(T), leading to a complexity in O(MTM
                        ) for each vector 
                           
                              (
                              
                                 
                                    a
                                    ^
                                 
                                 1
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                    ^
                                 
                                 m
                              
                              )
                           
                        . The best cost for a subplan (u, v) is given by:

                           
                              
                                 
                                    
                                       
                                          
                                             G
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   a
                                                   ^
                                                
                                             
                                             
                                                (
                                                H
                                                
                                                   (
                                                   
                                                      t
                                                      ′
                                                   
                                                   −
                                                   1
                                                   ,
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                         
                                                            u
                                                            v
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                         ^
                                                      
                                                      m
                                                   
                                                   
                                                      Q
                                                      m
                                                   
                                                   )
                                                
                                                +
                                                
                                                   h
                                                   
                                                      
                                                         t
                                                         ′
                                                      
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                         
                                                            u
                                                            v
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                         ^
                                                      
                                                      m
                                                   
                                                   
                                                      Q
                                                      m
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         u
                                                      
                                                      
                                                         
                                                            t
                                                            ′
                                                         
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      d
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             S
                                             S
                                             
                                                Q
                                                
                                                   t
                                                   ′
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ɛ
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            a
                                                            ^
                                                         
                                                         1
                                                      
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         
                                                            a
                                                            ^
                                                         
                                                         m
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              S
                              S
                              
                                 Q
                                 
                                    t
                                    ′
                                 
                              
                              
                                 (
                                 Q
                                 )
                              
                           
                         is the best cost of supplying the quantity Q at period t′ and storing demands of periods 
                           
                              
                                 t
                                 ′
                              
                              +
                              1
                           
                         to 
                           
                              v
                              −
                              1
                           
                        . 
                           
                              S
                              S
                              
                                 Q
                                 
                                    t
                                    ′
                                 
                              
                              
                                 (
                                 Q
                                 )
                              
                           
                         can be calculated in O(M
                        2). For each subplan (u, v), the complexity is in O(M
                        3
                        T
                        2M
                        ). As O(T
                        2) subplans must be calculated to obtain the optimal solution, the total complexity is in 
                           
                              O
                              (
                              
                                 M
                                 3
                              
                              
                                 T
                                 
                                    2
                                    M
                                    +
                                    2
                                 
                              
                              )
                           
                        . If M is fixed, this complexity becomes 
                           
                              O
                              (
                              
                                 T
                                 
                                    2
                                    M
                                    +
                                    2
                                 
                              
                              )
                           
                        .

The proposed algorithm is polynomial when M is fixed but the computational complexity is relatively high for large values of M. When we have only one mode the complexity is reduced to O(T
                        4) which means that the ULS-MOQ problem with stationary minimum order quantities can be solved with the same complexity. We conclude through this analysis that this algorithm cannot be used in practice for industrial variants of the ULS-FPC problem with a high number of modes. In what follows, we propose a pseudo-polynomial dynamic programming algorithm to solve the ULS-FPC with stationary parameters and costs. Its complexity depends mainly on the mean value of the demands.

In this section we suppose that carbon emission parameters and costs are stationary. In the stationary case, it is optimal to order only when the inventory level at the beginning of period t is strictly lower than the demand in period t, i.e. when 
                           
                              
                                 s
                                 
                                    t
                                    −
                                    1
                                 
                              
                              <
                              
                                 d
                                 t
                              
                           
                        . This is because it is always possible to improve a solution in which there is an order in period t and 
                           
                              
                                 s
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ≥
                              
                                 d
                                 t
                              
                           
                         by moving the next production period to 
                           
                              t
                              +
                              1
                           
                        .

A forward pseudo-polynomial dynamic programming algorithm is derived based on the fact that, even though the ZIO policy is not optimal (see Theorem 4), the number of inventory levels that can be reached in a given period t can be discretized. Then a state of the dynamic programming is associated with each period and each stock level.

From the properties in Section 3, we know that strictly positive initial inventory levels 
                           
                              s
                              
                                 t
                                 −
                                 1
                              
                           
                         can only be reached from Threshold Ordering Periods (TOPs) since a Non-threshold Ordering Period (NOP) leads to a period with zero inventory level.

Let us define some notations to formalize the dynamic programming algorithm:

                           
                              •
                              Let 
                                    
                                       G
                                       (
                                       t
                                       ,
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                  be the minimum cost to attain inventory level 
                                    
                                       s
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                  (
                                    
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       <
                                       
                                          d
                                          t
                                       
                                    
                                 ) at the beginning of period t,


                                 SSC(Q) denotes the smallest cost to supply a quantity Q using a mode or a combination of two modes considering their threshold order quantities.

The recursion formula of the dynamic programming algorithm is as follows for 
                           
                              t
                              ∈
                              {
                              1
                              ,
                              ⋯
                              ,
                              T
                              +
                              1
                              }
                           
                        :

                           
                              
                                 
                                    
                                       
                                          
                                             G
                                             (
                                             t
                                             ,
                                             
                                                s
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      (
                                                      
                                                         t
                                                         ′
                                                      
                                                      ,
                                                      
                                                         s
                                                         
                                                            
                                                               t
                                                               ′
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      |
                                                   
                                                   
                                                      t
                                                      ′
                                                   
                                                   <
                                                   t
                                                
                                             
                                             
                                                (
                                                G
                                                
                                                   (
                                                   
                                                      t
                                                      ′
                                                   
                                                   ,
                                                   
                                                      s
                                                      
                                                         
                                                            t
                                                            ′
                                                         
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                S
                                                S
                                                C
                                                
                                                   (
                                                   Q
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                
                                                   min
                                                   (
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   T
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             
                                                h
                                                l
                                             
                                             
                                                (
                                                
                                                   s
                                                   
                                                      
                                                         t
                                                         ′
                                                      
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                Q
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                   l
                                                
                                                
                                                   d
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where the supply quantity is 
                           
                              Q
                              =
                              
                                 s
                                 
                                    t
                                    −
                                    1
                                 
                              
                              −
                              
                                 s
                                 
                                    
                                       t
                                       ′
                                    
                                    −
                                    1
                                 
                              
                              +
                              
                                 ∑
                                 
                                    l
                                    =
                                    
                                       t
                                       ′
                                    
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              
                                 d
                                 l
                              
                           
                         and the supplying cost for this quantity is SSC(Q). The quantity Q must verify Q ≥ Qmin
                         where Qmin
                         is the minimum threshold order for the selected mode or the combination of two modes. The optimal policy is the minimum among all values 
                           
                              G
                              (
                              T
                              +
                              1
                              ,
                              
                                 s
                                 T
                              
                              )
                           
                        . The complexity of the dynamic program is detailed below:

                           
                              •
                              Each SSC(Q) can be computed in O(M
                                 2), but this complexity can be reduced by using a pre-processing procedure. As at most two modes are used to supply a given quantity, O(M
                                 2) threshold orders have to be calculated. The pre-processing procedure is used to determine the breakpoints and slopes of SSC(.). This can be done in O(M
                                 3). The value of a given SSC(Q) can then be calculated in O(log M).


                                 
                                    
                                       G
                                       (
                                       t
                                       ,
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                  with 
                                    
                                       0
                                       <
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       <
                                       
                                          d
                                          t
                                       
                                    
                                 : This state is reachable from TOP periods (see Property 4) and has then O(M) predecessors. Each state 
                                    
                                       G
                                       (
                                       t
                                       ,
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                  can be computed in O(M). The number of these states is in 
                                    
                                       O
                                       (
                                       T
                                       
                                          
                                             d
                                             ¯
                                          
                                          t
                                       
                                       )
                                       ,
                                    
                                  where 
                                    
                                       
                                          d
                                          ¯
                                       
                                       t
                                    
                                  is the mean value of the demands.


                                 
                                    
                                       G
                                       (
                                       t
                                       ,
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                  with 
                                    
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 : This state is reachable from NOP periods (see Property 4) and has then 
                                    
                                       O
                                       (
                                       T
                                       
                                          
                                             d
                                             ¯
                                          
                                          t
                                       
                                       )
                                    
                                  potential predecessors each one can be evaluated in O(log M). The number of these states is in O(T).

The stock at the end of the horizon sT
                                  depends on the maximum threshold orderings. In order to avoid calculating all the states related to this maximum threshold orderings, we only need to consider each state 
                                    
                                       (
                                       t
                                       ,
                                       
                                          s
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                  and each mode as source to lead to a final stock sT
                                 . This can be done in 
                                    
                                       O
                                       (
                                       T
                                       M
                                       
                                          
                                             d
                                             ¯
                                          
                                          t
                                       
                                       )
                                    
                                 .

Finally, the proposed dynamic program is in 
                           
                              O
                              (
                              
                                 M
                                 3
                              
                              +
                              
                                 (
                                 T
                                 M
                                 +
                                 
                                    T
                                    2
                                 
                                 log
                                 M
                                 )
                              
                              
                                 
                                    d
                                    ¯
                                 
                                 t
                              
                              )
                           
                         and is pseudo-polynomial. This shows that the studied problem is NP-hard in the weak sense.

The complexity of this dynamic programming algorithm depends on the mean value of the demands (
                           
                              
                                 d
                                 ¯
                              
                              t
                           
                        ). If the mean value of the demands is relatively small, the complexity tends to 
                           
                              O
                              (
                              
                                 M
                                 3
                              
                              +
                              
                                 (
                                 T
                                 M
                                 +
                                 
                                    T
                                    2
                                 
                                 log
                                 M
                                 )
                              
                              )
                           
                         which is a reasonable complexity. Otherwise, for high values of 
                           
                              
                                 
                                    d
                                    ¯
                                 
                                 t
                              
                              ,
                           
                         the complexity of the algorithm explodes. Note that the ULS-FPC does not correspond to an industrial problem but corresponds to a subset of some industrial constraints. In fact, real-life problems consider in particular, multiple items, resource capacity constraints and transportation capacity constraints. Solving ULS-FPC efficiently can help developing decomposition methods for the multi-item capacitated version of the ULS-FPC problem. For example, a decomposition approach calls the solution method of sub-problems thousands or millions of times. If the algorithm that solves the ULS-FPC problem is not efficient, which means that the CPU time is more than a second, a decomposition approach for industrial problems will be non-efficient. Despite the high complexity of this algorithm, we can derive efficient heuristics approaches by using rounding heuristics. In fact, demands can be normalized in order to obtain low values of demands. This can be done in order to reduce the global complexity of the algorithm. Such heuristics should be studied by analyzing their worst case.

We studied the single-item lot sizing problem with periodic carbon emission constraints and fixed carbon emissions (ULS-FPC). Several structural properties of the problem were presented, and we showed that considering fixed carbon emissions makes the problem NP-hard. We also proposed two dynamic programming algorithms. The first dynamic programming algorithm is polynomial when the number of modes is fixed. It solves the problem where only carbon emission parameters are stationary. This complexity grows quickly since when the number of modes is not fixed the proposed algorithm is exponential. The second dynamic programming algorithm is pseudo-polynomial and solves the ULS-FPC problem with stationary carbon emission parameters and costs, showing that the studied problem is NP-hard in the weak sense. The computational complexity depends mainly on the mean value of the demands which can lead to a high complexity when facing large demand values.

Several perspectives could be investigated. In particular, as the problem is NP-hard, heuristics could be proposed for ULS-FPC. It would also be relevant to work on multi-item problems in at least two directions. First, supplying (production and/or transportation) capacity could be taken into account. Second, we could extend the present work by considering that fixed carbon emissions are associated to the total supplied quantity and not the quantity per product. We actually believe that combining both extensions would lead to complex but interesting research problems.

@&#REFERENCES@&#

