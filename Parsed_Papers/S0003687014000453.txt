@&#MAIN-TITLE@&#Estimating oxygen consumption from heart rate using adaptive neuro-fuzzy inference system and analytical approaches

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose an individualized fuzzy model for the estimation of VO2 using HR measurements.


                        
                        
                           
                           We propose an individualized analytical model to estimate VO2 using HR measurements.


                        
                        
                           
                           We propose a general fuzzy model that does not require individual calibration for VO2 estimation of groups of workers.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Work design

Oxygen consumption

Heart rate monitoring

@&#ABSTRACT@&#


               
               
                  In new approaches based on adaptive neuro-fuzzy systems (ANFIS) and analytical method, heart rate (HR) measurements were used to estimate oxygen consumption (VO2). Thirty-five participants performed Meyer and Flenghi's step-test (eight of which performed regeneration release work), during which heart rate and oxygen consumption were measured. Two individualized models and a General ANFIS model that does not require individual calibration were developed. Results indicated the superior precision achieved with individualized ANFIS modelling (RMSE = 1.0 and 2.8 ml/kg min in laboratory and field, respectively). The analytical model outperformed the traditional linear calibration and Flex-HR methods with field data. The General ANFIS model's estimates of VO2 were not significantly different from actual field VO2 measurements (RMSE = 3.5 ml/kg min). With its ease of use and low implementation cost, the General ANFIS model shows potential to replace any of the traditional individualized methods for VO2 estimation from HR data collected in the field.
               
            

@&#INTRODUCTION@&#

Ergonomics and occupational health and safety researchers have demonstrated the importance of designing jobs within the physiological capacity of the workforce (Dempsey et al., 2008). Studies have shown that designing jobs based on the balance between this capacity and the energetic demands of physical jobs is key to maintaining workforce safety and productivity (Malchaire et al., 1984; Abdelhamid, 1999; Wu and Wang, 2002; Dempsey et al., 2008). Oxygen consumption (VO2) reflects energy expenditure (EE) associated with physically demanding jobs (Malchaire et al., 1984; Smolander et al., 2008; Wu and Wang, 2002; Bouchard and Trudeau, 2008). Since direct measurement of VO2 requires sophisticated and costly devices, is invasive and often not practical in actual work environments, attempts have been made to find alternative feasible estimation methods (e.g., ISO-8996, 2004; Smolander et al., 2008). Many researchers have reported a linear relationship between oxygen consumption and heart rate for a wide variety of activities (Wyndham et al., 1962; Poulsen and Asmussen, 1962; McArdle et al., 1971; Rodahl et al., 1974; Evans et al., 1983; Gordon et al., 1983; Astrand and Rodahl, 1986). Hence, determining an individual's VO2–HR relationship (calibration curve) has become a very common practice to assess VO2 from HR data (Smolander et al., 2008). This calibration process involves measuring an individual's HR and VO2 while performing a graded exercise, such as treadmill, stationary bicycle or step-test. The linear relationship between the two variables is then modelled using graphical or linear regression analysis. The model is then used to estimate VO2 from HR data collected in the field for the same individual.

One major criticism of this method is the difficulty of establishing individual calibration curves at workplaces with large working populations. Even though the calibration procedure is simple, it is time consuming (at least 45 min per individual), requires a trained practitioner, and requires access to a controlled environment. Another criticism is the fact that at low activity levels (low workload intensity), the relationship between HR and VO2 is nonlinear and often deviates from the calibration curve and thus may produce inaccurate estimates of VO2 (Abdelhamid, 1999; Bouchard and Trudeau, 2008; Smolander et al., 2008). In recent years, a number of artificial intelligence (AI) techniques have been proposed as alternatives to conventional statistical methods (Jang et al., 1997; Kaya et al., 2003; Yildirim and Bayramoglu, 2006). One of the most effective AI techniques, particularly for function approximation and pattern recognition, is the adaptive neuro-fuzzy inference system (ANFIS). It combines the unique ability of fuzzy logic to make decisions in uncertain conditions with the learning and adaptive capabilities of artificial neural networks (Kaya et al., 2003). ANFIS has consistently been demonstrated effective in solving nonlinear function approximation problems, particularly in biomedical engineering (Güler and Übeyli, 2004, 2005; Übeyli and Güler, 2005a,b).

The primary objective of the present study is to develop a fuzzy-based general model for VO2 estimation from HR that does not require individual calibration and hence can be used quickly and easily by practitioners in actual workplaces. The secondary objective is to develop individualized models based on fuzzy logic and analytical methods that provide higher accuracy VO2 estimates for laboratory and small population work environments applications. The proposed models are expected to improve handling of the nonlinearity and uncertainty involved in VO2 estimation. Heart rate and VO2 measurements performed in a laboratory environment and in the field were used to develop and test the proposed models. Their performance was compared with traditional individual methods, namely linear calibration (Schulz et al., 1989; Bouchard and Trudeau, 2008) and Flex-HR (Spurr et al., 1988; Ceesay et al., 1989) methods.

@&#METHODS@&#

A laboratory study was first conducted to develop individualized VO2 prediction models for each participant and compare their quality of fit performance. Then, part of the laboratory participants' data (approximately 70%) was used to develop the General ANFIS model, and the remaining data were used to feed it to generate VO2 estimates that could be compared with VO2 measurements. Next, a field study was conducted to collect new data to test and compare the performance of the different models (General ANFIS and individualized models).

A total of 27 healthy men aged from 20 to 45 years participated in the laboratory study and eight male forest workers performing regeneration release work participated in the field study (Table 1
                        ). Participants had to pass the pre-activity readiness questionnaire (PAR-Q) before being accepted for the studies (Chisholm et al., 1975; Shephard, 1988). No participants were competitive athletes, and none regularly used medication. Both studies were approved by the Human Research Ethics Committee of Polytechnique Montréal. All participants signed a written informed consent form prior to partaking in the studies.

@&#PROCEDURE@&#

All participants performed the Meyer and Flenghi (1995) step-test, which has the following advantages: simple, cost-effective, and practical, it can be implemented safely without imposing high cardiac strain, particularly for older and less active individuals. Imbeau et al. (2010) demonstrated that the highest exertion level on this test reached by a group of forest workers corresponded well to the exertion generally measured during typical regeneration release work.

This step-test has been validated against other graded submaximal exertion tests (Meyer and Flenghi, 1995) and against a maximal treadmill test (Imbeau et al., 2009). An additional advantage is that step frequency (15 steps per min paced with a metronome) is sufficiently low for any worker to be able to keep pace at all four step heights, for superior overall test precision and robustness. A detailed description of the Meyer and Flenghi step-test was provided in Kolus et al. (2013). The participant's heart rate and oxygen consumption were continuously measured during the test using a heart rate monitor (Polar Electro T-61 coded) and a portable oximeter (Cosmed Fitmate PRO), respectively. The laboratory study data set included the VO2–HR measurements collected at rest and for each step height of the step-test.

Regeneration release work involves variable workload intensities as a result of varied work conditions (e.g., sloping terrain, field obstacles, vegetation density, and stem diameters to be cut) (Toupin et al., 2007). The 8 forest workers who participated in the field experiment performed the Meyer and Flenghi step-test in the morning shortly after their arrival to the worksite, on the edge of the road close to the patch that had to be cleared during the day. According to Meyer and Flenghi (1995), one advantage of their test is that it was developed such that it can be administrated at the beginning of a workday without compromising a participants' ability to perform physical work throughout his work shift because of undue fatigue. During the test, heart rate and oxygen consumption were continuously measured with the same portable devices as in the laboratory experiment. Participant's HRrest was determined during the 5-min rest preceding the test. Upon completion of the step-test, the worker was released and started his regular workday. Worker heart rate was continuously measured throughout the day using the Polar Electro while oxygen consumption was measured with the Cosmed Fitmate PRO for an average duration of 37 min (range: 34–53 min) around mid morning. The Cosmed Fitmate PRO could not be used any longer since it was deemed uncomfortable by the workers. Nonetheless, the field VO2 measurements provided a means to validate the energy expenditure estimates produced by the different models with heart rate data as their main input. The field study data set included the VO2–HR measurements collected during the early morning step-test as well as VO2–HR measurements collected during work for all 8 workers. As with any existing HR-based VO2 estimation method, the HR data collected during work were corrected by one of the authors using the method proposed by Vogt et al. (1970, 1973) to remove the thermal component (or thermal pulse) from the field-measured HR data. This HR increase is related to an increase in body core temperature owing to work in hot conditions (Rowell, 1986; Kampmann et al., 2001) and it may lead to a significant VO2 overestimation when a participant's VO2–HR relationship from the morning step-test is used to estimate his work VO2 from HR measurements in the field.

A two-step approach was followed for models development (see Fig. 1
                        ). First, four “individualized” models for estimating VO2 from HR data were developed using each participant's step-test data from the laboratory experiment (N = 27 participants with 42 data samples per participant). Two of the models were developed using ANFIS and analytical methods, respectively. The other two models used traditional linear calibration and Flex-HR methods, respectively. Models quality of fit were compared. Next, a General ANFIS model was trained using the step-test data from a random sample of 19 laboratory participants. The HR data from the remaining 8 laboratory participants were fed to the General ANFIS model to generate VO2 estimates that were compared with corresponding VO2 measurements.

In the second step (field study) data from the early morning step-test (N = 8 participants with 42 data samples per participant) were used to develop four “individualized” models for each one of the 8 forest workers. Next, regeneration release work HR data (148 data samples per participant on average) were fed to the individualized models as well as to the General ANFIS model developed previously from laboratory data to produce work VO2 estimates that were compared with work VO2 measurements.

The individualized ANFIS model developed with each participant's data was associated with clustering parameters that were specific to the participant and hence used a specific rule-base. For example, the clustering parameters selected for Participant 3 were: r = 0.5, η = 1.25, 
                              
                                 
                                    
                                       ∈
                                       ¯
                                    
                                 
                                 =
                                 0.5
                              
                            and 
                              
                                 
                                    ∈
                                    ¯
                                 
                                 =
                                 0.15
                              
                           . As a result, three fuzzy rules were associated with the Participant 3's ANFIS model. The individual ANFIS was then trained for 100 epochs using 42 samples from Participant 3's data. The developed ANFIS model for this participant estimates VO2 with a 1.0 (ml/kg min) RMSE and R
                           2 = 0.97 (see Fig. 2
                           ).

A careful analysis of the laboratory data collected for each participant pointed to a bilinear relationship between HR and VO2, that is a relationship known as a “bilinear frontier” defined as a boundary formed by two half lines intersecting at one point (Labib and Khattar, 2010). A previous study by Schulz et al. (1989) supported this idea as they represented the curve describing the relationship between HR and VO2 using two straight lines.

A unit step function is used to indicate the absence of the linear behaviour at low workload intensities. As shown in Fig. 3
                           , the curve describing the relationship between HR and VO2 over the range of all workload intensities can be represented as follows:
                              
                                 (1)
                                 
                                    
                                       f
                                       
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                a
                                                x
                                                −
                                                b
                                             
                                             )
                                          
                                       
                                       ·
                                       u
                                       
                                          
                                             (
                                             
                                                x
                                                −
                                                
                                                   b
                                                   a
                                                
                                             
                                             )
                                          
                                       
                                       +
                                       c
                                    
                                 
                              
                           where a, b, c > 0. x and f (x) indicate HR and VO2, respectively. The transition point in the heart rate profile that separates between low and moderate workload intensities is denoted by b/a while c represents a shift along the y-axis indicating the initial VO2 value during low workload intensity. For simplicity, the unit step function was approximated using the logistic function:
                              
                                 (2)
                                 
                                    
                                       f
                                       
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       ≅
                                       
                                          
                                             (
                                             
                                                a
                                                x
                                                −
                                                b
                                             
                                             )
                                          
                                       
                                       ·
                                       
                                          
                                             [
                                             
                                                
                                                   1
                                                   
                                                      1
                                                      +
                                                      
                                                         ⅇ
                                                         
                                                            −
                                                            p
                                                            
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     −
                                                                     
                                                                        b
                                                                        a
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       +
                                       c
                                    
                                 
                              
                           or
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             VO
                                          
                                          2
                                       
                                       ≅
                                       
                                          
                                             (
                                             
                                                a
                                                ·
                                                HR
                                                −
                                                b
                                             
                                             )
                                          
                                       
                                       ·
                                       
                                          
                                             [
                                             
                                                
                                                   1
                                                   
                                                      1
                                                      +
                                                      
                                                         ⅇ
                                                         
                                                            −
                                                            p
                                                            
                                                               
                                                                  (
                                                                  
                                                                     HR
                                                                     −
                                                                     
                                                                        b
                                                                        a
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       +
                                       c
                                    
                                 
                              
                           where p denotes a smoothing parameter such that a larger p corresponds to a sharper transition at x or HR = b/ɑ.

A Heaviside-based analytical model was developed for each one of the 27 participants by optimizing the parameters ɑ, b, c and p such that the bilinear curves represented by Eq. (3) would best fit the each participant's data. The Trust-Region Reflective Newton algorithm was used to solve the nonlinear optimization problem using MATLAB 7.5.0. This algorithm represents an improvement over the popular Levenberg–Marquardt algorithm and it is considered as one of the most efficient algorithms in solving difficult nonlinear optimization problems (Coleman and Li, 1996). For example, analysing the VO2–HR data collected from Participant 3 yielded the following Heaviside-based analytical model (see Fig. 4
                           ):
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             VO
                                          
                                          2
                                       
                                       ≅
                                       
                                          
                                             (
                                             
                                                0.4452
                                                ×
                                                HR
                                                −
                                                40.19
                                             
                                             )
                                          
                                       
                                       ×
                                       
                                          
                                             [
                                             
                                                
                                                   1
                                                   
                                                      1
                                                      +
                                                      
                                                         ⅇ
                                                         
                                                            −
                                                            0.2304
                                                            
                                                               
                                                                  (
                                                                  
                                                                     HR
                                                                     −
                                                                     90.274
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       +
                                       4.917
                                    
                                 
                              
                           with RMSE = 1.3 (ml/kg min) and R
                           2 = 0.95.

The traditional linear calibration model is a VO2–HR linear regression equation created for each participant using his laboratory step-test data (Schulz et al., 1989; Bouchard and Trudeau, 2008). For instance, the linear regression equation created from Participant 3's data was:
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             VO
                                          
                                          2
                                       
                                       =
                                       0.4393
                                       ×
                                       HR
                                       +
                                       34.4118
                                    
                                 
                              
                           with RMSE = 1.5 (ml/kg min) and R
                           2 = 0.94.

The Flex-HR model uses four parameters (resting VO2, Flex-HR point, slope and intercept of the linear portion of the VO2–HR relationship) to establish a participant's calibration curve (Spurr et al., 1988; Ceesay et al., 1989). The Flex-HR point was determined as the average of the lowest HR during the step-test and the highest HR during the sitting rest preceding the test (Valanou et al., 2006). Above the Flex-HR point, a linear regression equation was created from the corresponding VO2–HR data, while the average of VO2 values measured during sitting at rest was determined as the resting VO2. For instance, the parameters associated with Participant 3 were as follows: resting VO2 = 5.8 ml/kg min, Flex-HR point = 101 bpm, slope = 0.41 and intercept = −31.3. These parameters describing the Flex-HR model for Participant 3 yielded a RMSE = 1.4 (ml/kg min) and R
                           2 = 0.94.

The ANFIS model was developed using VO2 and HR laboratory step-test data. Measured HR and HRrest were used as input variables to the General ANFIS model while VO2 was used as the output variable. Several studies have recommended the 70%/30% randomly selected proportions of data for model training/validation (Kutner et al., 2004; Abu Bakar and Tahir, 2009). Therefore, the data from 19 randomly selected participants (798 data samples) were used to train the model (each participant providing 42 samples), while the data from the remaining 8 participants (336 data samples) were used to produce model estimates. An enumerative search for optimal determination of subtractive clustering parameters yielded the following selection of parameters: r = 0.9, η = 1.5, 
                              
                                 
                                    
                                       ∈
                                       ¯
                                    
                                 
                                 =
                                 0.9
                              
                            and 
                              
                                 
                                    ∈
                                    ¯
                                 
                                 =
                                 0.9
                              
                           . As a result, three clusters were identified each corresponding to one fuzzy IF–THEN rule. Once the initial FIS was developed, it was put in a neural network framework to optimize the rules parameters (premise and consequent parameters).

The back-propagation gradient descent method in combination with the least squares method for 20 epochs were used to train the model (MATLAB version 7.5.0 with fuzzy logic toolbox). It contains three fuzzy IF–THEN rules, with three Gaussian membership functions assigned to each input variable, and the total number of modifiable parameters is 21 (12 premise and 9 consequent parameters). Since the number of training samples was several times larger than the number of modifiable parameters being estimated and given that the training and the testing data sets were obtained from different participants, the General ANFIS model was expected to achieve good generalization capability (Yildiz et al., 2009).

The quality of fit of the individualized models were compared for HR values throughout the HR range as well as for three HR categories: very light work: <80 bpm; light work: 80–100 bpm; and moderate to heavy work: >100 bpm (Smolander et al., 2008). The VO2 estimates from the General ANFIS model using the data from the remaining 8 laboratory participants that had not been used to develop that model were compared with VO2 measurements across the complete HR range as well as for the three HR categories. The HR data measured during actual work in the field were used to generate work VO2 estimates with the five models (four individualized models developed from field step-test data and the General ANFIS model developed with laboratory data) that were compared with the VO2 measurements made during actual regeneration release work.

The quality of fit of the models and the comparisons among models were evaluated using: the root mean square error (RMSE) and the mean absolute percentage error (MAPE) between the measured and the model estimated VO2 (Azadeh et al., 2010). Student's two-tailed t-test for paired observations was used to test for differences between the values to be compared. A threshold of p < 0.05 was considered for statistical significance. Limits of agreement (LOA) between the measured VO2 values and the values estimated by the General ANFIS model and traditional estimation models (linear calibration and Flex-HR) were determined using the Bland–Altman plot to examine the accuracy of the estimation models (Bland and Altman, 1986). Moreover, the coefficient of variation (CV = standard deviation/sample mean × 100) was used to evaluate the performance of all VO2 estimation models.

@&#RESULTS@&#


                     Table 2
                      summarises the results obtained for each model and for each study's data. It reports the mean of all participants' average VO2 estimation per model as well as the corresponding mean RMSE and MAPE for the whole HR range and separately for the three HR categories. In addition, it includes a ranking of the different VO2 estimation model performance using the data from the two studies.

Results show that among the four individualized models developed with all 27 laboratory participants' data, the analytical and the linear calibration models overestimated measured VO2 with overall mean differences of 0.01 and 0.2 ml/kg min, respectively, whereas the individual ANFIS and the Flex-HR models underestimated measured VO2 with overall mean differences of 0.001 and 0.004 ml/kg min, respectively. When using only the data from the 8 laboratory participants not used to train the General ANFIS model, results showed much larger absolute differences between mean predicted and mean measured VO2 for all four individualized models: 0.7 ml/kg min for the linear calibration model, 0.9 ml/kg min for the Flex-HR and the analytical models and 0.9 ml/kg min for the individualized ANFIS. The General ANFIS model, on the other hand, overestimated the measured VO2 values with a 50% smaller overall mean difference (0.4 ml/kg min).

The VO2 relative difference associated with the interval HR < 80 bpm was smallest with the individual ANFIS model (1.5%) and largest with the General ANFIS model (11.9%). In the interval 80 < HR < 100 bpm, the smallest relative difference was obtained with the linear and Flex-HR models (0.3%), whereas the highest relative difference was obtained with the General ANFIS model (4.6%). The relative difference associated with the interval HR > 100 bpm was smallest with the individual ANFIS model (0.01%) and highest with the General ANFIS model (4.9%).

In terms of model estimation errors, results based on both the 27 and the 8 participants indicated the outperformance of the developed individual ANFIS over the other three individual models. Similarly, for different HR categories, the individual ANFIS model yielded the smallest relative estimation errors whereas the General ANFIS model yielded the highest relative errors.

Paired t-tests showed that the linear calibration model produced statistically significant differences between estimated and measured VO2 that could be observed throughout the HR range either with 27 or 8 participants, as well as in the higher HR range (Table 2). The analytical model overestimated significantly in the lower HR range and underestimated in the medium HR range. The General ANFIS model overestimated significantly in the lower HR range.

The Bland–Altman plot in Fig. 5
                        (a) depicts the limits of agreement (LOA) between the measured and estimated (i.e., by General ANFIS, linear calibration and Flex-HR models) VO2 values. The differences between the General ANFIS and VO2 measurements tend to decrease at low intensity levels compared with the linear calibration and Flex-HR models, whereas the opposite can be observed at higher intensity levels. The standard deviation figures and the LOA presented in Table 3
                         confirm this observation; compared with the other models in the lower HR range, the LOA are narrower for the General ANFIS and they increase with intensity level.

Results from the field study show that the linear calibration and Flex-HR models yielded larger mean prediction differences than in the laboratory (0.8 and 0.9 ml/kg min, respectively) whereas the individual ANFIS and the analytical models yielded much smaller errors (0.001 and 0.002 ml/kg min) across the overall HR range. The General ANFIS model underestimated the mean measured VO2 by 0.1 ml/kg min (Table 2). In the lower HR range, the relative difference between the measured VO2 values and the estimated values was smallest (0.01 ml/kg min) with the analytical model and highest (1.1 ml/kg min) with the linear calibration model. In the medium HR range, the relative difference was smallest (0.3 ml/kg min) for the individual ANFIS model and highest (1.2 ml/kg min) for the analytical model. In the higher HR range, the smallest relative difference was produced by the individual ANFIS (0.1 ml/kg min), while the highest was with the Flex-HR model (1.4 ml/kg min).

Rankings based on estimation errors show that the individual ANFIS model outperformed the other models (Table 2) while the analytical model provided second best performance. The General ANFIS performed comparably or slightly better on the overall HR range and for the lower HR range when compared to the linear calibration and Flex-HR models but, it produced the largest estimation errors in the medium and higher HR ranges. The paired t-test showed no significant difference between the mean measured VO2 and the mean VO2 estimated by any of the models, except for the Flex-HR model on the overall HR range.

The Bland–Altman plot in Fig. 5(b) shows the General ANFIS's prediction with field data generally comparable to that of the other models. Bias and SD figures in Table 3 indicate that the General ANFIS performs better than the other two models in the lower HR range. It performs comparably in the higher HR range and worse in the mid-range.

@&#DISCUSSION@&#

A key objective of this study was to develop an approach that is simpler and more practical than the current methods that require collecting individual calibration data on a number of workers when it comes to estimating work activity VO2 values from HR measurements. The General ANFIS model proposed here takes advantage of recent mathematical methods/software to improve on methods currently used by practitioners and many researchers to fit this purpose. As expected from the outset, the General ANFIS model was not the most accurate of the models compared in this paper since it does not use individual calibration data once it is developed. Laboratory results showed that the General ANFIS tended on average to slightly overestimate the measured VO2 values during very light (0.5 ml/kg min), light (0.5 ml/kg min) and moderate-to-heavy (0.7 ml/kg min) work (Table 2). The difference was statistically significant for the lower HR range (+11.9%), however it is comparable to the ±10% figure generally expected when estimating the metabolic rate based on HR measurements using the linear calibration method (ISO 8996, 2004).

On the other hand, the General ANFIS model performed better with field data with average estimation errors under 5%, that is an error magnitude generally expected with direct VO2 measurement methods (ISO 8996, 2004). Prediction performance of the General ANFIS model using field data was generally better on average than that of the linear calibration and Flex-HR models according to the metrics described in Table 2, and comparable as indicated by LOA analysis (Table 3). The results also show that the General ANFIS model provides better prediction in the lower HR range than the linear calibration method, thus indicating a better ability in dealing with the nonlinearity between VO2 and HR at low intensity levels. This study shows the General ANFIS model to be a practical, low cost and very efficient replacement for the linear calibration and Flex-HR since it can be used directly to predict VO2 values from HR measured during work. Although adequate knowledge of MATLAB was required to develop the model, it has been implemented in Excel so that researchers and practitioners can apply it easily as a decision support tool. The general ANFIS model that was trained with all laboratory data (27 participants) is expected to perform better than the general model that was trained with only 19 participants since it yielded a slightly higher R-square fitting parameter (0.94 vs. 0.92).

A secondary objective in this study was to tackle the problem of uncertainty and nonlinearity that exist in traditional VO2 estimation methods, especially at low workload intensity. Therefore, new approaches were proposed, namely the individual ANFIS and the analytical models. Results from laboratory and field studies showed the outstanding superiority of the proposed individualized ANFIS over the more traditional models (linear calibration and Flex-HR) throughout the whole HR range observed, and separately for different HR ranges. Table 4
                      shows the percentage reductions in RMSE and MAPE that can be achieved when preferring the individual ANFIS over the individualized traditional models tested in this paper. Hence, where individual calibration data is available and best prediction must be achieved, the individual ANFIS model should be preferred. As our results show, better precision can only be achieved at the expense of increased cost of implementation of the method (i.e., individual participant calibration data collection).

The model performance statistics from this study are coherent with the recent literature. For instance, the traditional linear calibration method has been reported to yield mean absolute errors (MAE) during the overall HR range of approximately 3.7 ml/kg min (Firstbeat Technologies, 2007) and 4 ml/kg min (Pulkkinen et al., 2004; Smolander et al., 2008). These results fairly agree with our findings over the full HR range (1.9 and 4.3 ml/kg min with laboratory and field data, respectively). The smallest, median and largest MAE values obtained in different HR ranges with laboratory and field data were 0.3, 1.5 and 4.3 ml/kg min, respectively (Table 2). Other studies found that this method yielded MAPE figures over the full HR range of 16.8% (Schulz et al., 1989) and 15–25% (Firstbeat Technologies, 2007), which are coherent with our findings (17% and 21.7% for the laboratory and field data, respectively). The smallest, median and largest MAPE obtained in different HR ranges with laboratory and field data were 1.9%, 16.1% and 23.7%, respectively. For the Flex-HR method, Firstbeat Technologies (2007) reported a 13.5% MAPE, while Ceesay et al. (1989) reported an RMSE of 1.3 ml/kg min. These figures compare to our laboratory results (MAPEs ranging from 0.9 to 12.4%, and RMSEs ranging from 0.2 to 1.3 ml/kg min). Firstbeat Technologies (2005) proposed a general neural network-based method for VO2 estimation based on both HR and heart rate variability, which gives additional information on respiration rate and/or on-off response phases. During simulated real-life tasks in a laboratory study, Pulkkinen et al. (2004) found this method to yield an MAE of approximately 2.5 ml/kg min. In comparison the General ANFIS model proposed here yielded better performance with laboratory data (MAE = 2.1 ml/kg min, range = 1.1–2.1 ml/kg min) and a slightly reduced performance with field data (MAE = 4.4 ml/kg min, range = 1.3–4.4 ml/kg min). The linear calibration model has been reported to yield a coefficient of variation (CV) of 19.1% (Bouchard and Trudeau, 2008), 21% (Schulz et al., 1989) and 29.6% (Anjos et al., 2007) over the full HR range. Also, it has been reported that the Flex-HR model yields a CV of 16.7% (Ceesay et al., 1989) and 18.6% (Spurr et al., 1988) over the full HR range. Our findings show comparable relative variations with laboratory data (20.4% and 15% for the linear calibration and Flex-HR, respectively) and field data (24.1% and 19.4% for the linear calibration and Flex-HR, respectively) (Table 2). In addition, the General ANFIS model proposed here yielded CVs of 18.8% (range = 17.2–20.8%) with laboratory and 15.5% (range = 7.9–21.8%) with field data, respectively, indicating a relative precision comparable to or better than that of the traditional individual estimation methods (Table 2).

Practitioners should be aware that the models developed in this study will overestimate VO2 when a significant thermal pulse is present. Hence, the HR thermal component must be removed at the data preparation stage prior to use (Vogt et al., 1970, 1973). Thanks to recent technological developments, core temperature can now be measured easily and noninvasively during actual work (e.g., VitalSense), and could be included as an input variable in the General ANFIS model. To improve robustness and generalizability of the models, further studies could include a larger number and variety of participants and a variety of actual work activities for General ANFIS training and validation. Investigating the influence of different membership functions (i.e., triangular) and incorporating other easily measured variables (e.g., age, weight, body mass index and physical fitness) could further improve model performance.

@&#CONCLUSION@&#

This paper presented new approaches for VO2 estimation based on HR measurements. In the first part of the paper, individual ANFIS and analytical models were proposed for VO2 estimation so as to treat the nonlinearity and uncertainty associated with physiological variables. Results indicated the better performance of the individual ANFIS (based on laboratory and field data) and analytical (based on field data) models over the traditional VO2 estimation models (linear calibration and Flex-HR). Therefore, the proposed individualized models and preferably the individual ANFIS, should be used in small population work environments or when very accurate VO2 estimation is desired. This paper also presented a General ANFIS model for VO2 estimation that does not require individual calibration data to be obtained. Results indicated the similarity between the measured VO2 and estimates from the General ANFIS model. This strongly implies that the General ANFIS model can replace the traditional VO2 estimation models especially in large population work environments where one cannot afford to have each participant take a graded exercise test and yet obtain a VO2 estimation that provides reasonable (±5%) accuracy. The proposed models do not only represent a new application of fuzzy logic for VO2 estimation, but they also can be implemented as easily as the traditional models due to the rapid software advancements in recent years.

The MATLAB code for the General ANFIS model, the models description (based on 19 and 27 participants), and the Excel file implementing both of these models can be obtained by contacting the first author of the paper.

@&#ACKNOWLEDGEMENTS@&#

This project received joint funding from the Ministère des Ressources Naturelles et de la Faune of Québec, the Fonds Québécois pour la Recherche sur la Nature et les Technologies (FQRNT), and the Natural Science and Engineering Research Council of Canada (NSERC), through the Canada Research Chair in Ergonomics of Polytechnique de Montreal.

@&#REFERENCES@&#

