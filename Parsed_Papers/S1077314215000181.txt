@&#MAIN-TITLE@&#Learning ramp transformation for single image super-resolution

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose an edge based single image super-resolution algorithm.


                        
                        
                           
                           Our algorithm involves learning how ramp profiles transform across resolutions.


                        
                        
                           
                           Ramp profiles are defined as monotonic pixel profiles across edges.


                        
                        
                           
                           Our results demonstrate several advantages compared to other techniques.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Super-resolution

Segmentation

Low-level vision

@&#ABSTRACT@&#


               
               
                  We propose the use of explicitly identified image structure to guide the solution of the single image super-resolution (SR) problem. We treat the image as a layout of homogeneous regions, surrounded by ramp edges of a larger contrast. Ramps are characterized by the property that any path through any ramp pixel, monotonically leading from one to the other side, has monotonically increasing (or decreasing) intensity values along it. Such a ramp profile thus captures the large contrast between the two homogeneous regions. In this paper, the SR problem is viewed primarily as one of super-resolving these ramps, since the relatively homogeneous interiors can be handled using simpler methods. Our approach involves learning how these ramps transform across resolutions, and applying the learnt transformations to the ramps of a test image. To obtain our final SR reconstruction, we use the transformed ramps as priors in a regularization framework, where the traditional backprojection constraint is used as the data term. As compared to conventional edge based SR methods, our approach provides three distinct advantages: (1) Conventional edge based SR methods are based on gradients, which use 2D filters with heuristically chosen parameters and these choices result in different gradient values. This sensitivity adversely affects learning gradient domain correspondences across different resolutions. We show that ramp profiles are more adaptive, stable and therefore reliable representations for learning edge transformations across resolutions. (2) Existing gradient based SR methods are often unable to sufficiently constrain the absolute brightness levels in the image. Our approach on the other hand, operates directly in the image intensity domain, enforcing sharpness as well as brightness consistency. (3) Unlike previous gradient based methods, we also explicitly incorporate dependency between closely spaced edges while learning ramp correspondences. This allows for better recovery of contrast across thin structures such as in high spatial frequency areas. We obtain results that are sharper and more faithful to the true image color, and show almost no ringing artifacts.
               
            

@&#INTRODUCTION@&#

Super-resolving an image entails estimating the intensities of a high resolution (HR) version of the image from the smaller number of intensities available in the given low resolution (LR) image. For even moderate upscaling factors, this problem is fundamentally very highly ill-posed. Choosing appropriate regularizers or priors for the single image super-resolution (SR) problem has therefore been a major focus of research in this area.

Priors for the SR problem can be broadly classified into patch based and edge based priors, depending on the domains in which they operate. Perhaps the simplest patch based priors are those which assume simple models for image smoothness (such as linear or cubic). Super-resolution then simply amounts to interpolation of the patch pixels according to the chosen model to obtain the sub-pixel values [14,15,30]. However, such methods tend to produce overly smooth results, and tend to produces artifacts such as chessboard effect along edges. A popular class of priors that are aimed at preserving sharpness are those which impose constraints on the marginal distributions of filterbank responses of the image [12,17]. Studies on statistical properties of natural images have found that these distributions are well modeled as Laplacians [12] or generalized Gaussians [17]. The constraints therefore occur in terms of fits of these distribution types to the data at hand. These priors, however, are used as a global constraint over the entire image. Spatial localization is incorporated only weakly at best [18].

More recently, learning based priors have aimed at estimating the relationship between LR and HR patches using a training database [9,28,27,22,29]. These learnt mappings are then used to predict the HR version of each patch of the given LR image. Freeman et al. [9,10] use a Markov random field (MRF) model to learn the relationship between LR and HR patches. Yeung et al. [29] uses ideas from manifold learning to capture this relationship, wherein the manifold of HR patches is assumed to be locally linear, and patches are expressed as a linear combinations of its neighbors. Yang et al. [27] express image patches as linear combinations of atoms from a dictionary of a fixed set of image patches. This is then extended to the case where the dictionary itself is learnt to support a sparse representation of patches [28,26].

While learning based patch priors have demonstrated success, they do have certain shortcomings. Image patches, depending on their size, can exhibit high degrees of complexity and variability and it is not clear how many samples are sufficient to adequately model the variability seen in generic images, and for effectively learning their mappings across resolutions. The choice of patch size in learning based methods is itself rather heuristic, and has a significant effect on the number of patches required for learning and on the SR result as well. Patch based approaches also tend to be susceptible to spurious artifacts near sharp edges, since patches containing sharp transitions in intensities may be difficult to model using limited number of training patches, unless a very similar patch exist in the training set.


                     Edge based priors attempt to overcome some of the limitations of patch based approaches described above. Edge smoothness priors [5,16,24] favor smooth contours (or isophotes) in the image, and are motivated by human perceptual preferences for smooth image boundaries [5,16,24]. These priors have been effective in minimizing artifacts along high contrast boundaries while producing geometrically smooth contours. However, they do not directly consider the sharpness of intensities across edges in the estimated HR image. Edge profile based priors address this issue by modeling 1-D edge profiles of the image and learning (using training data) how these profiles transform across resolutions [21,20,7,23,25]. In [7], statistics of 1-D edge profiles are obtained by computing moments of the profile shape, and their transformation across resolutions is learnt. The gradient profile prior (GPP) approach of [21,20], fits a generalized Gaussian distribution to edge profiles, and uses a sharpness parameter to transform them across resolutions. The aforementioned approaches try to reap advantages of 1-D modeling over 2-D patch modeling. 1-D profiles are of lower dimensionality than rectangular patches, and can be described by one [21] or a few [7] parameters.

While existing edge profile methods extract 1-D profiles, these profiles are obtained using gradients, which still invlove 2-D processing using a predefined filter. Computing gradients using predefined 2-D filters requires making strict assumptions about the geometry and scale of structures being detected [1]. Any choice of filter size and coefficients of the gradient operator essentially restricts the type of structures that can be detected, in terms of their scale and geometry. Such restrictions have a particularly detrimental effect on the SR problem, wherein all structures in the image, irrespective of their scale/geometry, need to be upscaled by learning correspondences between LR structures and their HR counterparts. Restrictions and assumptions on the scale/geometry introduced by 2D linear pre-processing causes distortions in learning this mapping, and therefore the advantage of subsequently using 1D profiles gets diminished.

In addition, imposing priors on gradients does not impose constraints on the absolute brightness values of the image. This sometimes leads to deviations in the brightness levels of the HR image relative to the given LR image in such methods [7,21]. We show this by an example presented in Fig. 1
                     , which shows an upsampling result obtained by the edge profile based method of [7].

In this paper we propose a new edge profile based prior for the SR problem, that overcomes some of the limitations of existing edge based methods as described above. We propose a method which avoids 2-D preprocessing for obtaining edge information. We do so by adopting the definition of image structure as proposed in [2,1]. We treat the image as a layout of homogeneous regions partitioning the image, each surrounded by ramp edges [2,1], as shown in Fig. 3(b). Such a layout is obtained by the simple requirement that the intensity variation within a region interior be strictly less than those in the ramps surrounding it. Ramps are characterized by the property that any path through a ramp pixel, monotonically leading from one to the other side, has monotonically increasing (or decreasing) intensity values along it. Such a ramp profile thus consists of a sharp intensity transition over a relatively narrow area between the interior intensities on the two sides, and thus captures the large contrast between the two regions.

Since ramps correspond to areas most affected by a change in resolution (as illustrated by the example in Fig. 2
                     ), we propose a prior for the SR problem that learns how ramps transform across resolutions. We model the 1-D ramp profiles using sigmoidal functions, adequately parameterized to allow the variability seen in ramp profiles extracted from natural images. We learn functions that map the ramp profiles from LR images to their HR counterparts using a set of training images. As we demonstrate in Section 2, ramp profiles are more robust descriptors of edge profiles as compared to gradient profiles. We do not use fixed size and fixed coefficient filters or templates for edge extraction. Like other edge based methods, the remaining non-ramp, homogeneous region interiors are super-resolved using the simple intensity conservation constraint [13].

Unlike gradient based edge profile priors, ramp profile modeling allows us to formulate our prior in the intensity domain. Gradient domain constraints are unable to accurately preserve brightness [7,20]. Our prior enforces sharpness directly in the image domain, thus avoiding deviations from the original intensities/colors.

Current edge profile based methods assume only a one-to-one transformation between an LR edge profile and its HR counterpart. However, we show that edge profiles across thin regions/structures also exhibit a non-trivial inter-dependency since the distance between two ramps (separated by a thin region) in an HR image may be small enough to cause an overlap between their domains of support in the corresponding LR image. We model such inter-edge profile relationship for better recovery of contrast across thin regions and structures.

In the next section, we describe the ramp based representation of image structure. In Section 3 we present an overview of the steps involved in our algorithm. Sections 4–7 describe our proposed algorithm in detail. Section 8 shows our results.

We now briefly review some of the key ideas of image modeling presented in [2] and the references therein.

A ramp profile 
                     
                        
                           R
                           (
                           x
                           ,
                           θ
                           )
                        
                      at a location 
                        
                           x
                        
                      in an image is defined as the longest sequence (ordered set) of monotonically increasing (or decreasing) pixel values along a path passing through 
                        
                           x
                        
                      in a particular direction θ. Ramp profiles, computed over a sufficiently large number of directions, quantify the intensity variations around a given edge location and capture the local edge structure. Ramp profiles are detected without using any predefined filters (e.g., along horizontal and vertical directions), are fully adaptive to structures of any width or height and they result from a bottom up process, without any prior assumptions [2]. We elaborate a bit more on these advantages in the context of the SR problem by a real world example in Section 3.

Using ramp profiles, Akbas and Ahuja [2] develops a low level segmentation algorithm that realizes the properties targeted in [1]: (i) it uses a realistic model of the segments - each region having a smoothly varying interior intensity profile, surrounded by a relatively steep intensity ramps; (ii) it provides a segmentation with quantitatively and qualitatively demonstrated accuracy that does not assume any priors on region geometry (shape, size), and region topology (how many regions neighbor a given region), but rather lets the segmentation structure emerge in a bottom-up fashion; (iii) it provides regions with closed contours as well as the hierarchy of their spatial embedding, the latter not being used in this paper; (iv) the results are perceptually valid.

To summarize, for an input image, the algorithm of [2] provides us with the following: (i) A binary valued edge map E, containing closed, single-pixel wide boundaries of smooth, homogeneous regions, with 
                        
                           E
                           =
                           {
                           e
                           :
                           E
                           (
                           e
                           )
                           =
                           1
                           }
                        
                     , denoting the set of these edge pixels. (ii) For each edge pixel 
                        
                           e
                           ∈
                           E
                        
                     , a set of D ramp profiles 
                        
                           R
                           (
                           e
                           ,
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           )
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           D
                        
                     , along D different directions 
                        
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 D
                              
                           
                        
                      passing through 
                        
                           e
                        
                     . These ramp profiles characterize the local image structure around the edge pixel 
                        
                           e
                        
                     . In our work, we compute ramps along 
                        
                           D
                           =
                           4
                        
                      different directions in the 2D image plane - horizontal, vertical and the two diagonals. Also, we deem a ramp profile valid only if it causes a specified minimum change in intensity level across it, which is above the sensor noise level. In our application, we set this threshold to be 15. Therefore, we deem a ramp profile to be valid only if it causes a gray level intensity change of at least 15 across it.


                     Fig. 3
                     (c) shows the edge map obtained via such a segmentation. Fig. 3(b) shows the ramp areas, i.e., areas that are populated by the ramp profiles at the edge pixels, which can be seen as forming a thin border around the edges.

To super-resolve a given image 
                        
                           
                              
                                 I
                              
                              
                                 LR
                              
                           
                        
                      defined in the LR domain 
                        
                           
                              
                                 Ω
                              
                              
                                 LR
                              
                           
                        
                     , our algorithm consists of the following steps:


                        
                           
                              (1)
                              We first upscale 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             LR
                                          
                                       
                                    
                                  to the HR domain 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             HR
                                          
                                       
                                    
                                  by a simple bicubic interpolation to yield 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             U
                                          
                                       
                                    
                                 .

We then use the algorithm of [2] to obtain the low-level edge map E of 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             U
                                          
                                       
                                    
                                 , and the four ramp profiles 
                                    
                                       R
                                       (
                                       e
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                    
                                  for each edge pixel 
                                    
                                       e
                                    
                                 .

To each ramp profile, we fit a sigmoid function parameterized by 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             l
                                          
                                       
                                    
                                 , as detailed in Section 4.

We then transform 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             l
                                          
                                       
                                    
                                  to its HR counterpart 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             h
                                          
                                       
                                    
                                 , using a set of transformation functions that we learn from training images, as described in Section 5.

The transformed ramp profiles (parameterized by 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             h
                                          
                                       
                                    
                                 ) are then used to create a prior image 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             p
                                          
                                       
                                    
                                  in the HR domain 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             HR
                                          
                                       
                                    
                                 , as described in Section 6. This prior image 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             p
                                          
                                       
                                    
                                  essentially contains the ramp based structural information that the HR image is expected to have.

We estimate our final HR image 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             HR
                                          
                                       
                                    
                                  using a regularization framework, by using 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             p
                                          
                                       
                                    
                                  as a prior constraint, along with the classical backprojection formulation [13] as the data term. This step is described in Section 7.

Consider a ramp profile 
                        
                           R
                           (
                           e
                           ,
                           θ
                           )
                        
                      that is monotonically increasing along a direction θ though the edge pixel 
                        
                           e
                        
                      of an image. To fit a parametric model to this ramp profile, we first consider a 1D spatial domain 
                        
                           t
                           ∈
                           (
                           -
                           ∞
                           ,
                           ∞
                           )
                        
                     , centered at 
                        
                           e
                        
                     , and along the direction θ. We can assume the ramp profile intensities to be a 1D function 
                        
                           r
                           (
                           t
                           )
                        
                      in this domain, defined at discrete locations 
                        
                           t
                           =
                           -
                           N
                           ,
                           -
                           N
                           +
                           1
                           ,
                           …
                           ,
                           0
                           ,
                           …
                           ,
                           M
                           -
                           1
                           ,
                           M
                        
                     .

We model this ramp profile using a continuous sigmoid function defined as,
                        
                           (1)
                           
                              f
                              (
                              t
                              ;
                              A
                              ,
                              B
                              ,
                              S
                              )
                              =
                              A
                              +
                              
                                 
                                    B
                                    -
                                    A
                                 
                                 
                                    1
                                    +
                                    exp
                                    (
                                    -
                                    St
                                    )
                                 
                              
                              .
                           
                        
                     
                     A and B denote the intensity values at the ends of the ramp, and 
                        
                           H
                           =
                           B
                           -
                           A
                        
                      denotes the height of the ramp profile. S controls the sharpness or steepness of the ramp profile. Fig. 4
                     (a) shows these parameters schematically.

We set 
                        
                           A
                           =
                           r
                           (
                           -
                           N
                           )
                        
                     , and 
                        
                           B
                           =
                           r
                           (
                           M
                           )
                        
                      as the intensity levels at the end of the ramps. The least squares estimate for S can be analytically obtained as 
                        
                           S
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             T
                                          
                                       
                                       t
                                    
                                 
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          T
                                       
                                    
                                    r
                                 
                              
                           
                        
                     , where, 
                        
                           t
                           =
                           
                              
                                 
                                    
                                       N
                                       ,
                                       N
                                       -
                                       1
                                       ,
                                       …
                                       ,
                                       0
                                       ,
                                       …
                                       ,
                                       -
                                       M
                                       +
                                       1
                                       ,
                                       -
                                       M
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           r
                           =
                           
                              
                                 [
                                 r
                                 (
                                 -
                                 N
                                 )
                                 ,
                                 r
                                 (
                                 -
                                 N
                                 +
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 r
                                 (
                                 0
                                 )
                                 ,
                                 …
                                 ,
                                 r
                                 (
                                 M
                                 -
                                 1
                                 )
                                 ,
                                 r
                                 (
                                 M
                                 )
                                 ]
                              
                              
                                 T
                              
                           
                        
                     .

Since this parameter estimation is simple and non-iterative, we are able to parameterize a large number of ramps relatively fast. We show a few examples of ramps extracted an image, superimposed with the above sigmoidal fit in Fig. 4(c).

To summarize, the above modeling procedure parameterizes the shape of a ramp profile 
                        
                           R
                           (
                           x
                           ,
                           θ
                           )
                        
                      with a parameter vector 
                        
                           Z
                           =
                           [
                           A
                           ,
                           B
                           ,
                           S
                           ]
                        
                     .

In order to determine how an LR ramp profile, parameterized by 
                        
                           
                              
                                 Z
                              
                              
                                 l
                              
                           
                        
                     , transforms to its HR counterpart 
                        
                           
                              
                                 Z
                              
                              
                                 h
                              
                           
                        
                     , we need to learn functions that map 
                        
                           
                              
                                 Z
                              
                              
                                 l
                              
                           
                        
                      to 
                        
                           
                              
                                 Z
                              
                              
                                 h
                              
                           
                        
                      using a set of known pairs of LR and HR ramp profiles 
                        
                           
                              
                                 {
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       h
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                     . For this, we collect a set of HR images (of around 1000x1000 pixels), covering a variety of scenes, and then generate the LR images by downsampling using a filter 
                        
                           
                              
                                 f
                              
                              
                                 psf
                              
                           
                        
                     .

For obtaining a pair 
                           
                              (
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    h
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              )
                           
                        , we need to extract a ramp profile from an LR image and find its corresponding ramp in the HR image. We use the segmentation algorithm [2] to obtain the edge pixels and the associated ramp profiles for all the HR images, and the LR images after upscaling (using bicubic interpolation) to the HR domain. We perform this upscaling step to have both the LR and HR image defined over the same resolution domain, as this would facilitate in finding correspondences.

For an LR ramp profile 
                           
                              
                                 
                                    R
                                 
                                 
                                    l
                                 
                              
                              (
                              
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                              ,
                              θ
                              )
                           
                         through the edge pixel 
                           
                              
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                           
                         along direction θ in an LR image, the corresponding ramp profile 
                           
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    e
                                 
                                 
                                    h
                                 
                              
                              ,
                              θ
                              )
                           
                         in the HR image is found at a location 
                           
                              
                                 
                                    e
                                 
                                 
                                    h
                                 
                              
                           
                         given by,
                           
                              (2)
                              
                                 
                                    
                                       e
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       e
                                       ∈
                                       N
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                H
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          e
                                          ,
                                          θ
                                          )
                                          -
                                          
                                             
                                                H
                                             
                                             
                                                l
                                             
                                          
                                          (
                                          
                                             
                                                e
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          θ
                                          )
                                          |
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              N
                              (
                              
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         is the set of edge pixels of the HR image, in a 5×5 neighborhood around 
                           
                              
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                           
                        . The function 
                           
                              H
                              (
                              x
                              ,
                              θ
                              )
                           
                         quantifies the height of the ramp profile through the pixel 
                           
                              x
                           
                        , along the direction θ, in the image.

Ramp profiles allow for more accurate correspondences to be found, as compared to using gradient profiles. This is illustrated in Fig. 5
                        . We show a cross section of an image from its HR version and its upsampled LR version. The gradient profile is quite sensitive to the type of gradient filter used, and it is difficult to infer the edge location in the HR image and establish correspondence to LR. Making any decision on the type of filter to use imposes strong assumptions of the expected geometry and scale of the image profile. On the other hand, by definition, ramp profiles avoids any such assumptions on scale, and detects structure bottom-up, adaptively. It is able to correctly identify the HR edge in the example shown in Fig. 5.

We collect T pairs of LR–HR ramp profiles from the training images, using the matching criterion in (2).

To learn a regression function from 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                              
                           
                         to 
                           
                              
                                 
                                    Z
                                 
                                 
                                    h
                                 
                              
                           
                        , we also need to account for the dependency between an HR ramp profile and the closely spaced neighbors (across thin structures etc.) of the corresponding LR ramp profile. Fig. 6
                         shows an example of a ramp profile R (in red), along with its two neighboring ramp profiles 
                           
                              
                                 
                                    R
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         (in green) in either direction. Without loss of generality, we denote the left neighboring ramp profile with the superscript ‘
                           
                              
                                 
                                 
                                    -
                                 
                              
                           
                        ’, and the right neighbor with a superscript ‘
                           
                              
                                 
                                 
                                    +
                                 
                              
                           
                        ’. The intensity values at the ends of the ramps are respectively denoted by A and B, with the appropriate superscript as shown in Fig. 6. Therefore, we also can denote the heights of the neighboring ramps as 
                           
                              
                                 
                                    H
                                 
                                 
                                    -
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    -
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    H
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    +
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    +
                                 
                              
                           
                         respectively.

The distance between two neighboring ramps along the same cross section in an HR image may be small enough to cause an overlap between the spatial supports of the corresponding ramps in the LR image. This effect of this dependency is illustrated through a simple example in Fig. 7
                        . In both cases of Fig. 7, as expected, the filtering operation causes a change in sharpness of the ramps. However, in case of Fig. 7(a), due to the presence of a close neighboring ramp, along with sharpness, the height of the filtered ramp 
                           
                              
                                 
                                    Rf
                                 
                                 
                                    1
                                 
                              
                           
                         is also affected. The height remains unaffected if the ramp does not have neighboring ramps such as in Fig. 7(b).

To incorporate this dependency of neighboring ramps in our model, we formulate our regression function to be,
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                h
                                             
                                          
                                          |
                                          
                                             
                                                Z
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                l
                                             
                                             
                                                +
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                l
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    -
                                 
                              
                           
                         denote the parameters of the neighboring ramps on either side of the ramp 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                              
                           
                        , along the same cross section of the image. The above equation essentially says that the parameters of the HR ramp 
                           
                              
                                 
                                    Z
                                 
                                 
                                    h
                                 
                              
                           
                         are predicted not only by its corresponding LR ramp 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                              
                           
                        , but also by the LR ramp’s neighbors, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    -
                                 
                              
                           
                         if they are close enough. We make use of the ramp map (such as in Fig. 3(b)) to determine if the ramps are close enough to require modeling using (3). Neighboring ramp profiles are deemed to be close and dependent on each other if there are no non-ramp pixels between them. In the example shown in Fig. 7(a), the neighboring LR ramps profiles 
                           
                              
                                 
                                    Rf
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Rf
                                 
                                 
                                    1
                                 
                                 
                                    +
                                 
                              
                           
                         do not have any non-ramp pixels between them. Therefore, we use the dependency model of (3) to relate them to the HR ramps profiles 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                                 
                                    +
                                 
                              
                           
                        . For all other ramp profiles, we drop the dependency on 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    l
                                 
                                 
                                    -
                                 
                              
                           
                         and simply assume a one-to-one function.

We make some simplifying independence assumptions among the variables in (3) in order to make the estimation tractable: By comparing the filtered ramps 
                           
                              
                                 
                                    Rf
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Rf
                                 
                                 
                                    2
                                 
                              
                           
                         in Fig. 7, we notice that the presence of a neighboring ramp essentially reduces the height of the ramp during the filtering process. Therefore, our regression function must be aimed at compensating for this attenuation in the ramp height. Furthermore, we notice that the attenuation in height is caused by change in intensity level at only one end of the ramp, that is closer to the neighboring ramp. We can therefore incorporate the neighborhood dependency by modeling 
                           
                              
                                 
                                    A
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    B
                                 
                                 
                                    h
                                 
                              
                           
                         as functions of the neighboring LR ramp profiles, in the respective directions. Therefore,
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                h
                                             
                                          
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                l
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                h
                                             
                                          
                                          |
                                          
                                             
                                                B
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                l
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We assume the sharpness parameter of the HR ramp profile 
                           
                              
                                 
                                    S
                                 
                                 
                                    h
                                 
                              
                           
                         to always be independent of the neighborhood ramps. We model 
                           
                              
                                 
                                    S
                                 
                                 
                                    h
                                 
                              
                           
                         as a function of the height and sharpness of corresponding LR ramp profile, without any neighborhood dependency.
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                h
                                             
                                          
                                          |
                                          
                                             
                                                S
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 8
                         shows a graphical representation of the dependence and independence relationship assumed in our model.

To estimate the prediction functions (4)–(6), we take a discriminative modeling approach. We approximate 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                              =
                              E
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                       
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       
                                          
                                             H
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                           
                         using support vector regression with a polynomial kernel. We choose the polynomial order to be 3 based on k-fold (
                           
                              k
                              =
                              10
                           
                        ) cross validation by partitioning the training data. Fig. 9
                        (a) shows plots of the learnt 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         as a function of the LR sharpness 
                           
                              
                                 
                                    S
                                 
                                 
                                    l
                                 
                              
                           
                        , for different values of LR ramp heights 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                              
                           
                        . Clearly, there is a significant dependence of the HR ramp sharpness on not just the LR ramp sharpness, but also the LR ramp height 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                              
                           
                        .

We use a linear model to estimate 
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         in (4) and (5) in terms of 
                           
                              
                                 
                                    A
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                         respectively. Fig. 9(b) shows the learnt 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         as a function of 
                           
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                           
                        , for different values of 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                        . 
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         behaves similarly, and we do not show it here.

Clearly, the estimation of 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         is dependent on the neighboring ramp height 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                        . To better understand the plots in Fig. 9(b), let us first focus on the 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                           
                         line that is shown in the plot for reference. This line shows the case when the intensity level at the end of the HR ramp 
                           
                              
                                 
                                    B
                                 
                                 
                                    h
                                 
                              
                           
                         is the same as the intensity level 
                           
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                           
                         at the end of its corresponding LR ramp. Indeed, this is the case if there are no neighboring ramps present. However, due to the presence of a neighboring ramp, the predicted intensity level 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         of the HR ramp deviates from 
                           
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                           
                        . This deviation is dependent on the height 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                         of the neighboring ramp. For example, let’s focus on the red curve, which corresponds to the presence of a neighboring ramp of height 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                              =
                              100
                           
                        . Qualitatively, we show such an example in Fig. 10
                         (b), where the red colored ramp is to be super-resolved, and the green colored ramp is the neighboring ramp of height 
                           
                              
                                 
                                    H
                                 
                                 
                                    l
                                 
                                 
                                    +
                                 
                              
                           
                        . Fig. 10(c) shows the transformed ramp, without incorporating the neighboring ramp dependency. In this case, while the sharpress of the ramp is appropriately transformed, the height of the ramp remains the same as in the LR ramp of Fig. 10(b). However, this height is lower than the ground truth HR ramp height as in Fig. 10(a). To compensate for this smaller height as compared to the ground truth, our neighboring ramp dependency model predicts a lower intensity value 
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    h
                                 
                              
                           
                         at the ramp end, as compared to the LR ramp end intensity 
                           
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                              
                           
                        , in Fig. 10(d). This is evident by the plots of Fig. 9(b), such as the red curve. Due tho this lower predicted intensity level of the ramp end, the resultant ramp in Fig. 10(d) is similar in height to the ground truth HR ramp of Fig. 10(a).

In case of real world images, the effect of incorporating our neighboring ramp dependency on our SR results is demonstrated in Fig. 11
                        . Thin structures like the bird’s beak show better contrast, owing to the correction provided by the learnt function in Fig. 9(b).

Given an LR image 
                        
                           
                              
                                 I
                              
                              
                                 LR
                              
                           
                        
                      (and its bicubic-upsampled version 
                        
                           
                              
                                 I
                              
                              
                                 U
                              
                           
                        
                     ) to be super-resolved, each ramp profile in 
                        
                           
                              
                                 I
                              
                              
                                 U
                              
                           
                        
                      is transformed using the prediction functions learnt above. The transformed sigmoids are then resampled at the positions where the corresponding LR ramp profiles were defined, and the intensities thus obtained are placed in a new image 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                     . Let 
                        
                           
                              
                                 Ω
                              
                              
                                 R
                              
                           
                           ⊂
                           
                              
                                 Ω
                              
                              
                                 HR
                              
                           
                        
                      denote the set of pixels of 
                        
                           
                              
                                 I
                              
                              
                                 U
                              
                           
                        
                      or 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                      that is populated by ramp profiles (as shown in the example of Fig. 3(b)).

Unlike previous gradient based approaches that model gradient profiles in only one direction (in the direction of the gradient), we extract and transform ramp profiles in four directions. As a result, the value 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                           (
                           x
                           )
                        
                      of a particular ramp pixel 
                        
                           x
                           ∈
                           
                              
                                 Ω
                              
                              
                                 R
                              
                           
                        
                      is typically predicted by multiple transformed ramp profiles. We perform a weighted average of all these predictions, to get the final predicted value of 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                           (
                           x
                           )
                        
                     .
                        
                           (7)
                           
                              
                                 
                                    I
                                 
                                 
                                    p
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          H
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          I
                                       
                                       
                                          p
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          H
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ,
                              
                              x
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    R
                                 
                              
                              .
                           
                        
                     
                     
                        
                           
                              
                                 S
                              
                              
                                 h
                              
                           
                           (
                           x
                           ,
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 H
                              
                              
                                 h
                              
                           
                           (
                           x
                           ,
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           )
                        
                      are the sharpness and height of the (transformed) ramp profiles through 
                        
                           x
                        
                      in direction 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                        
                     , and 
                        
                           
                              
                                 I
                              
                              
                                 p
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           (
                           x
                           )
                        
                      is the intensity predicted at 
                        
                           x
                        
                      by the (transformed) ramp profile along direction 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                        
                      alone. Intensities predicted by high contrast and sharp ramp profiles have higher weight.

Due to this averaging, smoothness is automatically achieved between neighboring pixels in 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                     , without an explicit Markov chain based inference [7,22].

For the non-ramp locations in 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                     , we simply retain the bicubic interpolated values from 
                        
                           
                              
                                 I
                              
                              
                                 U
                              
                           
                        
                     . This new image 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                      serves as our ramp based prior constraint.


                     Fig. 12
                      shows an example where we extract ramps from an upsampled LR image, transform the ramps using the learnt functions, and obtain the prior image 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                     .

We use the prior 
                        
                           
                              
                                 I
                              
                              
                                 p
                              
                           
                        
                      together with the intensity conservation constraint in the LR domain to estimate the HR image. The cost function to minimize is therefore,
                        
                           (8)
                           
                              J
                              (
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    HR
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          (
                                          1
                                          -
                                          Λ
                                          )
                                          ↓
                                          ∘
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         HR
                                                      
                                                   
                                                   ∗
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         psf
                                                      
                                                   
                                                   )
                                                   ↓
                                                   -
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         LR
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          Λ
                                          ∘
                                          (
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                HR
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                p
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                     ‘
                        
                           ∘
                        
                     ’ denotes the Hadamard (entry-wise) product between matrices. Λ is a matrix containing spatially adaptive regularization parameters, defined as, 
                        
                           Λ
                           =
                           λ
                           M
                           ∗
                           g
                        
                     , where 
                        
                           M
                           (
                           x
                           )
                           =
                           1
                           
                           if
                           
                           x
                           ∈
                           
                              
                                 Ω
                              
                              
                                 R
                              
                           
                        
                     , and 0 everywhere else. M is therefore a binary valued matrix used as a map to indicate the ramp regions. Λ is obtained by smoothing out the map M using Gaussian filter g and rescaling it by λ.


                     Λ gives high weight to our prior in the ramp areas. In smooth regions, 
                        
                           J
                           (
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 HR
                              
                           
                           )
                        
                      defaults to the backprojection formulation [13]. We minimize (8) using gradient descent.

@&#EXPERIMENTAL RESULTS@&#

@&#IMPLEMENTATION DETAILS@&#

We used a training set of 10 LR–HR image pairs, as shown in Fig. 13
                        . We used a 7×7 Gaussian filter of width 1.6 as 
                           
                              
                                 
                                    f
                                 
                                 
                                    psf
                                 
                              
                           
                         for downsampling the HR training images by a factor of 4, to create the LR versions. The same 
                           
                              
                                 
                                    f
                                 
                                 
                                    psf
                                 
                              
                           
                         is used for the reconstruction in (8) as well. We extracted around 
                           
                              T
                              =
                              200
                              ,
                              000
                           
                         pairs of LR–HR ramp profile pairs for learning. We found that learning with even 
                           
                              T
                              =
                              20
                              ,
                              000
                           
                         produced comparable results. We trained our ramp transformations for an upscaling factor of 4X. We choose 
                           
                              λ
                              =
                              .
                              8
                           
                         as the regularization parameter in (8), as this yielded the most visually pleasing results. For processing color images, we apply the proposed SR method only on the luma component. The chroma channels are upscaled using bicubic interpolation.

Despite the growing interest in the single image SR problem within the image processing and vision communities, it still lacks a common benchmark for objective evaluation and comparisons. Accurate numerical and quantitative evaluation is also an open problem. Peak signal-to-noise ratio (PSNR) and structural similarity measure (SSIM) [31] have been two commonly used numerical measures in the past. However, their correlation with human perception of image quality (which tends to be sharpness-driven) is debatable. Numerical measures like PSNR often tend to favor smoother images, whereas the challenge in the SR problem is to recover adequate sharpness. Sharp reconstructed edges yielded by SR algorithms are susceptible to high numerical errors due to the ambiguity in edge localization in the HR domain. Perhaps for this reason, several recent state-of-the-art SR methods (such as [11,8,7,19]) emphasize visual quality rather than quantitative comparisons, and provide results without any ground truth HR versions.

For evaluation, we show most of our results on images that have ground truth HR versions. For these images we report both PSNR and SSIM measures. Although we report these numbers, for better evaluation we encourage the reader to examine the visual similarity of our results with the ground truth images, as compared to competing methods. In some cases where our numerical results are close to those of others, visually our results appear better and bear closer resemblance to the ground truth images when compared to them. In some results, we also extract a few 1-D pixel profiles, in order to visually examine the quality of the reconstructed ramps of our method vs the others, and compare to the ground truth.

We also show some results on LR images that do not have ground truth HR versions, but have been used by several recent methods and have been provided online [11,8,7]. This allows us to visually compare our results with these methods, albeit without any ground truth.

We first compare our results to the gradient profile prior (GPP) [21,20] method, which is a learning based approach, most related to our method. We also compare to the patch based dictionary learning approach of Yang et al. [28]. In addition, as baselines we also compare to the classical bicubic interpolation as well as the backprojection algorithm [13], which is equivalent to setting 
                           
                              λ
                              =
                              0
                           
                         in (8).


                        Fig. 14
                         shows our comparisons on the Leaves image. Both the GPP based approach [21] as well as the dictionary based approach [28] do not produce sufficiently sharp results. Our edges are reconstructed better and are most similar to the ground truth image shown in Fig. 14(a). In Fig. 15
                        , we show a 1-D profile extracted from the Leaves image. We can see that the ramp transitions are better reconstructed by our algorithm as compared to the others. Thin/fine structures are blurred and flattened out by other methods, but our algorithm is able to better preserve such structures.


                        Fig. 16
                         compares results on the Bird image. Here we highlight an important drawback of gradient based edge priors such as GPP [21]: As shown in Fig. 16(d), the GPP result fails to accurately reproduce the color of the sky, as compared to the ground truth figure of Fig. 16(a). The gradient domain constraint in [21] does not enforce brightness consistency. Edges are also not as sharp as those obtained by our method in Fig. 16(f). Although sharper than GPP, the dictionary based method by Yang et al [28] produces ringing artifacts along edges, such as along the bird’s beak in Fig. 16(e). Our result is free of such artifacts.


                        Fig. 18 and Fig. 17
                        
                         show two more similar comparisons. Our results are consistently sharper than other methods, and bear closer visual resemblance to the ground truth, with almost no ringing artifacts. Fig. 19
                         shows 1-D profiles extracted from the results of Fig. 18. Our ramps bear the closest resemblance to the ground truth. Other methods produce ramp transitions that are less sharp.

For these images, we tabulate the PSNR (db) and SSIM [31] values in Table 1
                        . Our numerical results are significantly better than GPP [21] and also the bicubic and backprojection [13] baselines. Our values are quite close to those of Yang et al. [28], although visually our results appear better, particularly along strong edges.

We also compare our results with the edge statistics driven method of Fattal [7] in Figs. 24 and 25. Note that no ground truths are available for these images. In the Wheel image of Fig. 24, the result of Fattal [7] exhibits more ringing artifacts than our result, and it also appears overly smooth in places. In the Sculpture image of Fig. 25, Fattal [7] exhibits disparity in brightness due to reasons mentioned earlier. Our method, while also being edge driven, is fundamentally free from this drawback.

We now compare our results to some methods that do not utilize any learning based prior knowledge. In particular, we compare our results to those of Shan et al. [19] that is based on iterative feedback based filtering. We also compare to the edge directed interpolation method called NEDI [14], and non-local (NL) backprojection [6] which is an edge-aware extension to the classical backprojection algorithm [13].


                        Fig. 20
                         shows our comparison on the Penguin image. NL backprojection [6] overcomes some of the excessive ringing effect seen in the classical backprojection algorithm [13], but also introduces other artifacts along the edges. The edge directed interpolation method in NEDI [14] produces overly smooth results. Shan et al. [19] produces good results, but shows slightly more ringing artifacts as compared to our result, such as along the beak of the penguin. We again show 1-D profiles in Fig. 21
                        , extracted from the Penguin results. Our algorithm is able to accurately reconstruct the sharpness of the ground truth ramps. Other methods typically are not that sharp.

In the Zebra image of Fig. 22
                        , Shan et al. [19] exhibits ringing or zig-zag like effects along the stripe edges. NL backprojection [6], although sharp, creates unwanted dark streaks in the interior of the white stripes. This is better visualized by zooming in on Fig. 20(e). Our result is free of such artifacts.


                        Fig. 23
                         shows another set of results. Although the ringing effect of Shan et al. [19] is not very evident in this result, fine textural details (such as in the interior of leaves) seem to be slightly washed out as compared to our result.

We show quantitative results of these three images in Table 2
                        . Overall, our results are better quantitatively as well.

Freedman [8] and Glasner [11] have proposed SR methods that exploit self similarity within images. While they produce visually pleasing results with sharp edges, they often do not appear very photorealistic, and tend to smooth out fine details.


                        Fig. 24
                        (e) shows the result of the method by Freedman [8] on the Wheel image. The circular rim in the center of the steering wheel appears un-natural as compared to the other results, and fine textural details also appear to be smoothed out as compared to our result in Fig. 24(f). Fig. 25
                        (e) shows the result of Glasner et al. [11] on the Sculpture image. Objective evaluation on this image is difficult since the ground truth HR image is not available.

@&#DISCUSSION AND CONCLUSION@&#

Quantifying structure accurately is a fundamental problem in several low level vision tasks. Conventional methods are based on using pre-defined filters and linear convolution. In this paper, we have shown some drawbacks of such a formulation, for the single image SR problem. We have presented a ramp profile based model of structure around image edges for learning a prior for SR, that overcomes the important drawbacks of edge based priors using gradients. In addition, we have also proposed in our model a simple, but novel idea of incorporating dependency between closely spaced edges, while recovering the HR image. Our method is based on characterizing structure around edges, as detected by a low level segmentation procedure. For dealing with region interiors, our algorithm simply defaults to the classical backprojection algorithm. We have obtained better results than several state-of-the-art techniques. Our primary improvement and contribution lies in the better reconstruction of edges as compared to other methods.

A limitation of our algorithm is the lack of robustness to noise. Our definition of ramps as described in the paper assumes a relatively noise free image. In the presence of noise, spurious or distorted ramps may be detected which may hinder performance in the subsequent steps, particularly during the learning phase. In such noisy scenarios, we preprocess the images with a denoising algorithm [4,3] before using the proposed SR method.

Note that noise sensitivity is an issue for other edge based SR methods as well [21,20,7]. Presence of noise significantly affects gradient computations on which algorithms such as GPP [21] are based. Patch based methods generally tend to perform relatively better in presence of noise [28].

In our algorithm, the relatively smooth region interiors are super-resolved using the backprojection constraint alone. Although from a perceptual standpoint, we are justified in focusing on edges and the structures around them for the SR problem, improvement in results may be expected through better modeling of region interiors as well. One approach of doing so could be the integration of both edge based and patch based priors, in order to reap the advantages of each. This would also lend some noise robustness to our approach. We would be exploring these ideas in the future.

@&#REFERENCES@&#

