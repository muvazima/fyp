@&#MAIN-TITLE@&#Optimizing mining complexes with multiple processing and transportation alternatives: An uncertainty-based approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We formulate the optimization of a mining complex accounting by geological uncertainty.


                        
                        
                           
                           The solution approach perturbs a solution using simulated annealing.


                        
                        
                           
                           The risk-based solution outperforms a conventional deterministic one.


                        
                        
                           
                           Risk-based solution provides higher value with less risk.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Metaheuristics

OR in natural resources

Mining complex

Stochastic orebody simulations

Operating alternatives

@&#ABSTRACT@&#


               
               
                  Mining complexes contain multiple sequential activities that are strongly interrelated. Extracting the material from different sources may be seen as the first main activity, and any change in the sequence of extraction of the mining blocks modify the activities downstream, including blending, processing and transporting the processed material to final stocks or ports. Similarly, modifying the conditions of operation at a given processing path or the transportation systems implemented may affect the suitability of using a mining sequence previously optimized. This paper presents a method to generate mining, processing and transportation schedules that account for the previously mentioned activities (or stages) associated with the mining complex simultaneously. The method uses an initial solution generated using conventional optimizers and improves it by mean of perturbations associated to three different levels of decision: block based perturbations, operating alternative based perturbations and transportation system based perturbation. The method accounts for geological uncertainty of several deposits by considering scenarios originated from combinations of their respective stochastic orebody simulations. The implementation of the method in a multipit copper operation shows its ability to reduce deviations from capacity and blending targets while improving the expected NPV (cumulative discounted cash flows), which highlight the importance of stochastic optimizers given their ability to generate more value with less risk.
               
            

@&#INTRODUCTION@&#

A mining complex can be interpreted as a supply chain system where material is transformed from one activity to another (Goodfellow, 2014). The primary activities (or stages) consist of: mining the materials from one or multiple sources (deposits); blending the material considering stockpiling; processing the material in different processing paths accounting for multiple operating alternatives; and transporting the products to port or final stocks using one or multiple transportation systems.

For a given processing path (e.g. mill-roaster in a refractory ore operation), it is possible to have multiple operating alternatives; for example, a mill may be operated using two different options: fine or coarse grinding (Fig. 1
                     ). If the mill is operated using fine grinding, there is often a very high energy consumption, which is associated with a higher processing cost and also requires larger residence times for the material processed, thus limiting the mill throughput. A coarse grinding option requires less energy and residence time in the mill, which decreases the operating cost and increases the mill throughput, however, it results in a lower recovery in the roaster downstream. Furthermore, different processing alternatives often impose different blending requirements. For example, the tolerable amount of free silica of the input material may be lower when operating the mill at fine grinding given that the presence of this element increases the hardness of the material. When a mill is bottlenecking the system, it is better to use a coarse grind with higher throughput in the early periods of the life-of-mine (LOM), and, to use a finer grind to maximize recovery towards the end of the LOM (Whittle, 2014). During the early periods, a mining complex incurs an opportunity cost for having material with large residence times in the mill, however, as the quantity of ore remaining in the mining complex diminishes, there is no opportunity cost.

Once the material is processed through the different processing paths and using some available operating alternatives, existing transportation systems, either continuous (belt conveyors, pipe transport) or batch (trucks, rail transportation), are used to transport the processed material to one or several ports or final stocks. Accounting for transportation systems in the optimization of mining complexes is important, given that they may limit the overall system output. In a mining complex, it is common to have multimodal transportation that involves the use of separate contractors or operators for each type of transport (Zamorano, 2011). To account for the demand of transportation of material processed, it is necessary to establish the feasible relations between processing paths and transportation systems; specifically, a particular transportation system may be able to handle output material from some of the available processing paths: For example, in a pyro/hydrometallurgical complex, a hydraulic pipe may be able to transport the material output from the lixiviation plant whereas the material output from the pyrometallurgical plant is transported to the final stocks via trucks. Once the feasible transport relations are established, the demand for transportation is evaluated by considering the throughput relationships (output/input tonnages) for each processing path given the operating alternative implemented. For example, the output/input tonnage relation and the metallurgical recovery in a gold flotation plant change if the mass pull is 4 or 7 percent (Hadler, Smith, & Cilliers, 2010). When the transportation of processed material is the bottleneck in the overall system, the operating conditions at the different processing paths must be evaluated. To overcome this limitation, it may be useful to re-evaluate throughput specifications of the processed material. Whittle (2010) shows that by increasing the copper concentrate from 28 to 32 percent in some periods on a sulfide deposit, the metallurgical recovery decreases by 7 percent, but the NPV increases by 6 percent given the possibility of transporting more concentrated ore on the pipe, which is the bottleneck of the system.

Optimizing mining complexes by considering geological uncertainty and the different activities simultaneously is a large combinatorial optimization problem (Fig. 2
                     ). Several efficient methodologies have been developed in stochastic environments for the mine production scheduling problem (Bendorf & Dimitrakopoulos, 2013; Godoy, 2003; Godoy & Dimitrakopoulos, 2004; Goodfellow & Dimitrakopoulos, 2013; Lamghari & Dimitrakopoulos, 2012; Lamghari, Dimitrakopoulos, & Ferland, 2013; Montiel & Dimitrakopoulos, 2013). The integration of multiple activities during optimization in deterministic frameworks include the work of Hoerger, Seymour, and Hoffman (1999); Wharton (2007); Whittle (2007); Whittle (2010a); Whittle (2010). This paper presents a new model for optimizing multipit mining complexes that incorporates processing and transportation alternatives and accounts for geological uncertainty by means of stochastic orebody simulations (Fig. 3
                     ). Stochastic simulation of mineral attributes provides possible representations of the mineral deposits that are consistent with the data and with the geological model (Dowd, 1994). A mining complex may contain several deposits discretized into a large number of mining blocks leading to optimization models of prohibitive size. To solve the optimization model presented in this paper, a solution approach that uses simulated annealing algorithm is developed and implemented.

@&#METHOD@&#

@&#OVERVIEW@&#

In a mining complex, the material flows from the deposits as raw material to ports or final stocks as saleable products. To optimize the mining complex, the different stages that are involved must be considered simultaneously (Fig. 4). First, the multiple material types coming from the mine(s) are sent to the available processes or to stockpiles where they are blended to meet the quality requirements. At each process the material is transformed into intermediate or final products, which are then transported to ports or final stocks. The goal when optimizing a mining complex is to maximize discounted cash flows while minimizing deviation from mining and metallurgical processing targets, such as capacities associated to the different processing and transportation options and blending requirements regarding the different metallurgical properties. These metallurgical properties control the operation of the different processes and are calculated as mathematical expressions of the different grade elements, e.g., fuel value is a metallurgical property that controls the operation on a roaster.

Maximize

                           
                              (1)
                              
                                 
                                    O
                                    =
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       T
                                    
                                    
                                       (
                                       
                                          1
                                          S
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                s
                                                =
                                                1
                                             
                                             S
                                          
                                          d
                                          i
                                          s
                                          c
                                          p
                                          r
                                          o
                                          f
                                          i
                                          t
                                          
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                          −
                                          p
                                          e
                                          n
                                          a
                                          l
                                          t
                                          y
                                          
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Subject to

                           
                              (2)
                              
                                 
                                    m
                                    i
                                    n
                                    e
                                    p
                                    r
                                    o
                                    d
                                    u
                                    c
                                    t
                                    i
                                    o
                                    n
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       ∑
                                       
                                          d
                                          =
                                          0
                                       
                                       D
                                    
                                    
                                       X
                                       
                                          i
                                          t
                                          d
                                       
                                    
                                    ·
                                    
                                       m
                                       
                                          i
                                          s
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    t
                                    o
                                    n
                                    n
                                    e
                                    s
                                    e
                                    n
                                    t
                                    m
                                    i
                                    n
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       X
                                       
                                          i
                                          t
                                          d
                                       
                                    
                                    ·
                                    
                                       m
                                       
                                          i
                                          s
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             t
                                             o
                                             n
                                             n
                                             e
                                             s
                                             t
                                             o
                                             c
                                             k
                                             p
                                             i
                                             l
                                             e
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                             t
                                             o
                                             n
                                             n
                                             e
                                             s
                                             t
                                             o
                                             c
                                             k
                                             p
                                             i
                                             l
                                             e
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             t
                                             o
                                             n
                                             n
                                             e
                                             r
                                             e
                                             h
                                             a
                                             n
                                             d
                                             l
                                             e
                                             
                                                (
                                                s
                                                ,
                                                t
                                                ,
                                                d
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             t
                                             o
                                             n
                                             n
                                             e
                                             s
                                             e
                                             n
                                             t
                                             m
                                             i
                                             n
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             0
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             t
                                             o
                                             n
                                             n
                                             e
                                             p
                                             r
                                             o
                                             c
                                             e
                                             s
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             )
                                             =
                                          
                                       
                                       
                                          
                                             
                                             t
                                             o
                                             n
                                             n
                                             e
                                             s
                                             e
                                             n
                                             t
                                             m
                                             i
                                             n
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             t
                                             o
                                             n
                                             n
                                             e
                                             r
                                             e
                                             h
                                             a
                                             n
                                             d
                                             l
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    t
                                    o
                                    n
                                    n
                                    e
                                    r
                                    e
                                    h
                                    a
                                    n
                                    d
                                    l
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       )
                                    
                                    ≤
                                    t
                                    o
                                    n
                                    n
                                    e
                                    s
                                    t
                                    o
                                    c
                                    k
                                    p
                                    i
                                    l
                                    e
                                    s
                                    
                                       (
                                       s
                                       ,
                                       t
                                       −
                                       1
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    m
                                    e
                                    t
                                    a
                                    l
                                    s
                                    e
                                    n
                                    t
                                    m
                                    i
                                    n
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       ,
                                       m
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       (
                                       
                                          X
                                          
                                             i
                                             t
                                             d
                                          
                                       
                                       ·
                                       
                                          m
                                          
                                             i
                                             s
                                          
                                       
                                       ·
                                       
                                          g
                                          
                                             i
                                             s
                                             m
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             m
                                             e
                                             t
                                             a
                                             l
                                             s
                                             t
                                             o
                                             c
                                             k
                                             p
                                             i
                                             l
                                             e
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             m
                                             )
                                             =
                                          
                                       
                                       
                                          
                                             
                                             m
                                             e
                                             t
                                             a
                                             l
                                             s
                                             t
                                             o
                                             c
                                             k
                                             p
                                             i
                                             l
                                             e
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             −
                                             1
                                             ,
                                             m
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             −
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             m
                                             e
                                             t
                                             a
                                             l
                                             r
                                             e
                                             h
                                             a
                                             n
                                             d
                                             l
                                             e
                                             
                                                (
                                                s
                                                ,
                                                t
                                                ,
                                                d
                                                ,
                                                m
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             m
                                             e
                                             t
                                             a
                                             l
                                             s
                                             e
                                             n
                                             t
                                             m
                                             i
                                             n
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             0
                                             ,
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             m
                                             e
                                             t
                                             a
                                             l
                                             p
                                             r
                                             o
                                             c
                                             e
                                             s
                                             s
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             ,
                                             m
                                             )
                                             =
                                          
                                       
                                       
                                          
                                             
                                             m
                                             e
                                             t
                                             a
                                             l
                                             s
                                             e
                                             n
                                             t
                                             m
                                             i
                                             n
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             ,
                                             m
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             m
                                             e
                                             t
                                             a
                                             l
                                             r
                                             e
                                             h
                                             a
                                             n
                                             d
                                             l
                                             e
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             d
                                             ,
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    m
                                    e
                                    t
                                    a
                                    l
                                    r
                                    e
                                    h
                                    a
                                    n
                                    d
                                    l
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       ,
                                       m
                                       )
                                    
                                    ≤
                                    m
                                    e
                                    t
                                    a
                                    l
                                    s
                                    t
                                    o
                                    c
                                    k
                                    p
                                    i
                                    l
                                    e
                                    s
                                    
                                       (
                                       s
                                       ,
                                       t
                                       −
                                       1
                                       ,
                                       m
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          m
                                          e
                                          t
                                          a
                                          l
                                          s
                                          t
                                          o
                                          c
                                          k
                                          p
                                          i
                                          l
                                          e
                                          s
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          m
                                          )
                                       
                                       
                                          t
                                          o
                                          n
                                          n
                                          e
                                          s
                                          t
                                          o
                                          c
                                          k
                                          p
                                          i
                                          l
                                          e
                                          s
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          m
                                          e
                                          t
                                          a
                                          l
                                          r
                                          e
                                          h
                                          a
                                          n
                                          d
                                          l
                                          e
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          ,
                                          m
                                          )
                                       
                                       
                                          t
                                          o
                                          n
                                          n
                                          e
                                          r
                                          e
                                          h
                                          a
                                          n
                                          d
                                          l
                                          e
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    t
                                    o
                                    n
                                    n
                                    e
                                    o
                                    u
                                    t
                                    p
                                    r
                                    o
                                    c
                                    e
                                    s
                                    s
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          o
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       (
                                       t
                                       o
                                       n
                                       n
                                       e
                                       p
                                       r
                                       o
                                       c
                                       e
                                       s
                                       s
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          )
                                       
                                       ·
                                       
                                          Y
                                          
                                             t
                                             d
                                             o
                                          
                                       
                                       ·
                                       
                                          P
                                          
                                             d
                                             o
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    t
                                    o
                                    n
                                    n
                                    e
                                    t
                                    r
                                    a
                                    n
                                    s
                                    p
                                    o
                                    r
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       r
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       (
                                       t
                                       o
                                       n
                                       n
                                       e
                                       o
                                       u
                                       t
                                       p
                                       r
                                       o
                                       c
                                       e
                                       s
                                       s
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          )
                                       
                                       ·
                                       
                                          Z
                                          
                                             t
                                             d
                                             r
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    m
                                    e
                                    t
                                    a
                                    l
                                    r
                                    e
                                    c
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       m
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       ∑
                                       
                                          0
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       (
                                       m
                                       e
                                       t
                                       a
                                       l
                                       p
                                       r
                                       o
                                       c
                                       e
                                       s
                                       s
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       ,
                                       m
                                       )
                                       ·
                                       r
                                       e
                                       c
                                       (
                                       d
                                       ,
                                       o
                                       ,
                                       m
                                       )
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    r
                                    e
                                    v
                                    e
                                    n
                                    u
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       (
                                       m
                                       e
                                       t
                                       a
                                       l
                                       r
                                       e
                                       c
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       m
                                       )
                                       ·
                                       p
                                       r
                                       i
                                       c
                                       e
                                       (
                                       m
                                       )
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    m
                                    i
                                    n
                                    e
                                    c
                                    o
                                    s
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    m
                                    i
                                    n
                                    e
                                    p
                                    r
                                    o
                                    d
                                    u
                                    c
                                    t
                                    i
                                    o
                                    n
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    ·
                                    
                                       m
                                       c
                                    
                                 
                              
                           
                        
                        
                        
                           
                              (17)
                              
                                 
                                    p
                                    r
                                    o
                                    c
                                    o
                                    s
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       ∑
                                       
                                          o
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       (
                                       t
                                       o
                                       n
                                       n
                                       e
                                       p
                                       r
                                       o
                                       c
                                       e
                                       s
                                       s
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          )
                                       
                                       ·
                                       
                                          P
                                          c
                                       
                                       
                                          (
                                          d
                                          ,
                                          o
                                          )
                                       
                                       ·
                                       
                                          Y
                                          
                                             t
                                             d
                                             o
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    s
                                    t
                                    o
                                    c
                                    k
                                    c
                                    o
                                    s
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    t
                                    o
                                    n
                                    n
                                    e
                                    s
                                    e
                                    n
                                    t
                                    m
                                    i
                                    n
                                    e
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       0
                                       )
                                    
                                    ·
                                    
                                       k
                                       c
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    r
                                    e
                                    h
                                    a
                                    n
                                    d
                                    l
                                    e
                                    c
                                    o
                                    s
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          ∑
                                          
                                             d
                                             =
                                             1
                                          
                                          D
                                       
                                       t
                                       o
                                       n
                                       n
                                       e
                                       r
                                       e
                                       h
                                       a
                                       n
                                       d
                                       l
                                       e
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          )
                                       
                                       )
                                    
                                    ·
                                    
                                       h
                                       c
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    t
                                    r
                                    a
                                    n
                                    s
                                    c
                                    o
                                    s
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       R
                                    
                                    
                                       (
                                       t
                                       o
                                       n
                                       n
                                       e
                                       t
                                       r
                                       a
                                       n
                                       s
                                       p
                                       o
                                       r
                                       t
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          r
                                          )
                                       
                                       ·
                                       
                                          τ
                                          c
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             d
                                             i
                                             s
                                             c
                                             p
                                             r
                                             o
                                             f
                                             i
                                             t
                                             (
                                             s
                                             ,
                                             t
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                               e
                                                               v
                                                               e
                                                               n
                                                               u
                                                               e
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                               −
                                                               m
                                                               i
                                                               n
                                                               e
                                                               c
                                                               o
                                                               s
                                                               t
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                               −
                                                               p
                                                               r
                                                               o
                                                               c
                                                               o
                                                               s
                                                               t
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               s
                                                               t
                                                               o
                                                               c
                                                               k
                                                               c
                                                               o
                                                               s
                                                               t
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                               −
                                                               r
                                                               e
                                                               h
                                                               a
                                                               n
                                                               d
                                                               l
                                                               e
                                                               c
                                                               o
                                                               s
                                                               t
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                               −
                                                               t
                                                               r
                                                               a
                                                               n
                                                               s
                                                               c
                                                               o
                                                               s
                                                               t
                                                               (
                                                               s
                                                               ,
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      d
                                                      r
                                                      a
                                                      t
                                                      e
                                                      )
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    p
                                    e
                                    n
                                    a
                                    l
                                    t
                                    y
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                                e
                                                n
                                                a
                                                l
                                                p
                                                i
                                                t
                                                (
                                                s
                                                ,
                                                t
                                                )
                                                +
                                                p
                                                e
                                                n
                                                a
                                                l
                                                t
                                                r
                                                a
                                                n
                                                s
                                                (
                                                s
                                                ,
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                +
                                                
                                                p
                                                e
                                                n
                                                a
                                                l
                                                p
                                                r
                                                o
                                                (
                                                s
                                                ,
                                                t
                                                )
                                                +
                                                p
                                                e
                                                n
                                                a
                                                l
                                                m
                                                e
                                                t
                                                a
                                                l
                                                (
                                                s
                                                ,
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                          (
                                          p
                                          )
                                       
                                    
                                    
                                       ∑
                                       
                                          d
                                          =
                                          0
                                       
                                       D
                                    
                                    
                                       X
                                       
                                          k
                                          t
                                          d
                                       
                                    
                                    ·
                                    
                                       m
                                       
                                          i
                                          s
                                       
                                    
                                    +
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          p
                                          )
                                       
                                       U
                                    
                                    −
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          p
                                          )
                                       
                                       L
                                    
                                    =
                                    M
                                    C
                                    A
                                    P
                                    
                                       (
                                       p
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    t
                                    o
                                    n
                                    n
                                    e
                                    t
                                    r
                                    a
                                    n
                                    s
                                    p
                                    o
                                    r
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       r
                                       )
                                    
                                    +
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          r
                                          )
                                       
                                       U
                                    
                                    −
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          r
                                          )
                                       
                                       L
                                    
                                    =
                                    T
                                    C
                                    A
                                    P
                                    
                                       (
                                       r
                                       )
                                    
                                 
                              
                           
                        
                        
                        
                        
                           
                              (25)
                              
                                 
                                    t
                                    o
                                    n
                                    n
                                    e
                                    p
                                    r
                                    o
                                    c
                                    e
                                    s
                                    s
                                    
                                       (
                                       s
                                       ,
                                       t
                                       ,
                                       d
                                       )
                                    
                                    +
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          ,
                                          o
                                          )
                                       
                                       U
                                    
                                    −
                                    D
                                    
                                       
                                          (
                                          s
                                          ,
                                          t
                                          ,
                                          d
                                          ,
                                          o
                                          )
                                       
                                       L
                                    
                                    =
                                    P
                                    C
                                    A
                                    P
                                    
                                       (
                                       d
                                       ,
                                       o
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                   e
                                                   t
                                                   a
                                                   l
                                                   p
                                                   r
                                                   o
                                                   c
                                                   e
                                                   s
                                                   s
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   ,
                                                   d
                                                   ,
                                                   k
                                                   )
                                                
                                                
                                                   t
                                                   o
                                                   n
                                                   n
                                                   e
                                                   p
                                                   r
                                                   o
                                                   c
                                                   e
                                                   s
                                                   s
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                             +
                                             D
                                             
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   ,
                                                   d
                                                   ,
                                                   o
                                                   ,
                                                   k
                                                   )
                                                
                                                U
                                             
                                             −
                                             D
                                             
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   ,
                                                   d
                                                   ,
                                                   o
                                                   ,
                                                   k
                                                   )
                                                
                                                L
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             M
                                             T
                                             A
                                             R
                                             (
                                             d
                                             ,
                                             o
                                             ,
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    p
                                    e
                                    n
                                    a
                                    l
                                    p
                                    i
                                    t
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          p
                                          =
                                          1
                                       
                                       P
                                    
                                    
                                       (
                                       C
                                       
                                          
                                             (
                                             t
                                             ,
                                             p
                                             )
                                          
                                          U
                                       
                                       ·
                                       D
                                       
                                          
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             p
                                             )
                                          
                                          U
                                       
                                       +
                                       C
                                       
                                          
                                             (
                                             t
                                             ,
                                             p
                                             )
                                          
                                          L
                                       
                                       ·
                                       D
                                       
                                          
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             p
                                             )
                                          
                                          L
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    p
                                    e
                                    n
                                    a
                                    l
                                    t
                                    r
                                    a
                                    n
                                    s
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       R
                                    
                                    
                                       (
                                       C
                                       
                                          
                                             (
                                             t
                                             ,
                                             r
                                             )
                                          
                                          U
                                       
                                       ·
                                       D
                                       
                                          
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             r
                                             )
                                          
                                          U
                                       
                                       +
                                       C
                                       
                                          
                                             (
                                             t
                                             ,
                                             r
                                             )
                                          
                                          L
                                       
                                       ·
                                       D
                                       
                                          
                                             (
                                             s
                                             ,
                                             t
                                             ,
                                             r
                                             )
                                          
                                          L
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    p
                                    e
                                    n
                                    a
                                    l
                                    p
                                    r
                                    o
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       ∑
                                       
                                          o
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                   
                                                      
                                                         (
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         )
                                                      
                                                      U
                                                   
                                                   ·
                                                   D
                                                   
                                                      
                                                         (
                                                         s
                                                         ,
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         )
                                                      
                                                      U
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                   C
                                                   
                                                      
                                                         (
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         )
                                                      
                                                      L
                                                   
                                                   ·
                                                   D
                                                   
                                                      
                                                         (
                                                         s
                                                         ,
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         )
                                                      
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    p
                                    e
                                    n
                                    a
                                    l
                                    m
                                    e
                                    t
                                    a
                                    l
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       ∑
                                       
                                          o
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                   
                                                      
                                                         (
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         ,
                                                         k
                                                         )
                                                      
                                                      U
                                                   
                                                   ·
                                                   D
                                                   
                                                      
                                                         (
                                                         s
                                                         ,
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         ,
                                                         k
                                                         )
                                                      
                                                      U
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                   C
                                                   
                                                      
                                                         (
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         ,
                                                         k
                                                         )
                                                      
                                                      L
                                                   
                                                   ·
                                                   D
                                                   
                                                      
                                                         (
                                                         s
                                                         ,
                                                         t
                                                         ,
                                                         d
                                                         ,
                                                         o
                                                         ,
                                                         k
                                                         )
                                                      
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       ∑
                                       
                                          d
                                          =
                                          0
                                       
                                       D
                                    
                                    
                                       X
                                       
                                          i
                                          t
                                          d
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       t
                                    
                                    
                                       ∑
                                       
                                          d
                                          =
                                          0
                                       
                                       D
                                    
                                    
                                       X
                                       
                                          j
                                          k
                                          d
                                       
                                    
                                    ≤
                                    0
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       T
                                    
                                    
                                       ∑
                                       
                                          d
                                          =
                                          0
                                       
                                       D
                                    
                                    
                                       X
                                       
                                          i
                                          t
                                          d
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       ∑
                                       
                                          o
                                          =
                                          1
                                       
                                       
                                          O
                                          (
                                          d
                                          )
                                       
                                    
                                    
                                       Y
                                       
                                          t
                                          d
                                          o
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       Z
                                       
                                          t
                                          d
                                          r
                                       
                                    
                                    ≤
                                    
                                       A
                                       
                                          d
                                          r
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       R
                                    
                                    
                                       Z
                                       
                                          t
                                          d
                                          r
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        
                     

All variables must be positive. Xitd
                         and Ytdo
                        
                        
                           ϵ
                         {0, 1}. Ztdr
                         ≤ 1 (Tables 1–7).

The objective function is given by Eq. (1) and seeks for maximizing discounted profits and minimizing deviations from targets along all periods and scenarios (derived from orebody simulations). The first term of the objective function accounts for discounted profits by evaluating the revenues obtained by selling the different products and the costs associated with the different activities of the mining complex. The second term accounts for penalized deviations regarding mining, processing, transportation and blending targets and may be seen as a penalty cost it is incurred by not meeting the different targets. The value of penalty(s,t) depends on the deviations from the targets itself and the magnitude of the per-unit penalty costs associated. If the per-unit penalty costs are too high, the method will improve the reproduction of the targets ignoring the first term of the objective function generating poor improvement of expected NPV. Conversely, too small per-unit penalty costs will generate impractical solutions with large and non-realistic NPV forecasts given the large violations of the targets.

To manage the risk along the different periods, the per-unit penalty costs can be discounted using the geological risk discounting rate (GRD) introduced by Dimitrakopoulos and Ramazan (2004) (see also Ramazan and Dimitrakopoulos, 2013). This allows deferring risks of not meeting targets for later periods when more information will be available. GRD can be applied to processing, blending and transportation targets.

The tonnage mined in a given period t under a scenario s can be evaluated using Eq. (2). Scenarios are obtained from orebody simulations and, due to grade and material type uncertainties, the tonnage of a block may differ from one scenario to another. Similarly, the tonnage sent from the pits to any particular destination d can be evaluated using Eq. (3).

In a mining complex, different material types are stored in different stockpiles given that they may have different metallurgical properties. The model considers one stockpile for each material type that contributes to the blending operation. When a particular block is sent to the stockpiles, the assignment of any particular stockpile is a scenario-dependent decision derived from the material type uncertainty. In other words, for each scenario, a stockpiled block will be assigned to the corresponding pile related to its material type. For modeling purposes, stockpiling a block is represented as having destination d=0. Therefore, in a period t, the total tonnage presented in the stockpiles under a scenario s is evaluated using Eq. (4).

The amount of material processed in a given destination d during period t under scenario s is given by Eq. (5). Eq. (6) ensures that it is not possible to rehandle more material than the available in the stockpiles.

The amount of metal m sent from the pits to a particular destination d, the amount of metal m in the stockpiles and the amount of metal m processed at a given destination d can be evaluated using Eqs. (7), (8) and (9) respectively. Eq. (10) ensures that it will not rehandle more metal than the available in the stockpiles.


                        Eq. (10) controls that the grade of the material rehandled at a given period corresponds to the grade of the stockpiles. This constraint is non-linear and assumes that there is a homogenization of the material in the stockpiles such that any material removed from there has its average grade. Although it may be seen as a strong assumption, it overcomes the limitation of linearized formulations where a constant grade is assumed for the stockpiles. Future additions to the problem may consider stochastic stockpile handling.
                        
                     


                        Eqs. (12), (13) and (14) are used to evaluate the output tonnage from a given destination d in period t under scenario s, the tonnage transported by transportation system r in period t under scenario s and the amount of metal m that will be recovered in period t under scenario s.
                        
                     

At a given processing destination, each available operating alternative may have its corresponding associated capacity, operating cost, recoveries, operational ranges for metallurgical properties and throughput specification (relation between output/input tonnages).

The revenues and costs associated with the different activities of the mining complex are evaluated using Eqs. (15)–(20).

The discounted profit, which is the term that appears in the objective function, can be calculated by discounting the difference between the revenues and the costs associated with the different activities (Eq. (21)).

To control the operation at the different processing destinations, several metallurgical properties may be considered. At any given operating alternative of a particular destination, these metallurgical properties must fall in between some operational ranges. The deviations from these operational ranges must be also minimized by means of penalty costs. penalty(s,t) is the second term of the objective function and can be calculated in each period and scenario using Eq. (22). Eqs. (23)–(26) allow evaluating the deviation from the different targets. The penalties that affect the second term of the objective function are calculated using Eqs. (27)–(30).
                        
                        
                     


                        Eq. (31) represents slope constraints. Eqs. (32), (33), (34) and (35) ensure that a block is mined only once, that only one alternative is chosen at a given destination in a certain period, that all the output material of a given destination is transported and that feasible process-transport relationships are respected.

The number of binary variables Xitd
                         is given by the number of blocks in which the open pits are discretized, the number of periods of the LOM and the number of processing destinations. A mining complex may contain several deposits discretized into a large number of blocks (hundreds of thousands or millions) which generates millions of integer variables. The mine production scheduling problem incorporated in the optimization of mining complexes is NP-hard (Faigle & Kern, 1994). Hence, it is necessary to find solution methods that overcome this limitation.

Given the complexity of the problem, a method that uses simulated annealing is proposed to generate solutions with mining, processing and transportation policies. The proposed method perturbs an initial solution iteratively to improve the objective function. In order to avoid local optimal solutions and to explore the solution domain (the set of all possible mine production schedules with operating policies for processing paths and transportation systems), the method allows deterioration based on a decision rule and uses diversification. The decision rule is the same implemented by the Metropolis algorithm (Metropolis, Rosenbluth, Rosenbluth, Teller, & Teller, 1953) and allows the exploration of the solution domain while converging to a final good-quality solution. A diversification strategy over the solution domain is performed by means of perturbation at different decision levels of the mining complex (blocks, operating alternatives, transportation systems). The proposed algorithm can be implemented multiple times to improve the final solution by controlling the number of cycles.


                           Metropolis et al. (1953) introduce an algorithm to provide a simulation of a collection of atoms in equilibrium at a given temperature. The Metropolis algorithm perturbs the initial state and, at each iteration, an atom is displaced and the resulting change in energy ΔE is computed. If ΔE ≤ 0, the displacement is accepted. The case ΔE > 0 is accepted or rejected based on random sampling of a probability distribution 
                              
                                 P
                                 
                                    (
                                    Δ
                                    E
                                    )
                                 
                                 =
                                 e
                                 x
                                 p
                                 
                                    (
                                    −
                                    Δ
                                    E
                                    /
                                    
                                       k
                                       B
                                    
                                    T
                                    )
                                 
                              
                            where KB
                            is a constant and T the temperature of the state. Kirkpatrick, Gelatt, and Vecchi (1983) use a cost function in place of the energy and define configurations by a set of variables to generate a population of configurations of a given optimization problem at some temperature. This temperature acts as a control parameter of the same units as the cost function. Previous implementation of simulated annealing in mine planning have demonstrated its ability to improve mine production scheduling and pit designs in terms of expected NPV and meeting production targets (Albor & Dimitrakopoulos, 2009; Godoy, 2003; Goodfellow & Dimitrakopoulos, 2013; Leite & Dimitrakopoulos, 2007). Because of this, simulated annealing was chosen among other metaheuristics to solve the problem of optimizing multipit mining complexes while accounting for geological uncertainty. However, other methods should be tested in the future searching for a better integration with the problem and a possible deeper exploration of the solution domain.

Given the nature of the optimization problem considered in this paper, which is a maximization problem and not a cost or deviation minimization one, a perturbation that deteriorates the current solution is the one that decreases its objective value. Accounting for this, the probability distribution is given by Eq. (36) with T being the annealing temperature.

                              
                                 (36)
                                 
                                    
                                       P
                                       
                                          (
                                          Δ
                                          O
                                          )
                                       
                                       =
                                       P
                                       
                                          (
                                          
                                             O
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          −
                                          
                                             O
                                             
                                                c
                                                u
                                                r
                                                r
                                                e
                                                n
                                                t
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                      
                                                      
                                                      if
                                                      
                                                      (
                                                      Δ
                                                      O
                                                      ≥
                                                      0
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                         
                                                            
                                                               −
                                                               (
                                                               Δ
                                                               O
                                                               )
                                                            
                                                            T
                                                         
                                                      
                                                      
                                                      
                                                      
                                                      if
                                                      
                                                      
                                                         (
                                                         Δ
                                                         O
                                                         <
                                                         0
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

The probability of accepting an unfavorable perturbation is greater at higher temperatures. As the optimization proceeds, the temperature is gradually lowered by a reduction factor. When the temperature approaches zero, the probability of accepting an unfavorable swap tends to zero. This allows the algorithm to converge to a final solution.

The total number of swaps and the number of swaps at a given temperature control the end of the algorithm and the changes of temperature throughout the iteration process.

The proposed algorithm requires an initial mining sequence to assign periods and destinations to mining blocks and a set of orebody simulations for each deposit to evaluate profits, costs, productions and deviations at the different activities of the mining complex. While reading the orebody simulations, the algorithm evaluates the overall profitability of a block at a given destination by accumulating the economic value of the block in that destination through all scenarios. For simplicity, the overall profitability of a block at a given destination will be referred to as OPBD. Based on the OPBD, it is possible to determine the optimal destination of a given block. One or several waste dumps may be considered and they are treated as processing destinations with null recoveries.

The solution is improved by means of the perturbation mechanism. The algorithm performs perturbation at three different level or stages: blocks, operating alternatives and transportation systems. At any level of perturbation, a new solution will be accepted based on the decision rule explained in the previous section.


                           Block Based Perturbations (BBP): The algorithm selects a block randomly and checks its OPBD in the different destinations. It perturbs the solution by modifying periods and destinations of mining blocks. Moving the extraction period of a mining block to a previous period will be referred to as pulling up the block, whereas moving the block to a following period is referred to as pushing down the block. If the block has a positive OPBD in the optimal destination, the algorithm iterates the candidate period from a previous to a following period, favoring first the chance of pulling up the block given the time value of money. In the case where a block has negative OPBD in all destinations, the algorithm iterates from the following period to the previous one, favoring first pushing down the block (Fig. 5). Before accepting any candidate period, the algorithm checks that slope constraints are respected.

For a block with positive OPBD in its optimal destination, the set of candidate destinations are those with positive OPBD. The algorithm sorts candidate destinations based on the OPBD and iterates from the most profitable destination to the less profitable one (but still with positive OPBD). If the block has negative OPBD in all destinations, the only candidate destination is its optimal destination (the one with higher OPBD). This ensures that waste blocks are always sent to the waste dump(s) as they are treated as destinations with null recoveries. There may be cases where blocks have negative OPBD in all destinations but the optimal destination in not a waste dump; that is, although processing that block in a particular processing path generates a negative profit, the profit losses are less by processing the block than by sending it to a waste dump. In these cases, optimal destinations are also respected.

Although, pulling up a positive block and pushing down a negative one improve NPV expectations because of the time value of money, the objective value of the new solution generated does not necessarily increase as there is a penalty term also affecting the objective function. There may be cases where the NPV increases, but the new solution deteriorates the objective value due to the penalized deviations. A similar analysis can be made for the opposite case; a perturbation that decreases NPV expectations does not necessarily deteriorate the current solution. The objective value can be seen then as a trade-off between improving the NPV and decreasing deviation from operational targets.


                           Operating Alternative Based Perturbations (OBP): In the previous section, block based perturbations were described; however, the operating alternatives implemented at each destination are not simultaneously modified. The set of perturbations at the OBP level refer to swapping operating alternatives at the different destinations (processing paths); e.g., swapping from fine to coarse grinding in the mill in some periods of the LOM. Modifying the operating alternative at a particular destination in a given period may vary the objective value as: (i) processing cost and recovery may change, which may affect the expected NPV; (ii) capacity and operational metallurgical ranges may change, which affect the penalty term in the objective function.

Given a particular period and destination, the algorithm selects randomly an available operating alternative as the candidate alternative, and evaluates the objective value when swapping the operating alternative to the candidate one (Fig. 6). The new solution is accepted or rejected based on the decision rule explained previously.


                           Transportation System Based Perturbations (TBP): As previously explained, the first level of perturbations modify period and destinations of mining blocks, whereas the second level of perturbations modify operating alternatives at the different periods and destinations. The third level of perturbations is referred to as the transportation system based perturbations. For a given destination and period, the algorithm attempts to perturb the proportion of output material transported using the available transportation systems; e.g., the mill-roaster processing path (destination) change its transportation arrangement for the output material from (70 percent trucks/30 percent pipe) to (50 percent trucks/50 percent pipe). This set of perturbations seeks to minimize the transportation costs and penalized deviations in the objective function. The variations of the proportions of transportation systems utilized are generated using random numbers but ensuring that 100 percent of the output material from a given destination is transported using the feasible transportation systems (mass conservation). Perturbations are accepted or rejected based on the decision rule described previously.


                           The Heuristic Approach: The different activities of a mining complex are strongly interrelated. Any modification in a particular activity modifies the optimal operation at the other activities of the mining complex; e.g., modifying the mining sequence affects the optimal operating parameters at a given destination and the transportation system implemented. The same occurs when modifying operating parameters or transportation arrangements. Given the interrelation between the different activities, the algorithm integrates the multilevel perturbations in an iterative way (Fig. 7).

At any given temperature, a user-defined number of BBP is performed, when it reaches this predefined number, the temperature in this level of perturbation is lowered and the OBP starts. Similarly, when it reaches a user-defined number of OBP, the temperature in this level of perturbation is lowered and the TBP starts. When the three levels of perturbations are performed, the algorithm returns to the first level (BBP). It continues until the total number of BBP is reached.

The heuristic approach can be implemented iteratively by controlling the number of cycles. However, it must be important to establish a trade-off between the quality of the solution and computational time, given that it increases linearly with the number of cycles. Furthermore, there may be a number of cycles from where no significant improvement in the objective value of the solution is obtained.

The algorithm is written in C++ programming language, compiled in Microsoft Visual Studio 2010 and runs on an Intel processor core i7 2600s with 8GB of RAM, using Windows 7 as operating system.

The method is implemented in a mining complex that produces copper and contains two different pits: Pit A and Pit B. The material extracted from both pits has been classified in five different types that originate different metal recoveries at the different destinations. Five destinations are available (Fig. 8
                        ), including a waste dump.

Twenty stochastic orebody simulations (Remy, Boucher, & Wu, 2008; Maleki & Emery, 2015) were provided for each deposit, which consider uncertainty in both grades and material types. Past work have demonstrated that at the scale of mine planning, solutions converge after ∼ 15 stochastic orebody simulations (Albor & Dimitrakopoulos, 2009; Dimitrakopoulos & Jewbali, 2013). Three variables of interest are considered in the orebody simulations: copper, which is the selling product of the mining complex; and two metallurgical properties that control the operation in the small and the big mill.

An initial solution for the multipit multiprocess problem is generated using Whittle, a widely used software for strategic mine planning. Whittle discretizes the deposits into nested pit-shells and generates good quality solutions in the deterministic space by combining pit-shells and benches at the different deposits during scheduling. This initial solution determines the periods and destinations of mining blocks for both pits, and is generated considering the estimated geological models (E-types) of the two deposits; that is, the average grade of each block from the available simulations. This solution will be referred to as base case schedule and it is generated using a conventional optimizer widely used in the mining industry.

The results obtained by implementing the base case schedule are depicted in Fig. 9
                        
                        
                        
                        . Large and impractical deviations in terms of capacities and blending targets are presented when implementing the base schedule over the different scenarios. After the pre-stripping years, deviations in the small mill are 18 percent in average and 22 percent in the big mill. Regarding the blending element 1 (BEL1) that controls the operation of the small mill, the deviations in the first 7 years of operation are in average 7 percent, whereas the blending element 2 (BEL2), that controls the operation of the big mill, deviates in average 1.8 percent in these periods.

Any conventional mine production scheduler attempts to optimize the sequence of extraction of a given deposit using a single estimated model. Interpolation methods used in estimation generate averaged-type models that smooth the mineral grades and do not reproduce the spatial variability of the drilling data. Given the non-linear transformations associated with the mine planning process, an averaged-type geological model does not generate a solution with average performance. This originates that a solution generated using a deterministic method do not perform as predicted in the estimated model.

To implement the approach, optimization parameters such as initial temperature, reduction factors, penalties, cycles and number perturbation must be calibrated. The penalties must account for the order of magnitude of the different targets in order to balance the penalization in the objective function. Fig. 10 displays the evolution of the terms of the objective function with the number of perturbations for five different temperatures. An initial temperature of 0 means that only perturbations that improve the objective value are accepted (pure iterative improvement) which limits the ability of the methodology of escaping from local optimal solutions. A very large initial temperature implies accepting both, favorable and unfavorable perturbations with high probability, which may not improve the initial solution as the solution will not necessarily converge to a final good solution.

The same analysis is performed to evaluate the number of cycles (Fig. 11). It can be observed that after two cycles, the improvement in expected NPV is negligible, whereas no significant reduction in penalized deviations is attained after one cycle.

The perturbation mechanism is performed until a stopping criterion is reached. A stopping criterion can be the total number of perturbations which controls the computational time of the implementation of the method. The case study shows the ability of the algorithm to perform 10 million perturbations in less than 1 hour in a mining complex comprised of two pits and 176,000 mining blocks. The algorithm will stop also if no significant improvement in the objective value is achieved after a certain number of perturbations, which means that the algorithm converged to a solution. In this case study, the solution converges after 2 million perturbations, which implies that the method is capable of generating solutions for real-size problems in practical times.

The proposed approach is implemented considering the economic and technical parameters used in the base case. The results obtained are displayed in Fig. 12.

Low deviations from capacities and blending targets are expected. After the pre-stripping years, deviations from the capacity of both the small and big mills are 1 percent on average. The probability of deviating from the operational ranges of BEL1 is largely reduced, obtaining an average expected deviation of 0.4 percent. Larger probabilities of deviating are presented at the end, originated from the geological risk discounting applied to the penalties that allow deferring risk to later periods when more information becomes available. For BEL2, there are expected deviations of 1.3 percent. The expected NPV is 3 percent higher when compared to the base case; however, given the large and impractical deviation from targets in the base case, its NPV forecast is not reliable.

The method is implemented considering the case where multiple operating alternatives are available in both mills. In case 1, fine grinding option is selected by default. The method is now able to choose which option to implement at each mill along the different periods. For both mills, when operating using a coarse grinding option, the capacities increase by 11.6 percent and the metallurgical recoveries decrease by 2 percent. The operational ranges for BEL1 and BEL2 also change with the two different operating alternatives. Given the flexibility in the operation of the mills, the method is able to perform second level perturbations (OAP). Fig. 13
                         display the results obtained when implementing the method.

The coarse grinding option is selected in years 5–8, 10, 12, 13, 16, 18, 21 and 22 in the small mill, and in years 16 and 19 in the big mill. Although capacities of the mill change when swapping from one alternative to another, the algorithm pushes material in a way that deviation from capacities of both mills are well controlled (in average 1 percent in small mill and 3 percent in the big mill). The same behaviour is observed with respect to the blend element targets; BEL1 jumps in periods when the small mill operates at coarse grinding to meet the new blending requirements, whereas BEL2 jumps in periods when the big mill swaps to coarse grinding. In average, BEL1 and BEL2 deviate 0.7 and 1.2 percent respectively.

The risk analysis of the NPV expected by implementing the solution generated in the case 2 is displayed in Fig. 14
                        . This solution generates an expected NPV 5 percent higher than the base case. As was previously mentioned, the NPV forecasts of the base case solution are not reliable given the large deviations from capacities and blending targets. The base case solution is improved by means of the two levels of perturbation implemented (BBP and OBP).

@&#CONCLUSIONS@&#

Mine planners optimize mining complexes considering that interpolated geological models represent accurately the reality in the ground, ignoring the geological uncertainty associated with mineral deposits. Interpolation methods generate averaged-type deposits by definition. Given that the transfer function that relates grades of mining blocks and economic outputs of a mining complex is non-linear, the use of averaged-types deposits in the optimization, as in standard industry practices, generates solution with poor performance over a set of possible scenarios. By contrast, risk-based formulations can make use of the joint local uncertainty by considering stochastic orebody simulations, which can lead to solutions with higher reward and less risk.

A risk-based method to optimize mining complexes comprised of multiple pits, stockpiles, blending requirements, processing paths, operating alternatives and transportation systems is presented and implemented. Due to the incorporation of geological uncertainty and other components of a mining complex, the solutions generated with the method outperform solutions obtained using conventional deterministic approaches in terms of expected NPV and meeting production targets. The solutions generated define the sequence of extraction of the mining blocks in the different pits, the operating alternative implemented at each processing path, and the transportation system used to carry the processed material to the final stocks.

The implementation of the method in a multipit copper operation allows reducing the average deviations from capacities and blending targets considering an initial solution generated using a conventional optimizer over a single estimated model: from 18 to 1 percent regarding small mill capacities, from 22 to 3 percent regarding big mill capacities, from 7 to 0.3 percent regarding BEL1 in the first 7 periods, and from 1.8 to 0.6 percent regarding BEL2 in the first 7 periods. Although NPV forecasts for the base case are not meaningful given its large deviations from capacities and blending targets, the solution generated by implementing the proposed method generates an expected NPV 5 percent higher than the base case, which highlights the ability of the method to generate a higher NPV with less risk. The objective value that accounts for both NPV and penalized deviations is improved by 105 percent.

The operating and transportation perturbation mechanisms act as a diversification strategy for the scheduling of the mining blocks. However, when no processing and transportation alternatives are available, the exploration of the solution domain will be very limited generating fast convergences to local optimal solutions. To overcome this limitation, a diversification strategy at a mining block scale should be added to the method. Future work should also consider mining complexes with underground operations and other sources of uncertainty as markets, stockpiles, etc.

@&#ACKNOWLEDGEMENTS@&#

We would like to thank the organizations and companies who funded this research: Canada Research Chairs (Tier I) in Sustainable Mineral Resource Development and Optimization under Uncertainty, and NSERC Collaborative Research and Development Grant CRDPJ 411270-10, entitled Developing new global stochastic optimization and high-order stochastic models for optimizing mining complexes with uncertainty; industry collaborators: AngloGold Ashanti, Barrick Gold, BHP Billiton, De Beers, Newmont Mining and Vale, and NSERC Discovery Grant 239019.

@&#REFERENCES@&#

