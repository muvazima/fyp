@&#MAIN-TITLE@&#Multi-level lot sizing and job shop scheduling with compressible process times: A cutting plane approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Simultaneous lot sizing and scheduling problem is formulated in a job shop.


                        
                        
                           
                           Machines are flexible to change their working speeds.


                        
                        
                           
                           Some valid inequalities are developed based on problem structures.


                        
                        
                           
                           The cuts are used in cut-and-branch and branch-and-cut approaches on a set of test data.


                        
                        
                           
                           The cuts are ranked by TOPSIS method by defining a set of performance indexes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

(P) Production

Scheduling

Process compressibility

Job shop

Cutting planes

Multi-level lot sizing

@&#ABSTRACT@&#


               
               
                  This paper proposes an integer linear programming formulation for a simultaneous lot sizing and scheduling problem in a job shop environment. Among others, one of our realistic assumptions is dealing with flexible machines which enable the production manager to change their working speeds. Then, a number of valid inequalities are developed based on problem structures. As the valid inequalities can help in reducing the non-optimal parts of the solution space, they are dealt with as some cutting planes. The proposed cutting planes are used to solve the problem in (i) cut-and-branch, and (ii) branch-and-cut approaches. The performance of each cutting plane is investigated with CPLEX 12.2 on a set of randomly-generated test data. Then, some performance criteria are identified and the proposed cutting planes are ranked by TOPSIS method.
               
            

@&#INTRODUCTION@&#

Production management is a multi-disciplinary job that involves in considering many factors simultaneously. Among other tasks, a production manager should simultaneously decide about lot sizing and process routing of some items in each planning period to minimize total cost of the plant. Furthermore, there is limited amount of available working time due to technical limitations in a planning period. And, dealing with such technical limitations results in a complicated problem that was mainly treated by heuristics and rule of thumbs (Fallah & Shayan, 2002). Also, these decisions (i.e. lot sizing and machine sequencing) were traditionally made in a sequential manner, resulting in a number of recursive corrective actions. In more details, the following steps were generally taken in traditional (i.e. MRP-based) production management with some minor variations (Koh, Saad, & Jones, 2002; Pochet & Wolsey, 2006; Waters, 2003):
                        
                           
                              Step 0:
                           estimate the available capacity for processing a set of items over needed machines in the following periods,

determine lot sizes of different items for forthcoming planning periods,

determine the best schedule of machineries to perform different processes of each item, regarding their lot sizes,

check if the obtained production schedule is feasible in term of needed capacities;
                                 
                                    
                                       if the production schedule is not feasible, then


                                       
                                       revise the decisions by some heuristics,

otherwise


                                       
                                       perform a local search to find better solutions for a number of trials.

Moreover, these decisions are usually updated via a rolling horizon framework with the hope of cost reduction by means of special-purpose packages or heuristics (Karimi, Fatemi Ghomi, & Wilson, 2003). Consequently, there are many critiques on the non-optimality of the above procedure due to non-simultaneousness of decision makings (Franck, Neumann, & Schwindt, 1997). On the other hand, machines can work in different rates/modes by changing their settings. This feature is ordinarily observed in lots of real world shop floors and provides a degree of flexibility for a production manager, but it may also complicate determining the optimal policy. So, if we decide about lot sizes and process sequences simultaneously while considering shop constraints, then we can be sure about the efficiency and/or optimality of the whole production schedule (i.e. lot sizes and machine sequences in periods). However, this may lead to mixed integer programming (MIP) formulations that are hard to solve in reasonable time for sizes close to real world (Pochet & Wolsey, 2006). This paper tries to fill in the gap by providing a problem formulation along with a set of efficient valid inequalities.

@&#LITERATURE REVIEW@&#

This section provides a brief review of the literature. Previous researchers have provided different contributions to the main problem in terms of new concepts, model, and solution methods. Afentakis (1985) proposed some crude ideas about combining lot sizing and sequencing decisions in a job shop environment. Later, Schwindt and Trautmann (2000) dealt with batch scheduling in process industries for the case of multi-purpose machines. They have used methods of resource-constrained project scheduling for handling the problem. Other similar contributions are proposed in the literature by integrating ideas from other problems. For example, Wong, Chan, and Chan (2009) combined ideas in capacitated lot sizing and scheduling problem (CLSP) with resource-constrained project scheduling problem (RCPSP). Also, they assumed that routing of processes among machines is known a priori. On the other hand, different lot streaming and/or sizing policies are proposed in the literature that lead to different properties of optimal solutions (Chan, Wong, & Chan, 2008; Wong et al., 2009). In contrast, this paper develops a dynamic capacitated lot sizing and scheduling problem, where lot sizes and schedules are determined periodically but periodical schedules obey from a global schedule in all periods. In this respect, to our best knowledge, a similar contribution is not proposed in the literature (Maravelias & Sung, 2009; Potts & Van Wassenhove, 1992; Zhu & Wilhelm, 2006).

The most favorite area of research in the literature is dedicated to providing different formulations for the problem according to various working conditions that can arise in reality. It should be noted that most of the formulations are based on some famous problems such as the followings: CLSP, RCPSP, PLSP (proportional lot sizing and scheduling problem), GLSP (generalized lot sizing and scheduling problem), DLSP (discrete lot sizing and scheduling problem), CSLP (continuous setup lot sizing and scheduling problem). One important challenging point is to consider precedence relationships between the needed processes of an item, when each process can be potentially performed on specific machines (Ierapetritou & Floudas, 1998; Ierapetritou, Hene, & Floudas, 1999). Another hardship in the formulations comes back to considering different types of capacities and/or shortages. Ozturk and Orneck (2010) developed a MIP model for multi-period production scheduling with allowable backordering and production capacity constraint along with linked lots. Their model is an extension of CLSP for job shop environments. However, note that most part of the literature is devoted to single stage cases when considering capacity issues. In addition, real world products are usually constructed by assembling needed factors of some items according bills of materials (BOM). For example, the product structures of automobiles, rockets, etc. are multi-level. In such cases, the production manager should periodically decide about the lot size of items along with assemblies of final product. But, the literature has mainly provided models for single-level products (see Table 1
                     ). Among others, Stadtler and Sahling (2013) provided formulations for the case of products with multi-level structure in a flowshop and solved it with simulated annealing (SA) and genetic algorithm (GA).

The problem is solved with different solution methods in the literature that can be mainly categorized to: exact methods (for small sizes or simple problems), (meta-) heuristic or hybrid methods (for complicated problems or large sizes). Generally speaking, one can consider flowshop as a special case of job shop, where precedence relations between the processes/machines are linear. In this regard, production scheduling in job shops is inherently harder than flowshops. Thus, most problems of the literature in job shops are solved by non-exact methods in contrast to the problems in other environments such as flow shops and single machines. As an example, Kim and Kim (1996) and Wong et al. (2009) solved the problem by SA and GA. Chan et al. (2008) used GA for determining lot sizes, and simple dispatching rules for determining sequence of lots in a hybrid framework. Ouenniche and Bertrand (2001) proposed a model based on basic cycle approach. They decomposed the main problem into an assignment subproblem, a sequencing subproblem, and a lot sizing and scheduling subproblem. Then, assignment subproblem was solved by a heuristic, sequencing subproblem was solved by either of simulated annealing or tabu search, but lot sizing and scheduling was solved by mathematical programming to optimality. Later, Nozick et al. (2002) proposed a simple model for processing items in a job shop environment with the help of project scheduling concepts. They solved the model by a heuristic based on generalized Benders’ decomposition (GBD). According to Table 1, it seems that most part of the literature have used (meta-) heuristics or commercial solvers such as CPLEX, GAMS, Xpress-MP, and so forth.

Recently, there seems a trend in the literature in developing efficient exact solution methods than inaccurate (meta-) heuristics. However, the best achievement is obtaining some pseudo-polynomial algorithms for such NP-Hard problems, but it preserves the motivation of researchers to continue the progress at least for not extremely large sizes but for some real size instances. Developing new cutting planes with good working characteristics is an attractive research area. The cutting planes can be added to original problem formulation a priori in a cut and branch manner or they can be added after calling a separation algorithm in order to recognize violated cutting planes at a node of a branch and bound tree in a branch and cut approach.

This paper tries to determine the optimal value of following decision variables simultaneously in an integrated manner:
                        
                           –
                           sequence of processes on different item types over every machine,

sequence of processes of a given item type over the needed machines according to predefined precedence relations,

lot size of different item types over planning periods,

working speed/mode of each machine for processing on different item types.

To the best of our knowledge and according to the reviewed literature (see Table 1), this problem is not broadly addressed till now by researchers while it seeks answers to some critical questions of production managers. Rest of the current paper is organized as follows: Section 3 provides problem formulation, Section 4 describes the cutting planes, Section 5 presents numerical example, and Section 6 concludes the papers and proposes some guides for future research.

This section formulates the problem based on the following working conditions:
                        
                           –
                           there are a set of final products that are obtained by assembling needed factor of produced items according to given bills of materials,

there are a set of items that each has to pass different processes according to a predefined precedence diagram between the processes (i.e. the machines are in a job shop environment). Furthermore, the problem environment is sometimes referred to as assembly job shop, where an assembly stage is appended to a job shop (Chan et al., 2008; Wong et al., 2009),

there are a finite number of planning periods with known dynamic available times. Also, demand of final products are known dynamic input data over periods,

there are a set of single-purpose (i.e. each machine is able to perform a unique process) non-duplicate machines (i.e. the machines are not similar). Without loss of generality, we assumed that what makes an environment to be labeled as job shop is just having a number of machines in a process layout. In more details, according to the definition of job shop in Pinedo (2008) we have: “In a job shop with m machines, each job has its own predetermined route to follow.” Clearly, there is no emphasis on having multi-purpose or single-purpose machines in a job shop. Also, one can observe that our problem is different from this definition by determining the routes as decision variables subject to precedence relations (this is in contrast to having predetermined routes in a classical job shop),

each machine is a dedicated resource that can only process one item at a time,

setup include two parts:
                                 
                                    (a)
                                    sequence-dependent setups which are separable such that it is done before processing on a batch of an item type. In other words, each machine should be setup by changing its current tool/settings whenever it finishes processing an item type, and

cleaning time which is independent of the item type and the process such that it is done after processing on a batch of an item type (i.e. cleaning is for brushing, lubricating, etc.),

shortage of the items are allowed in term of backorders not lost sales. In this way, shortage is allowed in all periods except the last one,

the manager desires to minimize total costs, including setup, production, inventory holding and shortage of the items,

work-in-process is not allowed to be held for any item types at the end of each planning period. In other words, production process of an item should be completed within the same period it started,

there are intermediate buffers with large enough capacities to hold work-in-processes before machines,

pre-emption/disruption is not allowed,

machines are reliable and they do not fail in the horizon,

all input parameters are deterministic,

each machine can operate in different discrete speed levels (or modes) such that the set of modes for each machine is known a priori (see Fig. 1
                               for example). Also, the working mode of each machine should be adjusted before starting any processings and the mode cannot be changed over periods according to managerial requirements.

Now, the problem formulation is constructed below.
                        
                           (1)
                           
                              min
                              
                              TC
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       {
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                       ∩
                                       
                                          
                                             Ω
                                          
                                          
                                             h
                                          
                                       
                                       }
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              
                                 
                                    sc
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    CW
                                 
                                 
                                    j
                                    ,
                                    i
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       U
                                    
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    u
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    INV
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       U
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       U
                                    
                                 
                              
                              
                                 
                                    mc
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                           
                        
                     s.t.
                        
                           (2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              =
                              1
                              
                              ∀
                              j
                           
                        
                     
                     
                        
                           (3)
                           
                              -
                              
                                 
                                    at
                                 
                                 
                                    t
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              ⩽
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              +
                              
                                 
                                    at
                                 
                                 
                                    t
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              )
                              
                              ∀
                              k
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              t
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    CW
                                 
                                 
                                    j
                                    ,
                                    i
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                          
                                             max
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                q
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                u
                                                =
                                                1
                                             
                                             
                                                U
                                             
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             k
                                             ,
                                             u
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             u
                                             ,
                                             q
                                          
                                       
                                    
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              )
                              
                              ∀
                              k
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              t
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              
                              ∀
                              u
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    SEQ
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                 
                              
                              +
                              
                                 
                                    SEQ
                                 
                                 
                                    j
                                    ,
                                    h
                                    ,
                                    k
                                 
                              
                              =
                              1
                              
                              ∀
                              k
                              
                              ≠
                              
                              h
                              ,
                              j
                              ∈
                              {
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ∩
                              
                                 
                                    Ω
                                 
                                 
                                    h
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       ∈
                                       
                                          
                                             Ψ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    -
                                    1
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                              
                              
                              ∀
                              k
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       ∈
                                       
                                          
                                             Ψ
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       {
                                       k
                                       }
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    h
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    -
                                    1
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                              
                              
                              ∀
                              k
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                Ψ
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                Ψ
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          =
                                          1
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             Ψ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              t
                              ,
                              j
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              ⩽
                              1
                              -
                              
                                 
                                    SEQ
                                 
                                 
                                    j
                                    ,
                                    h
                                    ,
                                    k
                                 
                              
                              
                              ∀
                              k
                              
                              ≠
                              
                              h
                              ,
                              j
                              ∈
                              {
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ∩
                              
                                 
                                    Ω
                                 
                                 
                                    h
                                 
                              
                              }
                              ,
                              t
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    Z
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              +
                              
                                 
                                    Z
                                 
                                 
                                    w
                                    ,
                                    j
                                    ,
                                    k
                                 
                              
                              =
                              1
                              
                              ∀
                              k
                              ,
                              {
                              j
                              
                              ≠
                              
                              w
                              }
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    r
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    w
                                    ,
                                    j
                                    ,
                                    k
                                 
                              
                              =
                              0
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    st
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                 
                              
                              
                              ∀
                              k
                              ,
                              t
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    X
                                 
                                 
                                    w
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    st
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    at
                                 
                                 
                                    t
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    Z
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              )
                              
                              ∀
                              k
                              ,
                              {
                              j
                              
                              ≠
                              
                              w
                              }
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    r
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              =
                              0
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    X
                                 
                                 
                                    w
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    st
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              
                              ∀
                              k
                              ,
                              {
                              j
                              
                              ≠
                              
                              w
                              }
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              =
                              1
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    st
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                 
                              
                              +
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    l
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    at
                                 
                                 
                                    t
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    SEQ
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                 
                              
                              )
                              
                              ∀
                              k
                              
                              ≠
                              
                              h
                              ,
                              {
                              j
                              
                              ≠
                              
                              w
                              }
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    X
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              k
                              ,
                              t
                              ,
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       U
                                    
                                 
                              
                              
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    at
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              t
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    k
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       1
                                    
                                    
                                       U
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    k
                                    ,
                                    u
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              
                              ∀
                              k
                              ,
                              t
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    INV
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              =
                              
                                 
                                    INV
                                 
                                 
                                    u
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    u
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              
                              ∀
                              u
                              ,
                              t
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    W
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    INV
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    u
                                    ,
                                    t
                                 
                              
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    +
                                 
                              
                              ∪
                              {
                              0
                              }
                           
                        
                     
                     
                        
                           (21)
                           
                              
                                 
                                    B
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    SEQ
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    h
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    j
                                    ,
                                    w
                                    ,
                                    k
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                        
                     
                  

The objective function (1) minimizes total costs, including setup, production, inventory of items and final products, shortage of final products, and assembly costs. Constraint (2) selects an appropriate speed for each machine (Note that 
                        
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              
                                 Δ
                              
                              
                                 j
                                 ,
                                 i
                              
                           
                           
                              
                                 p
                              
                              
                                 j
                                 ,
                                 i
                              
                           
                        
                     ). Consequently, by setting the speed level of machine j, the total process duration as well as total process cost of each item k in period t working at its mode i are determined by constraints (3) and (4). On the other hand, constraint (5) states that the total assemblies of product type u should not be less than the total needs of it over planning periods. Another indirect meaning of constraint (5) is that shortages can only occur in the form of partial backorders not lost sales. In other words, there can be shortages in all periods other than t
                     =
                     T. However, constraint (5) certainly holds in equal form in an optimal solution, but this form helps in finding initial solutions in shorter CPU times by solvers.

According to our assumption, which is motivated from a real case study, a unique sequence for processing items in all periods is desired. This can be achieved by constraint (6). Constraint (6) obtains a globally consistent sequencing of different item types over machine j, disregarding whether a/some of the items k is/are produced in a period t or not. Constraints (7)–(10) relate periodical sequence of items on machine j with the global sequence obtained by relation (6) as well as the production volume of item type k in period t. Constraint (7) tells that exactly one item type h can be processed immediately after item type k on machine j in period t if Y
                     
                        k,t
                     
                     ⩾1. Reversely, constraint (8) states that at most one item type h can be processed immediately before item type k on machine j in period t. Also, we have assumed in the formulation that h
                     =
                     k means that k is the first processed item type on the machine. Then, constraint (9) states that exactly one item type k should be at the first position of machine j in period t. Constraint (10) states the relation between SEQ
                     
                        j,k,h
                      and B
                     
                        j,h,k,t
                      in order to building periodical sequences (obtained by B
                     
                        j,h,k,t
                     ) consistent to the global sequence obtained by SEQ
                     
                        j,k,h
                      via constraint (6). Constraint (11) determines the process sequence on item k over needed machines j and w when there are no precedence relationships between these machines.

Constraints (12) and (13) define together the minimum and maximum value for the start of processing on an batch of item type k in period t over needed machine j respectively (i.e. X
                     
                        k,j,t
                     ). Then, we know that if item type k is processed at the first priority order of machine j in period t (i.e. B
                     
                        k,k,j,t
                     
                     =1), then the start of that process is assumed to be greater than or equal to the needed setup time st
                     
                        j,k,k
                     . In more details, constraint (12) states the same sense but in algebraic format. Note that in this way we can model the working condition of separable setups in the whole formulation, where setups can be done before release of an item type to the text process stage. In connection to constraint (11), constraint (13) relates the process start times of item type k on two machine j and w while considering separability of setups for the cases that machines j and w do not have any explicit precedence relationships. On the other hand, constraint (14) relates the process start times of item type k on two machine j and w when machine j is predecessor for machine w. And, constraint (15) relates the global sequence of item types k and h when both of them are processed on the same machine j in period t. Note that if either of item type k or h is not produced in period t (i.e. Y
                     
                        k,t
                     
                     Y
                     
                        H,t
                     
                     =0), then constraint (15) is true but redundant. Also, as it is better not to use big-M in the formulations, and the fact that X
                     
                        j,k,t
                      is bounded from above by at
                     
                        t
                      according to constraints (16) and (17), at
                     
                        t
                      in constraints (13) and (15) plays the role of big-M without any problem. Totally, constraints (12)–(15) determine the schedule of each item on each needed machine in each period along with controlling the available time of each period.

On the other hand, constraint (16) measures the completion time of processing on different item types in period t, and checks if all processes of the item types produced in period t are completed before the start of assemblies in period t. In other words, constraint (16) dictates that there should be no semi-finished items between production stages at the end of a period. Constraint (17) dictates that all assemblies of different product types in period t should be performed before the end of available time in that period. Inventory balance of item type k at the end of period t is controlled by constraint (18). Similarly, constraint (19) states the inventory balance for product u at the end of period t. Finally, relations (20) and (21) state the type of decision variables. As the model is a mixed integer linear program (ILP for short), it is inefficient to solve with commercial solvers directly. Hence, the next section develops a set of valid inequalities that can be used specially in large sizes close to real world instances in a cut and branch discipline to accelerate the solution process.

This section provides some valid inequalities by means of the decision variables of the model. As each inequality tightens a part of solution space, they can be regarded as cutting planes. When having a number of cutting planes at hand, one of the two main choices are possible for solving the problem (Pochet & Wolsey, 2006):
                        
                           –
                           appending the cutting planes to the original problem formulation before calling a solution procedure (e.g. a branch and bound based on simplex algorithm after temporary integrality relaxation) or a solver (such as CPLEX, Xpress-MP, etc). In this way, the new problem formulation, which consists the cuts, is wholly solved by the solver. This approach is sometimes referred to “cut-and-branch” among scholars.

appending a cutting plane to the problem formulation at some nodes of the brand-and-bound tree in a way that just a violated cut constraint is allowed to be appended to the formulation. Thus, there should be a separation algorithm to determine which cuts are violated at a node. This approach is mostly referred to “branch-and-cut” in the literature. Then, devising a low-order separation algorithm is the main feature of this approach. But, all NP-Hard problems have exponential-time separation algorithms till now.

This paper uses from the first approach (i.e. cut-and-branch) in solving the current problem formulation of Section 3. As our model is a mixed integer optimization formulation, we can potentially use many state of the art solution methods such as relaxations, decompositions, and so forth, other than cutting planes. We do not see any drawback in such methods. But, we believe that our cuts are good enough to solve the problem. Specially, a great goodness of our cuts is that we can simply append them as new constraints to the original problem formulation via commercial solvers without needing to provide a large amount of codings as in decompositions/relaxations/etc. However, all exact deterministic solution methods for our problem have exponential run times unless P=NP (Pochet & Wolsey, 2006). Now, the valid inequalities will be given based on problem formulation/assumptions and algebraic manipulations.
                        Proposition 1
                        
                           The optimal solution is contributed with the following relations:
                           
                              
                                 (22)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          k
                                          ,
                                          T
                                       
                                    
                                    =
                                    0
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          u
                                          ,
                                          T
                                       
                                    
                                    =
                                    0
                                    
                                    
                                    
                                    
                                    ∀
                                    u
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          q
                                       
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    t
                                 
                              
                           
                        

The correctness of relations (22) and (23) are straight for the fact that no extra inventories of either item k or product u is needed at the end of the planning horizon (i.e. I
                           
                              k,T
                           
                           =
                           INV
                           
                              u,T
                           
                           =0). Also, according to problem assumptions, shortage is not allowed in terms of lost sales (i.e. S
                           
                              u,T
                           
                           =0). However, such claims are straightly available for the fact that constraint (5) is active at optimality (i.e. in an optimal solution is satisfied at equality than inequality). Hence, relation (24) can be resulted directly for an optimal solution. On the other hand, relation (25) can be deduced from relation (24) and provides a ceiling for the optimal production volume of item type k in period t. □


                           Non-recursive form of constraints 
                           
                              (18) and (19)
                            
                           are
                           
                              
                                 (26)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   u
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    t
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    )
                                    
                                    
                                    
                                    
                                    ∀
                                    u
                                    ,
                                    t
                                 
                              
                           
                        

The claim is on hand by induction over t. □

(Cut I).The optimal value of TC is bounded from below by relation 
                           
                              (28)
                           
                           .
                           
                              
                                 (28)
                                 
                                    TC
                                    ⩾
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          sc
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          -
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   λ
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    T
                                    -
                                    t
                                    )
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   u
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             
                                                
                                                   π
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    (
                                    T
                                    -
                                    t
                                    +
                                    1
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    {
                                    
                                       
                                          mc
                                       
                                       
                                          u
                                       
                                    
                                    -
                                    
                                       
                                          π
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    T
                                    -
                                    t
                                    +
                                    1
                                    )
                                    -
                                    (
                                    T
                                    -
                                    t
                                    )
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   λ
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    }
                                 
                              
                           
                        

One can see that TC can be separated into different cost terms. Then, by combining the lower bound of these terms together, a lower bound can be obtained for TC.
                              
                                 
                                    i.
                                 A lower bound for setup costs is

According to constraint (4) and relation (24), production costs can be restated as

Inventory holding cost of items can be restated by replacing I
                                    
                                       k,t
                                     with the right hand side of relation (26). In other words, the following relation is correct.

Shortage cost of products can be re-written by replacing S
                                    
                                       u,t
                                     with the right hand side of the following relation which is obtained directly from relation (27). In other words, the following relation is correct.

Similar to Cut I, an upper bound can be constructed for TC. But, our computational experiments showed that it has not the expected performance as that of Cut I.
                        Proposition 3
                        
                           For every feasible solution vector, the following relation holds:
                           
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                    ⩽
                                    ⋯
                                    ⩽
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                i
                                             
                                          
                                       
                                    
                                    ⩽
                                    ⋯
                                    ⩽
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                min
                                             
                                          
                                       
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        

As W
                           
                              j,k,t
                           
                           =
                           Y
                           
                              k,t
                           
                           P
                           
                              j
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                              
                            are correct for every feasible solution vector, the claim is straight. □

(Cut II).The following inequality is valid for an optimal solution of the problem.
                           
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                i
                                             
                                          
                                       
                                    
                                    -
                                    (
                                    1
                                    -
                                    
                                       
                                          Δ
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        

There are two following cases for analyzing relation (38).
                              
                                 
                                    case 1.
                                 
                                    P
                                    
                                       j
                                    
                                    =
                                    p
                                    
                                       j,i
                                     and Δ
                                    
                                       j,i
                                    
                                    =1: Then, relation (38) reduces to the following relation.
                                       
                                          (39)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   u
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             ⩾
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                             ∀
                                             k
                                             ,
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    or equivalently,
                                       
                                          (40)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   u
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             ⩾
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   t
                                                
                                             
                                             
                                             ∀
                                             k
                                             ,
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    which, according to relation (24), is held at equality for an optimal solution.

. P
                                    
                                       j
                                    
                                    ≠
                                    p
                                    
                                       j,i
                                     and Δ
                                    
                                       j,i
                                    
                                    =0: Then, relation (38) does not necessarily hold at equality for an optimal solution. Then, the worst case is when 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                max
                                             
                                          
                                       
                                     at optimality, but the relation is written for 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                min
                                             
                                          
                                       
                                    . Thus, according to relation (37), the maximum error that should be corrected is
                                       
                                          (41)
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  min
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   u
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             
                                             ∀
                                             k
                                             ,
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    Now, by combining these two cases together, the proof is complete. □


                           Cut II (i.e. inequality 
                           
                              (38)
                           
                           ) exactly passes through an integer feasible solution.
                        

According to the statements in the proof of Lemma 2, there is exactly a combination of indexes (k, j, i) in Cut II that corresponds to those of the integer optimal solution of the problem. For such indexes, Cut II is active and hence it passes through the corresponding integer feasible solution. □

(Cut III).The following inequality is valid for an optimal solution of the problem.
                           
                              
                                 (42)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   u
                                                   ,
                                                   q
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   -
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         j
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                q
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                i
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        

One can verify that the following relation holds for every feasible solution:
                              
                                 (43)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          q
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    t
                                 
                              
                           In more details, relation (43) is certainly true for the fact that I
                           
                              k,t−1 is a non-negative integer value. Then, the following relation can be obtained by inserting the left hand side of relation (43) instead of the same term in its right hand side but in relation (24).
                              
                                 (44)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          q
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    t
                                 
                              
                           Then, by inserting (W
                           
                              j,k,q
                           /P
                           
                              j
                           ) instead of Y
                           
                              k,q
                           , the following relation is resulted.
                              
                                 (45)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                q
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                 
                              
                           As P
                           
                              j
                            is not a known value, relation (45) is certainly correct for 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                              
                           , but it may be or may not be true for other values of P
                           
                              j
                           . Now, there arise two cases below:
                              
                                 
                                    case 1.
                                 
                                    P
                                    
                                       j
                                    
                                    =
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j,i
                                    
                                    =1: This case means equivalence of relations (42) and (45) without any problem.


                                    P
                                    
                                       j
                                    
                                    ≠
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j,i
                                    
                                    =0: This case means that Y
                                    
                                       k,q
                                    
                                    ≠
                                    W
                                    
                                       j,k,q
                                    /p
                                    
                                       j,i
                                    . Then, the worst case is when 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                max
                                             
                                          
                                       
                                     at optimality, but the relation is written for 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                min
                                             
                                          
                                       
                                    . Hence, a compensating error factor should be paid to correct the case. One can verify that 
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                max
                                             
                                          
                                          /
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                min
                                             
                                          
                                       
                                     plays the role of a suitable error factor that should be multiplied to 
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                u
                                                ,
                                                q
                                             
                                          
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    .

After all, relation (42) combines these two cases into relation (45). Hence, relation (42) is valid for an optimal solution of the problem. □


                           Cut III exactly passes through an integer feasible solution.
                        

The proof is similar to that of Corollary 1 for Cut II. □

(Cut IV).The following inequality is valid for an optimal solution of the problem.
                           
                              
                                 (46)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          j
                                          ,
                                          k
                                          ,
                                          q
                                       
                                    
                                    ⩽
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   u
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          Δ
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                                
                                                   max
                                                
                                             
                                             -
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        

There are two following cases for relation (46).
                              
                                 
                                    case 1.
                                 
                                    P
                                    
                                       j
                                    
                                    =
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j,i
                                    
                                    =1: This case reduces relation (46) to relation (24), where Y
                                    
                                       k,q
                                     is replaced by (W
                                    
                                       j,k,q
                                    /p
                                    
                                       j,i
                                    ) for q
                                    =
                                    t, …, T. Also, similar to the proof of relation (24) in Proposition 1, Relation (46) is active for such an integer solution.


                                    P
                                    
                                       j
                                    
                                    ≠
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j,i
                                    
                                    =0: This case is similar to the case 2 in the proof of Lemma 3, but with an error factor of 
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                u
                                                ,
                                                q
                                             
                                          
                                       
                                    . Also, relation (46) reduces to the following relation:
                                       
                                          (47)
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      t
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                             ⩽
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   u
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                   ,
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                             
                                             
                                             
                                             
                                             
                                             ∀
                                             k
                                             ,
                                             j
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             t
                                             ,
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 

One can note that as 
                              
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                              
                           , then
                              
                                 (48)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          j
                                          ,
                                          k
                                          ,
                                          q
                                       
                                    
                                    ⩽
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   u
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   u
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             u
                                             =
                                             1
                                          
                                          
                                             U
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          u
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          ,
                                          q
                                       
                                    
                                    
                                    ∀
                                    k
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           This latter relation indicates that relation (46) is true but not the tightest possible relation for case 2. Now, the proof is at hand. □


                           Cut IV exactly passes through an integer feasible solution.
                        

The proof is similar to that of Corollary 1 for Cut II. □

(Cut V).The following inequality is valid for every feasible solution of the problem.
                           
                              
                                 (49)
                                 
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    ⩾
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                         ,
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ≠
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                   ,
                                                   q
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                Δ
                                             
                                             
                                                j
                                                ,
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   at
                                                
                                                
                                                   q
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   r
                                                   ,
                                                   q
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    u
                                    ,
                                    k
                                    ∈
                                    
                                       
                                          λ
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        

One can obtain the following relation by re-arranging the terms of relation (26) with respect to A
                           
                              u,q
                            for q
                           =1, …, t.
                              
                                 (50)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ≠
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    u
                                    ,
                                    k
                                    ∈
                                    
                                       
                                          λ
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    t
                                 
                              
                           Then, the following relation is constructed by inserting the right hand side of relation (50) into relation (27).
                              
                                 (51)
                                 
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                
                                             
                                             -
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ≠
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    
                                    
                                    
                                    
                                    
                                    ∀
                                    u
                                    ,
                                    k
                                    ∈
                                    
                                       
                                          λ
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    t
                                 
                              
                           Now, inserting W
                           
                              j,k,q
                           /p
                           
                              j,i
                            instead of Y
                           
                              k,q
                           , followed by a number of algebraic manipulations results in relation (49). Also, note that the error factor can be analyzed similar to that of Lemma 4 by considering the two following cases:
                              
                                 
                                    case 1.
                                 
                                    P
                                    
                                       j
                                    
                                    =
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j,i
                                    
                                    =1: This case means equivalence of relations (51) and (49). Hence, relation (49) is held at equality when passing through an integer feasible solution with P
                                    
                                       j
                                    
                                    =
                                    p
                                    
                                       j,i
                                    .


                                    P
                                    
                                       j
                                    
                                    ≠
                                    p
                                    
                                       j,i
                                    , Δ
                                    
                                       j, i
                                    
                                    =0: similar to the case 2 in the proof of Lemma 4, relation (49) is not the tightest possible inequality for this case. □


                           Cut V exactly passes through an integer feasible solution.
                        

The proof is similar to that of Corollary 1 for Cut II. □

(Cut VI).The following inequality is valid for every feasible solution of the problem.
                           
                              
                                 (52)
                                 
                                    
                                       
                                          INV
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          u
                                          ,
                                          t
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          u
                                          ,
                                          q
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                         ,
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   r
                                                   ,
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    u
                                    ,
                                    k
                                    ∈
                                    
                                       
                                          λ
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                    j
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    t
                                 
                              
                           
                        

The path of proof can traced by inserting 
                              
                                 
                                    
                                       W
                                    
                                    
                                       j
                                       ,
                                       k
                                       ,
                                       q
                                    
                                 
                                 /
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                              
                            instead of Y
                           
                              k,q
                           , followed by a number of algebraic manipulations results in relation (52). □


                           Cut VI does not necessarily passes through an integer feasible solution, except for when the two following conditions hold simultaneously. Otherwise, it just provides a lower bound for INV
                           
                              u,t
                           
                           .
                           
                              
                                 (i)
                                 
                                    t
                                    =
                                    T,


                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                max
                                             
                                          
                                       
                                     and i
                                    =
                                    θ
                                    
                                       j
                                     
                                    (for every machine j that is used to process item k used in product u).
                                 

The claim is trivially provable by considering the conditions in Cut VI and relation (27). □

This section first provides an illustrative numerical example. Then, computational experiments are reported for three categories of test data (i.e. small, medium, and large). In each category, there are 5 sizes, by changing the number of periods. And, three instances of input data are generated for each size. Hence, we have totally considered 3×5×3=45 test data in addition to the illustrative example. The inequalities are used in both branch-and-cut and cut-and-branch manners on different test data. Also, all codlings are carried out in CPLEX 12.20 environment on Pentium IV with 1GB RAM and 2.4GHz CPU. This software is capable to get a set of valid inequalities from user and use them in a branch-and-cut procedure. On the other hand, the user can feed the valid inequalities along with original constraints of the problem to the CPLEX in order to solve the problem via a cut-and-branch procedure. Lastly, the results are discussed and analyzed.

Data of this example are taken from a real world study of a shop floor belonging to defense ministry of Iran. Manager of the shop has used some simple codes that is originally based on the general purpose planning methods such as the one presented in the introduction. In this example, there are 3 machines, 4 items, 3 final products and 6 periods (i.e. J
                        =3, K
                        =4, U
                        =3, and T
                        =6). Then, Tables 2–8
                        
                        
                        
                        
                        
                        
                         provide different input data of the problem. Also, h
                        1
                        =1, h
                        2
                        =2, h
                        3
                        =1, and h
                        4
                        =1 are considered.

Furthermore, Fig. 2
                         shows the precedence relations between needed machines of the items. And, Fig. 3
                         illustrates the bill of material for the products in the current numerical example, where the numbers beside each box declares the consumption factor of the corresponding item for making a unit of the related final product. For example, assembly of a unit of u
                        1 needs 2 units of item k
                        1 and 3 units of item k
                        2.

After solving the problem with above data, the optimal solution is reported in Table 9
                         along with the Gant charts of Fig. 4
                        . Also, optimal process time of the machines are P
                        1
                        =15, P
                        2
                        =16, and P
                        3
                        =14. In Fig. 4,j
                        4 refers to assembly stage of final products.

Then, Table 10
                         provides CPLEX CPU time under different solution methods for the data of the illustrative example. In more details, different combinations of using/not using the proposed cuts and using/not using default cuts of CPLEX are considered in Table 10. This analysis indicates that Cut I and Cut IV have shown the best and worst performance respectively with all solution methods. Also, in most of the cases other than Cut I, all cuts have shown better CPU times with branch-and-cut method in contrast to cut-and-branch method. Furthermore, CPU times of Cut I are not so sensitive to use it in B&C or in C&B. Additionally, CPU time of all cuts increase when the default cuts of CPLEX are not used. However, note that the CPU time decreases meaningfully when using the proposed cuts in comparison to solving the problem by branch and bound.

Also, one can compare the two following cases:
                           
                              –
                              using our cuts in a branch-and-cut manner plus letting CPLEX use from its default set of cuts,

appending our cuts to the problem formulation like original constraint and letting CPLEX use its default set of cuts.

We believe that if a cut can improve the solution progress under the two above cases, it can surely improve the solution progress because the CPLEX has the opportunity of using its best in both cases fairly. Also, our analysis (see Table 10) confirms our claim. However, it seems that if many special features of CPLEX are not used, then the amounts of improvement in CPU time are different. Although, again there is significant improvement in CPU time, but a simple explanation about observing such a difference may be the change in solution platform.

This section provides a summary on computational results on a set of small size test data, when there are 3 machines, 4 items, 3 final products (i.e. J
                        =3, K
                        =4, U
                        =3) and period set T
                        ={6, 12, 18, 24, 30}. Our problem has many different special characteristics that make it hard to use existing data sets. For example, to our best knowledge:
                           
                              –
                              most existing data sets assume that the route of each item over needed machines is a linear precedence relation and is treated as input data (but, we need network precedence relations as input data while we treat with the route of each item over needed machines as decision variable),

most existing data sets assume a known value for the process time of an item over a given machine (but, process of each machine can be compressed in a given interval in our problem),

most existing data sets do not consider assembly of the items to make some final products (but, the produced items should be assembled together according to some bills of material in our problem),

most existing data sets assume an infinite planning horizon while optimizing objectives other than costs (but, we are minimizing different cost terms in a finite multi-period planning horizon in our problem),

most existing data sets consider either of sequence-dependent or sequence-independent setups (but, machine setups have both two parts in our problem simultaneously).

Thus, three test data were randomly generated for each size, where the domains of input data were similar to the data of the illustrative example. Tables 11 and 12
                        
                         report the percent of improvement in solution time by B&C and C&B approaches on different sizes. A clear observation on these tables is about the smooth decrease in the success of each cut in both approaches by increase in problem size.

Afterward, some performance indexes are defined for evaluating the proposed valid inequalities. Then, the most favorite cutting plane is identified based on the experimental observations. For this aim, TOPSIS is used as a multi-criteria decision making method. We use TOPSIS both for its simplicity and for our data. In other words, TOPSIS is much simpler than many other methods such as PROMETHEE, ELECTRE, etc. and it is also stronger than some theoretically poorer methods such as AHP. Also, TOPSIS needs a simple decision matrix as input data, in contrast to other methods such as PROMETHEE, ELECTRE, etc. that need further input data. Additionally, TOPSIS can be run without needing any external input data from a decision maker. This means that our analysis by TOPSIS does not depend on any person. In this way, the cutting planes are ranked. For use of TOPSIS method, we are to aggregate data of Tables 11 and 12. This aggregation is for the fact that the type and dimension of the data in both tables are the same, but they are resulted from different approaches. Hence, the aggregate percent of improvement in CPU time (APCPU) is calculated by simply multiplying data of the similar cells of the two tables. For example, APCPU for Cut I with T
                        =6 is 92.65=99.92×92.72. Then, Table 13
                         reports APCPU of the cuts for different sizes of the problem. As this index shows the overall strength of a given cut, it can be used as a criterion for judging about the proposed cuts. Another suitable indicator about the performance of a cut is its stability in improving the solution process by reducing the fractional parts of the solution space. In other words, cut i is more stable than cut j in successfully improving the CPU time if the records on the APCPU index of cut i has less variation than those of cut j. We believe that coefficient of variation is a good index for this aim. So, Table 13 also reports the coefficient of variation (CVCPU) for the column below each cut.

Let
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          a
                                          
                                             i
                                          
                                       
                                       number of cut type i used during solution by either B&C or C&B, and
                                    
                                    
                                       
                                          b
                                       
                                       number of constraints in original problem formulation.
                                    
                                 
                              
                           
                        
                     

Then, a/b indicates how powerful a given cut i is. In more details, cut type i is superior to cut type j for a given problem formulation with b number of constraints if a
                        
                           i
                        
                        ⩽
                        a
                        
                           j
                        . In this way, Tables 14 and 15
                        
                         report the ratio of the used cutting planes to the original problem formulation in C&B and B&C approaches.

Now, as the data of Tables 14 and 15 have the same dimension and type, they are aggregated in Table 16
                         by a similar aggregation to Table 13.

After, Table 17
                         shows the decision matrix with different cuts as the alternatives and the following criteria: (1) CVCPU, (2) average APCPU, and (3) average ARC.

Before running the TOPSIS method, the positive ideal solution (PIS) and negative ideal solution (NIS) are characterized in Table 18
                        .

Then, the following ranking is reported by TOPSIS method about the performance of the cuts:

Cut I≻Cut V≻Cut IV≻Cut III≻Cut II≻Cut VI.

In this way, experiments on small size test data propose a future user to first use Cut I, then Cut V. However, the difference between some other cuts is so small.

This section provides a summary on computational results on a set of medium size test data when there are 6 machines, 8 items, 7 final products (i.e. J
                        =6, K
                        =8, U
                        =7) and period set T
                        ={9, 15, 21, 27, 33}. Similar to small size experiments, Tables 19–24
                        
                        
                        
                        
                        
                         provide different performance indexes of the proposed cuts on medium size test data.

Now, Table 25
                         shows the decision matrix in order for TOPSIS to rank the proposed cuts based on the experiments on medium size instances.

By indemnifying PIS and NIS as in Table 26
                        , the following ranking is obtained by TOPSIS for the proposed cuts:

Cut I≻Cut V≻Cut IV≻Cut III≻Cut II≻Cut VI.

One can verify that the above ranking is similar to that of experiments on small size instances.

This section provides a summary on computational results on a set of large size test data when there are 9 machines, 12 items, 10 final products (i.e. J
                        =9, K
                        =12, U
                        =10) and period set T
                        ={18, 24, 30, 36, 42}. Similar to small (and medium) size experiments, Tables 27–32
                        
                        
                        
                        
                        
                         provide different performance indexes of the proposed cuts on large size test data.

Now, Table 33
                         shows the decision matrix in order for TOPSIS to rank the proposed cuts based on the experiments on large size instances.

By indemnifying PIS and NIS as in Table 34
                        , the following ranking is obtained by TOPSIS for the proposed cuts:

Cut I≻Cut V≻Cut III≻Cut IV≻Cut II≻Cut VI.

One can verify that the above ranking is similar to that of experiments on small (and medium) size instances, except that Cut III is a bit better than Cut IV.

@&#RESULTS AND DISCUSSION@&#

We can conclude the followings by analyzing the data of the experiments on different sizes:
                           
                              –
                              generally speaking, performance of the cuts deteriorate by increase in problem size,

the average rate of deterioration in the performance indexes of cuts decreases by increase in problem size. In more details, it seems that further increase in problem size will not largely deteriorate the performance indexes of the cuts,

performance values of Cut I does not meaningfully depend on the way of using it by B&C or C&B. In other words, as Cut I is a single valid inequality that its cardinal does not depend on problem size (i.e. the number of cuts of type Cut I does not grow by increase in problem size), it seems logical to observe approximately the same index values in improving the CPU times in both B&C and C&B methods,

Cut I and Cut IV are always the best and worst valid inequalities, disregarding the problem size and the solution approach,

usually, the performance index of a given cut is better in using it in B&C than using it in C&B. This observation may come back to the fact that some inequalities of a given cut are stronger than the others. Hence, it is not needed to append all inequalities of a given cut once at a time to the problem formulation. But, note that it is generally hard to identify such inequalities a priori.

Also, further investigations are carried out on the performance of the proposed model in terms of manufacturing performance indexes (or parameters as per the model) in contrast to using general purpose planning methods such as the one presented in the introduction (i.e. the package used in the studied shop). Therefore, the followings manufacturing performance indexes are measured in Table 35
                         for three instances of each size:
                           
                              –
                              average percent of decrease in aggregate inventories (i.e. inventories of items+final products) (DAI%),

average percent of decrease in shortages of final products (DPS%),

average decrease in delays of delivery of final products in days (DPD) (note that a planning period is assumed equivalent to 26 working days),

average percent of decrease in total number of setups over planning periods (DNS%), and

average percent of decrease in total costs (DTC%).

Clearly, one can conclude the followings from Table 35:
                           
                              –
                              all performance indexes of the model show meaningful improvement over the solutions obtained by traditional methods used in the studied shop,

approximately all performance indexes get better and better by increase in problem size. This means that the gap between the optimal solution obtained by our model and a heuristic solution grows larger by increase in problem size,

the average of an index for small size category is less than to those of medium and large sizes,

percent of improvement in either of indexes DAI, DPS, DNS and DTC is almost a value between 10% and 80%.

This paper formulated a problem with working conditions close to some real world settings. For example, it is common dealing with flexible machines that a production manager can decide about their optimal working speed. Then, a number of valid inequalities were developed, based on problem structures. Subsequently, theoretical and experimental analyses of the proposed cuts were given. It was proved that some cuts exactly pass through feasible integral solutions in certain conditions. Next, a number of performance indices were introduced to measure the quality of each cut. Afterward, the cuts were ranked by TOPSIS method. This ranking helps future users to know about the priority of the cuts to be used. Also, a number of performance indexes were measured to analyze what the model achieves in comparison to using heuristics similar to the one presented in introduction. The results indicated that the model and the solution method together provide good results for use by a production manager. However, new working conditions as well as new managerial policies can be involved in the formulation according to newly-encountered cases such as dealing with multi-purpose machines, or other managerial policies in dealing with work-in-processes, etc. Furthermore, potential routings of items through machines might change in many real world cases depending upon the circumstances in the operations such as queuing, non-availability of items, tools, etc.

Similar to us, it seems that one can find the global optimum solution of other real size instances by developing such special purpose cuts. In this way, a manager can find what should be done in the shop floor in a short time instead of using inaccurate rules of thump or heuristics. However, there is a long way till reaching to such a destination. The ideal point of the current research may be developing a well-structured model that can be solved by simple linear programming techniques (such as simplex) to true global integral solution. In other words, it is a good future research to find a tight formulation corresponding to the convex hull of the feasible integral solutions of the problem as possible. In other words, it is worth finding facet defining cuts that exactly pass through two feasible integral points. This research can be extended in many other dimensions. For example, one can develop other solution approaches such as decomposition, Lagrangean relaxation, and so forth.

@&#REFERENCES@&#

