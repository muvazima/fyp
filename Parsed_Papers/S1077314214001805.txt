@&#MAIN-TITLE@&#Online action recognition using covariance of shape and motion

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A descriptor for describing action in terms of shape and motion is proposed.


                        
                        
                           
                           The descriptor is employed in the online action recognition scenario.


                        
                        
                           
                           Two runtime optimizations are introduced to enable applicability in real time.


                        
                        
                           
                           The method is simple, fast and accurate enough to be of practical value.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Online action recognition

Gesture recognition

Covariance descriptor

Incremental covariance computation

@&#ABSTRACT@&#


               
               
                  We propose a novel approach for online action recognition. The action is represented in a low dimensional (15D) space using a covariance descriptor of shape and motion features – spatio-temporal coordinates and optical flow of pixels belonging to extracted silhouettes. We analyze the applicability of the descriptor for online scenarios where action classification is performed based on incomplete spatio-temporal volumes. In order to enable our online action classification algorithm to be applied in real time, we introduce two modifications, namely the incremental covariance update and the on demand nearest neighbor classification. In our experiments we use quality measures, such as latency, especially designed for the online scenario to report the algorithm’s performance. We evaluate the performance of our descriptor on standard, publicly available datasets for gesture recognition, namely the Cambridge-Gestures dataset and the ChaLearn One-Shot-Learning dataset and show that its performance is comparable to the state-of-the-art despite its relative simplicity. The evaluation on the UCF-101 action recognition dataset demonstrates that the descriptor is applicable in challenging unconstrained environments.
               
            

@&#INTRODUCTION@&#

Automatic recognition of actions performed by humans is a challenging task with applicability to video surveillance, video summarization, natural user interface and gaming. Typically, a distinction is made between “action” and “activity” [1]. Action is an atomic and self contained motion performed by a single subject, e.g., jumping, hand waving, whereas an activity is a series of actions bearing a more complex meaning typically involving more than one subject, e.g., a team scoring a goal in a soccer game. In this work we consider the problem of action recognition. Even more specifically, we are interested in interactive applications such as natural user interface (NUI) and gaming, where actions are to be detected and classified on the fly and the system response time is of great importance.

Action recognition has been extensively studied during the past two decades [1]. In the early works on action recognition the body or the hand appearance were learned and later recognized in video sequences. The action’s temporal aspect was handled by training a parametric model such as the Hidden Markov Models (HMM) [2,3]. Later on the community switched its attention to nonparametric approaches describing actions in terms of shape and motion patterns. Bobick and Davis [4] represent actions using Motion History Image (MHI) temporal templates, a weighted sum of binary silhouette masks, describing the action as a shape evolution in time. This representation was found to be discriminative enough for several simple action classes such as aerobics exercises. Blank et al. [5] use silhouette masks to represent an action as a space–time volume and extract features using the Poisson equation to compare these volumes. The major drawback of using shape is the assumption of availability of the silhouette masks, commonly extracted using background subtraction. To overcome this issue, Efros et al. [6] suggest motion descriptors based on optical flow computed over the entire bounding box in low resolution video sequences. Ali and Shah [7] derive kinematic features from optical flow and use them to represent spatio-temporal volumes in low dimensional space. Zelnik-Manor and Irani [8] use a nonparametric descriptor, based on normalized spatio-temporal gradient histograms extracted in different temporal scales and successfully apply it for action detection and clustering.

Following their success in still images, several extensions of local descriptors [9] to the spatio-temporal case were employed for action recognition. Laptev and Lindeberg [10] use an extension of Harris interest points to represent and recognize actions. Dollar et al. [11] learn a dictionary of spatio-temporal interest points and represent the action as a bag-of-words over the learned dictionary. Niebles et al. [12] use a similar approach, combining the bag-of-words approach with probabilistic graphical models.

Several recent works use tensors to represent space–time volumes. Kim and Cipolla [13] extend the Canonical Correlation Analysis (CCA) to tensors and use it to measure the similarity between two video volumes avoiding an explicit motion estimation. Lui et al. [14] represent the video volume tensor as a point on a product manifold and classify actions using the nearest neighbor in this space. In a follow up work [15] the authors employ least squares regression achieving impressive results in application to gesture recognition including the challenging problem of one-shot-learning [16], where the action class has to be recognized based on a single action instance.

The covariance descriptor [17,18], originally designed for object detection, was recently successfully employed for action recognition [19–21]. Guo et al. [19] use the covariance descriptor in kinematic feature space [7] to represent spatio-temporal volume. In their work on pedestrian detection, Tuzel et al. [18] show that covariance descriptors lie in a nonlinear Riemannian space. Harandi et al. [20] use a Riemannian Locality Preserving Projection (RLPP) technique to map the covariance descriptors into the euclidean space and to apply standard classification methods. In a follow up work by Sanin et al. [21] the RLPP was used with AdaBoost to learn a set of covariance descriptors giving impressive results in classification of a specific set of actions. A significant drawback of this approach is its learning phase making it inapplicable to the one-shot-learning scenario.

While classical action recognition is typically concerned with classifying actions using a full video volume, the goal of online action recognition is to classify actions on the fly. Albanese et al. [22] propose a system for online complex activity recognition using a specially designed logical language to describe the activity. In [23] the authors present a method for low latency online action recognition based on detecting distinctive canonical poses in the 3D motion of the subject’s skeleton.

In this work we present an efficient descriptor for action recognition and propose an algorithm for online action detection and recognition applicable in natural user interface and gaming scenarios. Motivated by the prior art [4–7], we use the silhouette shape and motion properties to derive our action descriptor. Fig. 1
                        (a–c) show a frame from a video capturing an action, a corresponding silhouette and the computed optical flow vector field. The optical flow [24] is computed between the current and the consecutive frames assuming translation only. Fig. 1(d and e) depict heat maps representing the optical flow’s horizontal and vertical components. The hotter (more red) the pixel is, the more dynamic it is in terms of its horizontal or vertical velocity. Our action descriptor is based on the heat maps’ evolution over time. We represent each pixel belonging to the silhouettes’ series as a vector of its spatio-temporal coordinates and velocity. The action is represented as an empirical covariance matrix of such vectors [17]. Although the resulting descriptor is of low dimensionality (15 unique values only), we show experimentally that its discriminating capabilities are comparable and sometimes favorable to much more complex descriptors used by the state-of-the-art algorithms.

Our approach differs from previous works in several important aspects:
                           
                              1.
                              We use an extension of the covariance descriptor to the temporal domain to represent a spatio-temporal volume in an exceptionaly low dimensional (15D) space. We analyze the applicability of the descriptor to the online scenario where action classification is performed based on incomplete spatio-temporal volumes.

We demonstrate that rough statistics of shape and motion (spatio-temporal coordinates and optical flow), computed on pixels belonging to regions of interest, provide a sufficiently rich representation for human body action and hand gesture classification. This is in contrast with [13] which uses a much richer method of Canonical Correlation Analysis (CCA), to represent the statistics of the volume and [7,19] who use more complex kinematic features based on optical flow.

Unlike [14,13] we do not assume a fixed number of frames in the spatio-temporal volume. Also, our approach does not rely on extensive learning procedures applied, for example, in [21,20,13]. Thanks to this our approach may be applied in the challenging one-shot-learning scenario [16].

Our online action recognition algorithm uses an incremental covariance descriptor computation and on demand nearest neighbor classification, which significantly improve its performance and make it suitable for real time applications. Finally, the algorithm is relatively simple, easy to implement and computationally efficient.

Additional contributions of this work are the experimental validation of our approach on two standard, publicly available datasets for gesture recognition, on one publicly available dataset for action recognition and on our own private dataset for online action recognition. We propose several quality measures for action recognition in the online scenario, which differ from those usually used in the classical action categorization, and use them for the evaluation of our algorithm. We will make both our dataset and the code available for public use.

We will now define the CovAct, the covariance descriptor for action recognition, and show its applicability for online action recognition. Let 
                        
                           V
                           =
                           
                              
                                 {
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 M
                              
                           
                        
                      denote a sequence of M video frames constituting an action and let 
                        
                           S
                           =
                           
                              
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 M
                              
                           
                        
                      denote a corresponding sequence of M binary silhouette masks of the figure performing the action, e.g., Fig. 1(b). Let 
                        
                           (
                           
                              
                                 L
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 W
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                           )
                        
                      denote the 
                        
                           
                              
                                 s
                              
                              
                                 t
                              
                           
                        
                     ’s bounding box, where 
                        
                           (
                           
                              
                                 L
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 t
                              
                           
                           )
                        
                      are its top left corner coordinates and 
                        
                           (
                           
                              
                                 W
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                           )
                        
                      are its width and height. We normalize the spatio-temporal coordinates 
                        
                           (
                           x
                           ,
                           y
                           ,
                           t
                           )
                        
                      of each point inside 
                        
                           
                              
                                 s
                              
                              
                                 t
                              
                           
                        
                      relative to the bounding box size and the action’s duration 
                        
                           (
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          x
                                          -
                                          
                                             
                                                L
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                W
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          M
                                       
                                    
                                 
                              
                           
                        
                     . This normalization step provides partial invariance to object-camera distance and action duration. Besides the normalized spatio-temporal coordinates, for each point 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      belonging to 
                        
                           
                              
                                 s
                              
                              
                                 t
                              
                           
                        
                     , we compute its Lucas-Kanade [24] optical flow 
                        
                           (
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           ,
                           
                              
                                 v
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           )
                        
                      using 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 I
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        
                     , assuming translation only. Fig. 2
                     (a and b) show an example of normalized horizontal and vertical optical flow heat maps corresponding to the frame in Fig. 1. Thus, each pixel 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                        
                      belonging to the silhouette sequence S of the spatio-temporal volume V is represented as a 5-dimensional vector:
                        
                           (1)
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                      are the normalized spatio-temporal coordinates and 
                        
                           (
                           
                              
                                 u
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                           )
                        
                      are the horizontal and vertical optical flow components. Only pixels belonging to the silhouettes and having optical flow greater than zero are represented:
                        
                           (2)
                           
                              Z
                              =
                              {
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              |
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                              ∈
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                              }
                              .
                           
                        
                     We label the observations in Z according to their normalized spatial origin – each observation 
                        
                           
                              
                                 z
                              
                              
                                 i
                              
                           
                        
                      is labeled with
                        
                           (3)
                           
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                2
                                                ,
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                >
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                3
                                                ,
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                >
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                4
                                                ,
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                >
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                >
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     differentiating between observations generated by the four parts of the silhouette (see Fig. 2(d)).

The purpose of region covariance descriptor, first introduced in [17], was for object recognition in still images. Since then, the covariance descriptor has proved useful also for representing spatio-temporal volumes [19,21]. We employ the covariance descriptor for representing shape and motion statistics of a spatio-temporal buffer of video frames.

In the case of a still image, each pixel is represented by a point in feature space. Possible features are the spatial coordinates of the pixel, its color and gradients, just to name a few. An image region consisting of m pixels is described using the covariance matrix of their feature representations 
                           
                              Z
                              =
                              
                                 
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                 
                              
                           
                        :
                           
                              (4)
                              
                                 
                                    
                                       C
                                    
                                    
                                       Z
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 μ
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       μ
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              μ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is the mean value of 
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              s
                           
                         and n is the number of features. An image is described by a set of covariance matrices, of size 
                           
                              n
                              ×
                              n
                           
                        , each corresponding to an image region. Covariance matrices are compared using a metric for covariance matrices [25]:
                           
                              (5)
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ln
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         are the generalized eigenvalues of 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        , both of size 
                           
                              n
                              ×
                              n
                           
                        , computed from 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              
                              ≠
                              
                              0
                           
                         are the generalized eigenvectors. Intuitively, the metric for covariance matrices measures the extent to which the matrix 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                         deviates from the identity. For a pair of equal matrices 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              d
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              0
                           
                         since the logarithms of all eigenvalues of I are zero.

Our action descriptor is based on the region covariance descriptor extended to the spatio-temporal domain. Let 
                           
                              
                                 
                                    Z
                                 
                                 
                                    k
                                 
                              
                           
                         denote a set of observations in Z generated by part k, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              ∈
                              Z
                              ,
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              k
                              }
                           
                        . Similarly to [17] we represent the action with covariance matrices computed on observations generated by five overlapping regions:
                           
                              (6)
                              
                                 A
                                 (
                                 Z
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                Z
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ∪
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ∪
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ∪
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ∪
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The proposed representation encodes the correlation of measurements extracted from different regions.

The group of covariance (symmetric positive definite) matrices may be represented as a connected Riemannian manifold 
                           
                              M
                           
                        . In this case, the distances between a pair of points 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                         on the manifold is defined as the geodesic distance between these points, and is computed using the Affine-Invariant distance metric [26]:
                           
                              (7)
                              
                                 
                                    
                                       d
                                    
                                    
                                       AI
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       trace
                                       
                                          
                                             
                                                
                                                   
                                                      log
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               -
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               -
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              ‖
                              ·
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                              
                           
                         is the matrix Frobenius norm and 
                           
                              log
                              (
                              ·
                              )
                           
                         is the matrix logarithm operator. Let 
                           
                              C
                              =
                              U
                              Λ
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                           
                         denote the eigenvalue decomposition of 
                           
                              C
                              ∈
                              M
                           
                        , then the matrix logarithm operator maps C to a point on a tangent (Euclidean) space, and is defined as:
                           
                              (8)
                              
                                 log
                                 (
                                 C
                                 )
                                 =
                                 U
                                 log
                                 (
                                 Λ
                                 )
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              log
                              (
                              Λ
                              )
                           
                         is a diagonal matrix with the logarithms of the eigenvalues of C. It turns out that the metric in Eq. (5), proposed by [25], is actually equivalent to the one from Eq. (7), proposed by [26].

One of the drawbacks of 
                           
                              
                                 
                                    d
                                 
                                 
                                    AI
                                 
                              
                           
                         is its relatively high computational burden, especially for high dimensional feature spaces. To overcome this issue, the Log-Euclidean metric was proposed in [27]:
                           
                              (9)
                              
                                 
                                    
                                       d
                                    
                                    
                                       LE
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             log
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             -
                                             log
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       F
                                    
                                 
                                 .
                              
                           
                        This metric maps both covariance matrices from the Riemannian manifold 
                           
                              M
                           
                         to the tangent Euclidean space 
                           
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           
                         at point I on the manifold using the logarithm operator. Besides the difference in several theoretical aspects (see [26,27] for details), the 
                           
                              
                                 
                                    d
                                 
                                 
                                    LE
                                 
                              
                           
                         and the 
                           
                              
                                 
                                    d
                                 
                                 
                                    AI
                                 
                              
                           
                         metrics differ in some practical aspects as well. First, 
                           
                              
                                 
                                    d
                                 
                                 
                                    LE
                                 
                              
                           
                         is typically faster since it does not compute generalized eigenvalues as 
                           
                              
                                 
                                    d
                                 
                                 
                                    AI
                                 
                              
                           
                         does. Second, mapping the covariance descriptors to the Euclidean space opens possibilities to employ various general machine learning techniques, e.g., [28,29]. We have evaluated both metrics in terms of computational efficiency and recognition accuracy while comparing the proposed descriptors. Our experiments showed that 
                           
                              
                                 
                                    d
                                 
                                 
                                    LE
                                 
                              
                           
                         is roughly two times faster compared to 
                           
                              
                                 
                                    d
                                 
                                 
                                    AI
                                 
                              
                           
                        , but the speedup comes at the expense of a slight degradation in the recognition accuracy. Therefore, despite the advantages and considering the low dimensionality of our descriptor, we decided that the modest gain in the computational efficiency does not justify the preference of 
                           
                              
                                 
                                    d
                                 
                                 
                                    LE
                                 
                              
                           
                         over 
                           
                              
                                 
                                    d
                                 
                                 
                                    AI
                                 
                              
                           
                        . We note that similar results were reported in [29] regarding the speed versus accuracy for these two metrics.

We suggest three possible distance measures for the comparison between action descriptors. The first measure compares only the 
                           
                              
                                 
                                    C
                                 
                                 
                                    Z
                                 
                              
                           
                         of both actions, thus disregarding the observations’ spatial origin while the second measure compares pairs of covariance matrices generated using observations of similar spatial origin. Let 
                           
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    5
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    5
                                 
                              
                           
                         denote two action descriptors as defined in Eq. (6). The two measures are defined as:
                           
                              (10)
                              
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 d
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and:
                           
                              (11)
                              
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          2
                                       
                                       
                                          5
                                       
                                    
                                 
                                 d
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              d
                              (
                              ·
                              ,
                              ·
                              )
                           
                         is the metric for covariance matrices (Eq. (5)). The sum in Eq. (11) starts with 
                           
                              i
                              =
                              2
                           
                         because 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         corresponds to the covariance descriptor of the entire region. The third distance measure uses the whole set of covariance matrices of A. It combines 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                           
                         in a way which gives more robustness to partial occlusions and to silhouette imperfections. Similarly to [17], we define the third measure as:
                           
                              (12)
                              
                                 D
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       
                                          max
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                 d
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The purpose of the subtracted element is to compensate for an accidentally large distance computed between a certain pair of covariance descriptors of 
                           
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                           
                         which may be due to partial occlusion or a missing silhouette part in one of the descriptors. In our experiments we have found that the distance measure defined in Eq. (12) gives the best performance in action categorization tasks. However, for online action recognition task, 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                           
                         is preferable because of its lower computational cost.

An important property of our approach is its extendability to the online scenario of action recognition. In addition to its computational efficiency this fact enables it to be successfully applied in real time interactive applications such as gaming and natural user interface. The challenge in the online action recognition scenario is that the decision regarding whether a specific action is taking place at the moment has to be made based on an incomplete information available up until that moment. Making the decision as soon as possible is crucial because it immediately affects the system’s behavior.

A useful property of the CovAct descriptor is that its dimension does not depend on the dimensions of the underlying spatio-temporal volume. That is to say, two descriptors, one extracted from a complete spatio-temporal volume describing an action and the second one extracted from only the first temporal half of this volume may be naturally compared. This is in contrast with methods reported in [13,14] where the volumes have to be normalized to a fixed temporal size. This observation allows us to apply the nearest neighbor classifier on descriptors extracted from different spatio-temporal volumes. To see the covariance descriptors’ behavior, we have used spatio-temporal volumes of gradually increasing temporal length (incremented one frame at a time), to extract a set of covariance matrices belonging to five different action types. The actions we used were punch, kick, bend forward, bend left and bend right and were performed by a single actor while playing an interactive video game. All covariance matrices in the set have 
                           
                              5
                              +
                              (
                              5
                              ×
                              4
                              )
                              /
                              2
                              =
                              15
                           
                         unique values due to symmetry. We have applied principal component analysis (PCA) on these 15D vectors. Fig. 3
                         depicts the cumulative energy as a function of the number of principal components. It can be seen from the graph that two major principal components contain around 80% of the overall energy. Fig. 4
                         shows clusters of trajectories for each one of the five actions plotted in 2D using the two major principal components. Each trajectory represents the descriptor’s transformation with the accumulation of frames in the underlying spatio-temporal volume. Each trajectory begins with “
                           
                              ∘
                           
                        ” and ends with “
                           
                              □
                           
                        ” corresponding to action’s complete covariance descriptor 
                           
                              
                                 
                                    C
                                 
                                 
                                    Z
                                 
                              
                           
                        . It can be noticed from the 2D illustration that the trajectories belonging to each action class tend to cluster together, and diverge in different directions as more frames are used. Since adding more principle components will intensify this divergence we conclude that in the original 15D space the trajectories are clustered as well.

Another interesting observations is that the trajectories’ intermediate points corresponding to descriptors extracted from incomplete information, at some point in time, tend to be closer to the trajectories’ end points belonging to the same class than to those belonging to different classes. To support this intuition, we used Eq. (10) to compute the distances between covariance descriptors extracted from complete and incomplete spatio-temporal volumes. Let 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    X
                                    %
                                 
                              
                           
                         denote a covariance descriptor computed using the 
                           
                              X
                              %
                           
                         of the ith spatio-temporal volume, and let 
                           
                              a
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         denote its corresponding action class. We define the distribution of distances between descriptors belonging to the same class, extracted from volumes of X’s degree of completeness and those extracted from the entire volumes (100%-complete), as 
                           
                              
                                 
                                    p
                                 
                                 
                                    same
                                 
                                 
                                    X
                                    %
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      X
                                                      %
                                                   
                                                
                                                ,
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      100
                                                      %
                                                   
                                                
                                             
                                          
                                       
                                       |
                                       i
                                       
                                       ≠
                                       
                                       j
                                       ,
                                       a
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       a
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        . Similarly, we define the distribution of distances between descriptors belonging to different classes as 
                           
                              
                                 
                                    p
                                 
                                 
                                    diff
                                 
                                 
                                    X
                                    %
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      X
                                                      %
                                                   
                                                
                                                ,
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      100
                                                      %
                                                   
                                                
                                             
                                          
                                       
                                       |
                                       a
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                       ≠
                                       
                                       a
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        . Fig. 5
                         shows the distributions 
                           
                              
                                 
                                    p
                                 
                                 
                                    same
                                 
                                 
                                    X
                                    %
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    diff
                                 
                                 
                                    X
                                    %
                                 
                              
                           
                         in green and red respectively, for 
                           
                              X
                              =
                              25
                              ,
                              50
                              ,
                              75
                              ,
                              100
                           
                        . As expected the modes separation increases with the increased information completeness. Note that while it may be difficult to correctly predict the action based on 25% of the information, it is much easier based on 50%. Thus, the distance between a descriptor extracted online, based on an incomplete spatio-temporal volume, to those extracted during the training phase, based on complete volumes, may serve as a predictor on what action is currently being performed. Thanks to this, we avoid the explicit modeling of actions’ fragments, significantly reducing the number of exemplar descriptors required for the nearest neighbor classifier. On the other hand, if necessary, we may seamlessly augment the exemplars set with descriptors extracted from incomplete spatio-temporal volumes, at the price of runtime performance.

Based on the above derivations we propose an algorithm (summarized in Algorithm 1) for online action recognition. The algorithm uses a temporal sliding window of 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                              
                            frames to buffer measurements for covariance descriptor computation. For each new frame the data buffer is updated, a new covariance matrix 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            is calculated and compared with exemplar matrices collected during training. The distance to the nearest neighbor is used to detect whether or not the action of the nearest neighbor’s class took place. Rather than applying a threshold on the absolute distance to the nearest neighbor we have found it useful to apply it on the ratio between the nearest and the farthest neighbor. Let 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                            denote the descriptors stored in the database together with their class labels taking values from 
                              
                                 A
                                 =
                                 {
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 }
                              
                           . Let 
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       max
                                    
                                 
                              
                            denote the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                           ’s distance to the farthest neighbor – 
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       =
                                       1
                                       …
                                       N
                                    
                                 
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           . Let 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       a
                                    
                                 
                              
                            denote the threshold on the nearest-to-farthest distance ratio for each class 
                              
                                 a
                                 ∈
                                 A
                              
                           . Thus, a covariance descriptor 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            is classified as belonging to class a if 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       i
                                       =
                                       1
                                       …
                                       N
                                    
                                 
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            belongs to class a and:
                              
                                 (13)
                                 
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          th
                                       
                                       
                                          t
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 d
                                 (
                                 ·
                                 ,
                                 ·
                                 )
                              
                            is the covariance distance defined in Eq. (5).
                              Algorithm 1
                              Online action recognition (CovActOL) 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Input: Video frames 
                                                      
                                                         V
                                                         =
                                                         
                                                            
                                                               {
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               }
                                                            
                                                            
                                                               t
                                                               =
                                                               0
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                   , maximum buffer size 
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               w
                                                            
                                                         
                                                      
                                                   ,
                                             
                                             
                                                action descriptors database 
                                                      
                                                         DB
                                                         =
                                                         
                                                            
                                                               {
                                                               (
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                               }
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                    (
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         A
                                                      
                                                   ),
                                             
                                             
                                                nearest-to-farthest distance ratio threshold for each action class 
                                                      
                                                         {
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               a
                                                            
                                                         
                                                         |
                                                         a
                                                         ∈
                                                         A
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                1. Initialize 
                                                      
                                                         Z
                                                         =
                                                         ∅
                                                      
                                                   .
                                             
                                             
                                                2. For t
                                                   =1:M
                                                
                                             
                                             
                                                2.1. Extract silhouette mask 
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   .
                                             
                                             
                                                2.2. Compute LK optical flow 
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                    using frames 
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   .
                                             
                                             
                                                2.3. Build 
                                                      
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                    as described in Eq. (2).
                                             
                                             
                                                2.4. 
                                                      
                                                         Z
                                                         =
                                                         Z
                                                         ∪
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   .
                                             
                                             
                                                2.5. If 
                                                      
                                                         t
                                                         ⩾
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               w
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2.5.1. 
                                                      
                                                         Z
                                                         =
                                                         Z
                                                         ⧹
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               t
                                                               -
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     w
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .
                                             
                                             
                                                2.5. Compute covariance matrix 
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                    of 
                                                      
                                                         Z
                                                      
                                                   .
                                             
                                             
                                                2.6. For i
                                                   =1:N
                                                
                                             
                                             
                                                2.6.1. Compute 
                                                      
                                                         d
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                    using Eq. (5).
                                             
                                             
                                                2.7. 
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         =
                                                         arg
                                                         
                                                            
                                                               min
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         d
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   .
                                             
                                             
                                                2.8. If 
                                                      
                                                         d
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                         <
                                                         
                                                            
                                                               th
                                                            
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           ∗
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   , Output “Action 
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   ”.
                                             
                                             
                                                2.9. Else, Output “No Action”.
                                             
                                          
                                       
                                    
                                 
                              

One of the deficiencies of the CovActOL algorithm as described in Algorithm 1, is that its runtime depends on the buffer size 
                           
                              
                                 
                                    L
                                 
                                 
                                    w
                                 
                              
                           
                         and on the database size N. This dependency is because for each frame we need to recompute the covariance descriptor and to compute its distance to each one of the descriptors in the database. In this section we outline two modifications to the CovActOL algorithm dealing with each one of these deficiencies independently, with no impact on the algorithm’s correctness. In the first modification we show that rather than recomputing the descriptor for each frame we can use a simple and efficient update rule. In the second modification we use the fact that the descriptors computed in the consecutive frames are not likely to be very different one from each other, and thus the distances between them and the descriptors in the database are not likely to change much as well. Using this observation and the properties of the metric for covariance matrices, Eq. (5), we derive a criterion which allows us to skip over the distance computations which are certainly not going to affect the classifier’s final decision.

In the online scenario the temporal sliding window is of a fixed size, and so for each new frame the data buffer has to be updated, namely observations extracted from the new frame should be appended while observations of the oldest frame should be dropped. However, the requirement of recomputing the covariance matrix at each iteration induces a significant computational burden, especially if a large number of pixels are extracted from each frame. To overcome this issue we propose a simple and efficient update rule for incrementally computing the covariance descriptor instead of recomputing it entirely after each frame.

Let 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∪
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                            denote a set of observations, currently in the buffer, extracted from the 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                              
                            frames preceding frame 
                              
                                 t
                                 -
                                 1
                              
                           , where 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                              
                            is the buffer size and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                            denotes a set of observations extracted from frame 
                              
                                 t
                                 -
                                 1
                                 -
                                 i
                              
                           . Let 
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                            denote the number of samples in 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                            respectively. Let 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                              
                            denote the mean and the covariance of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                            denote the mean and the covariance of 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                           . As a new frame, t, arrives, its observations are appended to the buffer: 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ∪
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                    
                                 
                              
                           . If the buffer is full,
                              1
                              By full buffer we mean that it contains observations extracted from 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             w
                                          
                                       
                                    
                                  last frames.
                           
                           
                              1
                            the least recent frame’s observations are dropped: 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 ⧹
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                    
                                 
                              
                           . Thus, the number of observations in 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              
                            when the buffer is not full. Our goal, therefore, is to efficiently compute the new mean 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                    
                                 
                              
                            and the covariance 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            of samples in 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                              
                            using 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                           , without explicitly recomputing them from the data 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                              
                           . In Sections A and B we derive these efficient update rules for 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                           , which are:
                              
                                 (14)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           and
                              
                                 (15)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             +
                                             Δ
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (16)
                                 
                                    Δ
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    -
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    1
                                    )
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                    )
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    -
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                       
                                          T
                                       
                                    
                                    -
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                       
                                          T
                                       
                                    
                                    .
                                 
                              
                           Thus the update takes 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            operations instead of the 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            operations, which would be the case had we explicitly recomputed the covariance from the data for each frame. For example, if 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                                 =
                                 30
                              
                           , then we improve the descriptor computation speed by a factor of 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 900
                              
                           . We note that a similar approach was used in [30] to improve the performance of real time tracking using the covariance descriptor. The authors used an efficient update rule to build an adaptive appearance model of the tracked target.

Using m recursive expansions of expression Eq. (15), we get 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            as a function of 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       i
                                    
                                 
                              
                            computed from 
                              
                                 
                                    
                                       {
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                             -
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                              
                           . (see Section B for details):
                              
                                 (17)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                            -
                                                            m
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                   -
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                             Δ
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                   -
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Let 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            denote the distance between the covariance descriptor 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                              
                           , computed in the 
                              
                                 (
                                 t
                                 -
                                 m
                                 )
                              
                           ’th iteration of the CovActOL algorithm 
                              
                                 (
                                 m
                                 <
                                 t
                                 )
                              
                           , and some covariance descriptor in the database, C′. Let us also assume that C′ belongs to class a and 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       th
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                    
                                       a
                                    
                                 
                                 ⩾
                                 0
                              
                           , where 
                              
                                 
                                    
                                       th
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                    
                                       a
                                    
                                 
                              
                            is as defined in Section 2.4.1. Thus, action a was certainly not detected based on the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                              
                           ’s proximity to C′ in iteration 
                              
                                 t
                                 -
                                 m
                              
                           . We would like to define a condition which, when held, guarantees that 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       th
                                    
                                    
                                       t
                                    
                                    
                                       a
                                    
                                 
                                 ⩾
                                 0
                              
                           , meaning that action a is not detected based on the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                           ’s proximity to C′ in iteration t, without explicitly computing the distance. Note that the thresholds 
                              
                                 
                                    
                                       th
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                    
                                       a
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       th
                                    
                                    
                                       t
                                    
                                    
                                       a
                                    
                                 
                              
                            depend on the distances to the farthest neighbor in iterations 
                              
                                 t
                                 -
                                 m
                              
                            and t respectively. However, since the farthest neighbor’s distance in iteration t could not shrink by more than 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                                 )
                              
                            relative to the farthest neighbor’s distance in iteration 
                              
                                 t
                                 -
                                 m
                              
                           , we can say that 
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       max
                                    
                                 
                                 ⩾
                                 
                                    
                                       d
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                                 )
                              
                           , and thus:
                              
                                 (18)
                                 
                                    
                                       
                                          th
                                       
                                       
                                          t
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    ⩾
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                   -
                                                   m
                                                
                                                
                                                   max
                                                
                                             
                                             -
                                             d
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                   -
                                                   m
                                                
                                             
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          th
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    -
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    .
                                 
                              
                           The triangle inequality holds for the covariance distance and therefore:
                              
                                 (19)
                                 
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ⩾
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    .
                                 
                              
                           Using the inequalities (18) and (19), we obtain the following inequality:
                              
                                 (20)
                                 
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          th
                                       
                                       
                                          t
                                       
                                       
                                          a
                                       
                                    
                                    ⩾
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          th
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    ⩾
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          th
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    ⩾
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          th
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    -
                                    (
                                    1
                                    -
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    .
                                 
                              
                           This lower bound allows us to derive a criterion to whether or not we should recompute the distance 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            in iteration t for some C′ in the database, or we can say for sure that it is above the threshold. Also, we define 
                              
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                              
                            indicating the maximum number of frames allowed to skip the distance computation. Thus, in iteration t we require a computations of 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            only if
                              
                                 (21)
                                 
                                    m
                                    >
                                    
                                       
                                          m
                                       
                                       
                                          max
                                       
                                    
                                    
                                    Or
                                    
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          th
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    -
                                    (
                                    1
                                    -
                                    
                                       
                                          γ
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    d
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          m
                                       
                                    
                                    )
                                    <
                                    0
                                    ,
                                 
                              
                           otherwise we conclude that 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 >
                                 
                                    
                                       th
                                    
                                    
                                       t
                                    
                                    
                                       a
                                    
                                 
                              
                            without the actual computation of 
                              
                                 d
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           . In our experiments we have found that 
                              
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                                 /
                                 2
                              
                           , where 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                              
                            is the sliding window length, provides a good choice in terms of performance.

In iteration t we evaluate the criterion from Eq. (21) for each one of the N descriptors in the database. The criterion computation involves at most 
                              
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                              
                            covariance distance computations to compare 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            with each one of the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       m
                                    
                                 
                                 ,
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                              
                           . Also once in a while, when the criterion does not hold, the distance computation comparing 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                              
                            with 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                              
                            is performed. Thus, the overall number of covariance distance computations per frame is reduced from N, as in the CovActOL algorithm, to 
                              
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                                 +
                                 pN
                              
                           , where p is the probability that the condition in Eq. (21) does not hold. According to our experiments, 
                              
                                 p
                                 ≈
                                 0.1
                              
                            when 
                              
                                 
                                    
                                       L
                                    
                                    
                                       w
                                    
                                 
                                 =
                                 30
                              
                            is used. This is much better considering that typically 
                              
                                 N
                                 ≫
                                 
                                    
                                       m
                                    
                                    
                                       max
                                    
                                 
                              
                           . Experimental validation showed that about 70–90% of the covariance distance computations are saved when using the criterion.

We have modified the CovActOL algorithm based on the improvements described in Sections 2.5.1 and 2.5.2. The resulting algorithm, Fast-CovActOL, is summarized in Algorithm 2. The algorithm uses a temporal sliding window of 
                           
                              
                                 
                                    L
                                 
                                 
                                    w
                                 
                              
                           
                         frames to extract the CovAct descriptor. For each new frame t the CovAct descriptor 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                         is computed using the updated rule in Eq. (15), and is compared with the exemplar descriptors meeting the criterion (inequality (21)), using the covariance distance Eq. (5). Action a is detected if 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                        ’s nearest neighbor is of class a, and its distance is smaller than the threshold, 
                           
                              
                                 
                                    th
                                 
                                 
                                    t
                                 
                                 
                                    a
                                 
                              
                           
                        . We present an experimental validation of the algorithm in Section 3.1.
                           Algorithm 2
                           Fast online action recognition (Fast-CovActOL) 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: Video frames 
                                                   
                                                      V
                                                      =
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            t
                                                            =
                                                            0
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                , maximum buffer size 
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             action descriptors database 
                                                   
                                                      DB
                                                      =
                                                      
                                                         
                                                            {
                                                            (
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                 (
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      A
                                                   
                                                ),
                                          
                                          
                                             nearest-to-farthest distance ratio threshold for each action class 
                                                   
                                                      {
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      |
                                                      a
                                                      ∈
                                                      A
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             1. Initialize 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                      ∀
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             2. For t
                                                =1:M
                                             
                                          
                                          
                                             2.1. Extract silhouette mask 
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             2.2. Compute LK optical flow 
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                 using frames 
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             2.3. Build Z as described in Eq. (2) with 
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      t
                                                   
                                                .
                                          
                                          
                                             2.4. Compute the mean 
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                 and the covariance matrix 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                 of Z (
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      |
                                                      Z
                                                      |
                                                   
                                                ).
                                          
                                          
                                             2.5. Update 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                 using Eq. (15).
                                          
                                          
                                             2.6. For i
                                                =1:N
                                             
                                          
                                          
                                             2.6.1. If 
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                 Or 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                 Or 
                                                   
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      -
                                                      
                                                         
                                                            th
                                                         
                                                         
                                                            t
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      -
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      <
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             2.6.1.1. Compute 
                                                   
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                 using Eq. (5).
                                          
                                          
                                             2.6.1.2. 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             2.6.2. Else
                                          
                                          
                                             2.6.2.1. 
                                                   
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      =
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             2.6.2.2. 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             2.7. 
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            argmin
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                .
                                          
                                          
                                             2.8. If 
                                                   
                                                      d
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            th
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        ∗
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                , Output “Action 
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ”.
                                          
                                          
                                             2.9. Else, Output “No Action”.
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTAL RESULTS@&#

Our experimental validation includes three parts. In the first part we validate our online action recognition approach on privately collected video sequences. In the second part we present experimental validation of our CovAct descriptor in gesture recognition on two publicly available datasets – the Cambridge-Gesture [13] and ChaLearn [16] datasets. In the third part we evaluate the CovAct descriptor in the action recognition scenario on a subset of the challenging UTF-101 [31] dataset.

We have evaluated our online action recognition approach described in Section 2.4 on a privately collected dataset of a player performing five game actions – “Punch”, “Kick”, “Bend Forward”, “Bend left” and “Bend right” – while playing an interactive video game. We used background subtraction to extract the player’s silhouette in each frame. In the training phase we built the action descriptors database, 
                           
                              DB
                              =
                              
                                 
                                    {
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                           
                        , and the set of thresholds on the nearest-to-farthest distance ratio for each action, 
                           
                              {
                              
                                 
                                    γ
                                 
                                 
                                    a
                                 
                              
                              |
                              a
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              5
                              }
                              }
                           
                        . The database of 
                           
                              N
                              =
                              88
                           
                         descriptors was extracted from a manually labeled video sequence of the player performing the actions. The set of thresholds was obtained using a validation video sequence with 10 action instances (two for each action class). In the test phase we have applied the CovActOL and the Fast-CovActOL algorithms on a test video sequence containing 3821 frames. We have used the descriptors database and the thresholds set obtained during the learning phase and 
                           
                              
                                 
                                    L
                                 
                                 
                                    w
                                 
                              
                              =
                              30
                           
                         as the input parameters to the algorithms. We remark that all of the actions in our experiments were performed by the same actor.


                        Fig. 6
                         shows the distances of descriptors, extracted from frames in the sliding window, to the nearest neighbor of each action class as a function of the frame number. For each frame the distances were normalized with respect to the maximal distance, thus the Y axis is in the [0,1] range. The color-coded intervals overlaid on top of the X axis are the ground truth indicating the frame ranges where the actions (each action is marked with a specific color) actually took place. We call these intervals action instances. The horizontal color-coded intervals appearing on different levels above X axis mark those frames which were classified as belonging to a certain action. We call these intervals action detections. The interval’s vertical level indicates the threshold 
                           
                              (
                              
                                 
                                    γ
                                 
                                 
                                    a
                                 
                              
                              )
                           
                         which was used to detect the corresponding action class. For example, for detecting a kick action a threshold of 0.15 was used. Any frame which is not color-coded belongs to an additional class we call “No Action”.

We use three types of measures to evaluate the performance of our algorithm. First we define the miss rate as a portion of missed instances of a specific class out of the total number of instances belonging to this class. An action instance is considered as missed if its intersection with any action detection of the same class is empty. See an example of a missed punch in Fig. 6. For all action instances which are not missed we define the latency and the hold measures. The latency measure is defined as the portion of the action instance duration which was required to detect that instance for the first time. The hold measure is defined as a correctly classified portion of the instance duration from the moment it was detected for the first time. The magnified section of Fig. 6 focuses on a sequence of two actions. For the blue (kick) action, for example, the latency equals to 
                           
                              
                                 
                                    L
                                 
                                 
                                    T
                                 
                              
                           
                         and the hold equals to 
                           
                              
                                 
                                    H
                                 
                                 
                                    T
                                    -
                                    L
                                 
                              
                           
                        . Table 1
                         summarizes the per class average measures obtained for the test video sequence. Note that the punch action is missed in 33% of the time, other actions are never missed. Note that the latency measure indicates the portion of the original spatio-temporal volume used for correct classification. Besides punch, which is typically detected based on only one third of its original spatio-temporal volume, all other actions are detected based on two thirds of theirs. Also note that the average hold measure is significantly lower for the punch action than for other actions. The reason for this is the descriptor’s contamination with irrelevant frames caused by the relatively short punch action duration (18 frames on average) compared to the sliding window (30 frames).

We note that our performance measures were used to determine the set of thresholds on the nearest-to-farthest distance ratio for each action (
                           
                              
                                 
                                    γ
                                 
                                 
                                    a
                                 
                              
                           
                        ). In particular, we have performed a grid search to find the set optimizing a value function combining the miss rate, the latency and the hold measures, computed over the validation video sequence. In other types of applications, for example, in action detection where there is no requirement to detect the action’s interval, but only its approximate point in time, another value function, involving only the miss rate, could be used.

The processing speed of our non-optimized Matlab implementation of the CovActOL and the Fast-CovActOL algorithms applied on the test video sequence was 13 and 16 fps respectively on a 1.70GHz Intel Core i5 machine. The processing speed of the CovActOL algorithm drops as the temporal window size and the database size increase. The Fast-CovActOL algorithm’s speed, on the other hand, does not depend on the window size and is much less affected by an increase in the database size.

In this section we describe the experimental validation of our CovAct descriptor in a standard gesture recognition scenario. In our experiments we have used exactly the same descriptor for categorization of palm gestures (Cambridge dataset) and general gestures involving both body and hands (ChaLearn). Given a gallery set of action descriptors we used the nearest neighbor, with distance measure defined by Eq. (12), to classify a query descriptor.

Cambridge-Gesture database [13] contains 900 video sequences of nine types of hand gestures performed by three individuals. The sequences are divided into five sets – one set for each one of the five types of illumination. Each set contains twenty sequences (ten for each one of two individuals) for each one of nine gestures. The dataset does not contain hand masks, so we have evaluated our approach without using silhouette masks at all, taking the measurements from the entire frame. In our experiments we have followed the protocol described in [13]. Sequences from Set5 which were shot under standard illumination were used as the training set and sequences from Set1, Set2, Set3 and Set4 were used as testing sets. Since our approach does not employ learning, we have used the whole Set5 for training rather than splitting it by half into training and validation sets as done in [13]. Unlike in [13,14] where the action spatio-temporal volume is resized to a fixed size we do not need to employ this step since our approach inherently copes with actions of different durations. We used the nearest neighbor with the distance metric from Eq. (12) for classification. Table 2
                            shows the recognition rates of our CovAct approach, the pLSA [12] method, TCCA [13] method, the Product Manifold [14] method and the RLPP [20] method. Despite its simplicity our method has a much better performance than the TCCA and the pLSA methods and the PM method slightly outperforms ours. Fig. 7
                           (a) shows the recognition confusion matrices for CovAct. Note that two typical classification errors occurred – the “Flat Right”(FR) gesture was confused with the “Spread Right”(SR) gesture and the “V Left”(VL) gesture was confused with the “Flat Left”(FL) gesture. Looking at Fig. 7(b), depicting the recognition confusion matrix of the PM method, note that for about half of the gesture types our recognition rates are higher than those of PM.

ChaLearn dataset
                              2
                              ChaLearn Gesture Dataset (CGD2011), ChaLearn, California, 2011.
                           
                           
                              2
                            is a large set of 50,000 gestures of various types, recorded using the Microsoft Kinect camera. The dataset contains short RGB video clips featuring a single actor performing a sequence of gestures. Each RGB video clip is coupled with a corresponding depth video captured using Kinect (see Fig. 8
                           )). One-Shot-Learning gesture challenge [16], was to recognize a specific gesture from a vocabulary of 8–15 gestures, based on a single example for each gesture from the vocabulary. This is a challenging task since extensive learning procedures providing good generalization capabilities may not be applied simply due to the lack of training data. We have evaluated our descriptor on the twenty provided development batches, each including 47 video clips, following the methodology described in [16]. Depth frames were used to extract the actors’ silhouettes. Table 3
                            shows error rates in terms of an average Levenshtein distance [32], also known as the edit distance. We compare our method with the baseline method reported in [16] and the method reported in [15] which is an extension of PM [14] specifically tuned for this challenge. Our results are superior to the baseline in all batches. Results marked in green are better or comparable to those obtained in [15], and those marked in red are worse. Note that despite the relative richness and complexity of the PM descriptor compared to ours, we report superior results for some of the batches, e.g., devel01, devel05. That being said, our approach did not perform well on several batches. After inspecting the video clips we found that the gestures in the batches where we did well are based primarily on limbs’ motion and those batches where we did not do well are based on subtle palm gestures overridden by more dominant, but not informative, limbs’ motion.

The UCF-101 dataset [31] is a large collection of video clips belonging to 101 action classes, downloaded from YouTube. The clips were recorded in unconstrained environments and contain a large variability in viewing angles and illumination conditions, partial occlusions, and a significant amount of background clutter. Video clips belonging to 24 sport action classes come with bounding box annotations. These sports action classes may be roughly divided into two categories – continuous activities, e.g., fencing, horse riding, ice dancing, and short actions, e.g., a golf swing, a basketball dunk, and a dive. In our experiments we used the following set of 8 actions belonging to the second category – “Basketball Dunk”, “Cliff Diving”, “Cricket Bowling”, “Basketball Shooting”, “Diving”, “Golf Swing”, “Tennis Swing”, “Volleyball Spiking” (see Fig. 9
                        (a)). In total we have extracted 1209 action instances from the labeled sequences of the UCF-101 dataset. We note that in this experiment we did not use the subjects’ silhouettes to derive the CovAct descriptors, but rather used the whole bounding boxes. Fig. 9(b) shows the confusion matrix of the 8 action classes we used. Note the relatively high confusion rates of the “Cliff Diving” vs. “Diving”, and the “Basketball Shooting” vs. “Volleyball Spike” action pairs, which are due to the high inherent similarity of these actions. As expected, we can see that actions involving less clutter, i.e., “Cricket Bowling”, “Diving”, “Golf Swing”, “Tennis Swing” are recognized with higher rates than other actions involving larger amounts of clutter.

@&#DISCUSSION AND CONCLUSIONS@&#

We have presented a method for action recognition for the online scenario. The method recognizes actions on the fly by applying a nearest neighbor classifier on descriptors extracted from an incomplete spatio-temporal volume available at the moment. The proposed descriptor encodes the statistics of temporal shape and motion changes in a low dimensional space using the covariance descriptor. The method was successfully validated on a privately collected dataset, using quality measures, e.g. latency, especially designed for the online scenario. The descriptor was evaluated on standard gesture recognition datasets showing performance comparable to the state of the art, despite its relative simplicity and compactness. Our fast online action recognition algorithm exploits two computational speed-ups, namely the incremental covariance update and the on demand nearest neighbor computation, to meet real time requirements.

In our method we use the Affine-Invariant distance metric to compare covariance matrices. As noted in Section 2.2, this metric gave us better results than the Log-Euclidean metric, in terms of accuracy. That said, the advantage of the Log-Euclidean metric is that it can be seen as a projection of points on the manifold to the Euclidean space, followed by the regular Euclidean metric computation. This may improve the accuracy beyond what we have obtained with the nearest neighbor classifier combined with the Affine-Invariant metric, using standard machine learning techniques. One of the possible extensions of this work could be deriving a more suitable classifier for our problem using either the Riemannian kernel [28] or the Riemannian pseudo-kernel [20].

Considering group actions is another possible direction for future work. The required adjustments depend on the type of the action. If the action is a collective motion of a group of people in some region of interest such as the case with the crowd actions, e.g., demonstrations, parades, concerts, the CovAct descriptor may be employed as is. For more complex scenarios involving a structured interaction between several actors, the method has to be adapted according to the available information. For example, if we are given the bounding boxes of each actor we may describe the motion of each one of them separately, and represent the action as a collection of such descriptors. Otherwise, if we are given a probability distribution of each actor’s position inside the region of interest, we may still model actors separately by employing soft association of samples to actors based on the given distribution. Finally, if no additional information is given we may represent the complex action as a collective motion, and for moderately complex actions, e.g., a mutual handshake, this may be just enough.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Ilya Gurvich for valuable discussions and Dany Rybnikov for providing the game actions dataset for our online action recognition experiments.

The derivation of the mean update rule is as follows:
                        
                           (A.1)
                           
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We would like to introduce the following lemma which will help us in the derivation of the covariance update rule.
                        Lemma Appendix B.1
                        
                           Let 
                           
                              
                                 
                                    
                                       {
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                            
                           denote a sample of N points in 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           , and let μ and C denote the sample mean and covariance matrix i.e., 
                           
                              
                                 μ
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           and 
                           
                              
                                 C
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 μ
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       μ
                                       )
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           . Then,
                           
                              
                                 (B.1)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    (
                                    N
                                    -
                                    1
                                    )
                                    C
                                    +
                                    N
                                    (
                                    μ
                                    -
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          μ
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                           
                           for any 
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ˆ
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           .
                        


                           
                              
                                 (B.2)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             μ
                                             )
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   μ
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             μ
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             μ
                                             
                                                
                                                   μ
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   μ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    =
                                    (
                                    N
                                    -
                                    1
                                    )
                                    C
                                    +
                                    N
                                    (
                                    μ
                                    -
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          μ
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    .
                                    
                                    □
                                 
                              
                           
                        

The derivation of the covariance update rule is as follows:
                        
                           (B.3)
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                M
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              (
                              (
                              
                                 
                                    N
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              -
                              1
                              )
                              C
                              +
                              N
                              (
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              -
                              (
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              +
                              (
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          M
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       (
                                       N
                                       -
                                       1
                                       )
                                       C
                                       -
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                       )
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       1
                                       )
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       (
                                       N
                                       -
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             t
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    N
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              -
                              1
                              )
                              C
                              -
                              (
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              +
                              (
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                                 
                                    T
                                 
                              
                              )
                              .
                           
                        
                     The above update rule may be rewritten in the following way:
                        
                           (B.4)
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       -
                                       1
                                       )
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       +
                                       Δ
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where
                        
                           (B.5)
                           
                              Δ
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              =
                              -
                              (
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              +
                              (
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              -
                              1
                              )
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    T
                                 
                              
                              -
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     Expanding 
                        
                           
                              
                                 C
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      we obtain:
                        
                           (B.6)
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                      -
                                                      2
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             2
                                          
                                       
                                       +
                                       Δ
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       +
                                       Δ
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                      -
                                                      m
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                m
                                                -
                                                1
                                             
                                          
                                       
                                       Δ
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             i
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     for 
                        
                           m
                           =
                           0
                           ,
                           …
                           ,
                           t
                        
                     .

@&#REFERENCES@&#

