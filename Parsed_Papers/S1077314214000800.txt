@&#MAIN-TITLE@&#Rao-Blackwellized particle filtering with Gaussian mixture models for robust visual tracking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Rao-Blackwellized particle filtering with Gaussian mixture models.


                        
                        
                           
                           Incremental learning approaches to update the appearance models.


                        
                        
                           
                           Evaluations on a number of publicly available datasets for visual tracking.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Visual tracking

Rao-Blackwellized particle filtering

Gaussian mixture model

Expectation–Maximization

@&#ABSTRACT@&#


               
               
                  In this paper, we formulate an adaptive Rao-Blackwellized particle filtering method with Gaussian mixture models to cope with significant variations of the target appearance during object tracking. By modeling target appearance as Gaussian mixture models, we introduce an efficient method for computing particle weights. We incrementally update the appearance models using an on-line Expectation–Maximization algorithm. To achieve robustness to outliers caused by tracking error or partial occlusion in updating the appearance models, we divide the target area into sub-regions and estimate the appearance models independently for each of those sub-regions. We demonstrate the robustness of the proposed method for object tracking using a number of publicly available datasets.
               
            

@&#INTRODUCTION@&#

Visual tracking is one of important elements in surveillance or guidance systems and it has been a long-lasting research topic in computer vision. In general, visual tracking can be defined as the problem of sequentially estimating the state of a dynamic object using a sequence of noisy measurements. Particle filters have been widely used for visual tracking because they enable effective estimation of non-linear and non-Gaussian distributions for state space models [1–4]. However, particle filter-based tracking approaches suffer from occlusion, varying illumination conditions, and deformations of the target object which can cause large difference between the current observation and the appearance model.

The Rao-Blackwellized particle filter (RBPF) [5] has been introduced to estimate high-dimensional joint distributions for tracking problems [6–8]. The Markov Chain Monte Carlo (MCMC) sampling method [9,10] and the variational particle filter [11] have been adopted to effectively handle the high dimensional tracking problem. The mean-shift algorithm has been another very successful technique for real-time tracking of non-rigid objects, as introduced in [12,13]. Han et al. proposed a new sequential kernel-based Bayesian filtering framework that can recursively approximate a mixture of Gaussians for the visual tracking problem [14].

Visual tracking is inherently challenging due to the variability of the target appearance. To mitigate this problem, online learning algorithms have been used to update the appearance model during visual tracking. For example, Ross et al. [15] presented an online algorithm that incrementally learns and adapts a low dimensional eigenspace representation to reflect appearance changes of the target object. Zhou et al. [16] proposed a tracking approach that incorporates adaptive appearance models in a particle-filter framework. Babenko et al. [17] addressed the problem of learning an adaptive appearance model by training a discriminative classifier online. Recently, Kwon and Lee [18] proposed a tracking approach using a visual tracking decomposition scheme in order to reliably track objects in challenging conditions with large illumination and appearance changes.

Our approach estimates the joint distribution of the target state and the appearance model. In general, estimating this joint distribution using a particle filter would be infeasible due to the high dimensionality. To resolve this problem, we present a fast and robust tracking algorithm based on a Rao-Blackwellized particle filter [5]. This algorithm achieves a substantial computational gain as one only has to sample some of variables and apply closed-form filtering to lower dimensional sub-networks for the rest of variables. Unlike [6], which combines RBPF and Kalman filtering while assuming a single Gaussian for the appearance of the target, we propose an adaptive appearance model represented by a Gaussian mixture model. Even though Gaussian distribution has some important analytical properties, a single Gaussian distribution is limited in modeling real data. For example, tracking is prone to failure in the subsequent frames if a single Gaussian distribution is used to model occlusion or drifting.

Previous approaches [15,16] update a single appearance model using new observations that correspond to the best target state. In contrast, our approach estimates multiple appearance models allocating to each particle its appearance model. Because of this, our approach is more robust to corrupted observations from tracking errors or drifting problems.

In this paper, we address Rao-Blackwellized particle filtering in which the appearance models are represented by Gaussian mixture models. The target state is estimated using particles whose weights are computed by marginalizing out our appearance models. The appearance models are incrementally updated through an online Expectation–Maximization (EM) algorithm. In addition, the appearance models for spatially divided sub-regions are individually estimated in the RBPF framework in order to achieve robustness to partial occlusion.

The Rao-Blackwellized particle filter is an effective approach for the state-estimation problem in high-dimensional spaces. We decompose the problem of estimating the joint distribution into the problem of estimating the target state, 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                     , and the problem of estimating the appearance model, 
                        
                           
                              
                                 a
                              
                              
                                 t
                              
                           
                        
                      conditioned on the given target state. This decomposition can be expressed as
                        
                           (1)
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 z
                              
                              
                                 1
                                 :
                                 t
                              
                           
                        
                      are all observations until time t.

In the Rao-Blackwellized particle filter, the distribution of the target state is estimated by marginalizing out the appearance model as
                        
                           (2)
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 ∫
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    da
                                 
                                 
                                    t
                                 
                              
                              =
                              κ
                              
                                 ∫
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    da
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                     where 
                        
                           κ
                        
                      is a normalizing constant.

Under the Markov assumption, Eq. (2) can be rewritten as
                        
                           (3)
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              κ
                              
                                 ∫
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 ∫
                                 
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                              
                              
                                 ∫
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    da
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    dx
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              
                                 
                                    da
                                 
                                 
                                    t
                                 
                              
                              .
                           
                        
                     
                  

Finally, the distribution of the target state can be decomposed into the likelihood distribution, the predictive distribution for the appearance model, and the predictive distribution for the target state as
                        
                           (4)
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             1
                                             :
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              κ
                              
                                 ∫
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       likelihood
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     1
                                                                     :
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            da
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       predictive
                                       
                                       distribution
                                       
                                       for
                                       
                                       appearance
                                       
                                       model
                                    
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      p
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     1
                                                                     :
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            dx
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       predictive
                                       
                                       distribution
                                       
                                       for
                                       
                                       target
                                       
                                       state
                                    
                                 
                              
                              
                                 
                                    da
                                 
                                 
                                    t
                                 
                              
                              .
                           
                        
                     
                  

In our approach, the distribution of the target state, 
                        
                           p
                           (
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           |
                           
                              
                                 z
                              
                              
                                 1
                                 :
                                 t
                              
                           
                           )
                        
                     , is represented as a set of weighted particles and the distribution of the appearance model, 
                        
                           p
                           (
                           
                              
                                 a
                              
                              
                                 t
                              
                           
                           |
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 1
                                 :
                                 t
                              
                           
                           )
                        
                     , is represented by a Gaussian mixture model. The 
                        
                           i
                        
                     th particle consists of one target state, 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 [
                                 i
                                 ]
                              
                           
                        
                     , including scale and position parameters, and its corresponding appearance model, 
                        
                           
                              
                                 a
                              
                              
                                 t
                              
                              
                                 [
                                 i
                                 ]
                              
                           
                        
                     , containing the 128-dimensional orientation histogram [19] representing the target appearance. We estimate the distributions 
                        
                           p
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          1
                                          :
                                          t
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           p
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          1
                                          :
                                          t
                                       
                                    
                                 
                              
                           
                        
                      for all particles individually.

Suppose that the prior distribution, 
                           
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    1
                                    :
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                        , at time t is available. Then the predictive distribution is determined by the motion model, 
                           
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                        , which evolves the target candidates between time steps. Our approach adopts a random walk model that is based on a uniformly distributed density of the previous target state, 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        , as
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ∼
                                             U
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      -
                                                      b
                                                      +
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      +
                                                      b
                                                      +
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             (
                                             1
                                             -
                                             
                                                
                                                   α
                                                
                                                
                                                   p
                                                
                                             
                                             )
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   p
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   -
                                                   2
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    α
                                 
                                 
                                    p
                                 
                              
                           
                         is a constant learning rate. The uncertainty for the incremental change is given by 
                           
                              b
                           
                        , and 
                           
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                           
                         is the velocity of the target object, which is determined by position and scale differences between time steps.

We also use the histogram of oriented gradients (HOG) [19] for the observations, 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                           
                        , because they are robust to scale and illumination changes. In addition, we construct the integral images [20] to reduce the computational cost of producing histograms. To further improve computational efficiency, we construct the integral images from the minimum region which contains all the predicted particles generated by Eq. (5) instead of the entire image.

In the case where a target object is partially occluded, the orientation histogram is very different from the appearance model because the entirely normalized histogram is computed using all the pixels in the image window. Thus, small occlusion may cause a large change in the entire orientation histograms. To mitigate this problem, we compute histograms for uniformly divided sub-regions and individually normalize them. Fig. 1
                         shows an example tracking results demonstrating that estimating the observations and appearance models by dividing an image window into sub-regions is robust to partial occlusion. In our implementation, appearance models for B spatially divided sub-regions are independently estimated to ensure robustness to occlusion, as shown in Fig. 2
                        . A similar idea has been proposed in [21] to handle partial occlusion and pose changes by representing the template object by multiple image patches.

More formally, the appearance model, 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                           
                        , is composed of B independent appearance models for B sub-regions, i.e., 
                           
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ;
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       ;
                                       …
                                       ;
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                              
                           
                        , and each of them is modeled by a mixture of G Gaussians as
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                            :
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                            :
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      G
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                             η
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ;
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                            ,
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             η
                                             
                                                
                                                   
                                                      a
                                                      ;
                                                      μ
                                                      ,
                                                      Σ
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         (
                                                         2
                                                         π
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                   Σ
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             exp
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            a
                                                            -
                                                            μ
                                                            )
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      (
                                                      a
                                                      -
                                                      μ
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                t
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              I
                           
                         are the mean and the covariance corresponding to 
                           
                              j
                           
                        th Gaussian for the 
                           
                              k
                           
                        th sub-region. 
                           
                              I
                           
                         denotes the identity matrix.

For each appearance model, 
                           
                              B
                              ×
                              G
                           
                         Gaussians are needed and the dimension of the variable for each Gaussian is reduced by a factor of B. Thus there is no additional computation time and memory usage compared with the case the window is not divided into sub-regions.

The prior distribution, 
                           
                              p
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    1
                                    :
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                        , is given as
                           
                              (7)
                              
                                 p
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                1
                                                :
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          B
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          G
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 η
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          ;
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Using this, the predictive distribution can be determined by
                           
                              (8)
                              
                                 p
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 p
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                1
                                                :
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          B
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          G
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 p
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 η
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          ;
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          B
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          G
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 η
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

If we assume that 
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             a
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                         is a zero-mean Gaussian distribution with the covariance, 
                           
                              
                                 
                                    σ
                                 
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              I
                           
                        , then the Gaussian components for the predictive distribution are determined by
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       Σ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 I
                                 .
                              
                           
                        
                     

We update the posterior distribution of the appearance model, 
                           
                              p
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    1
                                    :
                                    t
                                 
                              
                              )
                           
                        , using the online EM algorithm [22] to allow the model to adapt to deformation and changes in illumination when new observations are obtained. It is based upon selective updating. For this purpose, we compare the current observations for each sub region, 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                        , with the G Gaussian distributions that are represented by 
                           
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    1
                                    ,
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                                 
                                    2
                                    ,
                                    k
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    G
                                    ,
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                                 
                                    G
                                    ,
                                    k
                                 
                              
                           
                        , as shown in Fig. 2, and we select the 
                           
                              n
                           
                        th and 
                           
                              l
                           
                        th Gaussian distributions corresponding to the most and the least probable distributions with the current observations based on Eq. (10).
                           
                              (10)
                              
                                 n
                                 =
                                 
                                    
                                       argmax
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       
                                          η
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         c
                                                         ,
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         c
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 l
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       
                                          η
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         c
                                                         ,
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         c
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

If none of the G distributions matches the current observations, the least probable distribution is replaced with a new Gaussian distribution whose mean value is the current histogram, 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                        , with a pre-defined initial variance. A new Gaussian distribution is added with a small weight. Otherwise, we increase the weight for the 
                           
                              n
                           
                        th Gaussian distribution that matches the new observations, and the parameters 
                           
                              μ
                           
                         and 
                           
                              σ
                           
                         of this 
                           
                              n
                           
                        th Gaussian are updated by
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             =
                                             (
                                             1
                                             -
                                             
                                                
                                                   α
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   α
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            n
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               n
                                                               ,
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             (
                                             1
                                             -
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             )
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                            
                                                               n
                                                               ,
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               n
                                                               ,
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            n
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    n
                                    ,
                                    k
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    m
                                 
                              
                              η
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ;
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             n
                                             ,
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             Σ
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             n
                                             ,
                                             k
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    m
                                 
                              
                           
                         is a constant learning rate. After this approximation, the weights are renormalized.

In our approach, the initial Gaussian parameters, the mean, and the covariance, which are determined from the first image, are fixed to prevent the drifting problem, i.e., if the first Gaussian distribution is selected as the most probable Gaussian with the observation, then we do not update the first Gaussian parameters except the weight, and we select the least probable distribution except the first Gaussian. If the tracker loses the target object, it is likely to trigger the creation of a new Gaussian with a small weight; consequently the weight of the first Gaussian component increases. Thus, our tracker relies more on the first Gaussian automatically in the subsequent frames as it consistently loses the target object.

After updating the distribution 
                           
                              p
                              (
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    1
                                    :
                                    t
                                 
                              
                              )
                           
                         using the online EM algorithm, we calculate the appearance model 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                         that corresponds to the maximum a posteriori solution as
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       arg max
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                 p
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                1
                                                :
                                                t
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        We compute 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                         using the mean-shift algorithm [23], given by
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             G
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             t
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       η
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ;
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             G
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       η
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ;
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where n is the number of iterations.

Iterations are terminated when 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              η
                              (
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              )
                              ⩽
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              η
                              (
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              )
                           
                        , or when it reaches the maximum iterations value.

Our likelihood distribution is assumed to be a Gaussian whose mean is the appearance model 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              [
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ;
                              …
                              ;
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    B
                                 
                              
                              ]
                           
                         calculated by Eq. (12) and covariance is 
                           
                              
                                 
                                    σ
                                 
                                 
                                    o
                                 
                                 
                                    2
                                 
                              
                              I
                           
                        . Finally, the likelihood distribution is determined by
                           
                              (14)
                              
                                 p
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          B
                                       
                                    
                                 
                                 η
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                o
                                             
                                             
                                                2
                                             
                                          
                                          I
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Since exact evaluation of the posterior distribution in Eq. (4) is analytically intractable due to the complexity of the posterior, we need to resort to approximate inference. To effectively calculate the weight of the 
                           
                              i
                           
                        th particle, we employ the Laplace approximation [24] as
                           
                              (15)
                              
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                 
                                 =
                                 p
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                             
                                                [
                                                i
                                                ]
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                1
                                                :
                                                t
                                             
                                          
                                       
                                    
                                 
                                 ≃
                                 κ
                                 p
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                             
                                                [
                                                i
                                                ]
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                [
                                                i
                                                ]
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         [
                                                         i
                                                         ]
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         [
                                                         i
                                                         ∗
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         [
                                                         i
                                                         ∗
                                                         ]
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         [
                                                         i
                                                         ∗
                                                         ]
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                         :
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              i
                              ∗
                           
                         is the index of the particle at time 
                           
                              t
                              -
                              1
                           
                        , corresponding to the 
                           
                              i
                           
                        th particle at time t, which is determined by re-sampling [2].

The weight of the particle is determined by two probabilities: one for the likelihood distribution in Eq. (14), and the other for the probability of 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         with respect to the predictive distribution of the appearance model in Eq. (8). The probability of 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                         with respect to the predictive distribution becomes lower if the appearance model is updated by observations not corresponding to the target object, and it becomes higher otherwise.

The overall procedure can be summarized as Algorithm 1.
                           Algorithm 1
                           Rao-Blackwellized particle filtering with Gaussian mixture models 
                                 
                                    
                                       
                                       
                                          
                                             Input: 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        -
                                                                        1
                                                                     
                                                                     
                                                                        [
                                                                        i
                                                                        ]
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        t
                                                                        -
                                                                        1
                                                                     
                                                                     
                                                                        [
                                                                        i
                                                                        ]
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 p
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                a
                                                                                             
                                                                                             
                                                                                                t
                                                                                                -
                                                                                                1
                                                                                             
                                                                                             
                                                                                                [
                                                                                                i
                                                                                                ]
                                                                                             
                                                                                          
                                                                                          |
                                                                                          
                                                                                             
                                                                                                x
                                                                                             
                                                                                             
                                                                                                t
                                                                                                -
                                                                                                1
                                                                                             
                                                                                             
                                                                                                [
                                                                                                i
                                                                                                ]
                                                                                             
                                                                                          
                                                                                          ,
                                                                                          
                                                                                             
                                                                                                z
                                                                                             
                                                                                             
                                                                                                1
                                                                                                :
                                                                                                t
                                                                                                -
                                                                                                1
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 ︸
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           represented by GMMs
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      •
                                                      FOR 
                                                            
                                                               i
                                                               =
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               N
                                                            
                                                         
                                                         
                                                            
                                                               –
                                                               Determine 
                                                                     
                                                                        i
                                                                        ∗
                                                                     
                                                                   for i by re-sampling.
                                                            
                                                            
                                                               –
                                                               Draw 
                                                                     
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                        ∼
                                                                        p
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       x
                                                                                    
                                                                                    
                                                                                       t
                                                                                    
                                                                                 
                                                                                 |
                                                                                 
                                                                                    
                                                                                       x
                                                                                    
                                                                                    
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                    
                                                                                       [
                                                                                       i
                                                                                       ∗
                                                                                       ]
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                   by Eq. (5).
                                                            
                                                            
                                                               –
                                                               Estimate 
                                                                     
                                                                        p
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       a
                                                                                    
                                                                                    
                                                                                       t
                                                                                    
                                                                                    
                                                                                       [
                                                                                       i
                                                                                       ]
                                                                                    
                                                                                 
                                                                                 |
                                                                                 
                                                                                    
                                                                                       a
                                                                                    
                                                                                    
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                    
                                                                                       [
                                                                                       i
                                                                                       ∗
                                                                                       ]
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        p
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       a
                                                                                    
                                                                                    
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                    
                                                                                       [
                                                                                       i
                                                                                       ∗
                                                                                       ]
                                                                                    
                                                                                 
                                                                                 |
                                                                                 
                                                                                    
                                                                                       x
                                                                                    
                                                                                    
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                    
                                                                                       [
                                                                                       i
                                                                                       ∗
                                                                                       ]
                                                                                    
                                                                                 
                                                                                 ,
                                                                                 
                                                                                    
                                                                                       z
                                                                                    
                                                                                    
                                                                                       1
                                                                                       :
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                   by Eq. (8).
                                                            
                                                            
                                                               –
                                                               Calculate the HOG feature for 
                                                                     
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                     
                                                                  .
                                                            
                                                            
                                                               –
                                                               Update 
                                                                     
                                                                        p
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                        |
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              z
                                                                           
                                                                           
                                                                              1
                                                                              :
                                                                              t
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                   by Eq. (11).
                                                            
                                                            
                                                               –
                                                               Calculate 
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    a
                                                                                 
                                                                                 
                                                                                    ˆ
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                     
                                                                   by Eq. (12).
                                                            
                                                            
                                                               –
                                                               Calculate the weight of the particle 
                                                                     
                                                                        
                                                                           
                                                                              w
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                     
                                                                   by Eq. (15).
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      •
                                                      END FOR
                                                   
                                                   
                                                      •
                                                      FOR 
                                                            
                                                               i
                                                               =
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               N
                                                            
                                                         
                                                         
                                                            
                                                               –
                                                               Normalize 
                                                                     
                                                                        
                                                                           
                                                                              w
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                        =
                                                                        
                                                                           
                                                                              w
                                                                           
                                                                           
                                                                              t
                                                                           
                                                                           
                                                                              [
                                                                              i
                                                                              ]
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       ∑
                                                                                    
                                                                                    
                                                                                       j
                                                                                    
                                                                                 
                                                                                 
                                                                                 
                                                                                    
                                                                                       w
                                                                                    
                                                                                    
                                                                                       t
                                                                                    
                                                                                    
                                                                                       [
                                                                                       j
                                                                                       ]
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      •
                                                      END FOR
                                                   
                                                
                                             
                                          
                                          
                                             Output: 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        [
                                                                        i
                                                                        ]
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        [
                                                                        i
                                                                        ]
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 p
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                a
                                                                                             
                                                                                             
                                                                                                t
                                                                                             
                                                                                             
                                                                                                [
                                                                                                i
                                                                                                ]
                                                                                             
                                                                                          
                                                                                          |
                                                                                          
                                                                                             
                                                                                                x
                                                                                             
                                                                                             
                                                                                                t
                                                                                             
                                                                                             
                                                                                                [
                                                                                                i
                                                                                                ]
                                                                                             
                                                                                          
                                                                                          ,
                                                                                          
                                                                                             
                                                                                                z
                                                                                             
                                                                                             
                                                                                                1
                                                                                                :
                                                                                                t
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 ︸
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           represented by GMMs
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTAL RESULTS@&#

We tested the proposed method on a challenging sequence from the CAVIAR database [25]. The first row of Fig. 3
                         shows the tracking results using a single Gaussian model, and the second row of Fig. 3 shows the tracking results using the proposed method in which the appearances models are represented by Gaussian mixture models. The proposed method can successfully track two target objects under appearance changes while a single Gaussian model shows significant limitations caused by corrupted observations.

In addition, we evaluate the tracking performance by varying the parameter (the number of Gaussians) in our appearance models using three datasets, the David [15], Simultaneous [26], and Singer [18] datasets. Fig. 4
                         shows the tracking results with different number of Gaussian components. We calculate the pixel errors of tracking results compared with the ground truth, as shown in the top row in Fig. 4, and show the tracking examples for three datasets from the second row to the fourth row in Fig. 4, respectively.

In order to evaluate the performance more quantitatively, we compute the success rate based on [27]. For this purpose, we compute the percentage of the overlapping region, 
                           
                              G
                              ∩
                              T
                           
                        , between the regions of the ground truth, G, and the estimated target, T. Then we determine a frame tracked successfully by the following criterion.
                           
                              (16)
                              
                                 min
                                 
                                    
                                       
                                          
                                             
                                                A
                                                (
                                                G
                                                ∩
                                                T
                                                )
                                             
                                             
                                                A
                                                (
                                                G
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                                (
                                                G
                                                ∩
                                                T
                                                )
                                             
                                             
                                                A
                                                (
                                                T
                                                )
                                             
                                          
                                       
                                    
                                 
                                 >
                                 R
                                 ,
                              
                           
                        where 
                           
                              A
                              (
                              ·
                              )
                           
                         indicates the size of the region, and R is a threshold. For our evaluation, we set R to 0.5, 0.6 and 0.7 to obtain three success rates and show the average value of three rates in Tables 1–3
                        
                        
                        .

As shown in Table 1, as the number of Gaussian components increases, the tracking performance tends to be better in terms of the percentage of frames successfully tracked.

We evaluate the tracking performance by different values for the learning rate, 
                           
                              
                                 
                                    α
                                 
                                 
                                    m
                                 
                              
                           
                        , as denoted in Eq. (11), which is used for updating appearance models. Based on different values of the learning rate, we run our tracking algorithm for the Football [18], Trellis [15] and Skating datasets. Fig. 5
                         shows the pixel errors and tracking examples for each dataset.


                        Table 2 lists the average percentage of frames which are decided by Eq. (16) and average pixel errors for different values of the learning rate using three datasets.

As the value of the learning rate increases, our tracking approach strongly relies on the current tracking results since the appearance model is mainly updated through the current observations. Thus if tracking fails, the appearance models are incorrectly updated, and our tracker cannot recover. Otherwise, our tracking approach cannot cope with rapid changes of the target appearance since the current observations cannot be appropriately included in the appearance model. Thus, in our evaluation, the values from 0.2 to 0.3 show the good performance for appearance changes of the target object.

In order to evaluate the robustness to partial occlusion, we test our approach by varying the number of sub-regions for three datasets, MB, MS [26] and Face [21] datasets. We divide a target window into 4×4 sub-regions, 2×2 sub-regions and a 1×1 sub-region. Fig. 6
                         shows the pixels errors and some examples of tracking results with different numbers of sub-regions.


                        Table 3 lists the average percentage of frames which are decided by Eq. (16) and average pixel errors for different numbers of sub-regions.

From our evaluation, we show the improved results under partial occlusion when the appearance models and the observations are individually modeled on each sub-region.

Our parameters used for other experiments are summarized, as shown Table 4
                        . We evaluated our approach on the PETS dataset [28] that includes 7 people that are randomly wandering, changing their appearances, and are partially occluded. Fig. 7
                         shows our tracking results. We compared the performance of our approach with other approaches, including a mean-shift-based tracker [29], MIL [17], IVT [15], VTD [18], and the RBPF-based tracker with a single Gaussian model.


                        Table 5
                         lists the average percentages of frames tracked successfully for each target object when we set R involved in Eq. (16) to 0.5.

We show the tracking results obtained from various challenging datasets that are widely used to evaluate tracking performance. Fig. 8
                         shows the tracking results for the Sylvester database, the Dudek database, the Car database [15], and another image sequence captured at night, which are strongly affected by varying illumination conditions and pose changes.

The proposed algorithm was fully implemented in C++, and we used a 2.4GHz CPU with 3GB RAM. The average processing time for one target in a PET video (Fig. 7) with different numbers of particles is shown in Fig. 9
                        .

@&#CONCLUSION@&#

We presented a robust and fast tracking approach that simultaneously updates the appearance model and tracks the target object using the Rao-Blackwellized particle filter. Our appearance model is represented adaptively with a Gaussian mixture model to handle the case when there are corrupted observations due to occlusion, tracking errors or varying illumination conditions. We also presented an effective method of estimating the distribution of the target state by marginalizing out the appearance model represented by a Gaussian mixture model. In addition, we independently estimated the appearance models for sub-regions to achieve robustness to partial occlusion.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the Human Resources Development Program for Convergence Robot Specialists supervised by the NIPA (H1502-13-1001) and the Center for Integrated Smart Sensors funded by the Ministry of Science, ICT & Future Planning as Global Frontier Project (CISS-2011-0031868).

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2014.04.002.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

