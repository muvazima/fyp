@&#MAIN-TITLE@&#State and parameter estimation for nonlinear biological phenomena modeled by S-systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Propose new improved particle filtering based on minimizing the Kullback–Leibler divergence distance.


                        
                        
                           
                           Apply the developed techniques to estimate states and parameters in biology process model representing Cad System in E. coli.


                        
                        
                           
                           Investigate the effects of practical challenges on the performances of developed techniques.


                        
                        
                           
                           Comparative performance analysis of various state-of-the-art state estimation techniques.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

State and parameter estimation

Improved particle filtering

Nonlinear biological systems

Cad system in E. coli

@&#ABSTRACT@&#


               
               
                  Biological pathways can be modeled as a nonlinear system described by a set of nonlinear ordinary differential equations (ODEs). A central challenge in computational modeling of biological systems is the determination of the model parameters. In such cases, estimating these variables or parameters from other easily obtained measurements can be extremely useful. For example, time-series dynamic genomic data can be used to develop models representing dynamic genetic regulatory networks, which can be used to design intervention strategies to cure major diseases and to better understand the behavior of biological systems. Unfortunately, biological measurements are usually highly affected by errors that hide the important characteristics in the data. Therefore, these noisy measurements need to be filtered to enhance their usefulness in practice. This paper addresses the problem of state and parameter estimation of biological phenomena modeled by S-systems using Bayesian approaches, where the nonlinear observed system is assumed to progress according to a probabilistic state space model. The performances of various conventional and state-of-the-art state estimation techniques are compared. These techniques include the extended Kalman filter (EKF), unscented Kalman filter (UKF), particle filter (PF), and the developed improved particle filter (IPF). Specifically, two comparative studies are performed. In the first comparative study, the state variables (the enzyme CadA, the transport protein CadB, the regulatory protein CadC and lysine Lys for a model of the Cad System in E. coli (CSEC)) are estimated from noisy measurements of these variables, and the various estimation techniques are compared by computing the estimation root mean square error (RMSE) with respect to the noise-free data. In the second comparative study, the state variables as well as the model parameters are simultaneously estimated. In this case, in addition to comparing the performances of the various state estimation techniques, the effect of the number of estimated model parameters on the accuracy and convergence of these techniques is also assessed. The results of both comparative studies show that the UKF provides a higher accuracy than the EKF due to the limited ability of EKF to accurately estimate the mean and covariance matrix of the estimated states through lineralization of the nonlinear process model. The results also show that the IPF provides a significant improvement over PF because, unlike the PF which depends on the choice of sampling distribution used to estimate the posterior distribution, the IPF yields an optimum choice of the sampling distribution, which also accounts for the observed data. The results of the second comparative study show that, for all techniques, estimating more model parameters affects the estimation accuracy as well as the convergence of the estimated states and parameters. However, the IPF can still provide both convergence as well as accuracy related advantages over other estimation methods.
               
            

@&#INTRODUCTION@&#

One of the major research activities in modern molecular biology is estimating the states and parameters associated with biological system models [1,2]. Recent progress in measurement technologies such as the phosphorylation of protein kinase or mass spectrometry, nuclear magnetic resonance provided a wealth of comprehensive time profiles of metabolites that can be used for biochemical pathway modeling and proteomics. These metabolic profiles are simultaneous measurements of biochemicals that can be obtained as a sequence of snapshots or as simple snapshots [3]. In order to mathematically represent this information, it is first required to estimate the model parameters using state estimation techniques and then to specify a mathematical modeling framework and to develop computational methods to fit the measured information to the selected modeling framework.

Voit et al. [4] proposed the S-system as a canonical nonlinear model to capture the dynamical behavior of a large class of biochemical pathways. S-systems offer a good trade-off between mathematical flexibility and accuracy [5]. In this modeling scheme nonlinear systems are approximated by products of power-law functions which are derived from multivariate linearization in logarithmic coordinates. Gentilini [5] has shown that this type of representation is a valid description of biological processes in a variety of settings. Voit and Almeida [6] developed an ANN-based technique to decouple the dynamic systems to identify the structure of the S-system model and estimate the model parameters. Tucker et al. in [7] have used the interval analysis method to estimate parameters for the generalized mass action models, and the authors in [8,9] proposed an intelligent two-stage evolutionary algorithm [8] and a so-called unified approach [9] to estimate the S-system models parameters. The authors in [10] proposed a hybrid scheme that consists in i) developing a mathematical modeling framework, in which the model parameters are direct indicators of the organization of the underlying phenomenon, ii) and developing a parameter estimation technique based on differential equations. Ashyraliyev et al. [11] proposed a parameter estimation technique for biochemical models. Lillacci and Khammash in [12] presented a new approach to the problem of parameter estimation of biological models using extended Kalman filter. They applied EKF to two examples, namely a model of the heat shock response in E. coli, and a model of a synthetic gene regulation system. Poovathingal et al. [13] developed practical and effective methods for estimating kinetic model parameters in the chemical master equation and other stochastic models from single cell and cell population experimental data. The authors in [14] reported on the use of the maximum likelihood scheme for parameter estimation of stochastic biochemical systems. The maximum likelihood scheme is usually very fast, but its convergence patterns are complex and requires further investigation. Chou et al. [15] proposed an alternating regression method to estimate the parameters of biochemical system models. The authors in [16] proposed a parameter estimation technique for biological systems using spline approximation. Liu et al. [17] considered the problem of parameter estimation for large-scale nonlinear dynamic biological systems. They proposed to use the particle swarm optimization method for parameter estimation in highly nonlinear large-scale metabolic networks in systems biology.

The estimation problem that is addressed here can be viewed as an optimal filtering problem [18,46], in which the posterior distribution of the unobserved state, is recursively updated, given the sequence of observed data and the state evolution model. Several state estimation techniques have been developed and used to achieve this objective. These techniques include the extended Kalman filter (EKF), unscented Kalman filter (UKF), and recently the particle filter (PF).

The classical Kalman Filter (KF) was developed in the 1960s [19], and has been widely applied in various engineering and science areas, including communications, control, machine learning, neuroscience, and many others. In the case where the model describing the system is assumed to be linear and Gaussian, the KF provides an optimal solution [20]. The KF has also been formulated in the context of Takagi–Sugeno fuzzy systems, which can be described by a convex set of multiple linear models [21,22]. It is known that KF is computationally efficient. However, it is limited by the non-universal linear and Gaussian modeling assumptions. To relax such assumptions, the Extended Kalman Filter [23,24] and the Unscented Kalman Filter [25,26] have been developed. In extended Kalman filtering, the model describing the system is linearized at every time sample (which means that the model is assumed to be differentiable). Therefore, for highly nonlinear models EKF does not usually provide a satisfactory performance. The UKF, on the other hand, instead of linearizing the model to approximate the mean and covariance matrix of the state vector, uses the unscented transformation to approximate these moments. In the unscented transformation, a set of samples (called sigma points) are selected and propagated through the nonlinear model to improve the approximation of these moments and thus the accuracy of state estimation. The above mentioned techniques usually require large amounts of computational resources and time. One aspect of concern is that these methods do not sufficiently take the special structures of biological system models into consideration. However, the propositions in [27,28] have shown that consideration of the model structure may simplify the parameter estimation problem. For example, a nonlinear model can be linearized to a linear one and the EKF can be applied to estimate the unknown sensitive parameters of the model. More details about other estimation techniques can be found in [4,5,29,30].

In addition, due to the fact that the number of unknown parameters is much more than the number of states (metabolites), the conventional EKF and UKF algorithms are not capable of estimating the unknown parameters of S-systems [45]. This motivated us to develop a new improved PF (IPF) algorithm, with a resetting feature, which can be utilized for parameter estimation within the S-system framework. The advantages of the IPF are due to the fact that it uses a better proposal distribution that takes the latest observation into account. The effectiveness of the proposed scheme is demonstrated using two case studies in which the unknown parameters of a generic branched pathway and the Cad system of E. coli are estimated. Some practical challenges, however, can affect the accuracy of estimated states and/or parameters. Such challenges include the large number of states and parameters to be estimated, the presence of measurement noise in the data, and the availability of small number of measured data samples.

The contributions of this work are three-fold. The first contribution is to develop an improved particle filtering algorithm for nonlinear and non-Gaussian estimation. In the case of the standard PF, the latest observation is not considered for the evaluation of the weights of the particles as the importance function is taken to be equal to the prior density function. This choice of the importance sampling function simplifies the computation but can cause filtering divergence. In those cases where the likelihood function is too narrow as compared to the prior function, very few particles will have significant weights. Hence, a better proposal distribution that takes the latest observation into account is desired. The proposed algorithm consists of a PF based on minimizing the KLD distance to generate the optimal importance proposal distribution. The proposed algorithm allows the particle filter to incorporate the latest observations into a prior updating scheme using the estimator of the posterior distribution that matches the true posterior more closely. The second contribution of this work is to investigate the effects of practical challenges on the performances of the IPF algorithm. The comparative analysis is performed to study the effects of three practical challenges (the number of measured data samples used, measurement noise, and the number of states and parameters to be estimated) on the estimation performances of various estimation techniques: the Extended Kalman Filter (EKF), Unscented Kalman Filter (UKF), Particle Filter (PF), and improved Particle Filter (IPF).

To study the effect of the number of measured data samples used on the estimation performances, we generate several measured data sets with different lengths and we use them for estimation. Then, we perform a comparative study to examine how the estimation performances of EKF, UKF, PF and IPF are affected by the variation of the number of the measured data samples. Similarly we consider several measurement noise contributions (e.g., different signal-to-noise ratios) to investigate the effects of the measurement noise on the estimation performances. Then we compare the performances of PF and IPF for different noise levels. Also, to study the effect of the number of states and parameters to be estimated on the performances of EKF, UKF, PF and IPF, we analyze various cases-study, differing in the numbers of estimated states and parameters. The third contribution of this work is to apply EKF, UKF, PF and IPF for estimating the states and parameters of a model of biological process describing the Cad System in E. coli (CSEC).

The rest of the paper is organized as follows. In Section 2, we present a statement of the problem addressed in this paper, followed by descriptions of various commonly used state estimation techniques in Section 2.3. Then, in Section 3, we compare the performances of the various state estimation techniques through their applications to estimating the state variables and model parameters of a CSEC model. Finally, in Section 4 we present some concluding remarks.

In this section, the formulation of the state and parameter estimation problem will be presented, and then a comparative performance analysis between the extended Kalman filter, unscented Kalman filter, particle filter, and improved particle filter will be conducted when applied to estimate the states and parameters of the CSEC model. Suppose that we are interested in identifying a mathematical model (or estimating the model parameters) of a given biological phenomenon in which we have two sets of a priori knowledge i) the topology of the metabolic pathways, and ii) experimentally measured time profiles of the metabolites. One possible solution to this model identification problem is to obtain an S-system representation of the given biological system. This solution can be obtained in two steps, 1) the structure of the S-system can be defined using knowledge of the pathways, which represent the biological phenomenon of interest following well-known steps developed in the literature [29]; 2) the measured time series of the metabolites can be used to estimate the unknown parameters in the S-system.

Consider the following S-system dynamics,
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˙
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              
                                 ∏
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                    +
                                    m
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              
                                 ∏
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                    +
                                    m
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           
                        
                      where 
                        
                           
                              α
                           
                           
                              i
                           
                        
                        >
                        0
                      and 
                        
                           
                              β
                           
                           
                              i
                           
                        
                        >
                        0
                      are rate coefficients and 
                        
                           
                              g
                           
                           
                              i
                              j
                           
                        
                      and 
                        
                           
                              h
                           
                           
                              i
                              j
                           
                        
                      are kinetic orders and there exist 
                        N
                        +
                        m
                      variables (genes/metabolites), where the first N variables are dependent and the remaining m variables are independent.

The above S-system can be written as the following nonlinear state space model:
                        
                           (2)
                           
                              
                                 
                                    x
                                 
                                 
                                    ˙
                                 
                              
                              =
                              g
                              (
                              x
                              ,
                              u
                              ,
                              θ
                              ,
                              w
                              )
                              ,
                           
                        
                      where 
                        x
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      is a vector of the state variables (concentrations of certain metabolite inside the cell), 
                        u
                        ∈
                        
                           
                              R
                           
                           
                              p
                           
                        
                      is a vector of the input variables (any manipulated variables that can change the state variables), 
                        θ
                        ∈
                        
                           
                              R
                           
                           
                              q
                           
                        
                      is an unknown parameter vector, 
                        w
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      is process noise vector and g is nonlinear differentiable function that describes the changes in the state variables over time.

The state estimation problem is formulated for a general system model. Let a nonlinear state space model be described as follows:
                        
                           (3)
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˙
                                    
                                 
                                 =
                                 g
                                 (
                                 x
                                 ,
                                 u
                                 ,
                                 θ
                                 ,
                                 w
                                 )
                                 ,
                              
                           
                           
                              
                                 y
                                 =
                                 l
                                 (
                                 x
                                 ,
                                 u
                                 ,
                                 θ
                                 ,
                                 v
                                 )
                                 ,
                              
                           
                        
                      where 
                        y
                        ∈
                        
                           
                              R
                           
                           
                              m
                           
                        
                      is a vector of the measured variables (measured metabolite concentrations), 
                        v
                        ∈
                        
                           
                              R
                           
                           
                              m
                           
                        
                      is the measurement noise vector, and l is a nonlinear differentiable function that describes the relationship between the measurements and state variables. Discretizing the state space model (3), the discrete model can be written as follows:
                        
                           (4)
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 h
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                      which describes the state variables at some time step (k) in terms of their values at a previous time step 
                        (
                        k
                        −
                        1
                        )
                     . Let the process and measurement noise vectors have the following properties: 
                        E
                        [
                        
                           
                              w
                           
                           
                              k
                           
                        
                        ]
                        =
                        0
                     , 
                        E
                        [
                        
                           
                              w
                           
                           
                              k
                           
                        
                        
                           
                              w
                           
                           
                              k
                           
                           
                              T
                           
                        
                        ]
                        =
                        
                           
                              Q
                           
                           
                              k
                           
                        
                     , 
                        E
                        [
                        
                           
                              v
                           
                           
                              k
                           
                        
                        ]
                        =
                        0
                      and 
                        E
                        [
                        
                           
                              v
                           
                           
                              k
                           
                        
                        
                           
                              v
                           
                           
                              k
                           
                           
                              T
                           
                        
                        ]
                        =
                        
                           
                              R
                           
                           
                              k
                           
                        
                     .

Inspecting the topology of the studied metabolic pathways, it is possible to identify those reactions for which the kinetic rate can be set to zero. For instance, if 
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                         does not directly affect 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , the corresponding kinetic orders 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                           
                         and 
                           
                              
                                 h
                              
                              
                                 i
                                 j
                              
                           
                         are zero. Moreover, following [6], the kinetic orders 
                           
                              
                                 g
                              
                              
                                 i
                                 i
                              
                           
                         are set to zero to omit a direct reinforcing effect of a metabolite on its own production. For example, consider the generic branched pathway (shown in Fig. 1
                        ) which has four dependent variables 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                         and one independent variable 
                           
                              
                                 x
                              
                              
                                 5
                              
                           
                         
                        [6]. As shown in this figure, the production of 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         depends on the independent variable 
                           
                              
                                 x
                              
                              
                                 5
                              
                           
                         with an inhibition effect exerted by 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                        . Hence, only the kinetic orders 
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 15
                              
                           
                         and 
                           
                              
                                 h
                              
                              
                                 11
                              
                           
                         are non-zero. Similarly, one can determine, for each metabolite, which kinetic orders are non-zero and which are negative such as 
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                        . For the branched pathway shown in Fig. 1, these concentrations are the four dependent variables 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                         in the following S-system [6], which also involves one independent variable 
                           
                              
                                 x
                              
                              
                                 5
                              
                           
                        :
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                13
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          5
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                15
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                11
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                21
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                32
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                33
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                34
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                41
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                44
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         In this case, the model parameter vector is 
                           θ
                           =
                           [
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 β
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 15
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 21
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 32
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 41
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 22
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 33
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 34
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 44
                              
                           
                           ]
                        . The four differential equations shown in model (5), describe the changes in the concentrations of four different metabolites within the cell and, thus, quantify the interactions among the genes responsible for producing these metabolites.

Since in the problem formulated by Eq. (4), we are interested in estimating the state vector, 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        , as well as the parameter vector, 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                        , let's assume that the parameter vector is described by the following model:
                           
                              (6)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                         In other words, the parameter vector model (6) corresponds to a stationary process, with an identity transition matrix, driven by white noise. We can define a new state vector 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                         that augments the state vector 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         and the parameter vector 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                         as follows:
                           
                              (7)
                              
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 +
                                 q
                              
                           
                         is assumed to follow a Gaussian model as 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           ∼
                           N
                           (
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           )
                        , where at any time instant k the expectation 
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                         and the covariance matrix 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                         are both constants. Also, defining the augmented noise vector as
                           
                              (8)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         the model (4) can be written as
                           
                              (9)
                              
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 F
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ϵ
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 R
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                         where 
                           F
                         and 
                           R
                         are differentiable nonlinear functions. The objective is to estimate the augmented state vector 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                        , given the measurements vector 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        .

The EKF and UKF algorithms, see [31] for details, do not always provide a satisfactory performance, especially for highly nonlinear processes, because linearizing the process model does not necessarily provide good estimates of the mean of the state vector and the covariance matrix of the estimation error which are used in state estimation. These issues are addressed by the particle filter (PF). In Section 2.3 we describe the two estimation techniques PF and IPF.

In this section, the formulations as well as the algorithms used in particle and improved particle filtering will be presented.

A particle filter is an implementation of a recursive Bayesian estimator [32,33]. Bayesian estimation relies on computing the posterior 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                           , which is the density function of the unobserved state vector, 
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           , given the sequence of the observed data 
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              ≡
                              {
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              }
                           . However, instead of describing the required posterior distribution in a functional form, in this particle filter scheme, it is represented approximately as a set of random samples of the posterior distribution. These random samples, which are called the particles of the filter, are propagated and updated according to the dynamics and measurement models [34,33]. The advantage of the PF is that it is not restricted by the linear and Gaussian assumptions, which makes it applicable in a wide range of applications. The basic form of the PF is simple, but may be computationally expensive. Thus, the advent of cheap, powerful computers over the last ten years has been a key to the introduction and utilization of particle filters in various applications.

For a given dynamical system describing the evolution of the states and parameters that we wish to estimate, the estimation problem can be viewed as an optimal filtering problem [18], in which the posterior distribution, 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                           , is recursively updated. Here, the dynamical system is characterized by a Markov state evolution model, 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                              =
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                           , and an observation model, 
                              p
                              (
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              )
                           . In a Bayesian context, the task of state estimation can be formulated as recursively calculating the predictive distribution 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                            and the filtering distribution 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            as follows,
                              
                                 (11)
                                 
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       ∫
                                       
                                          
                                             R
                                          
                                          
                                             n
                                          
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    d
                                    
                                       
                                          z
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    and
                                    
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    ,
                                    
                                    where
                                    
                                    p
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       ∫
                                       
                                          
                                             R
                                          
                                          
                                             z
                                          
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    d
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    .
                                 
                              
                           
                        

The nonlinear nature of the system model leads to intractable integrals when evaluating the marginal state distribution, 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                           . Therefore, Monte Carlo approximation is utilized, where the joint posterior distribution, 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                           , is approximated by the point-mass distribution of a set of weighted samples (particles) 
                              
                                 
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                           , i.e., [34]:
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    d
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    /
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                              
                              (
                              d
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            denotes the Dirac function, and N is the total number of particles. Based on the same set of particles, the marginal posterior probability of interest, 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                           , can also be approximated as follows [33]:
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    d
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    /
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

In this Bayesian importance sampling (IS) approach, the particles 
                              
                                 
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                            are sampled from the following distribution [33],
                              
                                 (14)
                                 
                                    π
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    ∫
                                    N
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    d
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    
                                    d
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    .
                                 
                              
                            Then, the estimate of the augmented state 
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                            can be approximated by a Monte Carlo scheme as follows [34]:
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            are the corresponding importance weights [34]:
                              
                                 (16)
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    ∝
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          π
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          |
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

A common problem with the sequential importance sampling-based particle filter is the degeneracy phenomenon, where after a few iterations, all but one particle will have negligible weights. It has been shown [35] that the variance of the importance weights can only increase over time, and thus, it is impossible to avoid the degeneracy phenomenon. This degeneracy implies that a large computational effort is devoted to updating particles whose contribution to the approximation of 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            is almost zero. A suitable measure of degeneracy of the algorithm is the effective sample size 
                              
                                 
                                    N
                                 
                                 
                                    eff
                                 
                              
                           , which is introduced in [32] and [36], and is defined as
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          eff
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            are the normalized weights obtained using (16). The PF algorithm for state/parameter estimation is summarized in Algorithm 1
                           .

Particle filtering suffers from one major drawback. Its efficient implementation requires the ability to sample from 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                           , which does not take into account the current observed data, 
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                           , and thus many particles can be wasted in low likelihood (sparse) areas. This issue is addressed by the proposed improved particle filter (IPF), which is described in Section 2.3.2.

The choice of optimal proposal function is one of the most critical design issues in importance sampling schemes. In [34], the optimal proposal distribution 
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            is obtained by minimizing the variance of the importance weights given the states 
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                            and the observations data 
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                           . This selection has also been studied by other researchers. However, this optimal choice suffers from one major drawback. The particles are sampled from the prior density 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                            and the integral over the new state need to be computed. In the general case, closed form analytic expression of the posterior distribution of the state is untractable [37]. Therefore, the distribution 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                            is the most popular choice of proposal distribution. One of its advantages is its simplicity in sampling from the prior functions 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                            and the evaluation of weights 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            (as presented in the previous section). However, the latest observation is not considered for the computation of the weights of the particles as the importance density is taken to be equal to the prior density [38,39]. The transition prior 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              )
                            does not take into account the current observation data 
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                           , and many particles can be wasted in low likelihood areas. This choice of importance sampling function simplifies the computational complexity but can cause filtering divergence [39]. In cases where the likelihood density is too narrow as compared to the prior function, very few particles will have considerable weights. Next, we present an overview of KLD-based improved particle filter.

The improved particle filtering (IPF) is proposed for approximating intractable integrals arising in Bayesian statistics. By using a separable approximating distribution 
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                            to lower bound the marginal likelihood, an analytical approximation to the posterior probability 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            is provided by minimizing the Kullback–Leibler divergence (KLD):
                              
                                 (17)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          KL
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    ‖
                                    p
                                    )
                                    =
                                    ∫
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    log
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    
                                    d
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       ∏
                                       i
                                    
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                             :
                                             k
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             0
                                             :
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    .
                                 
                              
                            Minimizing the KLD subject to the constraint 
                              ∫
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              )
                              
                              d
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                 
                              
                              ∫
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                              
                              d
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           , the Lagrange multiplier scheme is used to yield the following approximate distribution [40,41],
                              
                                 (18)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ∝
                                    exp
                                    
                                       [
                                       E
                                       
                                          
                                             (
                                             
                                                log
                                             
                                             
                                             p
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                   :
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   j
                                                   ≠
                                                   i
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                            where 
                              E
                              
                                 
                                    (
                                    .
                                    )
                                 
                                 
                                    q
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                            denotes the expectation operator relative to the distribution 
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           . Therefore, these dependent parameters can be jointly and iteratively updated. Taking into account the separable approximate distribution 
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                            at time 
                              k
                              −
                              1
                           , the posterior distribution 
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                            is sequentially approximated according to the following scheme:
                              
                                 (19)
                                 
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    ∝
                                    p
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          q
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    
                                    where
                                    
                                    
                                       
                                          q
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    ∫
                                    p
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    d
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    .
                                 
                              
                            Hence, the particles 
                              
                                 
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                            are sampled according to the following optimal function:
                              
                                 (20)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          |
                                       
                                       
                                          
                                             y
                                          
                                          
                                             0
                                             :
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    p
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          y
                                       
                                       
                                          0
                                          :
                                          k
                                       
                                    
                                    )
                                    =
                                    ∫
                                    N
                                    
                                       (
                                       
                                          
                                             
                                                z
                                             
                                             
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          |
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                λ
                                             
                                             
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          
                                             z
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       )
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       )
                                    
                                    
                                    d
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                       
                                    
                                    
                                    d
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    .
                                 
                              
                            The recursive estimate of the importance weights can be derived as follows:
                              
                                 (21)
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          |
                                          
                                             
                                                y
                                             
                                             
                                                0
                                                :
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                            Eq. (21) provides a mechanism to sequentially update the importance weights, given an appropriate choice of proposal distribution, 
                              
                                 
                                    q
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    0
                                    :
                                    k
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    0
                                    :
                                    k
                                 
                              
                              )
                           . Then, the estimate of the augmented state 
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                            can be approximated by a Monte Carlo scheme as follows:
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

The improved particle filter which based on minimizing KLD for proposal distribution generation within a particle filter framework is depicted in Algorithm 2
                           .

In this section, the state estimation techniques (i.e., EKF, UKF, PF and IPF) are compared through their utilization to estimate the states variables and model parameters of the Cad System in E. coli (CSEC). First, a description of the model of the CSEC process; is presented, and then two comparative studies are performed to assess the performances of these state estimation techniques. In the first comparative study, the three state estimation techniques are used to estimate the four state variables (the concentrations of the enzyme 
                        
                           Cad
                        
                        
                           
                              A
                           
                           
                              k
                           
                        
                     , the transport protein 
                        
                           Cad
                        
                        
                           
                              B
                           
                           
                              k
                           
                        
                     , the regulatory protein 
                        
                           Cad
                        
                        
                           
                              C
                           
                           
                              k
                           
                        
                      and the lysine 
                        
                           
                              Lys
                           
                           
                              k
                           
                        
                      for a model of the Cad System in E. coli (CSEC)) from noisy measurers of these variables. In the second comparative study, the various state estimation techniques are compared when used to simultaneously estimate the state variables as well as the model parameters of the CSEC. The effect of the number estimated parameters on the performances of these state estimation techniques is also investigated. Next, the model of CSEC, that will be used in our analysis, will be described.

In all cases, the following system parameters are used. The state noise is fixed to 
                        
                           
                              v
                           
                           
                              k
                           
                           
                              2
                           
                        
                        =
                        0.01
                        ⁎
                        o
                        n
                        e
                        s
                        (
                        1
                        ,
                        
                           
                              N
                           
                           
                              s
                           
                        
                        )
                      (
                        
                           
                              N
                           
                           
                              s
                           
                        
                      is the total number of the states to be estimated), the parameter noise is fixed to 
                        
                           
                              γ
                           
                           
                              k
                           
                           
                              2
                           
                        
                        =
                        0.01
                        ⁎
                        o
                        n
                        e
                        s
                        (
                        1
                        ,
                        
                           
                              N
                           
                           
                              p
                           
                        
                        )
                      (
                        
                           
                              N
                           
                           
                              p
                           
                        
                      is the total number of the parameters to be estimated), the measurement variance noise is fixed to 
                        
                           
                              w
                           
                           
                              n
                           
                           
                              2
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                     , the total sampling instants is 
                        N
                        =
                        200
                     , and 200 particles were used in PF and IPF algorithms. For the Kalman filter matrices, the state noise covariance, the initial estimation error covariance, and the measurement matrix are defined to be 
                        Q
                        =
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                        ⁎
                        diag
                        (
                        [
                        1
                        
                        1
                        
                        1
                        
                        1
                        ]
                        )
                     , 
                        P
                        =
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                        ⁎
                        [
                        1
                        
                        0
                        
                        0
                        
                        0
                        ;
                        0
                        
                        1
                        
                        0
                        
                        0
                        ;
                        0
                        
                        0
                        
                        1
                        
                        0
                        ;
                        0
                        
                        0
                        
                        0
                        
                        1
                        ]
                     , and 
                        H
                        =
                        [
                        1
                        
                        0
                        
                        0
                        
                        0
                        ]
                     , respectively. The estimation process began with the initial values of the state variables 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    CadA
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    CadB
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    CadC
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    Lys
                                 
                                 
                                    0
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                        =
                        
                           
                              [
                              1.4
                              
                              2.7
                              
                              1.2
                              
                              0.4
                              ]
                           
                           
                              T
                           
                        
                     . All the simulations shown in this paper are implemented using Matlab version 7.1, using an Intel Pentium CPU 3.4 GHz, 1.0 GB of RAM PC.

The Cad system is one of the conditional stress response modules in E. coli, which is induced only at low pH and a lysine-rich environment [42,43] and has been studied earlier in the context of parameter estimation of S-system models for biochemical networks [44]. As shown in Fig. 1, the main components of the Cad system are the enzyme CadA, the transport protein CadB, and the regulatory protein CadC. The decarboxylase CadA converts lysine Lys into cadaverine in a reaction which consumes 
                           
                              
                                 H
                              
                              
                                 +
                              
                           
                        . The transport protein CadB imports the substrate, lysine and exports the product, cadaverine. Hence, the intracellular 
                           
                              
                                 H
                              
                              
                                 +
                              
                           
                         concentration is reduced and the cell returns back to pH homeostasis. The membrane protein CadC senses the external conditions and regulates the stress response by binding directly to the DNA and activating the transcription of cadBA. This ensures that CadA and CadB are produced only under the appropriate external conditions of low pH and lysine abundance. Moreover, as shown in [43], CadC senses the external cadaverine and the accumulation of cadaverine in extracellular medium causes a delayed transcriptional down regulation of cadBA expression. The time profile data set reported in [44] is used here for parameter estimation of the S-system model of the Cad system. In this data set, time profiles of a subset of the Cad system components, namely CadA, cadBA transcript, external lysine, external cadaverine and pH are available. Following the approach in [44], the lack of an appropriate data set for CadC, internal lysine and internal cadaverine is handled as follows:
                           
                              •
                              
                                 CadC: due to the fact that CadC is the signal protein which senses pH, external lysine and external cadaverine, one can directly consider the effect of these signals on the expression of cadBA. It should be mentioned that the effect of external cadaverine on CadC, and consequently on the expression of cadBA, is not considered in [44].


                                 Internal lysine and cadaverine: due to the fact that CadA and CadB are responsible for decarboxylase reaction of lysine and the transport mechanism of lysine and cadaverine, one can couple the decarboxylase reaction and the transport mechanism and consider both CadA and CadB in a single step. Note that the level of CadB is proportional to that of CadA since they are translated from the same mRNA.

Based on the existing qualitative model (Fig. 1) and available pathway information, the following S-system can be obtained:
                           
                              (23)
                              
                                 
                                    
                                       
                                          d
                                          [
                                          
                                             CadA
                                          
                                          ]
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          [
                                          
                                             Cadav
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                13
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          [
                                          
                                             CadA
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                11
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                          [
                                          
                                             cadBA
                                          
                                          ]
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          [
                                          
                                             CadA
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                21
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          [
                                          
                                             cadBA
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                          [
                                          
                                             Cadav
                                          
                                          ]
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          [
                                          
                                             cadBA
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                32
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          [
                                          
                                             Cadav
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                33
                                             
                                          
                                       
                                    
                                    
                                       
                                          [
                                          
                                             Lys
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                34
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                          [
                                          
                                             Lys
                                          
                                          ]
                                       
                                       
                                          d
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          [
                                          
                                             CadA
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                41
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          [
                                          
                                             Lys
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                44
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           θ
                           =
                           [
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 β
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 15
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 21
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 32
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 41
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 22
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 33
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 34
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 44
                              
                           
                           ]
                         is a set of parameters.

Discretizing the model using a sampling interval of Δt and incorporating random process noise (to account for any uncertainties in the CSEC process model), the model can be written as
                           
                              (24)
                              
                                 
                                    
                                       
                                          CadA
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          CadA
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Cadav
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   9
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   13
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          cadBA
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          cadBA
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   10
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   cadBA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   14
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          Cadav
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Cadav
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   cadBA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   11
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             7
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Cadav
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   15
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Lys
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   17
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          Lys
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Lys
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   12
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Lys
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   17
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                         where the process noise is zero mean Gaussian noise, i.e., 
                           
                              
                                 w
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           ∼
                           N
                           (
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                        .

In a practical setting, the data would be collected, and then measuring the state variables, i.e., the concentrations of the enzyme 
                           
                              
                                 CadA
                              
                              
                                 k
                              
                           
                        , the transport protein 
                           
                              
                                 CadB
                              
                              
                                 k
                              
                           
                        , the regulatory protein 
                           
                              
                                 CadC
                              
                              
                                 k
                              
                           
                         and the lysine 
                           
                              
                                 Lys
                              
                              
                                 k
                              
                           
                         as functions of time. However, since this is a simulated example, the data are generated from the discretized model (24), given some pre-defined model parameters. The sampling time used for discretization is 0.01 min and the CSEC model parameters are shown in Table 1
                        .

Therefore, we consider the state vector that we wish to estimate as:
                           
                              (25)
                              
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             CadA
                                          
                                          
                                             k
                                          
                                       
                                       
                                       
                                          
                                             CadB
                                          
                                          
                                             k
                                          
                                       
                                       
                                       
                                          
                                             CadC
                                          
                                          
                                             k
                                          
                                       
                                       
                                       
                                          
                                             Lys
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Eventually, to perform comparison between the techniques, the following estimation root mean square error (RMSE) criterion will be used and calculated for the states (with respect to the noise free data)
                           
                              (26)
                              
                                 RMSE
                                 =
                                 
                                    
                                       E
                                       
                                          (
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where x (
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                        ) is the true parameter/state (estimated parameter/state).

The model (24) is used to simulate the responses of the concentrations of the enzyme 
                           
                              
                                 CadA
                              
                              
                                 k
                              
                           
                        , the transport protein 
                           
                              
                                 CadB
                              
                              
                                 k
                              
                           
                        , the regulatory protein 
                           
                              
                                 CadC
                              
                              
                                 k
                              
                           
                         and the lysine 
                           
                              
                                 Lys
                              
                              
                                 k
                              
                           
                         for Cad System in E. coli (CSEC) as functions of time. These simulated states, which are assumed to be noise free, are then contaminated with zero mean Gaussian errors, i.e., a measurement noise 
                           
                              
                                 v
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           ∼
                           N
                           (
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 v
                              
                              
                                 2
                              
                           
                           )
                        . Considering a value of 
                           
                              
                                 σ
                              
                              
                                 v
                              
                              
                                 2
                              
                           
                           =
                           0.01
                        , dynamic data are generated, which are shown in Fig. 3.

The objective behind this case study is to compare the performances of the various estimation techniques EKF, UKF, PF and IPF algorithms (which were discussed in this paper) through their application using simulated time-series metabolic data representing the concentrations of four metabolites that are related by the branched pathway shown in Fig. 2
                        
                        , i.e., the concentrations of the enzyme 
                           
                              
                                 CadA
                              
                              
                                 k
                              
                           
                        , the transport protein 
                           
                              
                                 CadB
                              
                              
                                 k
                              
                           
                        , the regulatory protein 
                           
                              
                                 CadC
                              
                              
                                 k
                              
                           
                         and the lysine 
                           
                              
                                 Lys
                              
                              
                                 k
                              
                           
                        . Hence, we consider the state vector that we wish to estimate, 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       CadA
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       CadB
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       CadC
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       Lys
                                    
                                    
                                       k
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        , and all model parameters (i.e., 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                        ,
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 21
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 32
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 41
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 11
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 22
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 33
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 44
                              
                           
                        ) are assumed to be known. The time courses of the four state variables CadA, CadB, CadC, and Lys estimated using EKF, UKF, PF and IPF are shown in Figs. 4
                        (a, b, c, d). The estimation root mean square errors (RMSE) are shown in Table 2
                        .

It can be observed from Fig. 4 and Table 2 that EKF resulted in the worst performance of all estimation techniques, which is expected due to the limited ability of EKF to accurately estimate the mean and covariance matrix of the estimated states through lineralization of the nonlinear process model. The results also show that the PF provides a significant improvement over the EKF and UKF, which is due to the limited ability of these techniques to deal with highly nonlinear process models. The results also show that the IPF provides a significant improvement over the PF, which is due to the fact that the IPF yields an optimal choice of the sampling distribution 
                           p
                           (
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           |
                           
                              
                                 z
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           )
                         over the estimated states by minimizing a KLD criterion that also utilizes the observed data 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        .

In this section, we are interested in examining the effect of the number of estimated states and parameters on the performances of EKF, UKF, PF and IPF when used to estimate the states and parameters of the CSEC process model. In other words, the state vector that we wish to estimate, 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                        , includes the model states, 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       CadA
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       CadB
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       CadC
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       Lys
                                    
                                    
                                       k
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        , as well as some (or all) of the model parameters (i.e., 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                        ,
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 13
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 21
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 32
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 41
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 11
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 22
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 33
                              
                           
                        , 
                           
                              
                                 h
                              
                              
                                 44
                              
                           
                        ) that are assumed to be unknown. Hence, the following equations can be used for describing the evolution of model parameters:
                           
                              (27)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                              
                           
                         where, 
                           i
                           =
                           {
                           1
                           .
                           .
                           17
                           }
                        , i.e., the parameters are a stationary process, with identity matrix, driven by white noise, 
                           
                              
                                 γ
                              
                              
                                 k
                                 −
                                 1
                              
                           
                        . Incorporating the evolution of the parameters into the model (24), it becomes:
                           
                              (28)
                              
                                 
                                    
                                       
                                          CadA
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          CadA
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   cadBA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   9
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             5
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   14
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          cadBA
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          cadBA
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Cadav
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   10
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Lys
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   34
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                pH
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   25
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             6
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   cadBA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   15
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          Cadav
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Cadav
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             3
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                cadBA
                                             
                                             ]
                                          
                                          
                                             k
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   11
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             7
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             Cadav
                                          
                                          
                                             k
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   15
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             Lys
                                          
                                          
                                             k
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   16
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          Lys
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Lys
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             4
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   12
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             8
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   CadA
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   31
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Cadav
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   17
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   Lys
                                                
                                                
                                                   k
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   34
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    t
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Defining 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                         to be a vector of the parameters to be estimated, which is described by the model (6), we can write the model of CSEC as given in (7). For example, if we are interested in estimating the four states, 
                           
                              
                                 CadA
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 CadB
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 CadC
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 Lys
                              
                              
                                 k
                              
                           
                        , and 2 other parameters (e.g., 
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 α
                              
                              
                                 2
                                 ,
                                 k
                              
                           
                        ), i.e., 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       2
                                       ,
                                       k
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        , then 
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 [
                                 
                                    CadA
                                 
                                 
                                 
                                    CadB
                                 
                                 
                                 
                                    CadC
                                 
                                 
                                 
                                    Lys
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       2
                                       ,
                                       k
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        .

To investigate the effect of the number of estimated model parameters on the performances of the different state estimators, this comparative study will be performed examinating the two cases-study summarized below. In all these cases; it is assumed that four state variables (the concentrations of the enzyme 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , the transport protein 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , the regulatory protein 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and the lysine 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                           ) are measured.
                              
                                 1.
                                 Case 1: the four states (CadA, CadB, CadC, and Lys) along with the first parameter 
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                     will be estimated.

Case 2: the four states (CadA, CadB, CadC, and Lys) along with the two parameters (
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                    ) will be estimated.

The estimation of the state variables and parameter(s) for these two cases are performed using the two state estimation techniques, EKF and UKF, and the estimation results for the states and the model parameters using these techniques are shown in Figs. 5(a, b), 6(a, b, c), and 7(a, b, c)
                           
                           
                           . Fig. 5 shows the estimation of the four state variables (CadA, CadB, CadC, and Lys) using EKF and UKF. Figs. 6 and 7, on the other hand, show the estimation of the model parameters (in both cases 1 and 2) using EKF and UKF, respectively. Also, Tables 3 and 4
                           
                            compare the performances of the two estimation techniques for the two cases using the RMSE criterion. For example, for case 1, Table 3 compares the estimation root mean square errors for the four state variables CadA, CadB, CadC, and Lys (with respect to the noise-free data) and the mean of the estimated parameter 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                            at steady state (i.e., after convergence of parameter(s)). Table 4 also presents similar comparisons for case 2. It can be seen from the results presented in Tables 3 and 4 that in all cases, the UKF outperforms the EKF (i.e., provides smaller RMSE for the state variables). These results confirm the results obtained in the first comparative study, where only the state variables are estimated. The advantages of the UKF over the EKF can also be seen through their abilities to estimate the model parameters. For example, EKF could not estimate any of the parameters in both cases 1 and 2 (see Fig. 6). The UKF, on the other hand, could estimate one parameter 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                            in case 1 (see Fig. 7(a)), but it could not converge for the second parameter in case 2 (see Fig. 7(b, c)).

The results also show that the number of estimated parameters affect the estimation accuracy of the state variables. In other words, for all the considered techniques, the estimation RMSE of 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                            increase from the first comparative study (where only the state variables are estimated) to case 1 (where only one parameter, 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                           , is estimated) to case 2 (where two parameters, 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                            are estimated). For example, the RMSEs obtained using EKF for CadA in the first comparative study and cases 1 and 2 of the second comparative study are 0.0694, 0.0742, and 0.0748, respectively, which increase as the number of estimated parameters increases (refer to Tables 3 and 4). This observation is valid for the other state variables, the transport protein CadB, the regulatory protein CadC and lysine Lys and for the UKF estimation technique.

The simulation results presented above confirm the fact that the EKF and UKF algorithms do not always provide a satisfactory performance, especially for highly nonlinear processes, because linearizing the process model does not necessarily provide good estimates of the mean of the state vector and the covariance matrix of the estimation error which are used in state estimation. PF was developed to address the limitations encountered in EKF and UKF techniques. In Section 3.4.2 we present the performance results of the PF and its improved version (IPF) when used to simultaneously estimate the state variables and model parameters.

Here, we will consider two cases, which are summarized below. In both cases, it is assumed that the four states (the concentrations of the enzyme 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , the transport protein 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , the regulatory protein 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and the lysine 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                           ) are measured.
                              
                                 1.
                                 Case 1: the four states (CadA, CadB, CadC, and Lys) along with the first parameter 
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                     will be estimated.

Case 2: the four states (CadA, CadB, CadC, and Lys) along with two parameters (
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                    ) will be estimated.

The estimation of the state variables and parameter(s) for these two cases is performed using PF and IPF, and the simulation results for the state variables and the model parameters are shown in Figs. 8(a, b), 9(a, b), 10(a, b), and 11(a, b)
                           
                           
                           
                           . Figs. 8 and 10 show the estimation of the state variables using PF and IPF, respectively. Figs. 9 and 11, on the other hand, show the estimation of the parameters using PF and IPF for both cases 1 and 2. Also, Tables 5 and 6
                           
                            compare the performances of PF and IPF for cases 1 and 2. For example, for case 1, Table 5 compares the estimation root mean square errors for the four state variables 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                            (with respect to the noise-free data) and the mean of the estimated parameter 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                            at steady state (i.e., after its convergence). Table 6 presents similar comparisons for case 2.

The results also show that the number of parameters to estimate affect the estimation accuracy of the state variables. In other words, for PF the estimation RMSE of 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                            increases from the first comparative study (where only the state variables are estimated) to case 1 (where the states and one parameter, 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                           , are estimated) and case 2 (where the states and two parameters, 
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                           , are estimated). For example, the RMSEs obtained using PF for CadA in the first comparative study and cases 1 of the second comparative study are 0.0012 and 0.00125, respectively, which increase as the number of estimated parameters increases (refer to Table 5). This observation is valid for the other state variables CadB, CadC and Lys. On the other hand, the PF, could estimate the two parameters in both cases (cases 1 and 2), even though it took longer to converge in case 2, where the two parameters are estimated (see Fig. 9). The IPF, however, could estimate the two parameters in both cases, and converged faster than PF technique (see Fig. 11). These advantages of the IPF are due to the fact that it provides an optimum choice of the sampling distribution used to approximate the posterior density function, which also accounts for the observed data.

Some practical challenges, however, can affect the accuracy of estimated states and/or parameters. Such challenge include the large number of states and parameters to be estimated, the presence of measurement noise in the data, and the availability of small number of measured data samples. Next, we investigate the effect of the challenges mentioned above on the performances of the PF and the IPF when all the 17 parameters are estimated.

1) Root mean square error analysis
                        

a) Effect of number of samples on the estimation RMSE
                        

In order to investigate the performance of the PF and IPF algorithms versus the number of samples, four different number of samples, namely, 50, 100, 150 and 200, are considered. Tables 7 and 8
                           
                            compare the 17 estimated parameters of the S-system with the training data for the different number of samples using the two techniques, PF and IPF. Moreover, Tables 9 and 10
                           
                            report the RMSE of the state variables estimated through the PF and the IPF. These results show that the RMSEs of the estimated states increase as the number of sample decreases. For example, the RMSEs obtained using the PF for CadA where the numbers of samples are 200 and 100 are 0.00122 and 0.00125, respectively. This observation is valid also for the IPF algorithm.

b) Effect of noise content on the estimation RMSE
                        

The estimated values of the 17 parameters are summarized in Tables 11 and 12
                           
                           . In order to show the effect of noise on the estimation accuracy of the PF and IPF algorithms, zero-mean Gaussian errors are introduced in the data. Four different levels of noise are considered (variances of 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    1
                                 
                              
                           , 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    2
                                 
                              
                           , 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    3
                                 
                              
                           , and 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                           ). Also, the RMSEs of the estimated states using the PF and IPF estimation techniques for different noise levels are shown in Tables 13 and 14
                           
                           , respectively. The results presented in Tables 13 and 14 show that as the noise level increases in the data (higher variance), the RMSE of the estimated states increases. For example, the RMSE obtained using the PF for CadA for the cases where the noise variances are 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    3
                                 
                              
                            and 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                            are 0.00121 and 0.00115, respectively. This observation is also valid for the IPF algorithm.

The simulation results obtained estimating the four state variables CadA, CadB, CadC, and Lys using PF and IPF when the variances noise vary in {
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                           , 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    3
                                 
                              
                           } are shown in Tables 13 and 14.

In other words, for both the PF and the IPF, the RMSEs of 
                              
                                 
                                    CadA
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                            increase from the first comparative study (noise variance = 10−4) to case (where the noise variance = 10−3). For example, the RMSEs obtained using PF for CadA increase as the noise variance increases. Indeed, the RMSEs corresponding to noise variances of 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                            and 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    3
                                 
                              
                            are 0.00115 and 0.00121, respectively. This observation is valid also for the other state variables 
                              
                                 
                                    CadB
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    CadC
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    Lys
                                 
                                 
                                    k
                                 
                              
                            as well as for the IPF algorithm.

@&#CONCLUSIONS@&#

In this paper, techniques are used to simultaneously estimate the state variables and model parameters of a model of the Cad System in E. coli (CSEC). Various state estimation techniques, which include the extended Kalman filter (EKF), unscented Kalman filter (UKF), particle filter (PF), and improved particle filter (IPF), are compared as they are used to achieve this objective. Two comparative studies have been performed to compare the performances of these estimation techniques. In the first comparative study, EKF, UKF, PF and IPF are used to estimate the four state variables, i.e. the concentrations of the enzyme 
                        
                           
                              CadA
                           
                           
                              k
                           
                        
                     , the transport protein 
                        
                           
                              CadB
                           
                           
                              k
                           
                        
                     , the regulatory protein 
                        
                           
                              CadC
                           
                           
                              k
                           
                        
                      and the lysine 
                        
                           
                              Lys
                           
                           
                              k
                           
                        
                     . In the second comparative study, the state variables and model parameters are simultaneously estimated and the effects of the number of estimated parameters on the performances of the different techniques is also investigated. This comparison is performed using simulated time series of biological data contaminated by white noise. The simulated data physically represent the concentrations of four metabolites related by a dynamic model. The simulation results of both comparative studies show that the PF provides a higher accuracy than the EKF and the UKF due to the limited ability of EKF and UKF to deal with highly nonlinear process models. The results also show that the IPF provides a significant improvement over the PF. This is because, unlike the PF which depends on the choice of sampling distribution used to estimate the posterior distribution, the IPF yields an optimum choice of the sampling distribution, which also utilizes the observed data. The results of the second comparative study show that, for all the techniques, estimating more model parameters affects the estimation accuracy as well as the convergence of the estimated states and parameters. The IPF, however, still provides advantages over other methods in terms of the estimation accuracy and convergence. It is worthwhile mentioning that time delay plays an important role in determining the dynamics of biological systems. However, in this paper, the delay in transcription and translation of the CSEC system has not been considered, and hence in a future research direction, we will consider such delay and its impact on the modeling process.

@&#ACKNOWLEDGEMENTS@&#

This work was made possible by NPRP grant NPRP08-148-3-051 from the Qatar National Research Fund (a member of Qatar Foundation). The statements made herein are solely the responsibility of the authors.

@&#REFERENCES@&#

