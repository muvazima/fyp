@&#MAIN-TITLE@&#Robust discriminative training against data insufficiency in PLDA-based speaker verification

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We address data insufficiency in discriminative PLDA training.


                        
                        
                           
                           First, we compensate for statistical dependencies in the training data.


                        
                        
                           
                           Second, we propose three constrained discriminative training schemes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Speaker verification

PLDA

Discriminative training

Statistically dependent training data

Overfitting

@&#ABSTRACT@&#


               
               
                  Probabilistic linear discriminant analysis (PLDA) with i-vectors as features has become one of the state-of-the-art methods in speaker verification. Discriminative training (DT) has proven to be effective for improving PLDA's performance but suffers more from data insufficiency than generative training (GT). In this paper, we achieve robustness against data insufficiency in DT in two ways. First, we compensate for statistical dependencies in the training data by adjusting the weights of the training trials in order for the training loss to be an accurate estimate of the expected loss. Second, we propose three constrained DT schemes, among which the best was a discriminatively trained transformation of the PLDA score function having four parameters. Experiments on the male telephone part of the NIST SRE 2010 confirmed the effectiveness of our proposed techniques. For various number of training speakers, the combination of weight-adjustment and the constrained DT scheme gave between 7% and 19% relative improvements in 
                        
                           
                              
                                 C
                                 ˆ
                              
                           
                           llr
                        
                      over GT followed by score calibration. Compared to another baseline, DT of all the parameters of the PLDA score function, the improvements were larger.
               
            

@&#INTRODUCTION@&#

In recent years, the combination of i-vector (Dehak et al., 2009, 2011) and probabilistic linear discriminant analysis (PLDA) (Ioffe, 2006; Kenny, 2010) has become one of the state-of-the-art systems in speaker verification. In this system, utterances are mapped into low dimensional vectors known as i-vectors. An i-vector contains information related to the speaker identity as well as irrelevant factors such as speaker's emotions, transmission channels, languages, and environmental noise. Given two i-vectors, the PLDA model separates speaker factors from irrelevant factors and provides a log-likelihood ratio (LLR) score for the two i-vectors being from the same speaker or not.

The PLDA parameters are usually optimized by generative training (GT) under the maximum likelihood (ML) criterion. However, several studies have suggested that discriminative training (DT) is beneficial, either as a complement or as an alternative to GT (Brümmer, 2010; Burget et al., 2011; Cumani et al., 2011, 2012, 2013; Borgström and McCree, 2013). In particular, score calibration by means of a discriminatively trained affine transformation (AT-Cal) (Brümmer, 2010), has become popular. AT-Cal only adjusts the scores and can therefore be applied to any speaker verification system. DT schemes that are specific to PLDA have also been proposed. A DT scheme that optimizes all the parameters of the PLDA LLR score function (Scr-UC)
                        1
                     
                     
                        1
                        UC refers to unconstrained.
                      was proposed by Burget et al. (2011) and Cumani et al. (2011) and a DT scheme that optimizes the PLDA model parameters instead of its score function, was proposed by Borgström and McCree (2013). However, DT is in general less robust against data insufficiency than GT. For example, in Cumani and Laface (2014), Scr-UC was worse than GT when the number of training speakers was less than around 1600. In this paper, we tackle the data insufficiency problem in two approaches. One is to effectively use the limited amount of training data. The other is to constrain the model parameters to avoid overfitting.

When the amount of training data is limited, each training utterance or speaker is often used in more than one training trial in the model training. Accordingly, the training trials are not statistically independent. As a consequence, the average loss of the training trials that we use as training objective is not the best estimate of the expected loss. We propose to adjust the weights of the training trials in order to obtain the best linear unbiased estimator (BLUE) of the expected loss.

In order to find the constraints that best avoid overfitting without constraining the model too much, we propose three discriminative training schemes that are less constrained than Src-UC (Burget et al., 2011; Cumani et al., 2011) but more flexible than AT-Cal (Brümmer, 2010). The first is a transformation of the PLDA LLR score function having four parameters. The second is a scaling of each element in the i-vectors. The third is a training scheme that, like Src-UC, updates all parameters of the PLDA LLR score function but preserves some properties of PLDA that are removed by Scr-UC (Rohdin et al., 2014a). Experiments on the male telephone part of the NIST SRE 2010 confirmed the effectiveness of our proposed techniques.

The remainder of this paper is organized as follows. Section 2 introduces the necessary background including the detection cost function, i-vector and PLDA based speaker-verification and discriminative PLDA training. Section 3 performs an analysis of the discriminative training methods. Based on the conclusions in Section 3, Section 4 presents the compensation for the statistical dependence, and Section 5 presents constrained discriminative PLDA training. Section 6 experimentally evaluates the methods. Finally, Section 7 concludes this paper.

@&#BACKGROUND@&#

When making a decision based on the score from a speaker verification system, it is typically desired to minimize the expected cost of the decision. This is reflected in the detection cost function (DCF) used in the NIST evaluations. When the test and enrollment utterances in a trial are from the same speaker, we refer to the trial as a target trial, otherwise we refer to it as a non-target trial. The DCF measures the cost for an application with a prior probability of a target trial, P
                        tar, and the costs C
                        FR and C
                        FA for false rejection (FR) and false acceptance (FA) respectively.


                        
                           
                              (1)
                              
                                 DCF
                                 =
                                 
                                    P
                                    tar
                                 
                                 
                                    C
                                    FR
                                 
                                 
                                    P
                                    FR
                                 
                                 +
                                 (
                                 1
                                 −
                                 
                                    P
                                    tar
                                 
                                 )
                                 
                                    C
                                    FA
                                 
                                 
                                    P
                                    FA
                                 
                                 ,
                              
                           
                        where P
                        FR
                        =
                        P(error∣target) and P
                        FA
                        =
                        P(error∣non−target) are the empirical probabilities for FR and FA respectively estimated in the evaluation database. For the purpose of ranking systems, a scaling of the DCF does not make any difference. Therefore, for system optimization it is equivalent to use


                        
                           
                              (2)
                              
                                 
                                    DCF
                                    ′
                                 
                                 =
                                 
                                    P
                                    eff
                                 
                                 
                                    P
                                    FR
                                 
                                 +
                                 (
                                 1
                                 −
                                 
                                    P
                                    eff
                                 
                                 )
                                 
                                    P
                                    FA
                                 
                                 ,
                              
                           
                        where


                        
                           
                              (3)
                              
                                 
                                    P
                                    eff
                                 
                                 =
                                 
                                    
                                       
                                          P
                                          tar
                                       
                                       
                                          C
                                          FR
                                       
                                    
                                    
                                       
                                          P
                                          tar
                                       
                                       
                                          C
                                          FR
                                       
                                       +
                                       (
                                       1
                                       −
                                       
                                          P
                                          tar
                                       
                                       )
                                       
                                          C
                                          FA
                                       
                                    
                                 
                                 ,
                              
                           
                        is known as the effective prior. In order to minimize the DCF, the decision threshold for the LLR score should be set to


                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          =
                                          −
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         
                                                            P
                                                            tar
                                                         
                                                      
                                                      
                                                         1
                                                         −
                                                         
                                                            P
                                                            tar
                                                         
                                                      
                                                   
                                                   +
                                                   log
                                                   
                                                      
                                                         
                                                            C
                                                            FR
                                                         
                                                      
                                                      
                                                         
                                                            C
                                                            FA
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          −
                                          log
                                          
                                             
                                                
                                                   P
                                                   eff
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   P
                                                   eff
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        Therefore, if the speaker verification system outputs scores that can be interpreted as LLRs, the threshold can easily be obtained for any P
                        eff. The cost obtained by using τ as the decision threshold is called the actual detection cost (actDCF) and the cost obtained by the optimal threshold for the evaluation set, is called the minimum detection cost (minDCF). If actDCF and minDCF are similar, we say that the LLR scores are well calibrated for the particular P
                        eff.

In the i-vector system (Dehak et al., 2011), it is assumed that the features from an utterance are generated by a Gaussian Mixture Model (GMM). It is further assumed that the GMM-supervector, 
                           μ
                        , corresponding to an utterance can be modeled as


                        
                           
                              (5)
                              
                                 
                                    
                                       μ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                             ¯
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                 
                                 ,
                              
                           
                        where 
                           ϕ
                         is a random vector, 
                           T
                         is a basis matrix for the total variability space, and 
                           
                              
                                 
                                    μ
                                    ¯
                                 
                              
                           
                         is the mean of 
                           μ
                        . It is assumed that 
                           ϕ
                         follows a standard normal distribution and its dimension, d, i.e., the rank of 
                           T
                        , is lower than the dimension of 
                           μ
                        . Given the speech features of an utterance, the i-vector, 
                           ω
                        , is the maximum a posteriori estimate of 
                           ϕ
                        .

An i-vector contains information related to the speaker identity as well as irrelevant channel factors such as the speaker's emotions, transmission channels, language, and environmental noise. Channel factors should be removed in order to improve the accuracy of verification. Currently, PLDA has become one of the state-of-the-art channel compensation techniques in i-vector based speaker verification (Kenny, 2010).

PLDA was originally proposed in image processing for object/face recognition (Ioffe, 2006; Prince and Elder, 2007). Kenny (2010) proposed to use it in speaker verification with i-vectors as features. In its most general form, PLDA assumes that the feature vectors (i-vectors), 
                           ω
                        , are generated as:


                        
                           
                              (6)
                              
                                 
                                    
                                       ω
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                 
                                 
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       U
                                    
                                 
                                 
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       D
                                    
                                 
                                 
                                    
                                       z
                                    
                                 
                                 ,
                              
                           
                        where 
                           m
                         is the mean of 
                           ω
                        , 
                           y
                         is a random vector depending on the class, and, 
                           x
                         and 
                           z
                         are random vectors depending on the channel, i.e., they are different from session to session. Contrary to the GMM-supervector, the i-vector is observed, which means that 
                           U
                         and 
                           D
                         must together span the full i-vector space. Two different PLDA configurations are popular. The configuration suggested by Prince and Elder (2007) constrains both 
                           V
                         and 
                           U
                         to have a rank lower than d, and 
                           D
                         to be diagonal. This configuration is suitable for large d. This PLDA model is very similar to joint factor analysis (JFA) (Kenny, 2005; Kenny et al., 2007). The configuration suggested by Ioffe (2006) skips 
                           U
                         but puts no constraints on 
                           D
                        , i.e.,


                        
                           
                              (7)
                              
                                 
                                    
                                       ω
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                 
                                 
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       D
                                    
                                 
                                 
                                    
                                       z
                                    
                                 
                                 .
                              
                           
                        This is the most popular configuration in speaker verification (Kenny, 2010; Brümmer and de Villiers, 2010) and we will use it in this study. The speaker matrix, 
                           V
                        , may have a rank lower than d (Kenny, 2010), or equal to d (Brümmer and de Villiers, 2010) in which case the model is known as the two-covariance model.

The original PLDA model (Ioffe, 2006; Prince and Elder, 2007) assumes 
                           y
                        , 
                           x
                         and 
                           z
                         follow Gaussian distribution (G-PLDA). However, the elements of the i-vector are, in reality, more heavy-tailed than the Gaussian distribution. Therefore, an extension named heavy-tailed PLDA (HT-PLDA), based on t-distributions, has been proposed (Kenny, 2010). HT-PLDA has much better performance than G-PLDA but is much slower both in the training and the testing phase. Later, normalizing the i-vectors to unit length, was shown to greatly improve the Gaussianity of the i-vectors so that G-PLDA provides similar performance as HT-PLDA (Garcia-Romero and Espy-Wilson, 2011). From here on, we only consider G-PLDA and refer to it as PLDA.

Given two i-vectors, 
                           ω
                        
                        
                           
                              i
                           
                         and 
                           ω
                        
                        
                           
                              j
                           
                        , the LLR score is given by


                        
                           
                              (8)
                              
                                 
                                    s
                                    ij
                                 
                                 =
                                 log
                                 
                                    
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                      
                                                   
                                                
                                                ∣
                                                
                                                   H
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                      
                                                   
                                                
                                                ∣
                                                
                                                   H
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where the hypotheses 
                           
                              H
                              s
                           
                         and 
                           
                              H
                              d
                           
                         are the following:
                           
                              
                                 
                                    
                                       H
                                       s
                                    
                                 :
                              
                                 
                                    ω
                                 
                                 
                                    
                                       i
                                    
                                  and 
                                    ω
                                 
                                 
                                    
                                       j
                                    
                                  are from the same speaker.


                                 
                                    ω
                                 
                                 
                                    
                                       i
                                    
                                  and 
                                    ω
                                 
                                 
                                    
                                       j
                                    
                                  are from different speakers.


                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         V
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                      
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where the speaker factors, 
                           y
                        
                        
                           i
                         and 
                           y
                        
                        
                           j
                         are the same in a target trial but different in a non-target trial. Accordingly, 
                           
                              
                                 [
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    i
                                    T
                                 
                                 
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    j
                                    T
                                 
                                 ]
                              
                              T
                           
                         follows a multivariate normal distribution. Calculating the mean and covariance of an i-vector pair in a target and a non-target trial based on Eq. (9) and plugging the resulting multivariate normal distributions into Eq. (8) results in a closed-form expression of the LLR given by


                        
                           
                              (10)
                              
                                 
                                    s
                                    ij
                                 
                                 =
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                    T
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    T
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                    T
                                 
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    T
                                 
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ω
                                             
                                          
                                          
                                             
                                                j
                                             
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 
                                    
                                       c
                                    
                                 
                                 +
                                 k
                                 ,
                              
                           
                        where


                        
                           
                              (11)
                              
                                 
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    Σ
                                    ac
                                 
                                 
                                    
                                       (
                                       
                                          Σ
                                          tot
                                       
                                       −
                                       
                                          Σ
                                          ac
                                       
                                       
                                          Σ
                                          tot
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          Σ
                                          ac
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       Q
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       
                                          Σ
                                          tot
                                       
                                       −
                                       
                                          Σ
                                          ac
                                       
                                       
                                          Σ
                                          tot
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          Σ
                                          ac
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       c
                                    
                                 
                                 =
                                 −
                                 2
                                 (
                                 
                                    
                                       P
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                 
                                 )
                                 
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 k
                                 =
                                 
                                    1
                                    2
                                 
                                 (
                                 log
                                 |
                                 
                                    
                                       Σ
                                       tot
                                    
                                 
                                 |
                                 −
                                 log
                                 |
                                 
                                    
                                       Σ
                                       tot
                                    
                                    −
                                    
                                       Σ
                                       ac
                                    
                                    
                                       Σ
                                       tot
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       Σ
                                       ac
                                    
                                 
                                 |
                                 )
                                 +
                                 
                                    
                                       
                                          m
                                       
                                    
                                    T
                                 
                                 2
                                 (
                                 
                                    
                                       P
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                 
                                 )
                                 
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        and Σac
                        =
                        
                           VV
                        
                        
                           T
                         and Σtot
                        =
                        
                           VV
                        
                        
                           T
                        
                        +
                        
                           DD
                        
                        
                           T
                        . Let 
                           
                              
                                 γ
                              
                           
                           =
                           
                              
                                 [
                                 vec
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 ,
                                 vec
                                 
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 ,
                                 
                                    
                                       
                                          c
                                       
                                    
                                    T
                                 
                                 ,
                                 k
                                 ]
                              
                              T
                           
                        , where vec(·) stacks the columns of a matrix into a column vector, and let


                        
                           
                              (15)
                              
                                 φ
                                 (
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    i
                                 
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    j
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   vec
                                                   (
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                      T
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                      T
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   vec
                                                   (
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                      T
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                      T
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      i
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Then Eq. (10) can be rewritten as (Burget et al., 2011; Cumani et al., 2011)


                        
                           
                              (16)
                              
                                 
                                    s
                                    ij
                                 
                                 =
                                 
                                    
                                       
                                          γ
                                       
                                    
                                    T
                                 
                                 φ
                                 (
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    i
                                 
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    j
                                 
                                 )
                                 .
                              
                           
                        In other words, the PLDA LLR score is a linear function of a non-linear feature expansion φ(
                           ω
                        
                        
                           i
                        , 
                           ω
                        
                        
                           j
                        ) of the two i-vectors.

Typically, the PLDA parameters are estimated by the generative maximum likelihood (ML) criterion.

As mentioned in the previous subsection, normalizing the i-vectors to unit length improves their Gaussianity and substantially improves the performance of PLDA. However, even with length normalization, it is clear that there is still a mismatch between the model assumptions and the training data. Obviously a PLDA model cannot generate i-vectors of a fixed length. Further, it has been shown that for length-normalized i-vectors, the within-class covariance depends strongly on the speaker factors (Bousquet et al., 2014), whereas PLDA assumes the within-class covariance is independent of the speaker factors. If the model assumptions are not accurate, we cannot expect the parameters obtained by GT to be optimal neither for discriminating between speakers nor for providing well-calibrated LLR scores. Therefore, it might be better to use a DT criterion that directly optimizes the model for providing accurate LLR scores.

Discriminative training has been proven very effective for score calibration and fusion (Brümmer et al., 2007; Brümmer, 2010) based on affine functions. Given the scores s
                        1, …, s
                        
                           n
                         from n different systems, the fused and/or calibrated score is given by


                        
                           
                              (17)
                              
                                 s
                                 =
                                 
                                    w
                                    0
                                 
                                 +
                                 
                                    w
                                    1
                                 
                                 
                                    s
                                    1
                                 
                                 +
                                 …
                                 +
                                 
                                    w
                                    n
                                 
                                 
                                    s
                                    n
                                 
                                 ,
                              
                           
                        where the parameters 
                           
                              
                                 w
                              
                           
                           =
                           [
                           
                              w
                              0
                           
                           ,
                           …
                           ,
                           
                              w
                              n
                           
                           ]
                         need to be estimated. Let t
                        
                           h
                        
                        ∈[−1, 1] be the label of trial h, i.e., it equals 1 if the two utterances are from the same speaker and -1 otherwise. Then 
                           
                              w
                           
                         can be estimated by minimizing the loss, 
                           
                              l
                              ¯
                           
                           (
                           
                              
                                 w
                              
                           
                           )
                        ,


                        
                           
                              (18)
                              
                                 
                                    l
                                    ¯
                                 
                                 (
                                 
                                    
                                       w
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       1
                                    
                                 
                                 
                                    
                                       
                                          P
                                          eff
                                       
                                    
                                    
                                       
                                          N
                                          1
                                       
                                    
                                 
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             h
                                          
                                          ,
                                          
                                             s
                                             h
                                          
                                          (
                                          
                                             
                                                w
                                             
                                          
                                          )
                                          ,
                                          τ
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          P
                                          eff
                                       
                                    
                                    
                                       
                                          N
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             h
                                          
                                          ,
                                          
                                             s
                                             h
                                          
                                          (
                                          
                                             
                                                w
                                             
                                          
                                          )
                                          ,
                                          τ
                                       
                                    
                                 
                                 ,
                              
                           
                        where N
                        1 and N
                        −1 are the numbers of target and non-target trials respectively, and 
                           l
                           
                              
                                 
                                    
                                       t
                                       h
                                    
                                    ,
                                    
                                       s
                                       h
                                    
                                    (
                                    
                                       
                                          w
                                       
                                    
                                    )
                                    ,
                                    τ
                                 
                              
                           
                         is a loss function for a trial. In this study, we follow Brümmer et al. (2007) and use the logistic regression loss function given by


                        
                           
                              (19)
                              
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             h
                                          
                                          ,
                                          
                                             s
                                             h
                                          
                                          (
                                          
                                             
                                                w
                                             
                                          
                                          )
                                          ,
                                          τ
                                       
                                    
                                 
                                 =
                                 log
                                 
                                    
                                       
                                          1
                                          +
                                          exp
                                          (
                                          −
                                          
                                             t
                                             h
                                          
                                          (
                                          
                                             s
                                             h
                                          
                                          (
                                          
                                             
                                                w
                                             
                                          
                                          )
                                          −
                                          τ
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        This loss function encourages both good calibration and discrimination (Brümmer and du Preez, 2006). See Brümmer and Doddington (2013) for a comparison of different such loss functions. With n
                        =1, we obtain an affine transformation of the scores which has become the standard approach for calibration (Brümmer et al., 2007; Brümmer, 2010). We refer to this method as AT-Cal. An affine transformation results in a very constrained update of the score function that cannot increase the system's ability to discriminate between target and non-target trials, i.e., to reduce minDCF. On the other hand it can substantially improve calibration, even with quite small amounts of data.


                        Burget et al. (2011) and Cumani et al. (2011) proposed to optimize the parameters 
                           γ
                         in Eq. (16), by minimizing the loss in Eq. (18) where s
                        
                           h
                         is a function of 
                           γ
                         instead of 
                           
                              w
                           
                        . Both the logistic regression loss in Eq. (19) and the SVM hinge loss were evaluated. In these studies, all possible i-vector pairs (typically some hundred millions) were used for training, and efficient calculations of the total loss and its gradient with respect to 
                           γ
                         were presented. However, this method easily overfits to the training data due to the large number of parameters to be estimated. We refer to this method as Scr-UC, where UC refers to unconstrained. Scr-UC is similar to a DT scheme for JFA, proposed by Burget et al. (2008).


                        Borgström and McCree (2013) considered discriminative PLDA training with multiple enrollment sessions. The proposed training scheme applies DT to the model parameters, 
                           m
                        , 
                           V
                         and 
                           D
                        , rather than the parameters of the LLR score function. The training trials were from either single or multiple enrollment sessions. Only the eigenvalues (which were floored to be positive) or a scaling factor of the covariance matrices were updated by DT. The number of parameters to be estimated are therefore much fewer than in Scr-UC, which reduces the risk of over-training.

While GT uses utterances as observations and the speaker IDs as classes, DT aims directly at improving the LLR score and uses trials as observations and same or different speaker as classes. The trials need to be constructed from the available training data, ideally over all possible trials. However, when a training utterance (or just the same speaker) is used in more than one trial, the trials will be statistically dependent. Further, when the parameters 
                           γ
                         are optimized directly, rather than the original PLDA model parameters, 
                           m
                        , 
                           V
                         and 
                           D
                        , we may obtain a model with different properties than a PLDA model. Optimizing the parameters 
                           m
                        , 
                           V
                         and 
                           D
                         preserves the properties of the PLDA model but is more difficult due to the complex relation between these parameters and 
                           P
                        , 
                           Q
                        , 
                           c
                         and k, given by Eqs. (11)–(14). These issues will be analyzed in the following section.

In this section we carry out two analyses:
                        
                           1.
                           What is the effect of using statistically dependent trials in DT?

What is the effect of training the parameters of the PLDA LLR score directly instead of training the original parameters of the PLDA model?

Analysis 1 leads us to propose a compensation for the statistical dependence in Section 4. Analysis 2 motivates us to propose one of the constrained DT schemes in Section 5. In the remainder of this paper, 
                        θ
                      denotes the parameters to be estimated by DT (e.g., 
                        
                           w
                        
                      in AT-Cal or 
                        γ
                      in Scr-UC).

In this subsection we discuss how DT is affected by the use of statistically dependent trials. We argue that using an equal weight for all target trials and another equal weight for all non-target trials in the training objective is not optimal when the trials are statistically dependent. For example, consider the correlations due the same speakers being used in many training trials. If each trial has equal weight, speakers with many trials will influence the model more than speakers with few trials. In order to avoid this speaker dependency in the model and make it good for the general population, the weights for speakers with many trials need to be reduced. The remaining discussion in this subsection does not consider the reason for the statistical dependencies. In Section 4 we show how to apply the principles discussed in this subsection specifically to the statistical dependencies that arise when all possible training trials are used, i.e., the same speakers and utterances are used in more than one training trial.

A trial consists of a label T
                        ∈[1, −1] and two i-vectors 
                           ω
                        
                        
                           i
                         and 
                           ω
                        
                        
                           j
                        . Here, we use upper case letters to denote that we treat these variables as random variables. We collect the i-vector pair of a trial in a vector denoted 
                           
                              
                                 
                                    ω
                                 
                              
                              
                                 (
                                 p
                                 )
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    i
                                    T
                                 
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    j
                                    T
                                 
                                 ]
                              
                              T
                           
                        . The loss of a trial, L(
                           θ
                        )=
                        l(T, s(
                           θ
                        , 
                           ω
                        
                        (p))), is then also a random variable. The training trials are observations of these random variables. Analogously, we use 
                           
                              l
                              ¯
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         to denote the average loss of an observed set of training trials as in Eq. (18), and 
                           
                              L
                              ¯
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         to be the corresponding random variable, i.e., the average loss of a set of trials treated as random variables. The expected loss of a single trial is given by


                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                T
                                                ,
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                          
                                          L
                                          (
                                          
                                             
                                                θ
                                             
                                          
                                          )
                                       
                                       
                                          =
                                          
                                             E
                                             
                                                T
                                                ,
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                          
                                          (
                                          l
                                          (
                                          
                                             
                                                θ
                                             
                                          
                                          ,
                                          T
                                          ,
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                          )
                                          )
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             ∑
                                             
                                                T
                                                =
                                                −
                                                1
                                                ,
                                                1
                                             
                                          
                                          P
                                          (
                                          T
                                          )
                                          
                                             ∫
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                   
                                                   
                                                      2
                                                      d
                                                   
                                                
                                             
                                          
                                          l
                                          (
                                          T
                                          ,
                                          s
                                          (
                                          
                                             
                                                θ
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                          )
                                          )
                                          P
                                          (
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                          ∣
                                          T
                                          )
                                          
                                             d
                                             
                                                2
                                                d
                                             
                                          
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where P(T
                        =1)=
                        P
                        eff, P(T
                        =−1)=1−
                        P
                        eff and P(
                           ω
                        
                        (p)
                        ∣
                        T) is the probability density function for the i-vector pair conditioned on the trial label. Discriminative training aims to find the 
                           θ
                         that minimizes 
                           
                              E
                              
                                 T
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                              
                           
                           (
                           L
                           (
                           
                              
                                 θ
                              
                           
                           )
                           )
                         by minimizing 
                           
                              l
                              ¯
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                        . In order for this approach to be successful, 
                           
                              L
                              ¯
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         must be a good estimator of 
                           
                              E
                              
                                 T
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                              
                           
                           (
                           L
                           (
                           
                              
                                 θ
                              
                           
                           )
                           )
                         for each value of 
                           θ
                        .

Let us generalize the DT objective as
                           
                              (21)
                              
                                 
                                    L
                                    ˆ
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          P
                                          ˜
                                       
                                    
                                    eff
                                 
                                 
                                    
                                       
                                          L
                                          ˆ
                                       
                                    
                                    1
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       
                                          P
                                          ˜
                                       
                                    
                                    eff
                                 
                                 )
                                 
                                    
                                       
                                          L
                                          ˆ
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           0
                           ≤
                           
                              
                                 
                                    P
                                    ˜
                                 
                              
                              eff
                           
                           ≤
                           1
                        ,


                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          L
                                          ˆ
                                       
                                    
                                    1
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       1
                                    
                                 
                                 
                                    β
                                    h
                                 
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             h
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             h
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          L
                                          ˆ
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       −
                                       1
                                    
                                 
                                 
                                    β
                                    h
                                 
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             h
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             h
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and


                        
                           
                              (24)
                              
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       1
                                    
                                 
                                 
                                    β
                                    h
                                 
                                 =
                                 
                                    ∑
                                    
                                       h
                                       :
                                       
                                          t
                                          h
                                       
                                       =
                                       −
                                       1
                                    
                                 
                                 
                                    β
                                    h
                                 
                                 =
                                 1
                                 .
                              
                           
                        Here 
                           
                              
                                 
                                    L
                                    ˆ
                                 
                              
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         and 
                           
                              
                                 
                                    L
                                    ˆ
                                 
                              
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         are estimators of the expected loss of a target and non-target trial respectively, and β
                        
                           h
                         is the weight for trial h. The expected loss of a trial with label 
                           t
                           ,
                           
                              E
                              
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                                 ∣
                                 t
                              
                           
                           (
                           L
                           (
                           
                              
                                 θ
                              
                           
                           )
                           )
                        , is not affected by the fact that the trials are statistically dependent. As long as Eq. (24) is fulfilled, 
                           
                              
                                 
                                    P
                                    ˜
                                 
                              
                              eff
                           
                           =
                           
                              P
                              eff
                           
                         therefore gives an unbiased estimate of the expected loss, 
                           
                              E
                              
                                 T
                                 ,
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                              
                           
                           (
                           L
                           (
                           
                              
                                 θ
                              
                           
                           )
                           )
                         (for any 
                           θ
                        ). In addition, we propose to adjust the trial weights, β
                        
                           h
                        , so that the variances of 
                           
                              
                                 
                                    L
                                    ˆ
                                 
                              
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         and 
                           
                              
                                 
                                    L
                                    ˆ
                                 
                              
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         is minimized. This gives the best linear unbiased estimator (BLUE) (Kay, 1993, ch. 6) of the expected loss. From here on, we use t
                        ∈[−1, 1] also as a suffix to indicate target or non-target trial. Let the i-vector pairs, 
                           
                              
                                 
                                    ω
                                 
                              
                              h
                              
                                 (
                                 p
                                 )
                              
                           
                        , of the training trials with label t be collected in a vector 
                           
                              
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    →
                                 
                              
                              t
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 2
                                 
                                    dN
                                    t
                                 
                              
                           
                        . Further, let the weights for the corresponding trials be collected in a vector 
                           
                              
                                 
                                    β
                                 
                              
                              t
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 
                                    N
                                    t
                                 
                              
                           
                        , and let 
                           
                              Σ
                              t
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 
                                    N
                                    t
                                 
                                 ×
                                 
                                    N
                                    t
                                 
                              
                           
                         be the covariance matrix for the losses of these trials.
                           2
                        
                        
                           2
                           For simplicity, we do not consider the statistical dependencies between a target trial and a non-target trial in this study.
                         Then, 
                           var
                           
                              
                                 
                                    
                                       
                                          
                                             L
                                             ˆ
                                          
                                       
                                       t
                                    
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      →
                                                   
                                                
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                         is given by


                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Ω
                                                               →
                                                            
                                                         
                                                      
                                                   
                                                   t
                                                
                                                ∣
                                                
                                                   I
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                               ˆ
                                                            
                                                         
                                                         t
                                                      
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ω
                                                                  
                                                               
                                                               →
                                                            
                                                         
                                                         t
                                                      
                                                      )
                                                      −
                                                      
                                                         E
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Ω
                                                                           →
                                                                        
                                                                     
                                                                  
                                                               
                                                               t
                                                            
                                                            ∣
                                                            
                                                               I
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                               ˆ
                                                            
                                                         
                                                         t
                                                      
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ω
                                                                  
                                                               
                                                               →
                                                            
                                                         
                                                         t
                                                      
                                                      )
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             E
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Ω
                                                               →
                                                            
                                                         
                                                      
                                                   
                                                   t
                                                
                                                |
                                                
                                                   I
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            h
                                                            :
                                                            
                                                               t
                                                               h
                                                            
                                                            =
                                                            t
                                                         
                                                      
                                                      
                                                         β
                                                         h
                                                      
                                                      l
                                                      
                                                         
                                                            
                                                               t
                                                               ,
                                                               
                                                                  
                                                                     θ
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        ω
                                                                     
                                                                  
                                                                  h
                                                                  
                                                                     (
                                                                     p
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         E
                                                         
                                                            
                                                               
                                                                  
                                                                     ω
                                                                  
                                                               
                                                               
                                                                  (
                                                                  p
                                                                  )
                                                               
                                                            
                                                            ∣
                                                            t
                                                         
                                                      
                                                      L
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     θ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                
                                                   β
                                                
                                             
                                             t
                                             T
                                          
                                          
                                             Σ
                                             t
                                          
                                          
                                             
                                                
                                                   β
                                                
                                             
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              I
                              t
                           
                         denotes any information about how 
                           
                              
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    →
                                 
                              
                              t
                           
                         is generated that affects Σ
                           t
                        .

Previous studies have set β
                        
                           h
                         to 1/N
                        1 for the target trials and 1/N
                        −1 for the non-target trials. From Eq. (25) it is clear that when Σ
                           t
                         is diagonal whose all elements are equal, this choice of β
                        
                           h
                         is optimal and results in the well-known formula for the variance of the sample mean of IID variables. However, when the trials are correlated, this choice of β
                        
                           h
                         is not optimal. By using a Lagrange multiplier to enforce the constraint in Eq. (24) it can be shown that, as long as Σ
                           t
                         is non-singular,
                           3
                        
                        
                           3
                           A singular Σ would mean that the losses of two trials have correlation 1 or that the variance of a trial loss is 0. These are not realistic scenarios.
                         the minimizer is given by,
                           
                              (26)
                              
                                 
                                    
                                       
                                          β
                                       
                                    
                                    t
                                 
                                 =
                                 
                                    
                                       
                                          Σ
                                          t
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                             
                                          
                                          T
                                       
                                       
                                          Σ
                                          t
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           1
                         is a column-vector of length N
                        
                           t
                         whose all elements equal 1.

According to Eq. (26), the optimal 
                           β
                        
                        
                           t
                         is not affected by a scaling of the covariance matrices. Since all target/non-target trial losses have the same variance, we therefore only need to know the correlation between the trials. We denote the correlation matrices 
                           
                              
                                 
                                    R
                                 
                              
                              t
                           
                           =
                           
                              Σ
                              t
                           
                           /
                           
                              v
                              t
                           
                        , where 
                           
                              v
                              1
                           
                         and 
                           
                              v
                              
                                 −
                                 1
                              
                           
                         are the variances for the target and non-target trial losses respectively. These correlation matrices have one entry per observation, In order to estimate them, it is therefore necessary to impose a structure on them so that they depend on a small number of parameters. In Section 4, we propose how to do this for the correlations that arise from using the same speakers and utterances in several training trials.

It should be noticed that same results can be obtained by regarding the trial losses 
                           
                              
                                 
                                    l
                                 
                              
                              t
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                           =
                           
                              
                                 [
                                 
                                    l
                                    1
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    l
                                    
                                       
                                          N
                                          t
                                       
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 ]
                              
                              T
                           
                         as one multivariate observation following normal distribution with mean 
                           η
                        
                        =[η, …, η]
                           T
                         and covariance matrix Σ
                           t
                         and then using the ML estimate of η as loss estimator, i.e.,


                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                ˆ
                                             
                                             t
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                          
                                          )
                                       
                                       
                                          =
                                          arg
                                          
                                             max
                                             η
                                          
                                          
                                             1
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            2
                                                            π
                                                            )
                                                         
                                                         
                                                            
                                                               N
                                                               t
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            Σ
                                                            t
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   −
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                         )
                                                         −
                                                         
                                                            
                                                               η
                                                            
                                                         
                                                         )
                                                      
                                                      T
                                                   
                                                   
                                                      Σ
                                                      t
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         l
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   )
                                                   −
                                                   
                                                      
                                                         η
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   l
                                                
                                             
                                             t
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   Σ
                                                   t
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   T
                                                
                                                
                                                   Σ
                                                   t
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Scr-UC optimizes the parameters of LLR score, 
                           
                              
                                 γ
                              
                           
                           =
                           
                              
                                 [
                                 vec
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 ,
                                 vec
                                 
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 ,
                                 
                                    
                                       
                                          c
                                       
                                    
                                    T
                                 
                                 ,
                                 k
                                 ]
                              
                              T
                           
                        , directly, whereas the DT scheme proposed in Borgström and McCree (2013) optimizes the parameters of the PLDA model, 
                           m
                        , 
                           V
                         and 
                           D
                        . The discriminative training objective in Eq. (18) depends on the scores, s
                        
                           h
                        , of the training trials. Since the scores according to Eq. (16) are given by a linear function of 
                           γ
                        , direct optimization of 
                           γ
                         is most straight-forward. However, if no constraints are imposed on 
                           γ
                        , this may result in a model with different properties than a PLDA model. The matrices 
                           P
                         and 
                           Q
                         depends on the PLDA between-class covariance matrix, 
                           VV
                        
                        
                           T
                        , and the within-class covariance matrix, 
                           DD
                        
                        
                           T
                        , according to Eqs. (11) and (12). It is however not immediately apparent what constraints that follows on 
                           γ
                        . In this subsection, the constraints on 
                           γ
                         are presented, as well as an analysis of their impact on the model. The discussion here is similar to the one in Rohdin et al. (2014a).

The matrices, 
                           P
                         and 
                           Q
                        , are symmetric and have the same rank as 
                           V
                         (Garcia-Romero and Espy-Wilson, 2011). In addition, it can be shown based on Eqs. (11) and (12), that the matrices, 
                           P
                         and 
                           Q
                        , are constrained as follows:
                           
                              1.
                              
                                 
                                    P
                                  is positive-(semi)definite.


                                 
                                    Q
                                  is negative-(semi)definite.


                                 
                                    P
                                 
                                 +
                                 
                                    Q
                                  is positive-(semi)definite.

Scr-UC preserves the symmetry of 
                           P
                         and 
                           Q
                         but relaxes the definiteness constraints. In the remainder of this subsection, the effects of these constraints on the model are analyzed. In Section 6, the impact of the constraints is evaluated experimentally.

The first constraint leads to a directional property. Consider an i-vector, 
                           ω
                        , scored against both α
                        
                           ω
                         and −α
                        
                           ω
                        , where α is a positive constant. That is, in the first trial, 
                           ω
                         is scored against an i-vector pointing in same direction and, in the second trial it is scored against an i-vectors pointing in the opposite direction. Let s(
                           ω
                        
                        
                           i
                        , 
                           ω
                        
                        
                           j
                        )=
                        s
                        
                           ij
                         in Eq. (10). If the i-vectors are centered around 
                           m
                        , the difference between the scores of these two trials is


                        
                           
                              (28)
                              
                                 s
                                 (
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 α
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 −
                                 s
                                 (
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 −
                                 α
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 =
                                 4
                                 α
                                 
                                    
                                       
                                          
                                             ω
                                          
                                       
                                    
                                    T
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                 
                                 .
                              
                           
                        In other words, the score of the same direction trial will be guaranteed to be larger than the score of the different direction trial if and only if 
                           P
                         is positive definite.

The second constraint leads to a length property:
                           
                              (29)
                              
                                 s
                                 (
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 >
                                 s
                                 (
                                 α
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 
                                    1
                                    α
                                 
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 .
                              
                           
                        This property means that two i-vectors of equal length and direction will obtain a higher score than two i-vectors having just equal direction.

From the first and the second constraint, it follows directly that 
                           P
                        
                        −
                        
                           Q
                         is positive-definite. Together with the third constraint, this leads to the following properties:


                        
                           
                              (30)
                              
                                 s
                                 (
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 >
                                 s
                                 (
                                 
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (31)
                              
                                 s
                                 (
                                 
                                    
                                       ω
                                    
                                 
                                 ,
                                 −
                                 
                                    
                                       ω
                                    
                                 
                                 )
                                 <
                                 s
                                 (
                                 
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       0
                                    
                                 
                                 )
                                 .
                              
                           
                        This means that any two i-vectors pointing in the same direction obtain a higher score than any two i-vectors pointing in opposite direction. These two properties are therefore a stronger version of the directional property.

In Section 3.1, we showed that using an equal weight for all target trials and another equal weight for the non-target trials is typically not optimal when the trials are statistically dependent. We argued that it is preferable to adjust the weights of the trials to obtain the BLUE for the loss estimator, 
                        
                           
                              
                                 
                                    L
                                    ˆ
                                 
                              
                           
                        
                        (
                        
                           
                              θ
                           
                        
                        )
                     , and showed that in order to do this, we need to know the correlation between the losses of the training trials. In this section, we propose practical methods for weight-adjustment of training trials that are statistically dependent due to each speaker and utterance being used in more than one trial.

Let capital letters denote different speakers in our training data. Let N
                        
                           X
                         be the number of utterances of speaker X, X
                        
                           i
                         be the i-th utterance of this speaker, and l(X
                        
                           i
                        , Y
                        
                           j
                        , 
                           θ
                        ) be the loss for the trial involving utterance X
                        
                           i
                         and Y
                        
                           j
                        . We would like to make some assumptions about Σ1 and Σ−1 that allow us to calculate the optimal weights 
                           β
                        
                        
                           t
                         by means of Eq. (26). Since the optimal weight vector only depends on the correlation between the trial losses, we can let the variances of the trial losses be functions of 
                           θ
                        . However, if the correlation coefficients depend on 
                           θ
                        , the optimal weights will also depend on 
                           θ
                        . For simplicity, we therefore assume that the correlation coefficients do not depend on 
                           θ
                        , but only on what the trials have in common. For example, we assume:


                        
                           
                              (32)
                              
                                 corr
                                 
                                    
                                       
                                          l
                                          (
                                          
                                             A
                                             1
                                          
                                          ,
                                          
                                             A
                                             2
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                          
                                          )
                                          ,
                                          l
                                          (
                                          
                                             A
                                             1
                                          
                                          ,
                                          
                                             A
                                             3
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    c
                                    a
                                 
                                 ,
                              
                           
                        where the correlation coefficient, c
                        
                           a
                        , is the same for all target trial pairs that share one utterance. All the possible relations between two trials as well as the notation for the correlation coefficients are given in Table 1
                        . Notice that two trials that have nothing in common are statistically independent so that, e.g., 
                           corr
                           
                              
                                 
                                    l
                                    (
                                    
                                       A
                                       1
                                    
                                    ,
                                    
                                       A
                                       2
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                    
                                    )
                                    ,
                                    l
                                    (
                                    
                                       B
                                       1
                                    
                                    ,
                                    
                                       B
                                       2
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           0
                        .

In this study, we use all the trials that can be constructed from the training data except those where both the utterances are the same. Under the assumptions given in the previous paragraph, the optimal weight for each target trial of speaker A is then given by (see Appendix B.1 for proof)


                        
                           
                              (33)
                              
                                 
                                    β
                                    A
                                 
                                 =
                                 
                                    
                                       
                                          k
                                          1
                                       
                                    
                                    
                                       1
                                       +
                                       2
                                       (
                                       
                                          N
                                          A
                                       
                                       −
                                       2
                                       )
                                       
                                          c
                                          a
                                       
                                       +
                                       (
                                       
                                          N
                                          A
                                       
                                       −
                                       2
                                       )
                                       (
                                       
                                          N
                                          A
                                       
                                       −
                                       3
                                       )
                                       
                                          c
                                          b
                                       
                                       /
                                       2
                                    
                                 
                                 ,
                              
                           
                        where k
                        1 is set so that the sum of the weights equals 1. Since we do not use target trials where both the utterances are the same, a speaker with only one utterance is never used for target trials, i.e., N
                        
                           A
                        
                        =1 is never used in the above formula. For a speaker with two utterances, there is only one unique target trial so the second and third term in the denominator will be 0. For a speaker with three utterances, we can construct two trials with one shared utterance but not two trials with no shared utterances. In this case, the third term in the denominator will be 0. Notice that if all correlations equals 0, or if each speaker has the same number of utterances, each trial will obtain the same weight. If all correlations equal 1, each speaker will obtain the same weight.

In order to derive the weights for the non-target trials, we do some approximations. The approximately optimal weight for each non-target trial of speaker A and B, is then


                        
                           
                              (34)
                              
                                 
                                    β
                                    AB
                                 
                                 ≈
                                 
                                    
                                       
                                          k
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          W
                                          AB
                                       
                                    
                                 
                              
                           
                        where k
                        −1 is set so that the sum of the weights equals 1 and,


                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             W
                                             AB
                                          
                                          =
                                       
                                       
                                          1
                                          +
                                          
                                             c
                                             
                                                −
                                                a
                                             
                                          
                                          (
                                          
                                             N
                                             A
                                          
                                          +
                                          
                                             N
                                             B
                                          
                                          −
                                          2
                                          )
                                       
                                    
                                    
                                       
                                       
                                          +
                                          
                                             c
                                             
                                                −
                                                b
                                             
                                          
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          1
                                          )
                                          (
                                          
                                             N
                                             B
                                          
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       
                                       
                                          +
                                          (
                                          2
                                          
                                             c
                                             
                                                −
                                                c
                                             
                                          
                                          +
                                          
                                             c
                                             
                                                −
                                                d
                                             
                                          
                                          (
                                          
                                             N
                                             A
                                          
                                          +
                                          
                                             N
                                             B
                                          
                                          −
                                          2
                                          )
                                          )
                                          
                                             ∑
                                             
                                                I
                                                ≠
                                                A
                                                ,
                                                B
                                             
                                          
                                          
                                             N
                                             I
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        The derivation including the approximations is given in Appendix B.2.

Ideally, we would have knowledge about c
                        
                           a
                        , c
                        
                           b
                        , c
                        −a
                        , c
                        −b
                        , c
                        −c
                         and c
                        −d
                        . In this study we explore two ways to find their values. The first is to approximate them with functions that depend on one tunable parameter. The second is to estimate them based on sample correlations in the training data.

Consider first the target trials. We assume that two target trials from the same speaker are correlated, and that two target trials where one utterance is the same are more correlated, so that 0≤
                           c
                           
                              b
                           
                           ≤
                           c
                           
                              a
                           
                           ≤1. In order to obtain only one parameter to tune we set


                           
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                c
                                                a
                                             
                                             =
                                             
                                                α
                                                1
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                c
                                                b
                                             
                                             =
                                             
                                                α
                                                1
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           where 0≤
                           α
                           1
                           ≤1 will be tuned. The weights according this formula for different values of α
                           1, are given in Fig. 1
                           .

Notice that, even for small values of α
                           1, the number of utterances of a speaker has large impact on the optimal weights for that speaker.

For the non-target trials, we can apply the same strategy, i.e., assume that a shared speaker makes the trials correlated and a shared utterance makes them more correlated. However, the relation between c
                           −b
                            and c
                           −c
                            is not clear. The former gives the correlation between non-target trial losses where both speakers are the same. The latter gives the correlation between non-target trial losses that has one common utterance. While it is clear that having one common utterance should give larger correlation than only having one common speaker, we cannot guess the relation between one same utterance and two same speakers. Therefore, we set


                           
                              
                                 (37)
                                 
                                    
                                       c
                                       
                                          −
                                          a
                                       
                                    
                                    =
                                    
                                       α
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       c
                                       
                                          −
                                          b
                                       
                                    
                                    =
                                    
                                       α
                                       
                                          −
                                          1
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                    
                                       c
                                       
                                          −
                                          c
                                       
                                    
                                    =
                                    
                                       α
                                       
                                          −
                                          1
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                    
                                       c
                                       
                                          −
                                          d
                                       
                                    
                                    =
                                    
                                       α
                                       
                                          −
                                          1
                                       
                                       3
                                    
                                    ,
                                 
                              
                           with 0≤
                           α
                           −1
                           ≤1. In this study, we will make a further simplification and set, α
                           1
                           =
                           α
                           −1, denoted α from here on. This parameter will be tuned on a development set which to some extent can compensate for inaccuracies introduced by our assumptions and approximations.

Let 
                              
                                 
                                    l
                                    ¯
                                 
                                 1
                              
                              (
                              
                                 
                                    θ
                                 
                              
                              )
                            and 
                              
                                 
                                    v
                                    ¯
                                 
                                 1
                              
                              (
                              
                                 
                                    θ
                                 
                              
                              )
                            be the sample mean and sample variance of the loss of the target trials for the parameter 
                              θ
                           . Given N
                           
                              a
                            target trial pairs with one utterance in common (see Table 1), we calculate the sample correlation for those trials as


                           
                              
                                 (38)
                                 
                                    
                                       
                                          c
                                          ¯
                                       
                                       a
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                v
                                                ¯
                                             
                                             1
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                          
                                          )
                                          
                                             N
                                             a
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                             a
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                             (
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                1
                                                
                                                   (
                                                   h
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                2
                                                
                                                   (
                                                   h
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   l
                                                   ¯
                                                
                                                1
                                             
                                             (
                                             
                                                
                                                   θ
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                             (
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                1
                                                
                                                   (
                                                   h
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                3
                                                
                                                   (
                                                   h
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   l
                                                   ¯
                                                
                                                1
                                             
                                             (
                                             
                                                
                                                   θ
                                                
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           The sample correlations for the other correlation coefficients are calculated analogously. Compared to the one-parameter model, this method makes fewer assumptions about the data. It relies on the assumption that the correlation coefficients are independent of 
                              θ
                            and the same for each trial of the same kind (as defined in Table 1). On the other hand, since the correlation coefficients are not tuned for performance, but to fit the data, this method may be more sensitive for incorrect model assumptions. For this method, we estimate the sample correlations based on trial losses calculated with the corresponding DT model without weight-adjustment.

In order to avoid overfitting, we would like to constrain the PLDA model during DT. One way to do this is to apply L2 regularization. Finding the right regularization is however difficult. Letting the regularization parameter be equal for all model parameters, as is typical, could be far from optimal. On the other hand, tuning many different regularization parameters is complicated. Similarly to Borgström and McCree (2013), we therefore propose several training schemes where a small number of parameters estimated by DT are used to adjust the model estimated by GT. This approach is in the spirit of AT-Cal but the training schemes we propose are less constrained. Based on the discussion in Section 3.2, we also propose a DT scheme that preserves the properties of 
                        P
                      and 
                        Q
                     . The gradients for the training schemes we propose can be derived based on the gradients for Scr-UC given in Cumani et al. (2011). These calculations are efficient enough for using all possible combinations of the training utterances as training data. The details of gradient calculations as well as the initializations are given in Appendix C.

As an option with 
                           O
                           (
                           1
                           )
                         parameters, we propose to scale each part of the PLDA LLR score function:


                        
                           
                              (39)
                              
                                 
                                    s
                                    ij
                                 
                                 =
                                 
                                    a
                                    P
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                    T
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 +
                                 
                                    a
                                    P
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    T
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 +
                                 
                                    a
                                    Q
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                    T
                                 
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 +
                                 
                                    a
                                    Q
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    T
                                 
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                 
                                 +
                                 
                                    a
                                    c
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ω
                                             
                                          
                                          
                                             
                                                j
                                             
                                          
                                       
                                       )
                                    
                                    T
                                 
                                 
                                    
                                       c
                                    
                                 
                                 +
                                 
                                    a
                                    k
                                 
                                 k
                                 ,
                              
                           
                        where a
                        P, a
                        Q, a
                        c and a
                        k are trained discriminatively. In other words, we let the discriminative training adjust the weight of each feature kind in the original model parameters. The definiteness properties 
                           P
                         and 
                           Q
                         given in Section 3.2 were, in our experiments, almost always satisfied by itself (see Section 6.4), so we did not add any other constraints for this purpose. We refer to this method as Scr-4par. It should be noted that if a
                        P
                        =
                        a
                        Q
                        =
                        a
                        c in Eq. (39), we obtain AT-Cal.

As an option with 
                           O
                           (
                           d
                           )
                         parameters, we propose to scale all the elements of the i-vector. Either one scaling for each of 
                           P
                        , 
                           Q
                         and 
                           c
                        , or a common scaling can be used. In either case, we use a scaling of k. Accordingly this gives 3d
                        +1 or d
                        +1 parameters to be estimated. In this study, we use the latter and refer to it as iV-elmnt. Another natural option with 
                           O
                           (
                           d
                           )
                         parameters is to scale the eigenvalues of 
                           P
                         and 
                           Q
                        , but the advantage of iV-elmnt is that we do not have to consider whether to preserve the PLDA properties.

For generative ML training, letting rank(
                           V
                        )=
                        r
                        <
                        d has been reported to be beneficial (Matejka et al., 2011). As explained in Section 3.2, this reduces the rank of 
                           P
                         and of 
                           Q
                         from d to r as well. Based on results in (Bishop, 2006, p. 577) it follows that the number of parameters to be estimated will be reduced from 
                           
                              d
                              2
                           
                           +
                           2
                           d
                           +
                           1
                           =
                           O
                           (
                           
                              d
                              2
                           
                           )
                         to 
                           r
                           (
                           2
                           d
                           −
                           r
                           )
                           +
                           d
                           +
                           r
                           +
                           1
                           =
                           O
                           (
                           dr
                           )
                        . However, a large reduction of the number of parameters in this way limits the model too much. As an extreme example, if we want the same number of parameters as iV-elmnt, we have to set r
                        =1, which means that the i-vectors are projected into a one-dimensional space.

As the least constrained option, we propose to just preserve the definiteness constraints of 
                           P
                         and 
                           Q
                        . In this case the number of parameters to be estimated is not reduced, but the values they can take are limited. In this subsection, we propose reparameterizations of of 
                           P
                         and 
                           Q
                         such that when these parameters are optimized instead of 
                           P
                         and 
                           Q
                        , the definiteness constraints will be preserved. The matrix 
                           P
                         is positive-semidefinite if


                        
                           
                              (40)
                              
                                 
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       
                                          P
                                       
                                    
                                    A
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    A
                                    T
                                 
                                 ,
                              
                           
                        where 
                           P
                        
                        
                           A
                         is a d
                        ×
                        r matrix with real elements. Accordingly, in order to keep 
                           P
                         positive-semidefinite, we can train 
                           P
                        
                        
                           A
                         instead of 
                           P
                        . The rank of 
                           P
                         is equal to r and can therefore be selected by selecting the number of columns in 
                           P
                        
                        
                           A
                        . If we wish to control the rank without keeping 
                           P
                         positive definite, we can use 
                           P
                        
                        =
                        
                           P
                        
                        
                           A
                        
                        
                           P
                        
                        
                           B
                         where 
                           
                              
                                 
                                    P
                                 
                              
                              B
                           
                           ≠
                           
                              
                                 
                                    P
                                 
                              
                              A
                              T
                           
                        .

In order to keep 
                           Q
                         negative-semidefinite, we set
                           
                              (41)
                              
                                 
                                    
                                       Q
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    A
                                 
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    A
                                    T
                                 
                                 ,
                              
                           
                        and train 
                           Q
                        
                        
                           A
                         instead of 
                           Q
                        .

In order to enforce the third constraint, we set
                           
                              (42)
                              
                                 
                                    
                                       P
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                 
                                 =
                                 
                                    
                                       
                                          R
                                       
                                    
                                    A
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    A
                                    T
                                 
                                 ,
                              
                           
                        instead of 
                           
                              
                                 P
                              
                           
                           =
                           
                              
                                 
                                    P
                                 
                              
                              A
                           
                           
                              
                                 
                                    P
                                 
                              
                              A
                              T
                           
                        , and as before


                        
                           
                              (43)
                              
                                 
                                    
                                       Q
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    A
                                 
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    A
                                    T
                                 
                                 .
                              
                           
                        We then optimize 
                           R
                        
                        
                           A
                         and 
                           Q
                        
                        
                           A
                        . In this study, we apply the three definiteness constraints without reducing the rank. We refer to this method as Scr-Def.

For the DT schemes with many parameters, we also apply L2 regularization in order to prevent overfitting, i.e., we add the term 
                           ρ
                           ‖
                           
                              
                                 
                                    θ
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 ˜
                              
                           
                           
                              ‖
                              2
                           
                         to the training objective in Eq. (21), where ||·|| denotes the Euclidean norm and the regularization parameter, ρ, is tuned on a development set. This forces the parameter vector, 
                           θ
                        , to be close to 
                           
                              
                                 
                                    θ
                                 
                              
                              ˜
                           
                        . For Scr-UC and Scr-Def, we use either 
                           0
                         or the model from GT. For Scr-Def, we use regularization in terms of 
                           P
                         and 
                           Q
                         rather than 
                           R
                        
                        
                           A
                         and 
                           Q
                        
                        
                           A
                        . For example, the contribution to the regularization term from 
                           Q
                         is


                        
                           
                              (44)
                              
                                 ρ
                                 ‖
                                 
                                    vec
                                    (
                                    
                                       
                                          Q
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                    )
                                 
                                 
                                    ‖
                                    2
                                 
                                 =
                                 ρ
                                 ‖
                                 
                                    vec
                                    (
                                    −
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       A
                                    
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       A
                                       T
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                    )
                                 
                                 
                                    ‖
                                    2
                                 
                                 ,
                              
                           
                        rather than 
                           ρ
                           ‖
                           
                              vec
                              (
                              
                                 
                                    
                                       Q
                                    
                                 
                                 A
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 A
                              
                              )
                           
                           
                              ‖
                              2
                           
                        , where 
                           
                              
                                 
                                    Q
                                 
                              
                              ˜
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    ˜
                                 
                              
                              A
                           
                         denotes either 
                           0
                         or the parameters obtained by GT.

The optimal ρ depends on the size of the training data. Instead of tuning ρ for each training data size, we use a modified training objective given by


                        
                           
                              (45)
                              
                                 
                                    
                                       
                                          L
                                          ˆ
                                       
                                    
                                    ′
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 =
                                 κ
                                 
                                    
                                       L
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 +
                                 ρ
                                 ‖
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                 
                                 
                                    ‖
                                    2
                                 
                              
                           
                        where κ
                        =
                        N
                        1
                        +
                        N
                        −1. We then tune ρ for the full training data and use this value also for smaller amounts of training data. This means that the influence of the regularization becomes larger for the smaller training data.

@&#EXPERIMENTS@&#

We first evaluated the weight-adjustment proposed in Section 4 applied to AT-cal. We then compared the constrained DT schemes proposed in Section 5 with the two baselines, AT-Cal and Scr-UC. Finally, we compared the combination of weight-adjustment and the best constrained DT scheme with the best baseline for various training data sizes. We mainly focused on the logarithmic cost function (
                           
                              
                                 
                                    C
                                    ˆ
                                 
                              
                              llr
                           
                        ) introduced in Brümmer and du Preez (2006) as evaluation metric. In addition, we report results on several other standard evaluation metrics, namely equal error rate (EER), actual and minimum detection costs (actDCF, minDCF) for the effective prior used in the NIST SRE 2008 and the NIST SRE 2010 (NIST, 2008, 2010), as well as minimum 
                           
                              
                                 
                                    C
                                    ˆ
                                 
                              
                              llr
                           
                         (
                           
                              
                                 
                                    C
                                    ˆ
                                 
                              
                              llr
                              min
                           
                        ). Notice that EER, minDCF and 
                           
                              
                                 
                                    C
                                    ˆ
                                 
                              
                              llr
                              min
                           
                         are calibration-insensitive evaluation metrics, i.e., they are not affected by monotonic transformations of the scores such as the affine transformation employed by AT-Cal.

In the next subsection, the details of the experimental set-up are given. In Section 6.3, the experimental results are given. Finally, an analysis of the results is given in Section 6.4.

We conducted experiments on the male part of three sets, the NIST SRE 2006 core task (SRE06), NIST SRE 2008 core task condition-6 (SRE08) and NIST SRE 2010 core task condition-5 extended (SRE10). We used SRE06 as the development set for tuning the regularization parameter, ρ, and for the weight-adjustment parameter, α. For some experiments (see Section 6.3.1), we also used SRE06 for calibration. SRE08 and SRE10 were used as the evaluation sets. A few trials in SRE06 and SRE08 were excluded because of their inconsistent meta-data. The number of trials were 22123, 12356 and 179338 for SRE06, SRE08 and SRE10 respectively. It should be noted that SRE08 could be too small to give a reliable estimate of actDCF10. The evaluation metrics were calculated with the BOSARIS toolkit (Brümmer and de Villiers, 2011) which uses the PAV algorithm for calculating the minimum version of the evaluation metrics.

For training the UBM and the 
                           T
                         matrix, we used NIST SRE 2004 (SRE04), NIST SRE 2005 (SRE05), Switchboard II Phase 1 (SB2P1), Switchboard II Phase 2 (SB2P2), Switchboard II Phase 3 (SB2P3), Switchboard Cellular Part 1 (SBCP1) and Switchboard Cellular Part 2 (SBCP2). For SRE04, we used speech files included in the training lists of one, three, eight and sixteen single-channel conversation sides and in the test list of one single-channel conversation side. For SRE05, we used speech files included in the training lists of one, three and eight two-channel conversation sides and in the test list of one single-channel conversation side. For the Switchboard datasets, we used all non-empty speech files.

For training PLDA models, we used the same data except SB2P1. In addition, from the Switchboard data, we excluded speech distorted by echo or crosstalk or background noise according to the meta-data in the databases. MIXER PIN and PIN were used as unique speaker IDs for NIST SRE and Switchboard datasets respectively. For the files whose MIXER PIN were missing, we used model IDs as speaker IDs. This gave 1153 speakers with in total 9152 utterances.

We used 15 PLP coefficients (Hermansky, 1990) along with log-energy and applied feature warping (Pelecanos and Sridharan, 2001). After that, we appended the first-order and second-order derivatives, resulting in 48 elements per frame. Non-speech parts were then removed by using a spectral subtraction-based voice activity detector (Mak and Yu, 2010). Our UBM had 2048 Gaussian components and d, i.e., the rank of 
                           T
                        , was set to 400. The i-vectors went through the process of centering, whitening, and length-normalization (Garcia-Romero and Espy-Wilson, 2011).

Generative PLDA training was performed with the EM algorithm (Brümmer, 2010). The number of columns of 
                           V
                         was set to d. For the discriminative training methods, we used the L-BGFS (Liu and Nocedal, 1989) implementation in Schmidt (2012). We used its default stopping criteria and in addition, we stopped the training if no change in minDCF08 had been observed on the development set for 20 iterations. As in Burget et al. (2011) and Cumani et al. (2011), we used all the trials that could be constructed from the training data, except that we excluded target trials where an utterance is scored against itself. The number of unique target trials in the training data was 52,709 and the number of unique non-target trials was 41,822,267. We used the effective prior of SRE08, P
                        eff
                        =0.0917, to balance target and non-target trials and for setting τ. The weight-adjustment parameter, α, was optimized over the steps 0, 0.1, …, 1.0. Sample correlations were estimated based on the losses of 106 trial pairs of each kind (sampled with replacement). The regularization parameter, ρ, was optimized over the steps 10−3,10−2,…,104.

@&#RESULTS@&#

For the initial exploration, we first evaluated the weight-adjustment with the one-parameter model for AT-Cal. We trained a PLDA model with the training data described in Section 6.2, and used data from the test set of SRE06 for calibration. We selected the calibration data in a way that the effect of the weight-adjustment should be easily observed, i.e., few speakers with large variation in their number of utterances. Specifically, we randomly selected 11, 14 or 21 speakers, and then for each of them, we randomly selected their number of utterances uniformly in the interval 1 to the number of available utterances (between 1 and 36, around 6 on average). Notice that this choice of calibration data was for demonstrating the effect of weight-adjustment. It is generally better to use all the available data. The actDCFs and 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            for the α that was the optimal on the development set, as well as α
                           =0 which gives the standard equal weight to each trial, are shown in Table 2
                           . For reference, the result in the calibration-insensitive evaluation metrics are given in Table 4. In Fig. 2
                           , 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            vs. α is shown. We observed a large improvement in 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            for 11 calibration speakers. The optimal α on the development set was 0.5 but any value in between 0.1 and 0.6 gave similar results. For 14 and 21 speakers, the improvements were marginal. A general rule for the optimal value of α is therefore not possible to infer from this experiment.

The differences in actDCF08 were insignificant in most cases. Both actDCF08 and actDCF10 consider a small value of P
                           eff (0.0917 and 0.0010 respectively). 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            on the other hand, considers all values of P
                           eff (Brümmer and du Preez, 2006). For the training sets with 11, 14 and 21 speakers, the proportion of target-trials were 0.0774, 0.0736 and 0.0583 respectively. These values are close to P
                           eff of actDCF08. The expected loss is therefore likely to be better estimated for this value of P
                           eff than others, so that the benefit of an improved estimation procedure becomes smaller.

In the above experiment we used additional data for the calibration. Results using only the original training data for weight-adjustment both based on the one-parameter model and based on sample correlations are shown in Table 3
                           
                           . We considered the following training conditions:
                              
                                 1.
                                 Use the data from 90% of the training speakers for model training, and the data from the remaining training speakers for calibration.

Use all training data both for model training and for calibration.

As Condition 2, but in addition preserve the balance between the NIST SRE and the Switchboard corpora when weight-adjustment is utilized.

Again, we confirmed that the weight-adjustment is effective, although the effect was smaller than in our previous experiment. We did not see any significant difference between weight-adjustment based on the one-parameter model and weight-adjustment based on sample correlations. It was overall better to use all data both in model training and in calibration, than to split the data. Using calibration trials from i-vectors that have been used in PLDA training is not ideal since it does not resemble the test situation where the trials are from new i-vectors, while in our experiments, the benefit of having more data for training outweighed this problem. Preserving the balance between NIST SRE and Switchboard was useful, in which case we obtained an relative improvement in 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            of 5% by weight-adjustment on SRE10.

Next, we evaluated the different discriminative PLDA training schemes without weight-adjustment. Since in the previous experiment, using all training data both for the GT step and the DT step was better in almost all cases, we continued to use this approach. The results are shown in Table 5
                           . If we ignore the methods for which regularization towards the GT model was applied, there is a clear pattern in Table 5. Overall, one of the baselines, AT-Cal, performed best for SRE08 and Scr-4par performed best for SRE10, where the relative improvement over AT-Cal was 14%. The less constrained iV-elmnt performed worse than these two methods but better than Scr-UC which has no constraints except regularization.

For Scr-Def and Scr-UC, we had to apply regularization in order to avoid overfitting. The regularization parameter, ρ was chosen to minimize 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            on the development set, SRE06. In terms of 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                           , these two methods performed worse than AT-Cal and Scr-4par. Applying regularization towards the GT model, gives mixed results. Both SCR-Def and SCR-UC performed well in actDCF08 but they did not perform well in actDCF10 and 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                           . This indicates that these systems are only good for the effective prior that has been specified in the training objective. The bad performance for the other effective priors is, however, surprising since the logistic regression loss function emphasizes on a broad range of effective priors (Brümmer and du Preez, 2006). Moreover, the optimal ρ was quite large and the effect on minDCF08 was minor. It should also be noted that the optimal ρ varies depending on which evaluation metric is considered. In particular, this was a problem for Scr-Def with regularization towards 
                              0
                            so we did not include that result in the table. The problem of this method method might be because its objective function is non-convex.

All the results taken into account, AT-cal and Scr-4par seems to be the best methods for this amount of training data or smaller.

We have already confirmed that the weight-adjustment improves the performance of At-Cal. In this experiment we explore the effect of weight-adjustment on Scr-4par and Scr-UC with regularization towards 
                              0
                           . The former is important because this DT scheme performed the best on SRE10. The latter is interesting since it is the least constrained scheme that does not use the model obtained by GT in any way. For Scr-UC with weight-adjustment, we used the same regularization as for Scr-UC without weight-adjustment (which was tuned on the development set). The results are given in Table 6
                           . For Scr-4par with the one-parameter model, we did not obtain any improvement in 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            on the development set. Therefore, only the α
                           =0 is included. The effect of weight-adjustment based on sample correlations were small. For Scr-UC the effect of weight-adjustment was larger in particular actDCF08 where we observed improvements of around 5% and 8% for SRE08 and SRE10 respectively. The difference between the weight-adjustment based on the one-parameter model and the weight-adjustment based one sample correlations were as in previous experiments small. In general, the minimum costs are much less effected by weight-adjustment than the actual costs. It should be noticed that the training objective aims at reducing actual costs. The minimum costs are only indirectly affected since they cannot be higher than the actual costs.

In the final experiment, we evaluated AT-Cal, Scr-4par and Scr-UC for smaller numbers of training speakers, with and without weight-adjustment. For simplicity, we did not preserve the balance between the NIST SRE and the Switchboard corpora. The same training data was used both in the GT step and the DT step. Since previous experiments showed very small differences between weight-adjustment based on the one-parameter model based on sample correlations, we use only the former in this experiment. In Table 7
                            the results using half of the training speakers are shown. Scr-UC benefited mostly from weight-adjustment where actDCF08 improved around 10% for both SRE08 and SRE10, and 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            improved around 6% for both SRE08 and SRE10.

In Fig. 3
                           , 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                            vs. the number of training speakers is shown for SRE10. It is clear that Scr-4par gave better results than AT-cal and that the weight-adjustment in most cases improved the performance of both methods. The relative improvements of Scr-4par with weight-adjustment compared to the baseline, AT-Cal without weight-adjustment, ranged from 7% to 19% for the different training sizes. It is interesting that the gap between the two methods became larger when the amount of training data increased. This is reasonable since more training data is needed in order to take advantage of the extra flexibility of Scr-4par. However, in accordance with the experiment in Section 6.3.2, AT-Cal was better on SRE08 in most cases. As in the experiments with AT-Cal in Section 6.3.1, the effect of weight-adjustment disappears when the number of training speakers became large. For other evaluation metrics than 
                              
                                 
                                    
                                       C
                                       ˆ
                                    
                                 
                                 llr
                              
                           , the trend was less clear.

@&#ANALYSIS@&#

In this subsection, we analyze some of the results more in detail. In particular, we investigate how accurate the assumptions leading to the weight-adjustment formulas in Eqs. (33) and (35) are, and whether the definiteness properties of 
                           P
                         and 
                           Q
                         discussed in Section 3.2 are important.

The weight-adjustment did not always work well. For example, when all training data was used for Scr-4par, the optimal value of α on the development set was 0, which corresponds to not using any weight-adjustment. The fact that the weight-adjustment did not always work may indicate that the assumptions behind it are not accurate enough. Let us recall the assumptions. First, we assumed that the correlation between the losses of two trials does not depend on the model parameters, 
                           θ
                        , but only on what the trials have in common, e.g., one utterance might be the same in both trials. For the one-parameter model, we further assumed that all correlations are given by a parameter α which was tuned on the development set. The estimated sample correlations are shown in Table 8
                        . We can see that there is a clear correlation between trials involving the same utterance or speaker. Moreover, the results for the three models are quite similar, which suggests the dependence on 
                           θ
                         may not be large. However, our assumptions about how the correlations depends on α are not that accurate. In particular, it is noticeable that using the same two speakers in both trials causes much more correlation than using only one same utterance, i.e., that c
                        −b
                        
                        ≫
                        c
                        −c
                        .

As already revealed, for Scr-4par, the definiteness constraints on 
                           P
                         and 
                           Q
                         were almost always preserved by itself. 
                           P
                         was always kept positive definite and 
                           Q
                         was always kept negative definite. Out of the 8 training sizes, it happened once that the matrix 
                           P
                        
                        +
                        
                           Q
                         was not positive definite, but in this case, only one of its eigenvalues were negative. We did not see any difference in performance between SCR-Def and Scr-UC but an inspection of the eigenvalues reveals that the definiteness constraints were never fulfilled for Scr-UC, regardless of whether regularization was applied towards the model obtained by GT, or towards 
                           0
                        . However, we also investigated whether 
                           ω
                        
                        
                           T
                        
                        
                           Pω
                        
                        >0, 
                           ω
                        
                        
                           T
                        
                        
                           Qω
                        
                        <0 and 
                           ω
                        
                        
                           T
                        (
                           P
                        
                        +
                        
                           Q
                        )
                           ω
                        
                        >0 for each i-vector, 
                           ω
                        , in the PLDA training set and in the development set, SRE06. When regularization towards the GT model was applied, the number of violations was very few. This means that the constraints are, in some sense, practically fulfilled for i-vectors that are normally observed. This may be because the DT model remains close to the GT model and therefore keeps its properties. Interestingly though, when regularization towards 
                           0
                         was applied, there were many violations against the second constraint, 
                           ω
                        
                        
                           T
                        
                        
                           Qω
                        
                        <0, but no violations against the other two constraints. Recall from Section 3.2 that the second constraint is related to a length property of the model, which is unlikely to be useful when the i-vectors are length-normalized. While this supports our analysis in Section 3.2, it also shows that, at least for the training sizes used in our experiment, the training procedure tends to learn the useful properties from the data.

@&#CONCLUSIONS AND FUTURE WORK@&#

We dealt with two issues in order to improve the robustness of discriminative training (DT) against data insufficiency in PLDA based speaker verification. First, we examined how to appropriately use statistically dependent training trials by adjusting the weights of the trials in the training objective. Second, we proposed three new DT schemes and systematically compared them with two existing training schemes, namely generative training (GT) followed by score calibration by means of a discriminatively trained affine transformation, and, DT of all the parameters of the PLDA score function. We evaluated the methods on the male telephone part of the NIST SRE 08 and the NIST SRE10. We confirmed the effectiveness of weight-adjustment when the number of training speakers were few or when DT was only weakly constrained. On SRE08, GT followed by score calibration performed better than any of the proposed DT schemes. However, on SRE10 one of our DT schemes was better. In combination with weight-adjustment it gave improvements in between 7% and 19% in 
                        
                           
                              
                                 C
                                 ˆ
                              
                           
                           llr
                        
                      depending on the training data size, compared to GT followed by score calibration, which in turn was better than DT of all the parameters of the PLDA score function. Future directions are many. There are other phenomena that may cause the training trials to be statistically dependent than common utterances or speakers. For example, when the same microphone is used in more than one training utterance. It would be interesting to apply the weight-adjustment to deal with such dependencies. Although using the best linear unbiased estimator for the expected loss is well motivated and works well, is possible that the results could be improved by some other estimator than the BLUE. For example, a non-linear estimator or an estimator that considers higher moments than the variance. Another issue for future consideration is that there might be a mismatch between the properties of the training trials and the properties of the test trials. Several studies in domain adaptation have shown that the Switchboard and the NIST SRE corpora have different properties (Garcia-Romero and McCree, 2014; Biswas et al., 2015). Furthermore, the target trials in the test sets of the NIST SRE are always from different telephone numbers whereas the majority of the target trials used for DT are from the same telephone number.

@&#ACKNOWLEDGMENT@&#

We thank Lukáš Burget as well as one anonymous reviewer of our Odyssey paper (Rohdin et al., 2014b) who suggested us to compensate for the statistical dependence of the training trials.

In this section, we derive the constraints on 
                        P
                      and 
                        Q
                      mentioned in Section 3.2. In this paper, we use the term definite only for symmetric matrices. We use the term semidefinite when at least one eigenvalue of the matrix is zero, i.e., it does not have full rank, and the term nonnegative-definite for matrices which are either positive-definite or positive-semidefinite.

In this subsection, we show that both the rank of 
                           P
                         and the rank of 
                           Q
                         is equal to the rank of 
                           V
                        .

Let 
                           
                              
                                 S
                              
                           
                           =
                           
                              Σ
                              tot
                           
                           −
                           
                              Σ
                              ac
                           
                           
                              Σ
                              tot
                              
                                 −
                                 1
                              
                           
                           
                              Σ
                              ac
                           
                        . Then,


                        
                           
                              (A.1)
                              
                                 rank
                                 (
                                 
                                    
                                       P
                                    
                                 
                                 )
                                 =
                                 rank
                                 (
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    Σ
                                    ac
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 ≤
                                 rank
                                 (
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (A.2)
                              
                                 rank
                                 (
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 =
                                 rank
                                 (
                                 
                                    Σ
                                    tot
                                 
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       S
                                    
                                 
                                 )
                                 ≤
                                 rank
                                 (
                                 
                                    
                                       P
                                    
                                 
                                 )
                                 .
                              
                           
                        Hence, rank(
                           P
                        )=rank(Σac)=rank(
                           V
                        ).

Using that 
                           S
                         is positive definite (Boyd and Vandenberghe, 2004, Ch. A.5.5) and the Woodbury identity (Petersen and Pedersen, 2012, Eq. (156)) we obtain


                        
                           
                              (A.3)
                              
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                          
                                       
                                       
                                          =
                                          −
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          −
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                −
                                                1
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   Σ
                                                   tot
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   Σ
                                                   ac
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           S
                        
                        −1/2 is the square root of 
                           S
                        
                        −1. Set 
                           
                              
                                 M
                              
                           
                           =
                           
                              Σ
                              tot
                              
                                 −
                                 1
                              
                           
                           
                              Σ
                              ac
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 −
                                 1
                                 /
                                 2
                              
                           
                        . Then,


                        
                           
                              (A.4)
                              
                                 rank
                                 (
                                 
                                    
                                       Q
                                    
                                 
                                 )
                                 =
                                 rank
                                 (
                                 
                                    
                                       M
                                    
                                 
                                 )
                                 ≤
                                 rank
                                 (
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (A.5)
                              
                                 rank
                                 (
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 =
                                 rank
                                 (
                                 
                                    Σ
                                    tot
                                 
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 )
                                 ≤
                                 rank
                                 (
                                 
                                    
                                       M
                                    
                                 
                                 )
                                 .
                              
                           
                        Hence, rank(
                           Q
                        )=rank(Σac)=rank(
                           V
                        ).

In this subsection, we derive the following constraints on 
                           P
                         and 
                           Q
                        :
                           
                              1.
                              
                                 
                                    Q
                                  is negative-(semi)definite.


                                 
                                    P
                                  is positive-(semi)definite.


                                 
                                    P
                                 
                                 +
                                 
                                    Q
                                  is positive-(semi)definite.


                        
                           
                              (A.7)
                              
                                 
                                    
                                       M
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      tot
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                      ac
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Σ
                                                      ac
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                      ac
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                        
                           Z
                         is positive-(semi)definite if 
                           M
                         is positive-(semi)definite (Boyd and Vandenberghe, 2004, Ch. A.5.5). By expanding 
                           
                              
                                 [
                                 
                                    
                                       
                                          x
                                       
                                    
                                    1
                                    T
                                 
                                 
                                 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    2
                                    T
                                 
                                 ]
                                 
                                    
                                       M
                                    
                                 
                                 [
                                 
                                    
                                       
                                          x
                                       
                                    
                                    1
                                    T
                                 
                                 
                                 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    2
                                    T
                                 
                                 ]
                              
                              T
                           
                         for two real vectors, 
                           x
                        
                        1 and 
                           x
                        
                        2, it can be verified that 
                           M
                         is positive definite if rank(Σac)=
                        d, otherwise positive-semidefinite. Since, 
                           SPS
                        , is a sum of nonnegative-definite matrices, it is nonnegative definite. Since rank(
                           P
                        )=rank(
                           V
                        ), Constraint 2 follows.


                        
                           P
                        
                        +
                        
                           Q
                         can be rewritten as
                           
                              (A.8)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                          
                                       
                                       
                                          =
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          I
                                          −
                                          
                                             Σ
                                             ac
                                          
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   =
                                                   S
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          I
                                          −
                                          
                                             Σ
                                             ac
                                          
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (A.9)
                              
                                 
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             Σ
                                             ac
                                          
                                          −
                                          
                                             Σ
                                             ac
                                          
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             Σ
                                             ac
                                          
                                          )
                                          
                                             Σ
                                             tot
                                             
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where (A.8) comes from the symmetry of 
                           
                              
                                 P
                              
                           
                           =
                           
                              Σ
                              tot
                              
                                 −
                                 1
                              
                           
                           
                              Σ
                              ac
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 −
                                 1
                              
                           
                        . If 
                           S
                        
                        1/2(
                           P
                        
                        +
                        
                           Q
                        )
                           S
                        
                        1/2 is positive (semi)definite, then 
                           S
                        
                        −1/2
                        
                           S
                        
                        1/2(
                           P
                        
                        +
                        
                           Q
                        )
                           S
                        
                        1/2
                        
                           S
                        
                        −1/2
                        =
                        
                           P
                        
                        +
                        
                           Q
                         is positive (semi)definite. Since this matrix is symmetric, it is enough to show that its eigenvalues are larger than, or equal to zero. For two matrices, 
                           A
                         and 
                           B
                        , the eigenvalues of 
                           AB
                         and 
                           BA
                         are the same (Harville, 1997, Thm. 21.10.1). Therefore, the eigenvalues of 
                           S
                        
                        1/2(
                           P
                        
                        +
                        
                           Q
                        )
                           S
                        
                        1/2 are the same as for


                        
                           
                              (A.10)
                              
                                 
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    Σ
                                    ac
                                 
                                 −
                                 
                                    Σ
                                    ac
                                 
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 ,
                              
                           
                        whose eigenvalues in turn are the same as for


                        
                           
                              (A.11)
                              
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       (
                                    
                                 
                                 
                                    Σ
                                    ac
                                 
                                 −
                                 
                                    Σ
                                    ac
                                 
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    Σ
                                    ac
                                 
                                 )
                                 
                                    Σ
                                    tot
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 .
                              
                           
                        The middle part is, as pointed out earlier, positive-definite if rank(
                           V
                        )=
                        d, otherwise positive-semidefinite. Accordingly, Constraint 3 follows.

In this section, we derive the formulas for the trial weights given in Eqs. (33) and (35).

From Eq. (26) we have
                           
                              (B.1)
                              
                                 
                                    Σ
                                    1
                                 
                                 
                                    
                                       β
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                 
                                 /
                                 (
                                 
                                    
                                       
                                          1
                                       
                                    
                                    T
                                 
                                 
                                    Σ
                                    1
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 
                                    
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

Consider the loss of one specific target trial of speaker A, l(A
                        1, A
                        2), and its covariance with the loss of all other target trials. Let 
                           
                              Σ
                              1
                              
                                 (
                                 
                                    A
                                    1
                                 
                                 ,
                                 
                                    A
                                    2
                                 
                                 )
                              
                           
                         be the row in Σ1, containing these covariances. Let the variance of the target trial losses be denoted 
                           
                              v
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                        . The covariances with the losses of the target trials from the other speakers are 0. The covariances with the losses of the other target trials of speaker A are either 
                           
                              v
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                           
                              c
                              a
                           
                         or 
                           
                              v
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                           
                              c
                              b
                           
                        . Let the number of such trials be denoted n
                        
                           a
                         and n
                        
                           b
                         respectively. Assume that the weights for all target trials of speaker A are the same, β
                        
                           A
                        , then


                        
                           
                              (B.2)
                              
                                 
                                    Σ
                                    1
                                    
                                       (
                                       
                                          A
                                          1
                                       
                                       ,
                                       
                                          A
                                          2
                                       
                                       )
                                    
                                 
                                 
                                    
                                       β
                                    
                                 
                                 =
                                 (
                                 1
                                 +
                                 
                                    n
                                    a
                                 
                                 
                                    c
                                    a
                                 
                                 +
                                 
                                    n
                                    b
                                 
                                 
                                    c
                                    b
                                 
                                 )
                                 
                                    v
                                    1
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                 
                                 )
                                 
                                    β
                                    A
                                 
                                 .
                              
                           
                        Notice that the elements in 
                           β
                         which are weights for another speaker than speaker A are always multiplied with elements in 
                           
                              Σ
                              1
                              
                                 (
                                 
                                    A
                                    1
                                 
                                 ,
                                 
                                    A
                                    2
                                 
                                 )
                              
                           
                         that are 0, and therefore they are not present on the right hand side of Eq. (B.2). Setting Eq. (B.2) equal to the corresponding row in Eq. (B.1) gives


                        
                           
                              (B.3)
                              
                                 
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             n
                                             a
                                          
                                          
                                             c
                                             a
                                          
                                          +
                                          
                                             n
                                             b
                                          
                                          
                                             c
                                             b
                                          
                                          )
                                          
                                             β
                                             A
                                          
                                       
                                       
                                          =
                                          1
                                          /
                                          
                                             
                                                
                                                   
                                                      v
                                                      1
                                                   
                                                   (
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                      T
                                                   
                                                   
                                                      Σ
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          1
                                          /
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             1
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             k
                                             1
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    R
                                 
                              
                              1
                           
                           =
                           
                              Σ
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                           /
                           
                              v
                              1
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         is the correlation matrix which, according to our assumptions, does not depend on 
                           θ
                        . Since we are using all possible target trials, the rows in Σ1 corresponding to the other target trials of speaker A contains the same elements as 
                           
                              Σ
                              1
                              
                                 (
                                 
                                    A
                                    1
                                 
                                 ,
                                 
                                    A
                                    2
                                 
                                 )
                              
                           
                         but with a different order. These rows therefore also results in Eq. (B.3). Thus, an equal weight for all target trials of the same speaker gives a solution to Eq. (26) and since Σ
                           t
                         is invertible, it is the only solution.

It remains to find n
                        
                           a
                         and n
                        
                           b
                        . There are N
                        
                           A
                        (N
                        
                           A
                        
                        −1)/2−1 unique target trials of speaker A, excluding the trial (A
                        1, A
                        2). n
                        
                           a
                         is the number of trials that include either A
                        1 or A
                        2 but not both, in total n
                        
                           a
                        
                        =2(N
                        
                           A
                        
                        −2) trials. n
                        
                           b
                         is the remaining target trials of speaker A, except (A
                        1, A
                        2), in total
                           
                              (B.4)
                              
                                 
                                    
                                       
                                          
                                             n
                                             b
                                          
                                       
                                       
                                          =
                                          
                                             N
                                             A
                                          
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          1
                                          )
                                          /
                                          2
                                          −
                                          2
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          2
                                          )
                                          −
                                          1
                                       
                                    
                                    
                                       
                                       
                                          =
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          2
                                          )
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          3
                                          )
                                          /
                                          2
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Consider the loss of one specific trial, l(A
                        1, B
                        1) and its covariance with the loss of other non-target trials. We use a similar approach as for the target trials. However, the non-target trials where one speaker is different from A and B will complicate matters. The number of non-target trials involving the same speakers, A and B, where one utterance is either, A
                        1 or B
                        1, is n
                        −a
                        
                        =
                        N
                        
                           A
                        
                        +
                        N
                        
                           B
                        
                        −2. The number of non-target trials involving the same speakers but not the utterance A
                        1 or B
                        1, are n
                        −b
                        
                        =(N
                        
                           A
                        
                        −1)(N
                        
                           B
                        
                        −1). Now, assume that each non-target trial involving speaker A and B has same weight, β
                        
                           AB
                        , and similarly for the other speaker pairs. (It can be verified that this gives a solution.) Then from Eq. (26), we have


                        
                           
                              (B.5)
                              
                                 
                                    
                                       
                                          1
                                          /
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                −
                                                1
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                       
                                       
                                          (
                                          1
                                          +
                                          
                                             n
                                             
                                                −
                                                a
                                             
                                          
                                          
                                             c
                                             
                                                −
                                                a
                                             
                                          
                                          +
                                          
                                             n
                                             
                                                −
                                                b
                                             
                                          
                                          
                                             c
                                             
                                                −
                                                b
                                             
                                          
                                          )
                                          
                                             β
                                             AB
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                          
                                             c
                                             
                                                −
                                                c
                                             
                                          
                                          
                                             ∑
                                             
                                                X
                                                ≠
                                                A
                                                ,
                                                B
                                             
                                          
                                          (
                                          
                                             β
                                             AX
                                          
                                          +
                                          
                                             β
                                             BX
                                          
                                          )
                                          
                                             N
                                             X
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                          
                                             c
                                             
                                                −
                                                d
                                             
                                          
                                          
                                             ∑
                                             
                                                X
                                                ≠
                                                A
                                                ,
                                                B
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      N
                                                      A
                                                   
                                                   −
                                                   1
                                                   )
                                                   
                                                      β
                                                      AX
                                                   
                                                   +
                                                   (
                                                   
                                                      N
                                                      B
                                                   
                                                   −
                                                   1
                                                   )
                                                   
                                                      β
                                                      BX
                                                   
                                                
                                             
                                          
                                          
                                             N
                                             X
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 −
                                 1
                              
                           
                           =
                           
                              Σ
                              
                                 −
                                 1
                              
                           
                           /
                           
                              v
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         is the correlation matrix and 
                           
                              v
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 θ
                              
                           
                           )
                         is the variance for the non-target trial losses. The number of unknown variables in this equation is equal to the number of speaker pairs and we have one such equation per speaker pair. The number of speaker pairs is, however, very large. Instead of solving this system of equations, we use the approximations:


                        
                           
                              (B.6)
                              
                                 
                                    ∑
                                    
                                       X
                                       ≠
                                       A
                                       ,
                                       B
                                    
                                 
                                 (
                                 
                                    β
                                    AX
                                 
                                 +
                                 
                                    β
                                    BX
                                 
                                 )
                                 
                                    N
                                    X
                                 
                                 ≈
                                 2
                                 
                                    ∑
                                    
                                       X
                                       ≠
                                       A
                                       ,
                                       B
                                    
                                 
                                 
                                    β
                                    AB
                                 
                                 
                                    N
                                    X
                                 
                                 ,
                              
                           
                        and


                        
                           
                              (B.7)
                              
                                 
                                    ∑
                                    
                                       X
                                       ≠
                                       A
                                       ,
                                       B
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             N
                                             A
                                          
                                          −
                                          1
                                          )
                                          
                                             β
                                             AX
                                          
                                          +
                                          (
                                          
                                             N
                                             B
                                          
                                          −
                                          1
                                          )
                                          
                                             β
                                             BX
                                          
                                       
                                    
                                 
                                 
                                    N
                                    X
                                 
                                 ≈
                                 
                                    ∑
                                    
                                       X
                                       ≠
                                       A
                                       ,
                                       B
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             N
                                             A
                                          
                                          +
                                          
                                             N
                                             B
                                          
                                          −
                                          2
                                          )
                                          
                                             β
                                             AB
                                          
                                       
                                    
                                 
                                 
                                    N
                                    X
                                 
                                 .
                              
                           
                        These approximations are quite reasonable since, e.g., a larger N
                        
                           A
                         results in a smaller values of both β
                        
                           AB
                         and β
                        
                           AX
                        . This results in


                        
                           
                              (B.8)
                              
                                 (
                                 1
                                 +
                                 
                                    n
                                    
                                       −
                                       a
                                    
                                 
                                 
                                    c
                                    
                                       −
                                       a
                                    
                                 
                                 +
                                 
                                    n
                                    
                                       −
                                       b
                                    
                                 
                                 
                                    c
                                    
                                       −
                                       b
                                    
                                 
                                 +
                                 
                                    n
                                    
                                       −
                                       c
                                    
                                 
                                 
                                    c
                                    
                                       −
                                       c
                                    
                                 
                                 +
                                 
                                    n
                                    
                                       −
                                       d
                                    
                                 
                                 
                                    c
                                    
                                       −
                                       d
                                    
                                 
                                 )
                                 
                                    β
                                    AB
                                 
                                 ≈
                                 
                                    k
                                    
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        where,


                        
                           
                              (B.9)
                              
                                 
                                    
                                       
                                          
                                             k
                                             
                                                −
                                                1
                                             
                                          
                                          =
                                          1
                                          /
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                −
                                                1
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             n
                                             
                                                −
                                                c
                                             
                                          
                                          =
                                          2
                                          
                                             ∑
                                             
                                                X
                                                ≠
                                                B
                                                ,
                                                A
                                             
                                          
                                          
                                             N
                                             X
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        and


                        
                           
                              (B.10)
                              
                                 
                                    n
                                    
                                       −
                                       d
                                    
                                 
                                 =
                                 (
                                 
                                    N
                                    A
                                 
                                 +
                                 
                                    N
                                    B
                                 
                                 −
                                 2
                                 )
                                 
                                    ∑
                                    
                                       X
                                       ≠
                                       B
                                       ,
                                       A
                                    
                                 
                                 
                                    N
                                    X
                                 
                                 .
                              
                           
                        
                     


                     Appendix C.1 states results given in previous studies. The gradients and initializations for Scr-4par, iV-elmnt and Scr-Def are then given in Appendix C.2, Appendix C.3 and Appendix C.4, respectively. In this section, 
                        1
                     
                     
                        q×r
                      denotes a matrix of dimension q
                     ×
                     r whose all elements are equal to 1.

The results in this subsection are given in Cumani et al. (2011). Let the n training i-vectors be collected in a matrix, 
                           Ψ
                        
                        =[
                           ω
                        
                        1
                        …
                        
                           ω
                        
                        
                           n
                        ], and all the scores of the training data be collected in a matrix 
                           S
                        , i.e., S
                        
                           ij
                        
                        =
                        s
                        
                           ij
                        , where s
                        
                           ij
                         is given by Eq. (10). Then 
                           S
                        
                        =
                        
                           S
                        
                        P
                        +
                        
                           S
                        
                        Q
                        +
                        
                           S
                        
                        c
                        +
                        
                           S
                        
                        k, where
                           
                              (C.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             P
                                          
                                          =
                                          2
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             T
                                          
                                          
                                             
                                                P
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             Q
                                          
                                          =
                                          diag
                                          (
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             T
                                          
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             
                                                Ψ
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                1
                                                ×
                                                n
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   T
                                                
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      1
                                                      ×
                                                      n
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             c
                                          
                                          =
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             T
                                          
                                          
                                             
                                                c
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                1
                                                ×
                                                n
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   T
                                                
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      1
                                                      ×
                                                      n
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             k
                                          
                                          =
                                          k
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                n
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

The gradient of 
                           
                              L
                              ˆ
                           
                           (
                           
                              
                                 γ
                              
                           
                           )
                         in Eq. (18) is given by,


                        
                           
                              (C.2)
                              
                                 ∇
                                 
                                    
                                       L
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       γ
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      k
                                                   
                                                   
                                                      
                                                         L
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   vec
                                                   (
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                                
                                             
                                             
                                                
                                                   vec
                                                   (
                                                   
                                                      
                                                         
                                                            Q
                                                         
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      ′
                                                   
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      k
                                                      ′
                                                   
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where


                        
                           
                              (C.3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             ′
                                          
                                       
                                       
                                          =
                                          2
                                          
                                             
                                                Ψ
                                             
                                          
                                          
                                             
                                                G
                                             
                                          
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             T
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             ′
                                          
                                       
                                       
                                          =
                                          2
                                          vec
                                          (
                                          [
                                          
                                             
                                                Ψ
                                             
                                          
                                          ∘
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                d
                                                ×
                                                n
                                             
                                          
                                          
                                             
                                                G
                                             
                                          
                                          )
                                          ]
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             T
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             ′
                                          
                                       
                                       
                                          =
                                          2
                                          [
                                          
                                             
                                                Ψ
                                             
                                          
                                          ∘
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                d
                                                ×
                                                n
                                             
                                          
                                          
                                             
                                                G
                                             
                                          
                                          )
                                          
                                             
                                                Ψ
                                             
                                          
                                          ]
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             k
                                             ′
                                          
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                1
                                             
                                             T
                                          
                                          
                                             
                                                G
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.4)
                              
                                 
                                    G
                                    ij
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          l
                                          ij
                                       
                                    
                                    
                                       ∂
                                       
                                          s
                                          ij
                                       
                                    
                                 
                                 ,
                              
                           
                        and


                        
                           
                              (C.5)
                              
                                 
                                    l
                                    ij
                                 
                                 =
                                 l
                                 
                                    
                                       
                                          
                                             t
                                             ij
                                          
                                          ,
                                          
                                             s
                                             ij
                                          
                                          (
                                          
                                             
                                                γ
                                             
                                          
                                          )
                                          ,
                                          τ
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The derivative of 
                           
                              L
                              ˆ
                           
                         with respect to a
                        P, is


                        
                           
                              (C.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   L
                                                   ˆ
                                                
                                             
                                             
                                                ∂
                                                
                                                   a
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          =
                                          
                                             ∑
                                             ij
                                          
                                          
                                             
                                                ∂
                                                
                                                   l
                                                   ij
                                                
                                             
                                             
                                                ∂
                                                
                                                   s
                                                   ij
                                                
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   s
                                                   ij
                                                
                                             
                                             
                                                ∂
                                                
                                                   a
                                                   P
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             ij
                                          
                                          
                                             G
                                             ij
                                          
                                          
                                             S
                                             
                                                P
                                                ij
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                1
                                             
                                             T
                                          
                                          (
                                          
                                             
                                                G
                                             
                                          
                                          ∘
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             P
                                          
                                          )
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                n
                                                ×
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        The derivatives 
                           
                              
                                 ∂
                                 
                                    L
                                    ˆ
                                 
                              
                              
                                 ∂
                                 
                                    a
                                    Q
                                 
                              
                           
                           ,
                           
                              
                                 ∂
                                 
                                    L
                                    ˆ
                                 
                              
                              
                                 ∂
                                 
                                    a
                                    c
                                 
                              
                           
                         and 
                           
                              
                                 ∂
                                 
                                    L
                                    ˆ
                                 
                              
                              
                                 ∂
                                 
                                    a
                                    k
                                 
                              
                           
                         are calculated in the same way. Each of a
                        P, a
                        Q, a
                        c and a
                        k, are initialized to 1.

We collect the scalings of the i-vector elements in a diagonal matrix, 
                           D
                        , so that 
                           ω
                         is replaced by 
                           Dω
                         in Eq. (10), i.e.,


                        
                           
                              (C.7)
                              
                                 
                                    
                                       
                                          
                                             s
                                             ij
                                          
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                             T
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                P
                                             
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                P
                                             
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                
                                                   ω
                                                
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                c
                                             
                                          
                                          +
                                          k
                                          .
                                       
                                    
                                 
                              
                           
                        Let the contribution to the gradient from terms including 
                           P
                         be denoted 
                           
                              ∇
                              
                                 diag
                                 
                                    (
                                    
                                       
                                          D
                                       
                                    
                                    )
                                 
                              
                              
                                 (
                                 P
                                 )
                              
                           
                           
                              L
                              ˆ
                           
                         and similarly for 
                           Q
                         and 
                           c
                        . We will use matrix calculus (Minka, 2001) with the convention that the elements of the matrix derivative are laid out according to the transpose of the denominator. The contribution from 
                           P
                         to the differential is


                        
                           
                              (C.8)
                              
                                 d
                                 
                                    L
                                    ˆ
                                 
                                 =
                                 tr
                                 (
                                 
                                    
                                       
                                          P
                                       
                                    
                                    ′
                                 
                                 d
                                 
                                    
                                       
                                          P
                                       
                                    
                                    T
                                 
                                 )
                                 .
                              
                           
                        Replacing 
                           P
                         with 
                           DPD
                         we then get


                        
                           
                              (C.9)
                              
                                 
                                    
                                       
                                          d
                                          
                                             L
                                             ˆ
                                          
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               DPD
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         PD
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        i.e.,


                        
                           
                              (C.10)
                              
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 =
                                 diag
                                 (
                                 
                                    
                                       PD
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    ′
                                 
                                 +
                                 
                                    
                                       
                                          P
                                       
                                    
                                    ′
                                 
                                 
                                    
                                       D
                                    
                                 
                                 
                                    
                                       P
                                    
                                 
                                 )
                              
                           
                        The contribution from the terms with 
                           Q
                         is calculated in the same way. For 
                           c
                        , we get


                        
                           
                              (C.11)
                              
                                 
                                    
                                       
                                          d
                                          
                                             L
                                             ˆ
                                          
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             ′
                                          
                                          d
                                          
                                             
                                                (
                                                
                                                   
                                                      Dc
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             ′
                                          
                                          (
                                          (
                                          d
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             T
                                          
                                          )
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             T
                                          
                                          +
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             T
                                          
                                          d
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             T
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        i.e.,


                        
                           
                              (C.12)
                              
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       c
                                       )
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 =
                                 diag
                                 (
                                 
                                    
                                       
                                          c
                                       
                                    
                                    ′
                                 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    T
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          c
                                       
                                    
                                    ′
                                 
                                 ∘
                                 
                                    
                                       c
                                    
                                 
                                 .
                              
                           
                        Finally,


                        
                           
                              (C.13)
                              
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 =
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 +
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       Q
                                       )
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 +
                                 
                                    ∇
                                    
                                       diag
                                       
                                          (
                                          
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       c
                                       )
                                    
                                 
                                 
                                    L
                                    ˆ
                                 
                                 .
                              
                           
                        The derivative for k is calculated as in Appendix C.2. The scalings of the i-vector elements and k are initialized to 1.

The gradients for 
                           c
                         and k in Eq. (C.2) are used without modification. The contribution from 
                           P
                         and 
                           Q
                         to the differential is


                        
                           
                              (C.14)
                              
                                 
                                    
                                       
                                          d
                                          
                                             L
                                             ˆ
                                          
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      T
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            Q
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            Q
                                                         
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                         
                                                      
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Q
                                                         
                                                      
                                                      ′
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                         
                                                      
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        Using the fact that 
                           P
                        ′ is symmetric, we get for the first term


                        
                           
                              (C.15)
                              
                                 
                                    
                                       
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   (
                                                   d
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                               
                                                               A
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                
                                             
                                          
                                          +
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        
                                                                           
                                                                              
                                                                                 R
                                                                              
                                                                           
                                                                           A
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                  
                                                                  A
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      T
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      
                                                         ′
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          tr
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          tr
                                          
                                             
                                                
                                                   2
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   d
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                      T
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        The other terms are treated analogously, resulting in


                        
                           
                              (C.16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                            
                                                            A
                                                         
                                                      
                                                   
                                                   
                                                      L
                                                      ˆ
                                                   
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                            
                                                            A
                                                         
                                                      
                                                   
                                                   
                                                      L
                                                      ˆ
                                                   
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   vec
                                                   (
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      A
                                                   
                                                   )
                                                
                                                
                                             
                                             
                                                
                                                   2
                                                   vec
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     P
                                                                  
                                                               
                                                               ′
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     Q
                                                                  
                                                               
                                                               ′
                                                            
                                                            )
                                                            
                                                               
                                                                  
                                                                     Q
                                                                  
                                                               
                                                               A
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The regularization term is dealt with by adding 
                           2
                           (
                           
                              
                                 P
                              
                           
                           −
                           
                              
                                 
                                    
                                       P
                                    
                                 
                              
                              ˜
                           
                           )
                         to 
                           P
                        ′ and 
                           2
                           (
                           
                              
                                 Q
                              
                           
                           −
                           
                              
                                 
                                    
                                       Q
                                    
                                 
                              
                              ˜
                           
                           )
                         to 
                           Q
                        ′. For initialization, we use a model estimated by GT and calculate 
                           R
                        
                        
                           A
                         and 
                           Q
                        
                        
                           A
                         by means of eigendecomposition of 
                           R
                         and 
                           Q
                         respectively, e.g.,


                        
                           
                              (C.17)
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    A
                                 
                                 =
                                 
                                    
                                       E
                                    
                                 
                                 (
                                 −
                                 
                                    
                                       Q
                                    
                                 
                                 )
                                 
                                    
                                       D
                                    
                                 
                                 
                                    
                                       (
                                       −
                                       
                                          
                                             Q
                                          
                                       
                                       )
                                    
                                    
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 ,
                              
                           
                        where the columns of 
                           E
                        (−
                        
                           Q
                        ) are the eigenvectors of −
                           Q
                         and 
                           D
                        (−
                        
                           Q
                        ) is a diagonal matrix containing the corresponding eigenvalues.

@&#REFERENCES@&#

