@&#MAIN-TITLE@&#Resource allocation in multi-relay multi-user OFDM systems for heterogeneous traffic

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Resource allocation with subcarrier-pairing under coexistence of RT and NRT traffic.


                        
                        
                           
                           Optimization of relay-user selection, subcarrier-pair assignment and power allocation.


                        
                        
                           
                           Flexible QoS guarantee of real-time traffic by system parameter adjustment adaptively.


                        
                        
                           
                           Total power constraint uses power resource better than individual power constraints.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Resource allocation

OFDM systems

Multi-relay

Heterogeneous traffic

Subcarrier-pairing

@&#ABSTRACT@&#


               
               
                  Resource allocation is an important issue that has not been well resolved in multi-relay multi-user Decode-and-Forward (DF) OFDM systems with subcarrier-pairing at relays in the presence of heterogeneous flows, i.e., simultaneous real-time (RT) and non-real-time (NRT) traffic. In this paper, we address the issue by first formulating it as a joint optimization problem of relay-user pair selection, subcarrier-pair assignment and power allocation and then solving it through dual decomposition and subgradient methods. Asymptotic optimal iterative algorithms with polynomial complexity are proposed with the objective of maximizing sum-transmission-rate of NRT traffic while providing quality-of-service (QoS) guarantee for RT traffic, in two cases: (i) with total network power constraint and (ii) with individual power constraints. Effective selections of initial dual variables and stepsize for the subgradient method are also presented. Simulation results are provided in multiple scenarios and they show that: (i) the proposed algorithms outperform the existing schemes in terms of providing QoS requirements of RT users and maximizing sum network transmission rates; (ii) algorithms designed under total power constraint exploit the power resource much better than those under individual power constraints.
               
            

@&#INTRODUCTION@&#

The ever-increasing heterogeneous wireless applications with diverse quality-of-service (QoS) requirements impose a great challenge on the design of future wireless communication networks due to increasing traffic loads and flow diversity. In addition, wireless channels are prone to impairments, such as fading and frequency selective characteristics. Therefore, it is crucial to allocate limited system resources adaptively according to channel state information (CSI) and differentiated QoS requirements to provide desirable wireless system performance. Orthogonal Frequency Division Multiplexing (OFDM) is a leading multicarrier modulation technique which provides various configurable system resources, such as subcarriers, power and modulation levels. Due to its superior performance, OFDM has been adopted by a few communication standards including IEEE 802.16j that supports relay-assisted cooperative communication, which is a very promising networking paradigm considered in this paper. However, efficient resource allocation in relaying OFDM systems is even more challenging as compared with traditional single-hop OFDM systems.

In single-hop OFDM systems, resource allocation refers mainly to subcarrier assignment and power allocation, as well as bit loading. Much work on this issue has been reported in the past decade [1]. However, the resource allocation problem in relaying OFDM systems, especially in multi-relay scenarios, is more complex; it involves more variables, such as subcarrier permutation (i.e., subcarrier-pairing) [2] and even network coding at relay stations [3,4]. Furthermore, subcarrier assignment in multi-relay systems often involves relay selection, which is not considered in single-hop or single-relay OFDM systems.

In general, relay selection in multi-relay OFDM systems falls into three categories [5]: symbol-based, subcarrier-based and subcarrier-pairing relay selections. Such three relay selections and their advantages or disadvantages can be briefly described as follows:

Symbol-based relay selection: only one relay out of multiple available relays is selected based on the channel condition of the whole OFDM symbol. Here, the channel condition often refers to the end-to-end equivalent channel gain which can be calculated as the minimum of the channel gains of the first and the second hops if Decode-and-Forward (DF) relaying strategy is applied at relays, or as the harmonic mean of both channel gains if Amplify-and-Forward (AF) is adopted at relays. Thus, the symbol-based relay selection chooses the relay with the highest equivalent end-to-end channel gain as the best relay. Such scheme is usually not efficient since the differences of channel conditions among different subcarriers at multiple relays are not exploited.

Subcarrier-based relay selection: one best relay for each subcarrier is selected [6], i.e., each subcarrier is assigned to one relay at which the subcarrier has the highest end-to-end equivalent channel condition among all available relays. In such scheme, signals received on one subcarrier in the first hop is decoded if DF is adopted (or amplified if AF is used) and forwarded by the relay on the same subcarrier in the second hop. Compared with symbol-based relay selection, subcarrier-based relay selection can exploit frequency diversity and node (or relay) diversity; and hence, it is likely to achieve better system performance. However, such scheme is still not optimal since the same subcarrier is used over the two hops when relaying signals.

Subcarrier-pairing relay selection: the system performance of the subcarrier-based relay selection can be enhanced by permuting and pairing subcarriers in the first and the second hops according to their channel conditions, resulting in the subcarrier-pairing relay selection. Therefore, the subcarrier in the second hop can be changed when forwarding signals at a relay, so as to exploit the independent frequency selective fading feature of the channels over the two hops. Such scheme can achieve optimal system performance by using ordered subcarrier pairing [7] for AF relaying system. In DF relaying system, ordered subcarrier pairing is also optimal if the relays do not buffer and reschedule packets over multiple time slots [3,8,9] or if one relay cannot change the number (or set) of subcarriers it used [10]; or else, the system performance can be further improved by rescheduling or re-packetizing. For the latter case, however, the implementation complexity and cost of relay station are likely higher than the subcarrier-pairing based system.

In all, the subcarrier-pairing scheme usually outperforms symbol-based or subcarrier-based schemes, and fully utilizes relay- and frequency-diversity, making this scheme more attractive. Note that, the symbol-based scheme can also employ subcarrier pairing but only at the selected relay, which is different from the subcarrier-pairing scheme where multiple relays are utilized.

Several results on resource allocation with subcarrier-pairing in relaying OFDM systems have been published recently. In basic three-node relaying systems, authors in [2,7] investigated the optimal power allocation problem to maximum system capacity under total power constraint, and proved sorted subcarrier pairing is optimal for both AF and DF OFDM relay systems. Further, if assuming the relay which adopts DF relaying can forward message on a subset of available subcarriers, authors in [10] found that joint optimization of subcarrier pairing and subcarrier set selection can enhance the system capacity under individual power constraints. In complex network scenarios, authors in [5] studied the joint optimization problem of subcarrier-pairing, relay selection and power allocation with the objective of maximizing sum transmission rates for multi-relay one-way single-user AF OFDM systems. Such a joint optimization problem was also studied in multi-relay two-way AF OFDM systems [11]. These works mainly concerned pure capacity maximization.

Moreover, Authors in [12] took the assumption that the proportional fairness [13] among relays and users are pre-configured to satisfy QoS requirement of each individual user, and developed a fairness-aware resource allocation scheme with the aim of capacity maximization for multi-relay multi-user one-way OFDM systems. Considering that different subcarriers may carry data from different services, authors in [14] formulated the optimization of subcarrier-pairing and power allocation as a weighted sum-rate maximization problem for a single-relay single-user DF OFDM system; wherein, the weighting factor reflects different priorities or QoS requirements. Such weighted factor is often adopted in two-way relaying systems to prioritize different users [4] or downlink and uplink sessions [3]. Although these works take the QoS requirements of traffic into account, the characteristics of heterogeneous traffic, i.e., real-time (RT) traffic and non-real-time (NRT) traffic, are not differentiated explicitly, resulting in insufficient support for RT traffic when the weights allocated to RT traffic are not fitting its requirements. To some extent, the proportional fairness or weighted strategy used can be viewed as solely homogeneous traffic support or weak support for heterogeneous traffic.

In this paper, we investigate the joint optimization problem of subcarrier-pair assignment, relay-user pair selection and power allocation issues with emphasis on heterogeneous traffic support in a two-hop multi-relay multi-user DF OFDM system. The major contributions of this paper are as follows:
                        
                           (i)
                           Formulating a new problem: different from the works so far which focus on either pure capacity maximization without consideration of traffic characteristics or weak support for heterogeneous traffic, we aim at providing optimal solutions to support the transmission of heterogeneous traffic in multi-relay multi-user scenarios. We formulate the problem with the objective to maximize the sum-rate of all NRT traffic while providing QoS guarantee for individual RT traffic. Such formulation can differentiate the heterogeneous traffic requirements explicitly; and thus, it may result in a resource allocation scheme with flexible and strong support of heterogeneous traffic.

Presenting joint optimization problems under two types of power constraints: when formulating the optimization problem, we jointly consider relay-user selection, subcarrier-pairing assignment and power allocation altogether, in two cases: total power constraint and individual power constraints. Hence, the resulting resource allocation schemes by solving these problems can exploit radio resources fully; and they can be potential candidates served for scenarios with different power configurations respectively.

Proposing optimal resource allocation schemes: the formulated optimization problems are mixed integer programming problems that are non-convex. Due to the high exponential complexity of the original problems, as shown in Sections 3 and 4, we resort to the dual decomposition approach [15] to develop asymptotic optimal schemes with polynomial complexity. In particular, the problems can be solved in three phases and the complexity of the resulting algorithms is polynomial in the number of subcarriers.

The remainder of this paper is organized as follows. We describe the system model and formulate the problem under total power constraint in Section 2, and propose an iterative asymptotic optimal resource allocation algorithm using dual decomposition and subgradient methods in Section 3. We then reformulate the problem under individual power constraints and provide the solution in Section 4. In Section 5, we evaluate the convergence performance, and the system performance in terms of end-to-end transmission rates for RT and NRT traffic in various cases with different network configurations. We conclude the paper in Section 6.

We consider a multi-relay downlink OFDM system with one base station (BS), K relay stations (RS), and M subscribed mobile stations (MS) located at the cell edge including Mrt
                         RT users and (M
                        −
                        Mrt
                        ) NRT users, as shown in Fig. 1
                        ; here we assume there are no direct links between BS and MSs due to the large distances between them. We refer to RT users as those with RT traffic, and to NRT users as those with NRT traffic. In this one-way system, relay stations operate in a time-division duplexing (TDD) model, applying the DF relaying scheme in two phases. In the first phase, the BS broadcasts its data to RSs, and then in the second phase, each RS decodes the received data, processes the data and forwards them to the target MSs. In particular, in the first phase while all RSs listen, BS sends one OFDM frame with traffic destined to different RSs on pre-assigned subcarriers (i.e., n
                        ∈{1,…,
                        n} shown in Fig. 1); in the second phase, BS keeps silent, while RSs decode the received data on their pre-assigned subcarriers and forward the data in a synchronous fashion on the paired subcarriers (i.e., n′∈{1,…,
                        n} shown in Fig. 1) as in OFDMA schemes. Then, MSs could decode data forwarded by RSs on their allocated subcarriers. This process defines subcarrier-pair (n,
                        n′) which is associated with the RS k (k
                        ∈{1,…,
                        K}) assigned to forward data to the MS m (m
                        ∈{1,…,
                        M}) and as such determining a relay-user pair (k,
                        m). Note that a relay can have several subcarrier-pairs.

We suppose each frequency-selective channel/link is divided into N orthogonal subcarriers with flat fading and the channel frequency responses remain constant during the span of the two phases. We denote 
                           
                              
                                 
                                    H
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    H
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         the channel frequency gains for subcarrier pair (n,
                        n′),∀
                        n,
                        n′∈{1,…,
                        N}, over the two-hop path (s,
                        k,
                        m), respectively. Here, (s,
                        k,
                        m) refers to the end-to-end transmission path (BS→RS k
                        →MS m), i.e., transmission from BS to RS k and from RS k to MS m. We assume the additive Gaussian noise power at relays and mobile stations to be independent of subcarrier index; and over single subcarrier they are denoted as 
                           
                              
                                 
                                    σ
                                 
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                        , respectively. For a given subcarrier pair (n,
                        n′) assigned to relay k and user m, we denote 
                           
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         the allocated power for subcarrier n and n′. Then, the end-to-end instantaneous rate of subcarrier pair (n,
                        n′) over path (s,
                        k,
                        m) can be represented as [16]
                        
                           
                              (1)
                              
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         sk
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         sk
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         km
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         km
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              ≜
                              |
                              
                                 
                                    H
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    σ
                                 
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ≜
                              |
                              
                                 
                                    H
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                         are the corresponding channel-to-noise ratios. In Eq. (1), the rate 
                           
                              
                                 
                                    R
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         is normalized to unit bandwidth; and the factor of 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         results from using two phases to send the data from BS to MSs via RSs. Here, we assume that the channel-to-noise ratios of all links in the network, i.e., CSI, are perfectly known at a central controller embedded within the BS, and the resulting resource allocation information, including subcarrier pairing, relay-user pair and power allocation, can be sent to associated stations via a separate reliable control channel. Such assumption is widely adopted in the literature [2–5]; and the resource allocation schemes proposed under such assumption can serve as upper bounds and provide benchmarks for designing schemes when the negative effects of imperfect CSI [17–20] are considered.

In this paper, heterogeneous traffic including NRT and RT traffic is considered. The QoS requirement for RT traffic can usually be regarded as the minimum transmission rate requirement [21,22]. Although authors in [20] impose average maximum delay constraint on the RT traffic, they transform it into minimum required scheduled rate constraint in their optimization problem based on the characteristics of RT traffic, under the assumption of Poisson arrival distribution. On the other hand, NRT traffic has no QoS requirement; therefore it can be treated as best-effort service [20]. In this paper, we prioritize RT traffic requirements through guaranteeing the required rate constraint for RT traffic with the needed system resources, while we service NRT traffic by utilizing the remaining resources.

In this paper, we formulate the problem as a joint optimization for resource allocation of subcarrier pairs, relay-user pairs and power with the objective of maximizing the sum rates of NRT users (in the user set {Mrt
                        
                        +1,…,
                        M}, shown in Fig. 1) while having the required rate of each RT user (in the user set {1,…,
                        Mrt
                        }). Mathematically, we first consider total network transmit power constraint, given by PT
                        , and we formulate the optimization problem as:
                           
                              (2)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          {
                                          ρ
                                          ,
                                          δ
                                          ,
                                          p
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        subject to:
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 n
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 n
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 ⩽
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                    
                                       req
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       rt
                                    
                                 
                                 }
                              
                           
                        where 
                           
                              ρ
                              =
                              {
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              }
                           
                        , 
                           
                              δ
                              =
                              {
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              }
                           
                         and 
                           
                              p
                              =
                              {
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                              }
                           
                         denote the sets of optimization variables, and 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         are indicator functions for subcarrier pair (n,
                        n′) and the associated relay-user pair (k,
                        m), respectively. Eqs. (3) and (4) define the subcarrier pairing constraint and the relay-user pair assignment constraint. Constraint in (5) imposes the limit on the total network transmit power, where 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         refers to the allocated transmit power for subcarrier pair (n,
                        n′) which is assigned to relay-user pair (k,
                        m). Here, 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         satisfies 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ⩾
                              0
                           
                        . Relation in (6) is the transmission rate constraint, where 
                           
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                                 
                                    req
                                 
                              
                           
                         is the required transmission rate of the RT traffic for user m i.e., RT user m.

This optimization problem is solved in the next section. We then reformulate the problem in (2) under individual power constraints instead of total power constraint and provide its solution in Section 4. Note that, the total power constraint refers to the total network transmit power constraint, i.e., the sum transmit powers of BS and RSs as shown in the downlink relaying transmission model considered in Fig. 1. Such constraint can be used in scenarios where the BS and RSs share the same power (or, energy) pool, and it regulates the maximum overall power supplied to all transmit stations including BS and RSs. However, the individual power constraint refers to the maximum transmit power constraint for each station, and it can be applied to scenarios where the BS or each RS has separate power/energy source.

Due to the use of the binary variable parameters of 
                        
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 δ
                              
                              
                                 km
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     , the problem in (2) is a mixed integer programming problem. Its complexity is 
                        
                           O
                           (
                           
                              
                                 (
                                 K
                                 ·
                                 M
                                 )
                              
                              
                                 N
                                 !
                              
                           
                           )
                        
                      if exhaustive search is employed, which is extremely high when N is large. Authors in [15] found that non-convex resource allocation optimization problem in multicarrier systems can be solved by using dual methods, and the duality gap is nearly zero when the number of subcarriers is sufficiently large. In this paper, we adapt the dual decomposition method in [15,23] to solve the problem in (2).

First, we define D as the set of all possible 
                        ρ
                      and 
                        δ
                      satisfying (3) and (4), respectively, and P as the set of all possible power allocation p for the given (
                        ρ
                     ,
                     
                        δ
                     ) that satisfies 
                        
                           
                              
                                 p
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 km
                              
                           
                           >
                           0
                        
                      for 
                        
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 δ
                              
                              
                                 km
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           1
                        
                     , and 
                        
                           
                              
                                 p
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 km
                              
                           
                           =
                           0
                        
                      for 
                        
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 δ
                              
                              
                                 km
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           0
                        
                     . Then, the dual objective function of the primal problem of (2) can be defined as
                        
                           (7)
                           
                              g
                              (
                              β
                              ,
                              μ
                              )
                              ≜
                              
                                 
                                    
                                       sup
                                    
                                    
                                       
                                          
                                             
                                                p
                                                ∈
                                                P
                                                (
                                                ρ
                                                ,
                                                δ
                                                )
                                             
                                             
                                                {
                                                ρ
                                                ,
                                                δ
                                                }
                                                ∈
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                              L
                              (
                              ρ
                              ,
                              δ
                              ,
                              p
                              ,
                              β
                              ,
                              μ
                              )
                           
                        
                     with the Lagrangian
                        
                           (8)
                           
                              L
                              (
                              ρ
                              ,
                              δ
                              ,
                              p
                              ,
                              β
                              ,
                              μ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             rt
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              +
                              β
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   nn
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             km
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             rt
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             km
                                          
                                          
                                             
                                                
                                                   nn
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                          
                                             req
                                          
                                       
                                    
                                 
                              
                           
                        
                     where β
                     ⩾0 and 
                        
                           μ
                           =
                           (
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 μ
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       rt
                                    
                                 
                              
                           
                           )
                           ⪰
                           0
                        
                      are the dual variables. Note that g(β,
                     
                        μ
                     ) is the supremum of the Lagrangian, i.e., it can reach its maximum when the Lagrangian is finite; otherwise, g(β,
                     
                        μ
                     )=∞ if the Lagrangian is unbounded. We assume the Lagrangian is always finite in our problem.

To solve g(β,
                     
                        μ
                     ), the optimal value of primal variables (
                        ρ
                     ,
                     
                        δ
                     ,
                     
                        p
                     ) should be first determined given dual variables (β,
                     
                        μ
                     ). Specifically, denoting (
                        ρ
                     
                     ∗,
                     
                        δ
                     
                     ∗,
                     
                        p
                     
                     ∗) as the optimal primal variables for given (β,
                     
                        μ
                     ), the dual function is then g(β,
                     
                        μ
                     )=
                     L(
                        ρ
                     
                     ∗,
                     
                        δ
                     
                     ∗,
                     
                        p
                     
                     ∗,
                     β,
                     
                        μ
                     ).

To obtain the optimal primal variables (
                           ρ
                        
                        ∗,
                        
                           δ
                        
                        ∗,
                        
                           p
                        
                        ∗) for given dual variables, we first decompose the dual function into KN
                        2 independent functions as follows:
                           
                              (9)
                              
                                 g
                                 (
                                 β
                                 ,
                                 μ
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                   ∈
                                                   P
                                                   (
                                                   ρ
                                                   ,
                                                   δ
                                                   )
                                                
                                                
                                                   {
                                                   ρ
                                                   ,
                                                   δ
                                                   }
                                                   ∈
                                                   D
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                    
                                       req
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where
                           
                              (10)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 ≜
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 -
                                 β
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, with fixed dual variables (β,
                        
                           μ
                        ), we optimize the primal variables (
                           ρ
                        ,
                        
                           δ
                        ,
                        
                           p
                        ) by solving (9) and (10).

Given subcarrier pair (n,
                        n′) assigned to relay-user pair (k,
                        m), i.e., 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              1
                           
                        , the optimal power allocation over transmission path (s,
                        k,
                        m) can be determined by solving the following problem
                           
                              (11)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          p
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 ,
                                 
                                 subject to
                                 
                                 p
                                 ⪰
                                 0
                              
                           
                        
                     

In considering the DF relaying scheme, the maximum achievable rate for a given total power 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         over path (s,
                        k,
                        m) can be given by [7]:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   km
                                                
                                                
                                                   
                                                      
                                                         nn
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      sk
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      km
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      sk
                                                   
                                                   
                                                      n
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      km
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                              ≜
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          sk
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          sk
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . Note that 
                           
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          sk
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          sk
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          sk
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                        .

With this result, we can rewrite (10) as
                           
                              (13)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 )
                                 -
                                 β
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It can be seen that 
                           
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                           
                         is concave with respect to 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                        . Therefore, Karush–Kuhn–Tucker (KKT) conditions [24] are satisfied. Differentiating 
                           
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                           
                         in (13) with respect to 
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         and applying KKT conditions, we can obtain the optimal power allocation 
                           
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          km
                                       
                                    
                                    )
                                 
                                 
                                    ∗
                                 
                              
                           
                         as
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         nn
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   km
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           m
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                     β
                                                                     ln
                                                                     2
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           γ
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 nn
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           km
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   m
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         rt
                                                      
                                                   
                                                   }
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                     β
                                                                     ln
                                                                     2
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           γ
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 nn
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           km
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   m
                                                   ∈
                                                   {
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         rt
                                                      
                                                   
                                                   +
                                                   1
                                                   ,
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         rt
                                                      
                                                   
                                                   +
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   M
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where (x)+
                        ≜max(x,0).

After obtaining optimal 
                           
                              
                                 
                                    p
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               nn
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         km
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                        , we can start to determine optimal (
                           ρ
                        
                        ∗,
                        
                           δ
                        
                        ∗). Substituting (14) into (13) to eliminate the power variable, we then have
                           
                              (15)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            log
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 m
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           ‾
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           γ
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 nn
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           km
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                     β
                                                                     ln
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                          -
                                          β
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        μ
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            β
                                                            ln
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  
                                                                     
                                                                        nn
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                               
                                                                  km
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              ≜
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ,
                                                m
                                                ∈
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      rt
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                                m
                                                ∈
                                                {
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      rt
                                                   
                                                
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                M
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .

Now, taking (
                           ρ
                        ,
                        
                           δ
                        ) into consideration, we can redefine (9) as
                           
                              (16)
                              
                                 g
                                 (
                                 β
                                 ,
                                 μ
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          {
                                          ρ
                                          ,
                                          δ
                                          }
                                          ∈
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                    
                                       req
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                              ≜
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         log
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              μ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              nn
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        km
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                                  β
                                                                  ln
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       β
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         β
                                                         ln
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               
                                                                  
                                                                     nn
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               km
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                           
                        , which has the same form as the inner part of (15) for a particular transmission path (s,
                        k,
                        m).

Given subcarrier pair (n,
                        n′), i.e., when 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              1
                           
                        , we can determine the optimal relay-user pair using 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                           
                        . To maximize g(β,
                        
                           μ
                        ) for given 
                           ρ
                         and fixed (β,
                        
                           μ
                        ), we can maximize 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                           
                        , i.e., select the relay-user pair, as follows:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   km
                                                
                                                
                                                   
                                                      
                                                         nn
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         (
                                                         k
                                                         ,
                                                         m
                                                         )
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   =
                                                   arg
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            {
                                                            k
                                                            ,
                                                            m
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         
                                                            
                                                               nn
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         km
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where (k,
                        m)∗ is the optimal relay-user pair for a particular subcarrier pair (n,
                        n′). Thus, the optimal relay-user pair assignment can be obtained 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ∗
                                 
                              
                              =
                              {
                              
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    ∗
                                 
                              
                              }
                           
                        .

Next, we can determine the optimal subcarrier-pair 
                           ρ
                        
                        ∗. Using (17), we can rewrite (16) as
                           
                              (18)
                              
                                 g
                                 (
                                 β
                                 ,
                                 μ
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          {
                                          ρ
                                          }
                                          ∈
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                    
                                       req
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ≜
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          (
                                          k
                                          ,
                                          m
                                          )
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                        . This problem is equivalent to maximizing 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        , which turns out to be a classic two-dimensional assignment problem and can be solved using the well-known Hungarian algorithm [25] in polynomial time of O(N
                        3).

Once optimal primal variables (
                           ρ
                        
                        ∗,
                        
                           δ
                        
                        ∗,
                        
                           p
                        
                        ∗) for given dual variables are determined, we can obtain the dual function g(β,
                        
                           μ
                        ), and then the standard dual optimization problem can be expressed as
                           
                              (19)
                              
                                 
                                    
                                       min
                                    
                                    
                                       {
                                       β
                                       ,
                                       μ
                                       }
                                    
                                 
                                 g
                                 (
                                 β
                                 ,
                                 μ
                                 )
                              
                           
                        subject to 
                           
                              β
                              ⩾
                              0
                              ,
                              μ
                              ⪰
                              0
                           
                        .

Since the problem in (19) is a convex optimization problem [24], a gradient-type search algorithm can be adopted which is guaranteed to converge to the global optimum. However, g(β,
                        
                           μ
                        ) is not necessarily differentiable, resulting in nonexistence of its gradient. In this case, subgradient methods or ellipsoid methods [15] can be valid candidates. Ellipsoid methods converge faster than subgradient methods, but require more computational time and memory when updating dual variables. Subgradient methods are of lower complexity and less cost than ellipsoid methods, and are amenable to distributed implementations [26]. Thus, we adopt subgradient methods in this paper.

By definition, a subgradient of function g at x is a vector h satisfying the following inequality:
                           
                              (20)
                              
                                 g
                                 (
                                 y
                                 )
                                 ⩾
                                 g
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 y
                                 -
                                 x
                                 )
                                 ,
                                 ∀
                                 y
                              
                           
                        With the inequality in (20), we can see that the set of subgradient of g at x is the subdifferential of g at x, i.e., h
                        ∈
                        ∂g(x). Then, with the substituted optimal primal variables (
                           ρ
                        
                        ∗,
                        
                           δ
                        
                        ∗,
                        
                           p
                        
                        ∗), a subgradient of g at some (β,
                        
                           μ
                        ) can be obtained as:
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∂
                                                         g
                                                      
                                                      
                                                         ∂
                                                         β
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            K
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               
                                                                  
                                                                     nn
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     k
                                                                     ,
                                                                     m
                                                                     )
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∂
                                                         g
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            K
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     km
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           nn
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         req
                                                      
                                                   
                                                   ,
                                                   
                                                   m
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         rt
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             
                                                
                                                   nn
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   k
                                                   ,
                                                   m
                                                   )
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               nn
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               k
                                                               ,
                                                               m
                                                               )
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                              ,
                              m
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    rt
                                 
                              
                              }
                           
                        .

With the subgradient in (21), the dual variables (β,
                        
                           μ
                        ) in (19) can be updated at each iterative step using the following projected subgradient method:
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           m
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           m
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   ,
                                                   
                                                   m
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         rt
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              {
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         are the stepsizes and the subgradients at the lth iteration, respectively. (⋅)+ projects (β,
                        
                           μ
                        ) to the nonnegative orthant to satisfy the constraints of the dual problem in (19).

To implement the above subgradient method, one important issue is to select good initial values of (β,
                        μ). Inappropriate initial values may yield infeasible solution or unexpected oscillation in the course of iterations. One suitable choice of the initial values can be found in Proposition 1 as below:
                           Proposition 1
                           
                              The dual variables (β,
                                 μ) can be initialized as
                              
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               m
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ∈
                                                         (
                                                         1
                                                         ,
                                                         2
                                                         )
                                                         ,
                                                         
                                                         m
                                                         ∈
                                                         {
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               rt
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                               ln
                                                               2
                                                            
                                                         
                                                         ·
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              T
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              ∑
                                                                           
                                                                           
                                                                              n
                                                                              =
                                                                              1
                                                                           
                                                                           
                                                                              N
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       1
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             (
                                                                                             
                                                                                                
                                                                                                   γ
                                                                                                
                                                                                                
                                                                                                   n
                                                                                                
                                                                                             
                                                                                             )
                                                                                          
                                                                                          
                                                                                             MAX
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where (γn)MAX is the maximum of all 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          km
                                       
                                    
                                 
                               
                              for given subcarrier n.

Assume the dual problem in (19) is feasible, i.e., there is a dual point (β,
                              
                                 μ
                              ) satisfying the constraints in (19) and g(β,
                              
                                 μ
                              )<∞, and there exists a primal-dual feasible pair (β,
                              
                                 μ
                              ,
                              
                                 ρ
                              
                              ∗,
                              
                                 δ
                              
                              ∗,
                              
                                 p
                              
                              ∗). Then, at a primal-dual feasible pair, the total power constraint is satisfied. Thereby, with (14), for all active subcarrier pairs (n,
                              n′) with each of which is assigned to its optimal relay-user pair and is allocated to some positive amount of power, we have
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      β
                                                      ln
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            
                                                               
                                                                  nn
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            km
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       ⩽
                                       0
                                    
                                 
                              Solving the inequality with respect to β, we obtain
                                 
                                    (25)
                                    
                                       β
                                       ⩾
                                       
                                          
                                             1
                                          
                                          
                                             2
                                             ln
                                             2
                                          
                                       
                                       ·
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         
                                                            
                                                               nn
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         km
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                       □
                                    
                                 
                              
                           

If we start the iteration from a dual point satisfying (25), the distance between the starting point and the optimal point if exists is narrow, which facilitates convergence process. This inequality must be satisfied for the chosen 
                           
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         associating with the active subcarrier pair and the optimal relay-user pair. Since the information of the chosen 
                           
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                         is unknown before solving the dual problem of (19); in reality, we can relax the above inequality to its upper bound when initializing dual variable β:
                           
                              (26)
                              
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          sup
                                       
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      nn
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                km
                                             
                                          
                                          ∈
                                          γ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                ln
                                                2
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      T
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            
                                                               
                                                                  nn
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            km
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       ln
                                       2
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            MAX
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           γ
                         denotes the set of all 
                           
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    km
                                 
                              
                           
                        .

Furthermore, the required transmission rate 
                           
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                                 
                                    req
                                 
                              
                           
                         for each RT user m must be satisfied at a primal-dual feasible pair. This implies that RT users prioritize to NRT users. Meanwhile, a user can obtain resources, including subcarrier pairs, relays and power, if and only if it is selected in the process of relay-user pairing by the rule of (17). Hence, we can set 
                           
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              >
                              1
                           
                         for RT user m so as to increase its opportunity to be chosen. However, if 
                           
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                         is too large, NRT users are hardly to be chosen. Hence, we simply set 
                           
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              ∈
                              (
                              1
                              ,
                              2
                              )
                           
                         for all RT users as a tradeoff.

Denote 
                           
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              (
                              ⩽
                              N
                              )
                           
                         as the number of subcarrier pairs assigned to user m,∀
                        m
                        ∈{1,…,
                        M}, together with 
                           
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              ∈
                              (
                              1
                              ,
                              2
                              )
                              ,
                              ∀
                              m
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    rt
                                 
                              
                              }
                           
                        , we have
                           
                              (27)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 (
                                 1
                                 ·
                                 
                                    
                                       N
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 ·
                                 N
                              
                           
                        
                     

Thus, we can further relax the inequality (26) and set β
                        0 with lower computational complexity as follows:
                           
                              (28)
                              
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       ln
                                       2
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                          
                                             0
                                          
                                       
                                       N
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            MAX
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Another important issue is the selection of stepsize. There are many ways to choose the stepsize in subgradient methods. A basic one is to apply the nonsummable diminishing stepsize [26], e.g., 
                           
                              
                                 
                                    s
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          l
                                       
                                    
                                 
                              
                           
                         where θ is a small enough constant, which satisfies these conditions: 
                           
                              
                                 
                                    lim
                                 
                                 
                                    l
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    l
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    ∑
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    l
                                 
                              
                              =
                              ∞
                              ,
                              
                                 
                                    s
                                 
                                 
                                    l
                                 
                              
                              ⩾
                              0
                           
                        . Such a stepsize rule converges to zero as l
                        →∞, making the subgradient method converges. We use this stepsize selection approach for the updating process of all dual variables (β,
                        
                           μ
                        ), i.e., 
                           
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    l
                                 
                              
                              ,
                              ∀
                              m
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    rt
                                 
                              
                              }
                           
                        . To make it work efficiently, θ should be selected properly, which is also the initial value of stepsize. Proposition 2 provides a method for the selection.
                           Proposition 2
                           
                              The initial stepsize for the above nonsummable diminishing stepsize selection in this paper is recommended as:
                                 
                                    (29)
                                    
                                       θ
                                       =
                                       α
                                       ·
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       α
                                       ∈
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                              
                              and it can be reset as
                              
                                 
                                    (30)
                                    
                                       θ
                                       =
                                       α
                                       ·
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      |
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            β
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ·
                                                (
                                                |
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      β
                                                   
                                                   
                                                      l
                                                   
                                                
                                                |
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       ,
                                       
                                       α
                                       ∈
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                              
                              if the power constraint is violated.

Observing (14), (21) and (22), we can see that if βl
                              
                              =0 at the lth iteration, βl
                              
                              +1 turns into positive infinity; this value is then held at the ensuing iterations, yielding infeasible solution to the dual problem in (19). To avoid this from happening, βl
                               should be higher than zero, which is equivalent to
                                 
                                    (31)
                                    
                                       
                                          
                                             β
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   l
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   β
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   β
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       >
                                       0
                                       
                                       □
                                    
                                 
                              
                           

In inequality (31), 
                           
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              >
                              0
                           
                         always holds for finite iterations. However, 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                         can be zero or negative. We discuss all the three cases of 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                         as follows.


                        Case 1: if 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              >
                              0
                           
                        , (31) yields 
                           
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              <
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              /
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                        . Since the sum allocated power at lth iteration is nonnegative, the subgradient 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                         in (21) satisfies 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              ⩽
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                           
                        . Hence, a minimum open upper-bound of 
                           
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                         can be obtained: 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    sup
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                        . Because θ is suggested to be small enough but not too small, we can initialize it as: 
                           
                              θ
                              =
                              α
                              ·
                              min
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                              ,
                              α
                              ∈
                              (
                              0
                              ,
                              1
                              )
                           
                        . The scaling factor α can be set to a value near 1, contributing to faster convergence compared with smaller α. Note that, 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                         can be regarded as a minimum open upper-bound of the stepsize, which thus can be used as the upper-bound value for initializing the stepsize to ensure the stepsize is not “too small”. But, 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                         may be not “small enough” or even very large when the PT
                         is far less than 1. Thus, we adopt 
                           
                              min
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                         instead of 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                         to make the initialized stepsize small enough but not too small; where, to some extent, PT
                         can be interpreted as a scaling factor in the stepsize initialization to regulate the initialized value properly.


                        Case 2: if 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              =
                              0
                           
                        , (31) yields βl
                        
                        +1
                        =
                        βl
                        , implying that dual variable β reaches or likely approaches to its stable optimal value.


                        Case 3: if 
                           
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              <
                              0
                           
                        , (31) yields βl
                        
                        +1
                        >
                        βl
                        , which is an ascendent searching direction, resulting from the violation of power constraint. In this case, the stepsize should be small enough to maintain moderate variations of β, avoiding sharp oscillation. To this end, we can reset and scale θ using 
                           
                              |
                              
                                 
                                    h
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              |
                           
                         as: 
                           
                              θ
                              =
                              α
                              ·
                              min
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   l
                                                
                                             
                                          
                                          
                                             (
                                             |
                                             
                                                
                                                   h
                                                
                                                
                                                   β
                                                
                                                
                                                   l
                                                
                                             
                                             |
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       ·
                                       (
                                       |
                                       
                                          
                                             h
                                          
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                              α
                              ∈
                              (
                              0
                              ,
                              1
                              )
                           
                        .

Since 
                           
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    l
                                 
                              
                           
                         can be regarded as a private factor for RT user m and is affected by βl
                         indirectly, the stepsize 
                           
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                           
                         can be set equal to 
                           
                              
                                 
                                    s
                                 
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                           
                         for simplicity.

Since the duality gap is not zero when N is insufficiently large, the optimal solution to the dual problem of (19) may be infeasible for the primal problem of (2). To solve this problem, we can refine the power allocation to satisfy constraints (5) and (6) using the optimal primal variables (
                           δ
                        
                        ∗,
                        
                           ρ
                        
                        ∗) obtained in the dual problem as the active relay-user pairs and subcarrier pairs. Specifically, denoting A
                              km
                           
                         as the set of active subcarrier pairs for relay-user pair (k,
                        m), we can convert the primal problem to the following problem:
                           
                              (32)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          p
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                rt
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          n
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 )
                              
                           
                        subject to:
                           
                              (33)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          n
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 ⩽
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          n
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                km
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                    
                                       req
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       rt
                                    
                                 
                                 }
                              
                           
                        
                     

Since this problem is a convex optimization problem, it can be solved using the dual method with zero duality gap [17]. Applying KKT conditions and the subgradient method described in Section 3.2, the optimal primal variable 
                           p
                        
                        ∗ for (32) can be readily obtained. Note that, since subcarrier pairs and relay-user pairs have been determined in Sections 3.1 and 3.2, we can initialize dual variable β using the right-hand part of inequality (25) instead of the corresponding estimated value in (23).

The overall procedure of the proposed resource allocation solution can be summarized as the algorithm in Algorithm 1. The algorithm is asymptotically optimal when N is sufficiently large. Due to lack of a good stopping criterion, subgradient methods are usually used in practice without any formal stopping criterion [26,27]. Hence, we terminate the iteration process when the number of iterations reaches configured preset maximum value I
                        MAX. In this case, the worst computational complexity of the proposed algorithm is on the order of O(I
                        MAX
                        ⋅(N
                        2
                        KM
                        +
                        N
                        3)), where N
                        2
                        KM comes from the optimal relay-user pair selection for all possible subcarrier pairs and N
                        3 comes from the Hungarian algorithm to find the optimal subcarrier-pairs. If considering simple unrefined stopping criteria, we can stop the iteration process in advance if the maximum interval of every other dual variables or dual objective function values is less than ε, i.e., 
                           
                              max
                              {
                              |
                              
                                 
                                    β
                                 
                                 
                                    l
                                    +
                                    2
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              |
                              ,
                              |
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    l
                                    +
                                    2
                                 
                              
                              -
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    l
                                 
                              
                              |
                              }
                              ⩽
                              ,
                              ∀
                              m
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    rt
                                 
                              
                              }
                           
                         or |gl
                        
                        +2
                        −
                        gl
                        |⩽
                        ε, provided that the required number of iterations is less than I
                        MAX.
                           
                              
                                 
                                 
                                    
                                       
                                          Algorithm 1: Proposed iterative resource allocation algorithm under total power constraint
                                    
                                 
                                 
                                    
                                       1: 
                                          Initialize: (β
                                          0,
                                          
                                             μ
                                          
                                          0) and stepsize using (23) and (29), respectively; set l
                                          =0.
                                    
                                    
                                       2: Compute 
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      
                                                         
                                                            nn
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      km
                                                   
                                                
                                             
                                           for each (n,
                                          n′) and (k,
                                          m) pair, respectively.
                                    
                                    
                                       3: 
                                          Repeat:
                                       
                                    
                                    
                                       4: 
                                          Obtain relay-user pair matrix 
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            km
                                                         
                                                         
                                                            
                                                               
                                                                  nn
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                           using (17) with matrix 
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      
                                                         
                                                            nn
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      km
                                                   
                                                
                                             
                                           for each (n,
                                          n′).
                                    
                                    
                                       5: 
                                          Obtain subcarrier pair matrix 
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            
                                                               
                                                                  nn
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                           using Hungarian algorithm with 
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      
                                                         
                                                            nn
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                           in (18).
                                    
                                    
                                       6: 
                                          Obtain power allocation matrix 
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            
                                                               
                                                                  nn
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            km
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                           using (14) for each paired (n,
                                          n′) in subcarrier pair matrix over its associated (k,
                                          m)∗ pair.
                                    
                                    
                                       7: 
                                          Reset stepsize using (30) if the power constraint is violated.
                                    
                                    
                                       8: 
                                          Update (βl
                                          ,
                                          
                                             μl
                                             
                                          ) using (22), then (l
                                          ←
                                          l
                                          +1).
                                    
                                    
                                       9: 
                                          Until: (βl
                                          ,
                                          
                                             μ
                                             l
                                          ) satisfies the stopping criterion, or l
                                          ==
                                          I
                                          MAX.
                                    
                                    
                                       10:Set 
                                             δ
                                          
                                          ∗,
                                          
                                             ρ
                                          
                                          ∗ obtained in the dual domain as the final optimal relay-user pair assignment and subcarrier pairing, respectively.
                                    
                                    
                                       11: Refine power allocation and obtain optimal power allocation 
                                             p
                                          
                                          ∗ by solving (32) at given (
                                             δ
                                          
                                          ∗,
                                          
                                             ρ
                                          
                                          ∗).
                                    
                                 
                              
                           
                        
                     

In the previous section, we solved the joint optimization of relay-user pair selection, subcarrier-pairing and power allocation under the total power constraint in (5), and proposed an iterative resource allocation algorithm shown in Algorithm 1. In this section, we solve the same problem formulated in Section 2.3 except that individual power constraints are considered. The optimization problem is presented as follows:
                        
                           (35)
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       {
                                       ρ
                                       ,
                                       δ
                                       ,
                                       p
                                       }
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             rt
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                     subject to: (3), (4), (6), and,
                        
                           (36)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              ⩽
                              
                                 
                                    P
                                 
                                 
                                    s
                                 
                              
                           
                        
                     
                     
                        
                           (37)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              ∀
                              k
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              K
                              }
                           
                        
                     where Ps
                      and Pk
                      represent the power limits for BS and RS k, respectively.

The problem in (35) can also be solved by using the dual decomposition method; and, the solution is very similar to that in Section 3. We present the solving procedure briefly as follows.

The dual objective function of the primal problem of (35) is defined as:
                        
                           (38)
                           
                              g
                              (
                              β
                              ,
                              μ
                              )
                              ≜
                              
                                 
                                    
                                       sup
                                    
                                    
                                       
                                          
                                             
                                                p
                                                ∈
                                                P
                                                (
                                                ρ
                                                ,
                                                δ
                                                )
                                             
                                             
                                                {
                                                ρ
                                                ,
                                                δ
                                                }
                                                ∈
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                              L
                              (
                              ρ
                              ,
                              δ
                              ,
                              p
                              ,
                              β
                              ,
                              μ
                              )
                           
                        
                     with the Lagrangian
                        
                           (39)
                           
                              L
                              (
                              ρ
                              ,
                              δ
                              ,
                              p
                              ,
                              β
                              ,
                              μ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             rt
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             s
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             sk
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             km
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             rt
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             km
                                          
                                          
                                             
                                                
                                                   nn
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                          
                                             req
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        β
                     
                     =(βs
                     ,
                     β
                     1,…,
                     βK
                     )⪰0 and 
                        
                           μ
                           =
                           (
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 μ
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       rt
                                    
                                 
                              
                           
                           )
                           0
                        
                      are the dual variables. Parameters {
                        ρ
                     ,
                     
                        δ
                     ,
                     D,
                     P} inherit the corresponding definitions to those in Sections 2.3 and 3, but 
                        p
                      is changed to the set of {
                        
                           
                              
                                 p
                              
                              
                                 sk
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 km
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     } instead of 
                        
                           {
                           
                              
                                 p
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 km
                              
                           
                           }
                        
                     . Like in Section 3, we assume the Lagrangian here is always finite, and then g(
                        β
                     ,
                     
                        μ
                     )<∞.

The dual optimization problem is then given by
                        
                           (40)
                           
                              
                                 min
                              
                              g
                              (
                              β
                              ,
                              μ
                              )
                              ,
                              
                              subject to
                              
                              β
                              ⪰
                              0
                              ,
                              μ
                              ⪰
                              0
                           
                        
                     
                  

For given dual variables, i.e., fixed (
                        β
                     ,
                     
                        μ
                     ), we have
                        
                           (41)
                           
                              g
                              (
                              β
                              ,
                              μ
                              )
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             
                                                p
                                                ∈
                                                P
                                                (
                                                ρ
                                                ,
                                                δ
                                                )
                                             
                                             
                                                {
                                                ρ
                                                ,
                                                δ
                                                }
                                                ∈
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             s
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      rt
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                          
                                             req
                                          
                                       
                                    
                                 
                              
                           
                        
                     with 
                        
                           
                              
                                 L
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 km
                              
                           
                           =
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           
                              
                                 R
                              
                              
                                 km
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           -
                           (
                           
                              
                                 β
                              
                              
                                 s
                              
                           
                           
                              
                                 p
                              
                              
                                 sk
                              
                              
                                 n
                              
                           
                           +
                           
                              
                                 β
                              
                              
                                 k
                              
                           
                           
                              
                                 p
                              
                              
                                 km
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                        
                     , where 
                        
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             m
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   rt
                                                
                                             
                                             }
                                          
                                       
                                       
                                          
                                             1
                                             ,
                                             m
                                             ∈
                                             {
                                             
                                                
                                                   M
                                                
                                                
                                                   rt
                                                
                                             
                                             +
                                             1
                                             ,
                                             …
                                             ,
                                             M
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     .

To obtain the value of g(
                        β
                     ,
                     
                        μ
                     ) in (41), 
                        
                           
                              
                                 L
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 km
                              
                           
                        
                      should be maximized for a given transmission path (s,
                     k,
                     m) with subcarrier pair (n,
                     n′), which is equivalent to solving the following problem:
                        
                           (42)
                           
                              
                                 max
                              
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          nn
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    km
                                 
                              
                              ,
                              
                              subject to
                              
                              
                                 
                                    p
                                 
                                 
                                    sk
                                 
                                 
                                    n
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    p
                                 
                                 
                                    km
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ⩾
                              0
                           
                        
                     
                  

The optimal solution to (42) is
                        
                           (43)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  sk
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              μ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 s
                                                                              
                                                                           
                                                                           +
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       γ
                                                                                    
                                                                                    
                                                                                       sk
                                                                                    
                                                                                    
                                                                                       n
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       γ
                                                                                    
                                                                                    
                                                                                       km
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             n
                                                                                          
                                                                                          
                                                                                             ′
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ln
                                                                  2
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     
                                                                        sk
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  km
                                                               
                                                               
                                                                  
                                                                     
                                                                        n
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            sk
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            km
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  sk
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              μ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           +
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       γ
                                                                                    
                                                                                    
                                                                                       km
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             n
                                                                                          
                                                                                          
                                                                                             ′
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       γ
                                                                                    
                                                                                    
                                                                                       sk
                                                                                    
                                                                                    
                                                                                       n
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 s
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ln
                                                                  2
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     
                                                                        km
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              n
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        Proof
                        Denoting 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       sk
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       sk
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 R
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 L
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                              
                            to facilitate presentation, we have 
                              
                                 L
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 R
                                 -
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            and 
                              
                                 R
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 min
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 }
                                 )
                              
                           . Next, we consider two cases:


                           Case 1: For 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                              
                           , we get 
                              
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 >
                                 0
                              
                           . Hence, we have 
                              
                                 L
                                 ⩽
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 R
                                 -
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 0
                              
                           , where 
                              
                                 R
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           . It implies that L gets its maximum 
                              
                                 
                                    
                                       L
                                    
                                    
                                       MAX
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 R
                                 -
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 }
                              
                            when 
                              
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                              
                           . Then, the problem in (42) is equivalent to
                              
                                 
                                    
                                       max
                                    
                                    
                                       
                                          L
                                       
                                       
                                          MAX
                                       
                                    
                                    ,
                                    
                                    subject to
                                    
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ⩾
                                    0
                                 
                              
                           
                        

The solution can be obtained easily by differentiating L
                           MAX respect to p
                           1 and applying KKT conditions, i.e.,
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          2
                                          ln
                                          2
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          1
                                          +
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   s
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        

We can get 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       2
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             s
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                       ln
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           . Due to the constraint 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ⩾
                                 0
                              
                           , we have the optimal value 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   2
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                   ln
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                              
                           , and then 
                              
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . Thus, the optimal solution in (43) follows.


                           Case 2: For p
                           1
                           γ
                           1
                           >
                           p
                           2
                           γ
                           2, we have 
                              
                                 R
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            and 
                              
                                 L
                                 ⩽
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 R
                                 -
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Using the method in Case 1, we can get the same results for 
                              
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                              
                           .□

With the results in (43), the optimal power allocation 
                        
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                           =
                           {
                           
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       sk
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 ∗
                              
                           
                           }
                        
                      is obtained. Also, we can obtain the optimal 
                        
                           
                              
                                 L
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 km
                              
                           
                        
                      associated with a given path as
                        
                           (44)
                           
                              
                                 
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          km
                                       
                                    
                                    )
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               sk
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         B
                                                         ln
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                2
                                                ln
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                B
                                             
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      sk
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                           
                        
                     where 
                        
                           B
                           =
                           
                              
                                 β
                              
                              
                                 s
                              
                           
                           +
                           
                              
                                 
                                    
                                       γ
                                    
                                    
                                       sk
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       γ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 β
                              
                              
                                 k
                              
                           
                        
                     .

After attaining the optimal 
                        
                           
                              
                                 L
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 km
                              
                           
                        
                      for each possible given path, we can determine the optimal relay-user pair for a given subcarrier pair (n,
                     n′) as
                        
                           (45)
                           
                              
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          km
                                       
                                       
                                          
                                             
                                                nn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                
                                                   
                                                      (
                                                      k
                                                      ,
                                                      m
                                                      )
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                =
                                                arg
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         {
                                                         k
                                                         ,
                                                         m
                                                         }
                                                      
                                                   
                                                
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      
                                                         
                                                            nn
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      km
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 H
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 km
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       km
                                    
                                 
                                 )
                              
                              
                                 ∗
                              
                           
                        
                     , and (k,
                     m)∗ is the optimal relay-user pair for a given (n,
                     n′). Thus, we have the optimal relay-user pair 
                        
                           
                              
                                 δ
                              
                              
                                 ∗
                              
                           
                           =
                           {
                           
                              
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       km
                                    
                                    
                                       
                                          
                                             nn
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 ∗
                              
                           
                           }
                        
                     .

Then, by maximizing 
                        
                           
                              
                                 H
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           (
                           =
                           
                              
                                 H
                              
                              
                                 
                                    
                                       nn
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       k
                                       ,
                                       m
                                       )
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           )
                        
                     , which can be solved by using the Hungarian algorithm, we can get the optimal subcarrier-pair 
                        ρ
                     
                     ∗.

With (
                        ρ
                     
                     ∗,
                     
                        δ
                     
                     ∗,
                     
                        p
                     
                     ∗), the value of g(
                        β
                     ,
                     
                        μ
                     ) in (41) can be obtained finally. Then, the dual optimization problem in (40) can be solved by updating dual variables (
                        β
                     ,
                     
                        μ
                     ) using the subgradient method like that in Section 3.2, with a subgradient as
                        
                           (46)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      g
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      s
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  sk
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      g
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  km
                                                               
                                                               
                                                                  
                                                                     
                                                                        n
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      g
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  km
                                                               
                                                               
                                                                  
                                                                     
                                                                        nn
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                -
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      req
                                                   
                                                
                                                ,
                                                
                                                m
                                                ∈
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      rt
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We then perform the power allocation refinement and get the final solution to (35), with the overall procedure similar to Algorithm 1.

@&#PERFORMANCE EVALUATION@&#

In this section, we evaluate the performance of the proposed algorithms under a multi-relay multi-user scenario depicted in Fig. 1. To obtain channel gains in the frequency domain, we first generate a zero-mean unit-variance complex Gaussian random variables representing finite impulse response (FIR) channels with length L
                     =3 (i.e., 3 taps). We simulate normalized frequency channel gains independently for all wireless channels between any two stations. We also normalize the noise power on each channel/link to unity. Hence, the channel-to-noise ratio on subcarrier n between node i and j is represented as 
                        
                           
                              
                                 γ
                              
                              
                                 ij
                              
                              
                                 n
                              
                           
                           =
                           N
                           ·
                           |
                           
                              
                                 h
                              
                              
                                 ij
                              
                              
                                 n
                              
                           
                           
                              
                                 |
                              
                              
                                 2
                              
                           
                        
                     .

We first observe the convergence performance of the proposed algorithms with the results shown in Fig. 2
                        . Since the proposed algorithms under total power constraint and under individual power constraints have the same framework, and the one under total power constraint has fewer dual variables which facilitate analysis, we only show its results in Fig. 2. We consider four relay stations and four users including two RT users with required transmission rates of 1bps/Hz and 2bps/Hz, where the rates are normalized to 1Hz of the system bandwidth based on Eq. (1). The system power and available number of subcarriers are 15W and 32, respectively.

As can be seen in Fig. 2(a), the dual objective functions g(β,
                        
                           μ
                        ) with and without power allocation refinement process converge to almost the same level, implying that the number of subcarriers N
                        =32 is sufficiently large to remove the duality gap between the primal problem of (2) and the dual problem of (19). Furthermore, for the first 200 iterations, g(β,
                        
                           μ
                        ) without the power allocation refinement process fluctuates rapidly while its counterpart with the refinement experiences much smoother and smaller function variations. Such fluctuations happen because the optimal subcarrier pairs and optimal relay-user pairs need to be determined at each iterative period (i.e., step 3 to step 9 in Algorithm 1) before the power allocation refinement process (i.e., step 11 in Algorithm 1), resulting in rapid adjustment of dual variables (Fig. 2(b)) and thus rapid fluctuation of dual objective function (Fig. 2(a)). Fig. 2(c) plots the transmission rates of users at each iteration. It can be seen that these results are in accordance with those variational tendency in Fig. 2(b) and reveal that the power refinement process improves the adjustment of RT users’ transmission rates.

For the stopping criterion, given a threshold 
                           
                              ∊
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    5
                                 
                              
                           
                        , the required number of iterations in this experiment is 109 and 541 for the cases without and with power allocation refinement process, respectively, if 
                           
                              |
                              
                                 
                                    g
                                 
                                 
                                    l
                                    +
                                    2
                                 
                              
                              -
                              
                                 
                                    g
                                 
                                 
                                    l
                                 
                              
                              |
                              ⩽
                              ∊
                           
                         is used. And, the numbers are increased to 110 and 2233 respectively if 
                           
                              max
                              {
                              |
                              
                                 
                                    β
                                 
                                 
                                    l
                                    +
                                    2
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              |
                              ,
                              |
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    l
                                    +
                                    2
                                 
                              
                              -
                              
                                 
                                    μ
                                 
                                 
                                    m
                                 
                                 
                                    l
                                 
                              
                              |
                              }
                              ⩽
                              ,
                              ∀
                              m
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    rt
                                 
                              
                              }
                           
                         is used. These numbers are also marked in Fig. 2(a). In general, both stopping criteria work well.

We now evaluate the system performance of the proposed algorithms. Two cases are considered: (i) with total power constraint and (ii) with individual power constraints. In the first case, the performance is compared with a symbol-based algorithm under total power constraint that is derived from the idea in [7]; and in the second case, the performance is compared with that of a fairness-aware algorithm [12] under individual power constraints. Authors in [7] prove that the ordered subcarrier pairing is optimal for both amplify-and-forward and decode-and-forward relay links when optimal power allocation is adopted for two-hop single relaying OFDM links, which provides an idea in terms of maximizing instantaneous rate for single-relay OFDM system, i.e., by using ordered subcarrier pairing and optimal power allocation. Combined with the symbol-based relay selection strategy, the idea in [7] can be extended to multi-relay OFDM systems without radical changes, and can be easily implemented as a symbol-based algorithm. Note that, subcarrier pairing is still employed in the symbol-based algorithm but only at the selected relay. Specifically, the major steps of the resulting symbol-based algorithm for multi-relay multi-user scenarios are as follows:
                              
                                 (i)
                                 for each relay, subcarriers in each hop are sorted in the descending order based on the corresponding channel-to-noise ratios;

for each relay k, a user m′ for each subcarrier n′ in the second hop is selected as 
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          arg
                                          
                                             
                                                max
                                             
                                             
                                                {
                                                m
                                                }
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                km
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    ;

the relay kbest
                                     with the maximum sum-rate among all relays under equal power assumption is selected as the best relay, i.e., 
                                       
                                          
                                             
                                                k
                                             
                                             
                                                best
                                             
                                          
                                          =
                                          arg
                                          
                                             
                                                max
                                             
                                             
                                                {
                                                k
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         log
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            min
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 γ
                                                                              
                                                                              
                                                                                 sk
                                                                              
                                                                              
                                                                                 n
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 T
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                           N
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 γ
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       km
                                                                                    
                                                                                    
                                                                                       ′
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       n
                                                                                    
                                                                                    
                                                                                       ′
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 T
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                           N
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    ;

the ordered subcarriers in two hops are paired and the equivalent channel-to-noise ratio is calculated for each subcarrier pair;

optimal power allocation is performed with the water-filling approach on the paired subcarriers.

Regarding the fairness-aware algorithm in [12], similar to this paper, it considers subcarrier pairing, relay selection and power allocation in multi-relay multi-user scenarios; but it regulates users’ QoS requirements by proportional fairness that is conducted by a set of predetermined constants which can be regarded as proportional fairness factors.

Overall, the rationale behind choosing above two algorithms as the benchmarks is due to four key factors considered in the proposed algorithms: (i) the capability to support QoS for heterogeneous traffic, (ii) considering subcarrier-pairing in the system model, (iii) considering total power constraint or individual power constraint in the problem formulation, and (iv) joint optimization of relay selection, subcarrier-pairing and power allocation. The following are the detailed reasons:
                              
                                 (i)
                                 Flexible QoS support for heterogeneous traffic is one of the major concerns in this paper. [7] does not take traffic characteristics into consideration, and [12] adopts proportional fairness to achieve the required QoS for different users, while this paper differentiates the heterogeneous traffic requirements explicitly. Thus, by comparing with [7,12], we can evaluate the validity of the proposed algorithm in terms of the capability of heterogeneous traffic support, as well as the importance of taking traffic features into account when designing resource allocation algorithms in terms of providing required QoS guarantee.

This paper adopts subcarrier pairing to exploit the channel diversity over the two-hop channels in OFDM relaying systems. Refs. [7,12] also apply subcarrier pairing.

This paper proposes two algorithms. One is under total power constraint and the other is under individual power constraint. The symbol-based algorithm derived from [7] is under total power constraint, while the fairness-aware algorithm in [12] is under individual power constraint. Thus, they can serve as the benchmark schemes when evaluating the two proposed algorithms, respectively.

This paper considers a joint optimization of relay selection, subcarrier-pairing and power allocation. The symbol-based algorithm derived from [7] and the fairness-aware algorithm in [12] also optimize the comparable factors, although utilizing different methods; for instance, selecting only one (best) relay in the symbol-based algorithm and decoupling the allocation process into two steps to decrease computational complexity in the fairness-aware algorithm. Thus, by comparing with these two algorithms, we can evaluate the performance gaps among different schemes.

Next, we evaluate the system performance in various settings. Note that, in the subsequent simulation results, each point in any figure, from Figs. 3–6, is obtained through averaging the results over 100 runtimes for different channel responses.

We first investigate the performances of the four algorithms with different number of subcarriers. The simulated network consists of one base station, four relays and four users with one RT user. The required transmission rates of the RT user are 4bps/Hz for the algorithms under total power constraint and 3bps/Hz for those under individual power constraints, respectively. For total power constraint, the system power is set to 20W. For individual power constraints, we set the maximum transmission power of the base station to 6.67W and that of each relay to 3.33W. The simulation results are shown in Fig. 3
                           .

From Fig. 3, for both the proposed algorithm under total power constraint and the proposed algorithm under individual power constraints, we observe that the transmission rate of the RT user is unsatisfied without power allocation refinement when the number of subcarriers is low, e.g. 8 and 16; however, it achieves its goal after the power allocation refinement process. This fact reveals that the power allocation refinement process helps to get feasible solutions when the duality gap exists. We can also see that more subcarriers contribute to higher capacity with all algorithms although in different increments. However, only the proposed algorithms can provide the required rates for the RT user.

We now analyze the RT user rate and NRT users’ mean rate in Fig. 3. For the algorithms under total power constraint, it can be seen that the NRT users’ mean rate of the proposed algorithm exceeds that of the symbol-based algorithm only when the number of subcarriers is close to or higher than 32. However, the RT user’s rate of the symbol-based algorithm is only 2.5bps/Hz at most, which is much below of the required 4bps/Hz that is always achieved in the proposed algorithm. This is expected because (i) RT user has priority over NRT users to access resources in the proposed algorithm and this requirement is not considered in the symbol-based algorithm, and (ii) multiple relays are used in the proposed algorithm while the symbol-based algorithm uses only one relay. Regarding the latter, with the proposed algorithm, users have higher opportunity to obtain subcarriers with higher channel-to-noise ratios from different relays, resulting in higher sum of transmission rates.

For those algorithms under individual power constraints, the proposed algorithm satisfies the required RT rate (i.e., 3bps/Hz); and the fairness-aware algorithm fails even the number of subcarriers increases to 64. Higher transmission rate for the RT user can be obtained if doubling the proportional fairness factor of the RT user [12] as shown in Fig. 3, but it is still below the required rate of 3bps/Hz. Even though one may acquire the desirable rate by configuring higher proportional fairness factor for the RT user, such predetermined scheme is not flexible in terms of providing QoS guarantee. In contrast, the proposed algorithm can avoid this problem by adjusting resource allocation adaptively based on individual QoS requirement of the RT user.

Next, we assess the effect of system power, denoting as PT
                           . For total power constraint, the maximum transmission power for any station is not fixed, while the sum powers of all stations limit to PT
                           . For individual power constraints, we have all equal Pk
                            and set PS
                           
                           =2Pk
                           , and the sum powers are also PT
                           , i.e., 
                              
                                 
                                    
                                       P
                                    
                                    
                                       S
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 ∀
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 K
                                 }
                              
                           . Again, we consider one base station, four relays and four users, but with two RT users. The number of subcarriers is 32. Without loss of generality, we assume that the required transmission rates of the two RT users are 4bps/Hz under total power constraint and 3bps/Hz under individual power constraints, respectively.

From Fig. 4
                           (a), we can see that the required transmission rates of RT users can be satisfied with the proposed algorithms as the system power exceeds 16W and 20W under total power constraint and individual power constraints, respectively. While the two compared algorithms, i.e., the symbol-based algorithm and the fairness-aware algorithm with equal fairness factor for all users, provide inadequate transmission rates for RT users even when the system power reaches 40W. Regarding the fairness-aware algorithm with doubling fairness factor for RT users, it achieves satisfied transmission rates for RT users (over 3bps/Hz) when the provided system power exceeds about 30W; the results suggest that improving the fairness factor for RT users works. However, such scheme is not flexible because it cannot adapt the fairness factor accurately as the requirements of RT users.

Additionally, the RT users’ mean transmission rate in the proposed algorithms is almost constant once the required power value reaches a threshold level, i.e., 16W or 20W, shown in Fig. 4(a). This in turn contributes to higher slope of NRT users’ rates as the system power increases in the proposed algorithms than that in the compared algorithms, as shown in Fig. 4(b). Moreover, it can be seen that, for the fairness-aware algorithm, the NRT users’ mean rate is reduced when doubling the fairness factor for RT users. It also can be observed that, for the proposed algorithms, when the required rates of RT users are not satisfied (shown in Fig. 4(a)) which is likely to cause service outage, the NRT users’ rates drop to zeros (shown in Fig. 4(b)), implying no resources allocated to them since the priority is on RT users. However, in this situation, the resources hold by the RT users should be released and reallocated to NRT users. This problem can be solved by admission control or a scheduler in the higher layer; while such a cross-layer design or analysis is beyond the scope of this work.

Furthermore, from Fig. 4(c), where the sum rates of all users are plotted as the function of system power, it is evident that, among the four algorithms, the proposed algorithm under total power constraint performs the best. The symbol-based algorithm is the second best but its performance is much worse than the proposed algorithm. The performance of the proposed algorithm under individual power constraints is only comparable to that of the symbol-based algorithm (which is an algorithm under total power constraint), but is better than that of the fairness-aware algorithm (no matter whether the fairness factor is doubled or not). Note that, the fairness-aware algorithm is a suboptimal one that has a lower complexity. Meanwhile, it is shown that the sum user rates of the fairness-aware algorithm are almost independent from the value of fairness factor. In all, these results imply that algorithms designed under total power constraint exploit the power resource much better than those under individual power constraints. Hence, the performances under total power constraint can serve as the upper bound when configuring individual powers for different stations and their proportions.

We also study the impact of the required transmission rates of RT users. In this case, the system is configured as in the previous scenario except that we fix the system power to 40W and vary the required transmission rates of RT users.


                           Fig. 5
                            shows that the proposed algorithms can provide target transmission rates for RT users within the range of 8bps/Hz under total power constraint and 6bps/Hz under individual power constraints, while the symbol-based algorithm, the fairness-aware algorithm with equal fairness factor and with doubling fairness factor support the transmission rates only up to 3.2bps/Hz, 2.9bps/Hz and 3.7bps/Hz, respectively. From Fig. 5, it can also be observed that, in the proposed algorithms, the mean transmission rate for NRT users declines as the required transmission rates of RT users increase, and falls to zero if the required rates of RT users are unattained or barely attained. This is because the priority is on RT users. Additionally, the mean transmission rate for NRT users in the fairness-aware algorithm cannot adjust adaptively according to the requirements of RT users.

Finally, we investigate the impact on the achievable user rates when the number of users in the system is varied. As before, we consider a network with one base station and four relays. The system power and the number of subcarriers are set to 40W and 32. The required transmission rate of each RT user is configured to 4bps/Hz under total power constraint and 3bps/Hz under individual power constraints. We run simulations in two separate scenarios: (i) with the fixed number of RT users (RT=2) and varied number of NRT users and (ii) with the fixed number of NRT users (NRT=2) and varied number of RT users, and we report the results in Fig. 6
                           (a) and (b), respectively.

From Fig. 6(a), it can be seen that when the number of RT users is fixed to two, the required rates of RT users can be always satisfied in the proposed algorithms while they are not achieved in the symbol-based algorithm and in the fairness-aware algorithm with equal fairness factor when the number of NRT users exceeds one; for the fairness-aware algorithm with doubling fairness factor, the required rates of RT users (i.e., 3bps/Hz) can be attained only when the number of NRT users is less than 4. In all algorithms, the mean rate of NRT users reduces as the total number of NRT users increases. Furthermore, when considering the mean rate of NRT users, the proposed algorithm under total power constraint still outperforms the symbol-based algorithm and fairness-aware algorithms with both equal and doubling fairness factors, implying that it can exploit user- and relay-diversity and system power. If the number of NRT users is fixed to two, as shown in Fig. 6(b), up to four and three RT users can be supported in the proposed algorithms under total power constraint and under individual power constraints, respectively; while only one RT user can be supported in the symbol-based algorithm and two at most in the fairness-aware algorithms. In summary, Fig. 6 demonstrates that the proposed algorithms provide better QoS support for RT users and obtain higher efficiency of resource utilization than the compared algorithms.

@&#CONCLUSION@&#

In this paper, we investigated the resource allocation problem in multi-relay multi-user DF OFDM systems with subcarrier-pairing at relay stations. We considered heterogeneous traffic and aimed to provide QoS guarantee for RT traffic and transmission rate maximization for NRT traffic. To this end, we formulated the resource allocation problem as a mixed integer programming problem and solved it using dual decomposition and subgradient methods. As a result, iterative resource allocation algorithms with total power constraint and with individual power constraints were developed. The convergence performance was then analyzed through simulations and the results demonstrate that the proposed algorithms exhibit fast convergence. We further evaluated the system performance of the proposed algorithms in multiple system configurations, and it is shown that the proposed algorithms outperform both the symbol-based and the fairness-aware algorithms in terms of QoS guarantees and sum network transmission rates. The results imply that the proposed algorithms exploit relay- and user-diversity better than the existing algorithms. Furthermore, total power constraint contributes much higher efficiency of system power utilization than that of individual power constraints; hence the performance under total power constraint can serve as the upper bound when configuring individual powers for different stations and their proportions. Moreover, the proposed algorithms are able to adjust system parameters adaptively according to the required transmission rate of each RT user, which is more flexible than the predetermined proportional fairness scheme as in the fairness-aware algorithm.

@&#ACKNOWLEDGEMENTS@&#

This work is supported by the National Natural Science Foundation of China under Grant Nos. 60970019 and 61373042, and the Key Program of the Science Foundation of Hubei Province of China under Grant No. 2009CDA132. We are extremely grateful to the editors and reviewers for their works and comments that help us to improve the quality of the paper.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.comcom.2014.12.004.


                     
                        
                           Supplementary data 1
                           
                        
                     
                     
                        
                           Supplementary data 2
                           
                        
                     
                     
                        
                           Supplementary data 3
                           
                        
                     
                     
                        
                           Supplementary data 4
                           
                        
                     
                     
                        
                           Supplementary data 5
                           
                        
                     
                     
                        
                           Supplementary data 6
                           
                        
                     
                     
                        
                           Supplementary data 7
                           
                        
                     
                     
                        
                           Supplementary data 8
                           
                        
                     
                     
                        
                           Supplementary data 9
                           
                        
                     
                  

@&#REFERENCES@&#

