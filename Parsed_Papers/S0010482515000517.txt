@&#MAIN-TITLE@&#Evaluation of bile reflux in HIDA images based on fluid mechanics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We used optical flow to ascertain the direction and velocity of bile flow to help physicians diagnose bile reflux exact.


                        
                        
                           
                           We combined image processing technology and hydrodynamic models to quantify bile reflux.


                        
                        
                           
                           We reconstructed 3D images from SPECT and CT to help physicians diagnosis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

HIDA image

Bile reflux

Image processing

Hydrodynamic model

Tc99m-DISIDA

SPECT

@&#ABSTRACT@&#


               
               
                  We propose a new method to help physicians assess, using a hepatobiliary iminodiacetic acid scan image, whether or not there is bile reflux into the stomach. The degree of bile reflux is an important index for clinical diagnosis of stomach diseases. The proposed method applies image-processing technology combined with a hydrodynamic model to determine the extent of bile reflux or whether the duodenum is also folded above the stomach. This condition in 2D dynamic images suggests that bile refluxes into the stomach, when endoscopy shows no bile reflux. In this study, we used optical flow to analyze images from Tc99m-diisopropyl iminodiacetic acid cholescintigraphy (Tc99m-DISIDA) to ascertain the direction and velocity of bile passing through the pylorus. In clinical diagnoses, single photon emission computed tomography (SPECT) is the main clinical tool for evaluating functional images of hepatobiliary metabolism. Computed tomography (CT) shows anatomical images of the external contours of the stomach, liver, and biliary extent. By exploiting the functional fusion of the two kinds of medical image, physicians can obtain a more accurate diagnosis. We accordingly reconstructed 3D images from SPECT and CT to help physicians choose which cross sections to fuse with software and to help them more accurately diagnose the extent and quantity of bile reflux.
               
            

@&#INTRODUCTION@&#

The cause of bile reflux gastritis is uncontrolled bile reflux into the stomach. When alkaline bile moves through the pylorus into the stomach, it can destroy the stomach mucosa solidity, posing the risk of gastritis that may eventually turn into cancer. Bile reflux may lead to mucosal injury and may appear with surgical excision of part of the stomach and the failure of the pylorus [1]. For this reason, physicians want to detect bile reflux as early as possible. From the fluid mechanics point of view, normal bile can be considered as a Newtonian fluid, and an increase in bile viscosity is an important factor in bile stone pathology [2,3]. Ooi et al. presented 2D and 3D computational models for bile flow in different geometrical cases of the cystic duct as a channel with baffles [4]. Li et al. simulated Newtonian and non-Newtonian bile flow in the cystic duct. They presented a model for analyzing bile flow at a T junction with rigid and flexible walls [5]. Agarwal et al. developed a mathematical model of bile flow, considering bile as a Herschel–Bulkley fluid in a constricted channel [6]. Maiti and Misra [7] presented a peristaltic flow motion model to evaluate the influence of critical pressure, porosity parameter, and bile velocity on reflux. Physicians are used to judging bile flow motion from diisopropyl iminodiacetic acid (DISIDA) images. If bile reflux is not serious, physicians cannot easily judge whether or not the bile flow is passing through the pylorus without analysis of SPECT DISIDA images. Physicians can easily judge the position of the stomach from CT images but cannot determine the bile flow to the stomach from SPECT images alone. The present study aimed to integrate CT and SPECT images to accurately find the position of the stomach and to determine whether or not there is reflux of bile into the stomach. Although instruments able to merge SPECT and CT, the procedure is very expensive, reflecting the high cost of the instruments to hospitals. For this reason, an interface is used to help physicians fuse DISIDA and SPECT images. Digital medical images are becoming increasingly more important to physicians, who use them to assess the severity of many diseases.


                     
                     Fig. 1 shows a flow chart of the analysis system proposed in this study. The system was built with MATLAB 7. In the system, we processed the dynamic DISIDA images using the proposed methods. This system can help doctors to estimate duodenogastric reflux and quantify the duodenogastric reflux easily.

@&#METHODOLOGY@&#


                     
                     Fig. 2 shows the human biliary system, which consists of the gallbladder, cystic duct, common hepatic duct, and common bile duct. The gallbladder, which is approximately 7–10cm in length and 1–3cm in width, stores 20–30ml of bile. The cystic duct is approximately 3.5cm in length and 3mm in width, and merges with the common bile duct. There are 3–7 crescentic folds known as the spiral valves of Heister, as shown in 
                     
                     Figs. 3 and 4. The hepatic common duct and common bile duct are approximately 4cm and 6–11cm long, respectively. Earlier experimental work by Rodkiewicz and Otto [8] showed that bile behavior is like a Newtonian fluid. According to their study in which the biliary system is divided into three parts, three hydromechanical models, as shown in Fig. 4, can be used to describe flow.


                        Fig. 3 shows that the cystic duct is not a straight tube but instead, is rotated and distorted. Thus, we cannot directly use the steady flow of fluid in the tube model. To improve the model of the cystic duct by referring to literature [9], we see the cystic duct rotation as a tube filled with the same half-size of the valve shown in Fig. 4. The curved pipe length is included in the calculation to analyze the model. After stretching the cystic duct to an equalization tube, we get into the steady flow tube model of fluid mechanics in application. Using this model, we combined the bile flow and optical flow to predict and evaluate the bile flow status. The following derivation describes the hydrodynamic modeling procedure and its results.

The equivalent diameter 
                           
                              
                                 d
                              
                              
                                 C
                                 D
                              
                           
                         of the cystic duct is dependent on the baffle number and baffle height H. 
                        Fig. 5 shows that the bile flow traveled twice the distance from points 1 to 2 between any two baffles in the duct, and 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                         are the corresponding cross-sectional areas at points 1 and 2. The sector area 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         can be easily calculated from formula (1) 
                        [9]:
                           
                              (1)
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       C
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 θ
                                 )
                                 /
                                 4
                                 −
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             C
                                             D
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       4
                                       −
                                       
                                          
                                             (
                                             H
                                             −
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   C
                                                   D
                                                
                                             
                                             )
                                             /
                                             2
                                             )
                                          
                                          2
                                       
                                    
                                 
                                 (
                                 H
                                 −
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       C
                                       D
                                    
                                 
                                 /
                                 2
                                 )
                                 )
                              
                           
                        where θ is half of the center angle of the baffle cut and is written as
                           
                              (2)
                              
                                 θ
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         tan
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     C
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               /
                                                               4
                                                               −
                                                               
                                                                  
                                                                     (
                                                                     H
                                                                     −
                                                                     
                                                                        
                                                                           d
                                                                        
                                                                        
                                                                           C
                                                                           D
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                         /
                                                         (
                                                         H
                                                         −
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               C
                                                               D
                                                            
                                                         
                                                         /
                                                         2
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   >
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         C
                                                         D
                                                      
                                                   
                                                   /
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   H
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         C
                                                         D
                                                      
                                                   
                                                   /
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                   +
                                                   
                                                      
                                                         tan
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     C
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               /
                                                               4
                                                               −
                                                               
                                                                  
                                                                     (
                                                                     H
                                                                     −
                                                                     
                                                                        
                                                                           d
                                                                        
                                                                        
                                                                           C
                                                                           D
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                         /
                                                         (
                                                         H
                                                         −
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               C
                                                               D
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   <
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         C
                                                         D
                                                      
                                                   
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For a given tube with fixed values of 
                           
                              
                                 L
                              
                              
                                 C
                                 D
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 C
                                 D
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         depends on the baffle height H only, so that we can obtain the maximum equivalent diameter 
                           
                              
                                 d
                              
                              
                                 e
                                 q
                                 ,
                                 
                                 max
                              
                           
                         of the cystic duct and the minimum equivalent diameter 
                           
                              
                                 d
                              
                              
                                 e
                                 q
                                 ,
                                 
                                 min
                              
                           
                        , as shown in Fig. 5:
                           
                              (3)
                              
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                       ,
                                       
                                       max
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       C
                                       D
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                       ,
                                       
                                       min
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       /
                                       π
                                    
                                 
                              
                           
                        
                     

The equivalent diameter 
                           
                              
                                 d
                              
                              
                                 e
                                 q
                              
                           
                         of the cystic duct can be expressed as
                           
                              (5)
                              
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                       ,
                                       
                                       min
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                       ,
                                       
                                       max
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       e
                                       q
                                       ,
                                       
                                       min
                                    
                                 
                                 )
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          n
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           
                              
                                 n
                              
                              
                                 C
                              
                           
                         is the maximum number of baffles considered. The equivalent length of the cystic duct is determined from the actual length of the flow passage along the duct, plus an extra length because of the complicated flow pattern:
                           
                              (6)
                              
                                 
                                    
                                       L
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 =
                                 H
                                 (
                                 n
                                 −
                                 1
                                 )
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       C
                                       D
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        where 
                           
                              
                                 L
                              
                              
                                 m
                              
                           
                         denotes the extra length corresponding to the minor pressure drop because of local vortices from the cross-sectional area expansion, contraction, and flow path bending in the baffle zone. Substituting maximum length 
                           
                              
                                 L
                              
                              
                                 m
                              
                           
                         for Poiseuille’s law [11], we obtained the bile flow equation in the cystic duct:
                           
                              (7)
                              
                                 Q
                                 =
                                 
                                    
                                       Δ
                                       P
                                       π
                                       
                                          
                                             D
                                          
                                          4
                                       
                                    
                                    
                                       128
                                       μ
                                       
                                          
                                             L
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The bile flow in the tube was a laminar flow when the Reynolds number (Re)<2300, and the tube entrance effect can be ignored when it is long enough. For this reason, the flow was fully developed in the tube. Considering that the model was a straight pipe with a fully developed flow within the region, the bile flow was an incompressible laminar flow, and its physical properties were constant. Using the momentum balance in the micro-elements of volume, we obtained the momentum equation and velocity distribution. It was assumed that every fluid particle that moved along the axial flow lines had a constant velocity in the fully developed laminar flow. The velocity distribution directions remained constant in the flow. Because there was no motion in the radial direction, the speed and flow direction of the vertical component was zero. Because it was a stable and fully developed flow, there was no acceleration. Now, a ring of micro-volume elements whose radius is r, thickness is dr, and tube axis length in the same direction is dx, as shown in 
                        Fig. 6 was considered [12].

Because the volume element was affected only by pressure and viscosity, the two must balance each other. The total force acting on the plane was the product of the pressure and the ring area. The force balance of the volume element was in the flow direction as
                           
                              (8)
                              
                                 
                                    
                                       (
                                       2
                                       π
                                       r
                                       d
                                       r
                                       P
                                       )
                                    
                                    
                                       X
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       2
                                       π
                                       r
                                       d
                                       r
                                       P
                                       )
                                    
                                    
                                       X
                                       +
                                       d
                                       X
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       2
                                       π
                                       r
                                       d
                                       x
                                       τ
                                       )
                                    
                                    
                                       r
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       2
                                       π
                                       r
                                       d
                                       x
                                       τ
                                       )
                                    
                                    
                                       r
                                       +
                                       d
                                       r
                                    
                                 
                                 =
                                 0
                              
                           
                        divided by 
                           2
                           π
                           d
                           r
                           d
                           x
                        , giving
                           
                              (9)
                              
                                 r
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             X
                                          
                                       
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 −
                                 r
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             X
                                             +
                                             d
                                             X
                                          
                                       
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             (
                                             r
                                             τ
                                             )
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       d
                                       r
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             (
                                             r
                                             τ
                                             )
                                          
                                          
                                             r
                                             +
                                             d
                                             r
                                          
                                       
                                    
                                    
                                       d
                                       r
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Making dr and dx close to zero, we obtained
                           
                              (10)
                              
                                 
                                    
                                       d
                                       (
                                       r
                                       τ
                                       )
                                    
                                    
                                       d
                                       r
                                    
                                 
                                 =
                                 r
                                 
                                    
                                       d
                                       P
                                    
                                    
                                       d
                                       x
                                    
                                 
                              
                           
                        substituting
                           
                              (11)
                              
                                 τ
                                 =
                                 μ
                                 
                                    
                                       d
                                       u
                                    
                                    
                                       d
                                       r
                                    
                                 
                              
                           
                        
                     

Setting μ as a constant, we obtained the relationship formula:
                           
                              (12)
                              
                                 
                                    μ
                                    r
                                 
                                 
                                    d
                                    
                                       d
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       r
                                       
                                          
                                             d
                                             u
                                          
                                          
                                             d
                                             r
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                       P
                                    
                                    
                                       d
                                       x
                                    
                                 
                              
                           
                        
                     

After integration into formula (12), we obtained
                           
                              (13)
                              
                                 u
                                 (
                                 r
                                 )
                                 =
                                 
                                    1
                                    
                                       4
                                       μ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             d
                                             P
                                          
                                          
                                             d
                                             x
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ln
                                 
                                 r
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

The distribution of velocity 
                           u
                           (
                           r
                           )
                         can produce C
                        2 by the boundary condition 
                           ∂
                           u
                           /
                           ∂
                           r
                        =0 (axial symmetry) when r=0 and r=R, then 
                           u
                           (
                           r
                           )
                        =0 (no sliding on the wall).
                           
                              (14)
                              
                                 C
                                 2
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             r
                                          
                                          2
                                       
                                    
                                    
                                       4
                                       μ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             d
                                             p
                                          
                                          
                                             d
                                             x
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

Then
                           
                              (15)
                              
                                 u
                                 (
                                 r
                                 )
                                 =
                                 
                                    1
                                    
                                       4
                                       μ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             d
                                             p
                                          
                                          
                                             d
                                             x
                                          
                                       
                                    
                                    )
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    2
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    2
                                 
                                 )
                              
                           
                        
                     

Thus, the velocity distribution of a fully developed laminar flow in the tube was a parabolic curve, with the maximum value at the center and the minimum value (zero) on the wall. Also, any axial velocity (u) of r is positive, so that the gradient dp/dx axial of pressure was negative (because of the relationship of viscosity, the pressure of the extension flow must be decreasing). The average velocity of the section in the flow channel was calculated by the mass conservation theorem:
                           
                              (16)
                              
                                 
                                    m
                                    •
                                 
                                 =
                                 ρ
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 ∫
                                 
                                    
                                       ρ
                                       
                                       
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                C
                                             
                                          
                                       
                                       
                                    
                                    u
                                    (
                                    r
                                    )
                                    d
                                    
                                       
                                          A
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                           
                        where 
                           
                              m
                              •
                           
                         is the flow rate of the mass, 
                           ρ
                         is the density,
                           
                              
                                 A
                              
                              
                                 C
                              
                           
                         is the cross-sectional area, and 
                           u
                           (
                           r
                           )
                         is the velocity distribution curve. Thus, the average rate of the incompressible flow, which is in the tube with radius R, can be expressed as
                           
                              (17)
                              
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             A
                                             c
                                          
                                       
                                       
                                          ρ
                                          u
                                          (
                                          r
                                          )
                                          d
                                          
                                             
                                                A
                                             
                                             
                                                C
                                             
                                          
                                       
                                    
                                    
                                       ρ
                                       
                                          
                                             A
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          0
                                          R
                                       
                                       
                                          ρ
                                          u
                                          (
                                          r
                                          )
                                          2
                                          π
                                          r
                                          d
                                          r
                                       
                                    
                                    
                                       ρ
                                       π
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    2
                                    
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                 
                                 
                                    ∫
                                    0
                                    R
                                 
                                 
                                    u
                                    (
                                    r
                                    )
                                    r
                                    d
                                    r
                                 
                              
                           
                        
                     

The average velocity can be obtained by substitution in the above equation:
                           
                              (18)
                              
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 =
                                 
                                    2
                                    
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                 
                                 
                                    ∫
                                    0
                                    R
                                 
                                 
                                    u
                                    (
                                    r
                                    )
                                    r
                                    d
                                    r
                                 
                                 =
                                 
                                    2
                                    
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                 
                                 
                                    ∫
                                    0
                                    R
                                 
                                 
                                    
                                       1
                                       
                                          4
                                          μ
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                d
                                                p
                                             
                                             
                                                d
                                                x
                                             
                                          
                                       
                                       )
                                    
                                    (
                                    
                                       
                                          r
                                       
                                       2
                                    
                                    −
                                    
                                       
                                          R
                                       
                                       2
                                    
                                    )
                                 
                              
                           
                        
                     

After integrating x from 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         to 
                           
                              
                                 x
                              
                              
                                 1
                                 +
                                 L
                              
                           
                         and integrating P from P
                        1 to P
                        2, we obtained
                           
                              (19)
                              
                                 
                                    
                                       d
                                       P
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                    
                                    L
                                 
                              
                           
                        
                     

Substituting the above formula (18), we obtained the average velocity of laminar flow in the horizontal tube.
                           
                              (20)
                              
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                    
                                       8
                                       μ
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             D
                                          
                                          2
                                       
                                    
                                    
                                       32
                                       μ
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                       P
                                       
                                          
                                             D
                                          
                                          2
                                       
                                    
                                    
                                       32
                                       μ
                                       L
                                    
                                 
                              
                           
                        
                     

As for diameter D and length L of the horizontal tube, the volume flow rate Q of the laminar flow is shown as
                           
                              (21)
                              
                                 Q
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             R
                                          
                                          2
                                       
                                    
                                    
                                       8
                                       μ
                                       L
                                    
                                 
                                 π
                                 
                                    
                                       R
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       π
                                       
                                          
                                             D
                                          
                                          4
                                       
                                    
                                    
                                       128
                                       μ
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                       P
                                       π
                                       
                                          
                                             D
                                          
                                          4
                                       
                                    
                                    
                                       128
                                       μ
                                       L
                                    
                                 
                              
                           
                        
                     

This formula is the well-known Poiseuille’s Law. Because a patient was lying down when being examined by the physician, the duct was oblique. Considering this point, we considered the angle θ in Poiseuille’s Law (
                        Fig. 7).

The relationship formulae of an oblique duct can use a similar balance of force obtained in the flow direction. The only additional items are the direction of the weight of the fluid vector component. The value is
                           
                              (22)
                              
                                 
                                    
                                       W
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 W
                                 
                                 sin
                                 
                                 θ
                                 =
                                 ρ
                                 g
                                 
                                    
                                       Q
                                    
                                    
                                       e
                                       l
                                       e
                                       m
                                       e
                                       n
                                       t
                                    
                                 
                                 
                                 sin
                                 
                                 θ
                                 =
                                 ρ
                                 g
                                 (
                                 2
                                 π
                                 r
                                 d
                                 r
                                 d
                                 x
                                 )
                                 sin
                                 
                                 θ
                              
                           
                        
                        θ is the angle between the horizontal line and flow direction (shown above), and the balance of force becomes
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                r
                                                d
                                                r
                                                P
                                                )
                                             
                                             
                                                X
                                             
                                          
                                          −
                                          
                                             
                                                (
                                                2
                                                π
                                                r
                                                d
                                                r
                                                P
                                                )
                                             
                                             
                                                X
                                                +
                                                d
                                                X
                                             
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             
                                                (
                                                2
                                                π
                                                r
                                                d
                                                x
                                                g
                                                t
                                                )
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          
                                             
                                                (
                                                2
                                                π
                                                r
                                                d
                                                x
                                                τ
                                                )
                                             
                                             
                                                r
                                                +
                                                d
                                                r
                                             
                                          
                                       
                                    
                                    
                                       
                                          −
                                          ρ
                                          g
                                          (
                                          2
                                          π
                                          r
                                          d
                                          r
                                          d
                                          x
                                          )
                                          sin
                                          
                                          θ
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

This equation can be extended further to
                           
                              (24)
                              
                                 
                                    d
                                    
                                       d
                                       r
                                    
                                 
                                 (
                                 r
                                 
                                    
                                       d
                                       u
                                    
                                    
                                       d
                                       r
                                    
                                 
                                 )
                                 =
                                 
                                    r
                                    μ
                                 
                                 (
                                 
                                    
                                       d
                                       p
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 +
                                 ρ
                                 g
                                 
                                 sin
                                 
                                 θ
                                 )
                              
                           
                        
                     

According to the process of the previous derivation, we obtained
                           
                              (25)
                              
                                 
                                    
                                       V
                                    
                                    
                                       a
                                       v
                                       g
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       4
                                       μ
                                    
                                 
                                 (
                                 
                                    
                                       d
                                       p
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 +
                                 ρ
                                 g
                                 
                                 sin
                                 
                                 θ
                                 )
                                 (
                                 
                                    
                                       r
                                    
                                    2
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    2
                                 
                                 )
                              
                           
                        
                     

The volume flow rate Q is
                           
                              (26)
                              
                                 ∴
                                 Q
                                 =
                                 −
                                 
                                    
                                       (
                                       Δ
                                       p
                                       −
                                       ρ
                                       g
                                       
                                       sin
                                       
                                       θ
                                       )
                                       π
                                       
                                          
                                             R
                                          
                                          4
                                       
                                    
                                    
                                       8
                                       μ
                                       l
                                    
                                 
                              
                           
                        
                     

When fluid was squeezed by a pressure jet out of a closed space through a small aperture, the resulting stream is called a jet. If the jet and the fluid of the surrounding environment have the same properties (both liquid and gas), the turbulent fluid, which is generated by the jet, will become involved with the surrounding fluid at the center of the flow line and mix. Then the rate and concentration of the jet’s fluid will be the same as those of the surrounding fluid. A round jet is the jet from a tube spread out from the center axis of the tube with symmetry without the influence of a lateral flow. Because of axial symmetry, the round jet can be regarded as a fluid field of two dimensions. We analyzed it using a cylindrical coordinate system. In a single tube with a free round jet, when the round jet entered the water, it established a zone with a distance of approximately 6–10 nozzle diameters of the tube forming a top-hat profile. This is called the establishing zone because of entrainment into the potential core of the round jet by the jet and surrounding fluid, before entering the developing zone of the round jet, as shown in 
                        Fig. 8.

When the round jet formed as a fully developed turbulent flow, the velocity and concentration distribution, which followed the axis direction on the section of the round jet, had similar power, although the velocity and concentration at the center of the round jet decreased with distance downstream. At different distances downstream, the section of velocity of developing zone and concentration of the round jet approaches Gaussian distribution; this phenomenon is called self-similarity regions in the round jet. The section of velocity and concentration of the round jet,
                           U
                           
                              (
                              
                                 s
                                 ,
                                 r
                              
                              )
                           
                        , can be described as in Eq. (27) by a Gaussian distribution:
                           
                              (27)
                              
                                 U
                                 (
                                 s
                                 ,
                                 r
                                 )
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 s
                                 )
                                 exp
                                 
                                    (
                                    
                                       −
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           
                              
                                 U
                              
                              
                                 C
                              
                           
                           (
                           s
                           )
                         is the time average of velocity of the centerline of the round jet, r is the distance from the centerline, and δ(s), which is half the width of the velocity distribution of the round jet, is generally defined as a distance out from the centerline of the round jet to the point at which the velocity decayed to 
                           
                              
                                 U
                              
                              
                                 c
                              
                           
                           /
                           e
                         (where e=2.71828) because the momentum of the round jet must be conserved:
                           
                              (28)
                              
                                 
                                    
                                       M
                                    
                                    
                                       O
                                    
                                 
                                 =
                                 
                                    
                                       π
                                       
                                          
                                             D
                                          
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                    4
                                 
                                 
                                    
                                       U
                                    
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    ∫
                                    0
                                    ∞
                                 
                                 
                                    
                                       
                                          U
                                       
                                       2
                                    
                                 
                                 (
                                 r
                                 )
                                 2
                                 π
                                 r
                                 d
                                 r
                                 =
                                 2
                                 π
                                 
                                    ∫
                                    0
                                    ∞
                                 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                                 exp
                                 
                                    (
                                    
                                       −
                                       
                                          
                                             2
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 r
                                 d
                                 r
                              
                           
                        
                     


                        
                           
                              
                                 U
                              
                              
                                 o
                              
                           
                         is the initial speed of the round jet; D is the diameter of the round tube, as follows:
                           
                              (29)
                              
                                 
                                    
                                       π
                                       
                                          
                                             D
                                          
                                          
                                             O
                                          
                                          
                                             2
                                          
                                       
                                    
                                    4
                                 
                                 
                                    
                                       U
                                    
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    π
                                    2
                                 
                                 
                                    
                                       U
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    2
                                 
                              
                           
                        
                     

The half width of the round jet increased with the downstream distance based on the equation
                           
                              (30)
                              
                                 δ
                                 (
                                 s
                                 )
                                 =
                                 β
                                 ×
                                 s
                              
                           
                        
                     

Positive coefficient β is also known as the spreading coefficient We substituted β into the momentum equations to obtain
                           
                              (31)
                              
                                 
                                    
                                       U
                                    
                                    
                                       C
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             O
                                          
                                       
                                    
                                    
                                       
                                          2
                                       
                                       β
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             O
                                          
                                       
                                    
                                    s
                                 
                              
                           
                        
                     

In other words, the velocity at the centerline of the round jet decayed linearly with the distance downstream. With respect to the volume flux of the round jet, because of the phenomenon of entrainment, the flow of the round jet increased with time:
                           
                              (32)
                              
                                 Q
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    ∫
                                    0
                                    ∞
                                 
                                 U
                                 
                                    (
                                    r
                                    )
                                 
                                 2
                                 π
                                 r
                                 d
                                 r
                                 =
                                 2
                                 π
                                 
                                    ∫
                                    0
                                    ∞
                                 
                                 
                                    
                                       U
                                    
                                    
                                       c
                                    
                                 
                                 e
                                 x
                                 p
                                 
                                    (
                                    
                                       −
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 r
                                 d
                                 r
                                 =
                                 π
                                 
                                    
                                       U
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    2
                                 
                              
                           
                        
                     

The entrainment of the surrounding flow into the jet caused the jet flow to increase. The initial flow of the round jet was
                           
                              (33)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       O
                                    
                                 
                                 =
                                 
                                    
                                       π
                                       
                                          
                                             D
                                          
                                          2
                                       
                                    
                                    4
                                 
                                 
                                    
                                       U
                                    
                                    
                                       O
                                    
                                 
                              
                           
                        
                     

The ratio of the flow and initial flow was
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             O
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    2
                                 
                                 β
                                 
                                    s
                                    D
                                 
                              
                           
                        
                     

When the round jet contains a mixture, the ratio of flow 
                           (
                           
                              
                                 Q
                              
                              
                                 C
                              
                           
                           (
                           s
                           )
                           )
                           /
                           
                              
                                 Q
                              
                              
                                 O
                              
                           
                         can be regarded as an average dilution of the mixture [13].

Using Formulae (31) and (34), a relationship including flow, velocity of flow, and cross-sectional area of the direction of flow could be deduced as
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             O
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             O
                                          
                                       
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                 
                                 =
                                 
                                    2
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             C
                                          
                                       
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             O
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As in those models, the distribution and quantification of bile can be estimated from the gallbladder to the stomach by each part.

Optical flow [15] is the apparent motion in the image plane produced by the projection of the real motion of an object in the 3D world onto a 2D image. It is the measure of the image brightness change in an image sequence. It is commonly used as an approximation of the velocity field, which is the projection of the 3D real velocity onto the image plane. Optical flow results from the relative motion of the objects in a scene [16]. Knowledge of optical flow is important not only for recognizing moving objects and their velocity but also because the optical flow can be a useful element when implementing higher-level vision tasks. At time t, if point (
                        
                           x, y
                        
                        ) in the image plane has brightness 
                           I
                        
                        (
                        
                           x, y, t
                        
                        )
                        
                           , u
                        
                        (
                        
                           x, y
                        
                        ) and 
                           v
                        
                        (
                        
                           x, y
                        
                        ) are its optical vectors in the directions of the x and y axes, respectively. We assume that brightness 
                           I
                        
                        (
                        
                           x+δx, y+δy, t+δt
                        
                        ) at point (
                        
                           x+δx, y+δy
                        
                        ) at time 
                           t+δt
                         is equal to the brightness at point (
                        
                           x, y
                        
                        ) at time 
                           t
                        .
                           
                              (36)
                              
                                 I
                                 (
                                 x
                                 +
                                 δ
                                 x
                                 ,
                                 y
                                 +
                                 δ
                                 y
                                 ,
                                 t
                                 +
                                 δ
                                 t
                                 )
                                 =
                                 I
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 t
                                 )
                              
                           
                        
                     

From the Taylor expansion of (1) or more generally, from an assumption that intensity was conserved, 
                           dI
                        
                        (
                        
                           x, t
                        
                        )
                        
                           /dt=
                        
                        0, the gradient constraint was easily derived
                           
                              (37)
                              
                                 I
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 t
                                 )
                                 +
                                 δ
                                 x
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 +
                                 δ
                                 y
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 +
                                 δ
                                 t
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 HOT
                                 =
                                 I
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 t
                                 )
                              
                           
                        where higher-order terms (HOT) are small enough to be ignored. From these equations, we obtained
                           
                              (38)
                              
                                 δ
                                 x
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 +
                                 δ
                                 y
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 +
                                 δ
                                 t
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 0
                              
                           
                        or
                           
                              (39)
                              
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 
                                    
                                       δ
                                       x
                                    
                                    
                                       δ
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 
                                    
                                       δ
                                       y
                                    
                                    
                                       δ
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 
                                    
                                       δ
                                       t
                                    
                                    
                                       δ
                                       t
                                    
                                 
                                 =
                                 0
                              
                           
                        which results in
                           
                              (40)
                              
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       I
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 0
                              
                           
                        where 
                           vx, vy
                         are the x, y components of the velocity or optical flow of 
                           I
                        
                        (
                        
                           x, y, t
                        
                        ). This is called the gradient constraint or optical flow constraint equation. The solution of 
                           v
                         cannot be obtained directly. We need more conditions to constrain the equation:
                           
                              (41)
                              
                                 ∇
                                 I
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 •
                                 v
                                 +
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 0
                              
                           
                        
                     

This is an equation with two unknowns and cannot be solved. This is known as the aperture problem of the optical flow algorithm. To find the optical flow, we need another set of equations, which is given by some additional constraints. The method we used is that of Lucas and Kanade [17].

Lucas and Kanade implemented a weighted least-squares fit of local first-order constraints to a constant model for 
                              v
                            in each small spatial neighborhood 
                              Ω
                            by minimizing the following function:


                           
                              
                                 (42)
                                 
                                    
                                       
                                          ∑
                                          
                                             x
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                W
                                             
                                             2
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                    
                                       
                                          [
                                          ∇
                                          I
                                          (
                                          x
                                          ,
                                          t
                                          )
                                          •
                                          v
                                          +
                                          
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          x
                                          ,
                                          t
                                          )
                                          ]
                                       
                                       2
                                    
                                 
                              
                           where W(x) denotes a window function. This approach placed more influence on the constraint at the center of the neighborhood than on that at the border. Minimizing (42) gave the solution
                              
                                 (43)
                                 
                                    V
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          
                                             
                                                W
                                             
                                             2
                                          
                                          A
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    
                                       
                                          W
                                       
                                       2
                                    
                                    b
                                 
                              
                           where
                              
                                 (44)
                                 
                                    A
                                    =
                                    
                                       
                                          [
                                          ∇
                                          I
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          ∇
                                          I
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ]
                                       
                                       T
                                    
                                    W
                                    =
                                    d
                                    i
                                    a
                                    g
                                    
                                       
                                          [
                                          W
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          W
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ]
                                       
                                       T
                                    
                                    b
                                    =
                                    −
                                    
                                       
                                          [
                                          
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ]
                                       
                                       T
                                    
                                 
                              
                           
                        

The solution to 
                              V
                            was solved in closed form when 
                              A
                           
                           
                              
                                 T
                              
                           
                           
                              W
                           
                           
                              2
                           
                           
                              A
                            was nonsingular:
                              
                                 (45)
                                 
                                    
                                       
                                          A
                                       
                                       T
                                    
                                    
                                       
                                          W
                                       
                                       2
                                    
                                    A
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            2
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            2
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            2
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            2
                                                         
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               y
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        

The spatial neighborhoods 
                              Ω
                            are 3×3pixel. The window function 
                              W
                           
                           
                              2
                           
                           (
                           
                              x
                           
                           ) was separable and isotropic. Lucas and Kanade’s method has the least average error and standard deviation in the result. In this paper, we used this method to compute the optical flow in the sequence of images [17,18].


                     
                     
                     Figs. 9 and 10 show the optical flow of DISIDA images for one case in which the patient had severe bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and 360° in 16 positions from (0,0) to (3,3). We listed all angles of patient A in Table 1 
                     [19–21].


                     
                     
                     Figs. 11 and 12 show the optical flow of DISIDA images for one case in which the patient had bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and 360° in 16 positions from (0,0) to (3,3). We listed all angles of patient B in 
                     Table 1.

In other cases, the physician doubts bile reflux but used gastroscopy observation for diagnosis in 
                     
                     Figs. 13, 14 and 17, 18 were no bile reflux. Figs. 13, 14 and 17, 18 show the optical flow of DISIDA images for one case in which the patient had bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and 360° in 16 positions from (0,0) to (3,3). We listed all angles of patient C and E in Table 1. So that decisions by our method are the same with physician diagnosis.


                     
                     
                     
                     
                     Figs. 15 and 16 show the optical flow of DISIDA images for one case in which the patient had no bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and 180° in 16 positions from (0,0) to (3,3). We listed all angles of patient D in Table 1.


                     
                     
                     
                     
                     Figs. 19–22 show the optical flow of DISIDA images for two cases in which the patient had bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and 360° in 16 positions from (0,0) to (3,3). We listed all angles of patient F and G in Table 1.


                     
                     
                     
                     
                     Figs. 23–26 show the optical flow of DISIDA images for three cases in which the patient had no bile reflux. We calculated the angles of optical flow. The range of angles were between 0° and −180° in 16 positions from (0,0) to (3,3). We listed all angles of patient H and I in Table 1.


                     
                     
                     
                     Figs. 27–29 show the direction degree of the optical flow of DISIDA images.

From the results shown in 
                     Table 2 and 
                     Fig. 30, we found that in bile reflux cases A, B, F, and G are not stable in the directions of optical flow. In cases D, H, and I that have no bile reflux, the optical flow was stable. In our analyses, we compared six patients with severe bile reflux and three patients with no bile reflux. In 
                     Table 3, we showed the same diagnosis results as the physician. From the experimental results, we could use the hydrodynamic models as Formulae (46) and (47) to estimate bile reflux quantity as
                        
                           (46)
                           
                              
                                 
                                    Q
                                 
                                 
                                    C
                                 
                              
                              (
                              s
                              )
                              =
                              −
                              
                                 
                                    (
                                    Δ
                                    p
                                    −
                                    ρ
                                    g
                                    
                                    sin
                                    
                                    θ
                                    )
                                    π
                                    
                                       
                                          R
                                       
                                       4
                                    
                                 
                                 
                                    8
                                    μ
                                    l
                                 
                              
                           
                        
                     
                     
                        
                           (47)
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          C
                                       
                                    
                                    (
                                    s
                                    )
                                 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          O
                                       
                                    
                                 
                              
                              =
                              2
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          O
                                       
                                    
                                 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          C
                                       
                                    
                                    (
                                    s
                                    )
                                 
                              
                              =
                              
                                 2
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          O
                                       
                                    
                                 
                              
                           
                        
                     
                  

We showed that the proposed hydrodynamic model can be used to quantify bile reflux in images. This quantitative assessment can help the physician improve clinical diagnosis.


                     
                     Fig. 31 shows the 3D reconstruction and fusion of SPECT and CT images for the patients [22–27] (
                     Fig. 32).

@&#CONCLUSION@&#

In the study, we implemented a quantification method of bile reflux using SPECT/CT 2D image analysis and 3D reconstruction based on fluid mechanics and optical flow. Using this method, physicians may estimate the quantity of bile reflux and observe bile flow to determine whether or not it moves into the stomach. The results can help physicians to diagnose patients and advise whether or not they have bile reflux. The proposed method can improve clinical diagnosis.

No conflict of interest.

@&#REFERENCES@&#

