@&#MAIN-TITLE@&#Improving tracking accuracy with subcarrier assistance and code monitoring for BOC modulated signal

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A general analytical expression of the two-dimension correlation of DET is formulated.


                        
                        
                           
                           The crosstalk between SLL and DLL will degrade the ranging capability of BOC signals.


                        
                        
                           
                           The subcarrier aided code tracking (SACT) technique is proposed.


                        
                        
                           
                           The adaptive adjustment by code monitoring is proposed to tap the potential ranging capability.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

GNSS

Code tracking loop

Two-dimension correlation

Binary offset carrier

Unambiguous tracking

@&#ABSTRACT@&#


               
               
                  The Binary Offset Carrier (BOC) modulated signals have been introduced in global navigation satellite systems (GNSS). They possess good frequency compatibility with existing Binary Phase Shift Keying (BPSK) signal. However, this type of modulation creates multiple side peaks in auto correlation function. Therefore it is hard to make full use of its ranging capability. To alleviate this problem, this paper analyzes the Double Estimator Technique (DET) thoroughly from a general formulation of two-dimension correlation and proposes a new subcarrier aided code tracking approach. In addition, based on the fact that the pseudo random noise (PRN) code can reflect the absolute delay, an adaptive code monitoring scheme is investigated to tap the potential tracking accuracy. Utilizing BOCsin(1,1) signal, Monte Carlo simulations demonstrate that the proposed method improves the tracking performance with respect to thermal noise significantly.
               
            

@&#INTRODUCTION@&#

Recently, applications of Global Navigation Satellite Systems (GNSS) are developing rapidly and attracting a great interest. With the advent of new GNSSs, e.g. the Russian GLONASS, the Chinese Compass system, the European Galileo and the modernized Global Position System (GPS) [1,2], the frequency bands allocated for satellite navigation are becoming more and more crowded with a multitude of signals which could create inter- and intra-system interference. To improve the radio-frequency (RF) compatibility among different GNSS signals, a new modulation called Binary Offset Carrier (BOC) modulation [3] has been proposed. The legacy binary phase shift keying (BPSK) modulation has a power spectrum concentrated around the center frequency, whereas the power spectrum of BOC modulation is split into a symmetric spectrum with two main lobes on account of the modulation of subcarrier. Therefore, the BOC signal significantly reduces interference with traditional GPS signal and introduces sharper Auto Correlation Function (ACF) which will improve tracking capabilities with respect to anti-jamming and anti-multipath [4,5]. Meanwhile, it also brings new problems. In particular, the most severe one is the tracking ambiguity, due to its multi-peak characteristics of the ACF envelope [3], which leads to false locks onto one of the side peaks easily. Once it locks to wrong peaks, it will definitely degrade the tracking accuracy. Besides for those BOC signals with higher chipping rates, they will possess more side peaks. It definitely raises new challenge for modern GNSS receiver design.

In spite of its side peaks, the excellent characteristic of BOC modulation should be fully exploited. Therefore the way to make better use of BOC signal should be built upon robust unambiguous tracking techniques. To alleviate this ambiguous false lock problem, several solutions are proposed in literature, e.g. Bump-Jump [6], BPSK-Like [7,8], Autocorrelation Side Peak Cancellation Technique (ASPeCT) [9], Pseudo-Correlation Function (PCF) [10], etc. Among these methods, only the Bump-Jump method maintains the original ACF pattern with multipeaks, whereas other methods are all intend to construct a unique correlation peak similar to the traditional BPSK signal. Besides, they all treat local code and subcarrier replicas synchronized. Thus, here we denote them by one-dimension correlation.

Hodgart etc. [11] starts a new two-dimension correlation for BOC signal, named Double Estimator Technique (DET). It has achieved quite robust performance [12] and reduced computational load which treats the code and the subcarrier completely independent. To obtain final estimation, the accurate but ambiguous estimate of subcarrier locked loop (SLL) is rounded-off with the rough but unique estimate of delay locked loop (DLL). However, it really contains some severe problems [13], typically in convergence process with large code offset. The essential of this problem is the independent generation of subcarrier and code replicas, which will lead to free correlation with incoming BOC signals. In fact, the subcarrier and PRN code of BOC signal are transmitted synchronous as it is defined in [3]. Thus it will degrade the BOC signal ranging capability to some extent.

In view of the robustness and performance that DET has obtained, in this paper, we aim to explore the way to further improve its tracking accuracy. Yao etc. [10] proposes the concept of “step-shape modulated symbols” originally to solve ambiguous problems in BOC code tracking. Yet it provides us the way to represent any kinds of BOC modulated signals. Based on these general symbols, in this paper, we formulate the two-dimension correlation of DET and obtain a better insight into the DET. Theoretical analysis demonstrates that the crosstalk between SLL and DLL will degrade the ranging capability. To improve the tracking accuracy, we propose the subcarrier aided code tracking (SACT) technique and present the tracking loop of this scheme. Furthermore, based on the consistency of subcarrier and PRN code, the adaptive adjustment by code monitoring is proposed to tap the potential ranging capability. Typically, using the BOCsin(1,1) signal as an instance, numerical simulation results demonstrate the validity and effectiveness of the proposed scheme.

The remainder of this paper is organized as follows. The BOC signal model and its ambiguity problem are presented and analyzed in Section 2. Section 3 presents thoroughly analysis on several existing possible tracking solutions and points out the reason for selection of DET as examining target. Based on the general “step-shape modulated symbols”, we formulate and analysis the two-dimension correlation for sine-BOC signals in Section 4. Section 5 presents the methods to improve tracking accuracy. Section 6 simulates and evaluates the performance of the proposed scheme. Finally, some conclusions are drawn in Section 7.

The BOC modulated signal is an analogous Direct Sequence Spread Spectrum (DSSS) signal which can be regarded as multiplication of Pseudo-Random Noise (PRN) code and square waves. When the square wave subcarrier has sine phase, the BOC modulated signal is referred as sin-BOC, or referred as cos-BOC when the square wave subcarrier has cosine phase. In the navigation community, it is generally denoted as BOCsin/cos(m,n), where m defines the subcarrier frequency 
                           
                              
                                 f
                                 
                                    s
                                    c
                                 
                              
                              =
                              1
                              /
                              
                                 (
                                 2
                                 
                                    T
                                    
                                       s
                                       c
                                    
                                 
                                 )
                              
                              =
                              m
                              
                              ×
                           
                         1.023 MHz and n defines the code frequency 
                           
                              
                                 f
                                 c
                              
                              =
                              1
                              /
                              
                                 T
                                 c
                              
                              =
                              n
                              
                              ×
                           
                         1.023 MHz [3]. These two parameters are related to the reference frequency of 1.023 MHz which emphasizes compatibility with existing GPS L1 C/A signal and consistency with the currently allocated frequency spectrum. The frequency ratio 
                           
                              k
                              =
                              2
                              m
                              /
                              n
                           
                         defines its specific spectral characteristics, which is generally a positive integer for several currently selected BOC modulated signals [14,15].

This paper mainly focuses on the process of BOC signal tracking, specifically for the PRN code synchronization. On neglecting radio frequency (RF) front end bandwidth limitations and navigation bit transitions, such a signal, after down-convention to intermediate frequency (IF), can be modeled in baseband by

                           
                              (1)
                              
                                 
                                    s
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          2
                                          P
                                       
                                    
                                    c
                                    
                                       (
                                       t
                                       −
                                       
                                          τ
                                          0
                                       
                                       )
                                    
                                    
                                       s
                                       b
                                    
                                    
                                       (
                                       t
                                       −
                                       
                                          τ
                                          0
                                       
                                       )
                                    
                                    c
                                    o
                                    s
                                    
                                       (
                                       2
                                       π
                                       
                                          f
                                          0
                                       
                                       t
                                       +
                                       ϕ
                                       )
                                    
                                    +
                                    n
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        where P denotes the total received power, c(t) and sb
                        (t) are the PRN code and subcarrier signals, respectively, τ
                        0 denotes the time delay, f
                        0 and ϕ are the carrier frequency and phase, respectively. The noise term n(t) represents thermal noise and is generally assumed to be additive white Gaussian noise, with a single side Power Spectral Density (PSD) of N
                        0 W/Hz.

Compared with the legacy Binary Phase Shift Keying (BPSK) signal, the only difference of BOC signal is the modulation of the so-called subcarrier which is the sign of secondary pure intermediate carrier. This modulation splits the main energy component of PRN signal spectrum symmetrically and moves it to around multiples of the subcarrier frequency. Therefore it limits the potential interference with legacy GPS signal.

In the GNSS domain, code tracking is an essential task to estimate pseudo range, which provides the receiver basic positioning information. In this process, it takes the full advantage of PRN code autocorrelation characteristic to track the incoming signal precisely. For a given RF front end bandwidth βr
                        , the autocorrelation function is given by

                           
                              (2)
                              
                                 
                                    
                                       R
                                       s
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    =
                                    
                                       ∫
                                       
                                          −
                                          
                                             β
                                             r
                                          
                                          /
                                          2
                                       
                                       
                                          
                                             β
                                             r
                                          
                                          /
                                          2
                                       
                                    
                                    
                                       G
                                       s
                                    
                                    
                                       (
                                       f
                                       )
                                    
                                    
                                       e
                                       
                                          j
                                          2
                                          π
                                          f
                                          τ
                                       
                                    
                                    d
                                    f
                                 
                              
                           
                        where Gs
                        (f) is the normalized power spectral density of incoming satellite signal. In terms of BOC(m,n) signal with subcarrier frequency fsc
                         and spreading code rate fc
                        , for instance the modulation ratio k is even, the PSD Gs
                        (f) is given by [3]
                        
                           
                              (3)
                              
                                 
                                    
                                       G
                                       
                                          B
                                          O
                                          C
                                          (
                                          
                                             f
                                             s
                                          
                                          ,
                                          
                                             f
                                             c
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       f
                                       )
                                    
                                    =
                                    
                                       f
                                       c
                                    
                                    
                                       
                                          (
                                          
                                             
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   
                                                      
                                                         π
                                                         f
                                                      
                                                      
                                                         2
                                                         
                                                            f
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   
                                                      
                                                         π
                                                         f
                                                      
                                                      
                                                         f
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                π
                                                f
                                                c
                                                o
                                                s
                                                
                                                   (
                                                   
                                                      
                                                         π
                                                         f
                                                      
                                                      
                                                         2
                                                         
                                                            f
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           
                        Whereas for BPSK signal with same spreading code rate, its Gs
                        (f) is given by [16]
                        
                           
                              (4)
                              
                                 
                                    
                                       G
                                       
                                          B
                                          P
                                          S
                                          K
                                          (
                                          
                                             f
                                             c
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       f
                                       )
                                    
                                    =
                                    
                                       f
                                       c
                                    
                                    
                                       
                                          (
                                          
                                             
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   
                                                      
                                                         π
                                                         f
                                                      
                                                      
                                                         f
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                π
                                                f
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           
                        On substituting Eq. (3) or Eq. (4) into Eq. (2) for BOC(m,n) or BPSK(n), it will be seen that the correlation function of BOC(m,n) will have several zero crossing points. The sawtooth-like, piecewise linear autocorrelation function of two typical BOC signal which have been adopted by Galileo [14], i.e. BOCsin(1,1) and BOCcos(15,2.5), are shown in Fig. 1
                        . As the modulation ratio k increases, the number of zero crossing points increases too, which will be as much as 
                           
                              2
                              k
                              −
                              2
                           
                         for sinBOC signal and 2k for cosBOC signal. On condition that the conventional DLL utilized in BPSK signal is directly used for BOC signal tracking, it will mistaken the zero crossing points and leads to false lock.

In the GNSS domain, generally, the modulation designs that have larger root mean square (RMS) bandwidth offer the potential for better code tracking accuracy in white noise [17]. Typically,the RMS bandwidth (in hertz) of a bandlimited signal is expressed as

                           
                              (5)
                              
                                 
                                    
                                       β
                                       
                                          r
                                          m
                                          s
                                       
                                       2
                                    
                                    =
                                    
                                       ∫
                                       
                                          −
                                          
                                             β
                                             r
                                          
                                          /
                                          2
                                       
                                       
                                          
                                             β
                                             r
                                          
                                          /
                                          2
                                       
                                    
                                    
                                       f
                                       2
                                    
                                    
                                       G
                                       s
                                    
                                    
                                       (
                                       f
                                       )
                                    
                                    d
                                    f
                                 
                              
                           
                        For a given code tracking loop with one-sided equivalent bandwidth of BL
                        , the lower bound on code tracking error that can be achieved in white noise is independent of discriminator and given by [17]
                        
                           
                              (6)
                              
                                 
                                    
                                       σ
                                       
                                          L
                                          B
                                       
                                    
                                    ≅
                                    
                                       1
                                       
                                          2
                                          π
                                          
                                             β
                                             
                                                r
                                                m
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                                L
                                             
                                             
                                                (
                                                1
                                                −
                                                0.5
                                                
                                                   B
                                                   L
                                                
                                                
                                                   T
                                                   I
                                                
                                                )
                                             
                                          
                                          
                                             C
                                             /
                                             
                                                N
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where TI
                         is the pre-detection integration time. The detail theory of spread spectrum signal considering noncoherent early-late processing (NELP) is well documented in [18] and consequently is not further described herein. Observing Eq. (5) and Eq. (6), it can be seen that the RMS bandwidth characteristic of one particular modulation scheme decides its ranging capability definitely. On substituting Eq. (3) or Eq. (4) into Eq. (5) for BOC(m,n) or BPSK(n), it will be seen that the RMS bandwidth of BOC(m,n) is larger than that of BPSK(n). Thus, the BOC modulated signal allow for better inherent mitigating of white Gaussian noise and narrow band interference during tracking. Characteristic comparisons of several well known BOC signals are summarized in [3,4]. The BOC modulation improves the navigation signal ranging capability significantly. However, the ambiguity of the autocorrelation function is still a serious risk on the way to accurate measures of BOC tracking.

On basis described in Section 2, the essence of improving BOC signal tracking accuracy is to approach the limitation of σLB
                      for one particular BOC modulation. Generally, the receiver can extract measurements by correlating incoming signal with local replicas. Observing Eq. (2), Eq. (5) and Eq. (6), for a given code loop parameters and thermal noise, it can be seen that two main sources will restrict the final tracking accuracy. The first one is the RF front end filter bandwidth βr
                     , which will limit the higher-frequency contents that sharpens the correlation. This can be implemented easily with a wider bandwidth RF front end filter. The second one is the correlation process, which determines the RMS bandwidth utilization efficiency. Owing to the orthogonality of PRN codes, any cross correlation caused by radio or artificial interference will dampen the efficiency. In this perspective, methods that intend to maintain RMS bandwidth utilization efficiency are in accordant with alleviating the ambiguity problem. Both of them serve to improve the tracking accuracy. The basic idea underlying unambiguous methods is to explore the properties of BOC signals and to reform the traditional BPSK signal tracking. This section review several effective tracking methods specially focusing on tracking accuracy.

In BPSK-Like scheme, it assumes that the received BOC signal is equivalent to two parallel BPSK signals with carrier frequency symmetrically positioned on each side of the BOC carrier frequency [7,8]. Each lobe is treated as an independent BPSK signal. However, nearly 3 dB signal to noise ratio (SNR) degradation (at least) will be induced for Single Side Band (SSB) process and 0.5 dB for Dual Side Band (DSB) process. Besides, the correlation function degenerates to that of BPSK signal and thus completely losses all of the range capability that BOC modulation possesses, as is shown in Fig. 1. Thus it will serious degrade tracking performance.

The Bump-Jump method directly correlates incoming signals with local BOC signal replicas which resembles the traditional BPSK tracking methods excepting for two extra correlators denoted as very early (VE) and very late (VL) [6]. These two branches are specially chosen to track the two secondary maximum side peaks. Based on detection and rejection of secondary peaks in the signal correlation function, it keeps track of the right correlation function peak. On assuming that the receiver has locked to the main peak, it works like the conventional BPSK code tracking but with sharper peak. Therefore, it can maintain the range capability of BOC signal at large. In this case, the most important issue for this method is the decision logic to ensure right tracking of the main peak. However, the decision logic is sensitive to SNR degradation and may have a high probability of false alarm under low SNR [12]. Besides, the Bump-Jumping system is time consuming when recovers from false-lock. Similarly, the hysteresis will happened when it declares false-lock [13,19]. As the modulation ratio k increases, this hysteresis will be more frequently and thus decreases the tracking accuracy eventually.

These two methods are all intend to construct a unique peak utilizing the characteristic of the cross correlation function (CCF) of BOC signal, e.g. pure PRN code and BOC signal in ASPeCT, pseudo-BOC signal and BOC signal in PCF, approximately presents an unambiguous ACF. To this end, the ASPeCT method uses ACF - β
                        *CCF where β is an empirical value detailed in [9], whereas Yao etc. [10] choose a pseudo correlation as follows

                           
                              (7)
                              
                                 
                                    
                                       R
                                       ˜
                                    
                                    
                                       
                                          (
                                          τ
                                          )
                                       
                                       =
                                       |
                                    
                                    
                                       R
                                       
                                          s
                                          
                                             s
                                             ′
                                          
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          τ
                                          )
                                       
                                       |
                                       +
                                       |
                                    
                                    
                                       R
                                       
                                          s
                                          
                                             s
                                             ′
                                          
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          τ
                                          )
                                       
                                       |
                                       −
                                       |
                                    
                                    
                                       R
                                       
                                          s
                                          
                                             s
                                             ′
                                          
                                          1
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    +
                                    
                                       R
                                       
                                          s
                                          
                                             s
                                             ′
                                          
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          τ
                                          )
                                       
                                       |
                                    
                                 
                              
                           
                        As it is known, the PRN code is a kind of golden code with excellent autocorrelation. Theoretically, cross correlation or additional arithmetical operation will degrade its original integrity. Therefore, they will lose some range capability with respect to code tracking jitter, which has been demonstrated in [9,10]. Besides, the quasi-ACF in ASPeCT is not ideal, and some flaws still exists in side peaks. Although the PCF technique can obtain an ideal ACF, its low RMS bandwidth utilization and high complexity restrict the practical receiver implementation.

The Double Estimator Technique (DET) is firstly proposed by M.S. Hodgart etc. in [11]. This technique splits the ambiguous BOC autocorrelation function to an ambiguous subcarrier correlation and an unambiguous PRN autocorrelation. Recently, some more enhanced versions [19,20] exploiting the same principle are proposed to further improve the system robustness. Detailed implementation of these techniques can refer to [21]. Fig. 1 presents these two independent autocorrelation for BOCsin(1,1) and BOCcos(15,2.5) respectively. The subcarrier and the PRN code are tracked independently with an extra SLL being employed to remove all side peaks, wherein the DLL works for legacy BPSK signal tracking. It eliminates the decision logic in Bump-Jump while keeps the pure autocorrelation. The final code delay estimate 
                           
                              τ
                              ^
                           
                         is calculated as follows [11]
                        
                           
                              (8)
                              
                                 
                                    
                                       τ
                                       ^
                                    
                                    =
                                    
                                       τ
                                       
                                          s
                                          c
                                       
                                    
                                    +
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                    ·
                                    r
                                    o
                                    u
                                    n
                                    d
                                    
                                       (
                                       
                                          
                                             
                                                τ
                                                c
                                             
                                             −
                                             
                                                τ
                                                
                                                   s
                                                   c
                                                
                                             
                                          
                                          
                                             T
                                             
                                                s
                                                c
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where τsc
                         represents the SLL delay estimate which is accurate but ambiguous; τc
                         represents the DLL delay estimate which is less accurate but unambiguous. The final delay estimate is calculated by fixing the ambiguity by Eq. (8). The rounding operation only work when the subcarrier seems to not lock to the correct peak. Therefore, the BOC subcarrier accuracy is fully exploited. Evaluated in [12], it outperforms Bump-Jump with respect to tracking threshold significantly.

In order to improve the tracking accuracy, one method that is not only robustness but also can maintain the BOC ranging capability should be adopted. To this end, the DET technique seems quite simple among all these methods and can be easily applied in existed receiver. Till now, there are already ample studies about this technique and impressive performance is reported. The essential idea underlying DET technique is the two-dimension correlation. In this paper, we further explore its potential through a generic signal model.

In a conventional GNSS receiver architecture, both a carrier and a code tracking loop are implemented to refine the frequency and code phase rough estimates. The first step in the tracking stage is to wipe-off the carrier by multiplying the incoming signal with local carrier replica. As is analyzed in Section 2, the ambiguity problem essentially derives from the modulation of subcarrier. Therefore, it assumes that the carrier is thoroughly wiped-off herein. On neglecting the data modulation, a normalized BOC modulated signal with infinite bandwidth in baseband can still be expressed as binary digits sequence {1,
                        −
                     1}. Using the concept of “step-shape modulated symbols” [10], the spreading code sequence can be represented as

                        
                           (9)
                           
                              
                                 
                                    S
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       C
                                       i
                                    
                                 
                                 
                                    p
                                    
                                       T
                                       c
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    i
                                    
                                       T
                                       c
                                    
                                    )
                                 
                              
                           
                        
                     where Ci
                      is binary PRN code digits {1,
                        −
                     1}; 
                        
                           
                              p
                              
                                 T
                                 0
                              
                           
                           
                              (
                              t
                              )
                           
                        
                      is rectangular pulse with amplitude being 1 and impulse duration being T
                     0, which is defined as

                        
                           (10)
                           
                              
                                 
                                    p
                                    
                                       T
                                       0
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                t
                                                ∈
                                                [
                                                0
                                                ,
                                                
                                                   T
                                                   0
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                o
                                                t
                                                h
                                                e
                                                r
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly, the subcarrier symbols can be expressed as

                        
                           (11)
                           
                              
                                 
                                    S
                                    
                                       s
                                       c
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       q
                                       =
                                       0
                                    
                                    
                                       M
                                       −
                                       1
                                    
                                 
                                 
                                    d
                                    q
                                 
                                 
                                    p
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    q
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where dq
                      is the step-shape symbol vector of subcarrier with each symbol duration time being Tsc
                     , M denotes the total symbol number within a code ship. For instance, in the case of BOCsin(1,1), dq
                      = {1,
                        −
                     1}, Tsc
                      = Tc
                     /2 and 
                        
                           M
                           =
                           2
                        
                     . With these assumptions presented above, the general BOC signal sequence in baseband, utilizing the step-shape symbol, can be given by

                        
                           (12)
                           
                              
                                 s
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    S
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ⊗
                                 
                                    S
                                    
                                       s
                                       c
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       C
                                       i
                                    
                                 
                                 
                                    p
                                    
                                       T
                                       c
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    i
                                    
                                       T
                                       c
                                    
                                    )
                                 
                                 
                                    ∑
                                    
                                       q
                                       =
                                       0
                                    
                                    
                                       M
                                       −
                                       1
                                    
                                 
                                 
                                    d
                                    q
                                 
                                 
                                    p
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    i
                                    
                                       T
                                       c
                                    
                                    −
                                    q
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                    )
                                 
                              
                           
                        
                     Referring to the practical BOC signal [14,15], the generation of data, spreading data, subcarrier and RF uses a common clock so that zero crossings are aligned. In this case, when the subcarrier and the code are perfectly aligned, i.e. a pure BOC modulated signal, sequence (12) can be optimized as

                        
                           (13)
                           
                              
                                 s
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    
                                       ∑
                                       
                                          q
                                          =
                                          0
                                       
                                       
                                          M
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             (
                                             −
                                             1
                                             )
                                          
                                          
                                             C
                                             i
                                          
                                       
                                       
                                          d
                                          q
                                       
                                       
                                          p
                                          
                                             T
                                             
                                                s
                                                c
                                             
                                          
                                       
                                       
                                          (
                                          t
                                          −
                                          i
                                          
                                             T
                                             c
                                          
                                          −
                                          q
                                          
                                             T
                                             
                                                s
                                                c
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                  

To estimate code delay, the DET estimator correlates local subcarrier and PRN code replicas with incoming signal. However, this technique considers that the subcarrier and the PRN code are completely independent. Thus, we can hardly ensure that these two replicas can be aligned perfectly. On assuming that the subcarrier and the code are slightly misaligned when the incoming BOC signal is correctly tracked, the phase error of these two local replicas is denoted as 
                        
                           μ
                           =
                           
                              τ
                              
                                 s
                                 c
                              
                           
                           −
                           
                              τ
                              c
                           
                        
                      herein. Considering the periodicity of subcarrier, the local quasi BOC replica can be expressed as

                        
                           (14)
                           
                              
                                 s
                                 
                                    (
                                    t
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 
                                    S
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ⊗
                                 
                                    S
                                    
                                       s
                                       c
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    μ
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          C
                                          i
                                       
                                    
                                    
                                       p
                                       
                                          T
                                          c
                                       
                                    
                                    
                                       (
                                       t
                                       −
                                       i
                                       
                                          T
                                          c
                                       
                                       )
                                    
                                    
                                       ∑
                                       
                                          q
                                          =
                                          0
                                       
                                       
                                          M
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          d
                                          q
                                       
                                       
                                          p
                                          
                                             T
                                             
                                                s
                                                c
                                             
                                          
                                       
                                       
                                          (
                                          t
                                          −
                                          i
                                          
                                             T
                                             c
                                          
                                          −
                                          q
                                          
                                             T
                                             
                                                s
                                                c
                                             
                                          
                                          −
                                          μ
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           −
                           
                              T
                              s
                           
                           <
                           μ
                           <
                           
                              T
                              s
                           
                        
                     . For the sake of simplicity, we will only consider the sine-BOC signal hereafter.

It is not hard to imagine that, to some extent, these two replicas have chance to go through every possible phase combination. Fig. 2
                     (a) shows the normalized two-dimension correlation map for BOCsin(1,1) signal. The central bold line is the autocorrelation distribution of BOCsin(1,1) signal, which can also be regarded as the boundary when the subcarrier and the code replica are aligned accurately. According to the phase error τc
                      and the phase offset μ of code and subcarrier, the main peak realm is divided into four sections, denoted as R1, R2, R3 and R4 respectively. This slight misaligned local quasi BOC signal Eq. (14) can be further expressed as

                        
                           Case 1: when the subcarrier lags behind the PRN code, i.e. region R1 and R4 where μ < 0,

                                 
                                    (15)
                                    
                                       
                                          s
                                          
                                             (
                                             t
                                             ,
                                             μ
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             {
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   C
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                d
                                                1
                                             
                                             
                                                p
                                                μ
                                             
                                             
                                                (
                                                t
                                                −
                                                i
                                                
                                                   T
                                                   C
                                                
                                                +
                                                μ
                                                )
                                             
                                             +
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   C
                                                   i
                                                
                                             
                                             
                                                d
                                                1
                                             
                                             
                                                p
                                                
                                                   
                                                      T
                                                      S
                                                   
                                                   −
                                                   μ
                                                
                                             
                                             
                                                (
                                                t
                                                −
                                                i
                                                
                                                   T
                                                   C
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   C
                                                   i
                                                
                                             
                                             
                                                ∑
                                                
                                                   q
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   d
                                                   q
                                                
                                                
                                                   p
                                                   
                                                      T
                                                      
                                                         s
                                                         c
                                                      
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   i
                                                   
                                                      T
                                                      c
                                                   
                                                   −
                                                   q
                                                   
                                                      T
                                                      
                                                         s
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           

Case 2: when the subcarrier is ahead of the PRN code, i.e. region R2 and R3 where μ > 0,

                                 
                                    (16)
                                    
                                       
                                          s
                                          
                                             (
                                             t
                                             ,
                                             μ
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                −
                                                ∞
                                             
                                             ∞
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               C
                                                               i
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               q
                                                               =
                                                               0
                                                            
                                                            
                                                               M
                                                               −
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               q
                                                            
                                                            
                                                               p
                                                               
                                                                  T
                                                                  
                                                                     s
                                                                     c
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               t
                                                               −
                                                               i
                                                               
                                                                  T
                                                                  c
                                                               
                                                               −
                                                               q
                                                               
                                                                  T
                                                                  
                                                                     s
                                                                     c
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                         
                                                         
                                                            
                                                               (
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               C
                                                               i
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               M
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            p
                                                            
                                                               
                                                                  T
                                                                  
                                                                     s
                                                                     c
                                                                  
                                                               
                                                               −
                                                               μ
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            −
                                                            i
                                                            
                                                               T
                                                               c
                                                            
                                                            −
                                                            
                                                               (
                                                               M
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               T
                                                               
                                                                  s
                                                                  c
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         +
                                                         
                                                         
                                                            
                                                               (
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               C
                                                               
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               M
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            p
                                                            μ
                                                         
                                                         
                                                            (
                                                            t
                                                            −
                                                            
                                                               (
                                                               i
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               T
                                                               c
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           

In the DET technique, it performs a two-dimension correlation, wherein the incoming signal is a pure BOC signal, i.e. sequence (13), while the local approximate BOC replicas can be denoted as the slight misaligned BOC signal, i.e. sequence (15) or sequence (16) decided by their relative phase relationship. Generally, the normalized two-dimension cross-correlation function of these two signals can be obtained by

                        
                           (17)
                           
                              
                                 R
                                 
                                    (
                                    τ
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 
                                    1
                                    T
                                 
                                 
                                    1
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                 
                                 
                                    ∫
                                    0
                                    T
                                 
                                 
                                    
                                       ∫
                                       0
                                       
                                          T
                                          
                                             s
                                             c
                                          
                                       
                                    
                                    
                                       s
                                       (
                                       t
                                       )
                                       s
                                       (
                                       t
                                       −
                                       τ
                                       ,
                                       μ
                                       )
                                    
                                 
                                 d
                                 t
                                 d
                                 
                                    t
                                    μ
                                 
                              
                           
                        
                     where 
                        
                           T
                           =
                           N
                           
                              T
                              c
                           
                        
                      is the total observation time and N is the period number of PRN code. Taking region R2 as an instance, where 
                        
                           −
                           
                              T
                              
                                 s
                                 c
                              
                           
                           <
                           
                              τ
                              
                                 s
                                 c
                              
                           
                           <
                           0
                           ,
                        
                      0 < μ < Tsc
                      and 
                        
                           −
                           
                              T
                              
                                 s
                                 c
                              
                           
                           <
                           τ
                           <
                           0
                           ,
                        
                      the cross-correlation results can be expressed as

                        
                           (18)
                           
                              
                                 
                                    R
                                    
                                       R
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 
                                    1
                                    T
                                 
                                 
                                    1
                                    
                                       T
                                       
                                          s
                                          c
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 
                                    ∑
                                    
                                       q
                                       =
                                       0
                                    
                                    
                                       M
                                       −
                                       1
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      0
                                                   
                                                   
                                                      M
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         
                                                            C
                                                            j
                                                         
                                                         +
                                                         
                                                            C
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      q
                                                   
                                                   
                                                      d
                                                      l
                                                   
                                                   
                                                      ∫
                                                      0
                                                      T
                                                   
                                                   
                                                      
                                                         ∫
                                                         0
                                                         
                                                            T
                                                            
                                                               s
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                            
                                                               T
                                                               
                                                                  s
                                                                  c
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            −
                                                            i
                                                            
                                                               T
                                                               c
                                                            
                                                            −
                                                            q
                                                            
                                                               T
                                                               
                                                                  s
                                                                  c
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                ×
                                                
                                                
                                                   p
                                                   
                                                      T
                                                      
                                                         s
                                                         c
                                                      
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   j
                                                   
                                                      T
                                                      c
                                                   
                                                   −
                                                   q
                                                   
                                                      T
                                                      
                                                         s
                                                         c
                                                      
                                                   
                                                   −
                                                   τ
                                                   )
                                                
                                                d
                                                t
                                                d
                                                
                                                   t
                                                   μ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         C
                                                         j
                                                      
                                                      +
                                                      
                                                         C
                                                         i
                                                      
                                                   
                                                
                                                
                                                   d
                                                   q
                                                
                                                
                                                   d
                                                   
                                                      M
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∫
                                                   0
                                                   T
                                                
                                                
                                                   
                                                      ∫
                                                      0
                                                      
                                                         T
                                                         
                                                            s
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         
                                                            T
                                                            
                                                               s
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         −
                                                         i
                                                         
                                                            T
                                                            c
                                                         
                                                         −
                                                         q
                                                         
                                                            T
                                                            
                                                               s
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                ×
                                                
                                                
                                                   p
                                                   
                                                      
                                                         T
                                                         
                                                            s
                                                            c
                                                         
                                                      
                                                      −
                                                      μ
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   j
                                                   
                                                      T
                                                      c
                                                   
                                                   −
                                                   
                                                      (
                                                      M
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      T
                                                      
                                                         s
                                                         c
                                                      
                                                   
                                                   −
                                                   τ
                                                   )
                                                
                                                d
                                                t
                                                d
                                                
                                                   t
                                                   μ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         C
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         C
                                                         i
                                                      
                                                   
                                                
                                                
                                                   d
                                                   q
                                                
                                                
                                                   d
                                                   
                                                      M
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∫
                                                   0
                                                   T
                                                
                                                
                                                   
                                                      ∫
                                                      0
                                                      
                                                         T
                                                         
                                                            s
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         
                                                            T
                                                            
                                                               s
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         −
                                                         i
                                                         
                                                            T
                                                            c
                                                         
                                                         −
                                                         q
                                                         
                                                            T
                                                            
                                                               s
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                ×
                                                
                                                
                                                   p
                                                   μ
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      T
                                                      c
                                                   
                                                   −
                                                   τ
                                                   )
                                                
                                                d
                                                t
                                                d
                                                
                                                   t
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

Specially, Fig. 3
                      shows the timing schematic of this circumstance. Because of the independence of subcarrier and PRN code, the phase of subcarrier replica may be ahead of that of code replica. This unsynchronized local replicas will introduce correlation loss. Noting that the phase error μ is little enough, such that most sign symbols are overlapped. Utilizing the identities resembling [10] and equation 
                        
                           
                              τ
                              c
                           
                           =
                           
                              τ
                              
                                 s
                                 c
                              
                           
                           −
                           μ
                           ,
                        
                      the normalized cross-correlation result of Eq. (18) can be simplified as

                        
                           (19)
                           
                              
                                 
                                    R
                                    
                                       R
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       
                                          (
                                          2
                                          M
                                          −
                                          1
                                          )
                                       
                                       
                                          τ
                                          
                                             s
                                             c
                                          
                                       
                                    
                                    
                                       T
                                       c
                                    
                                 
                                 −
                                 
                                    μ
                                    
                                       T
                                       c
                                    
                                 
                                 ,
                                 
                                 0
                                 <
                                 μ
                                 <
                                 
                                    T
                                    
                                       s
                                       c
                                    
                                 
                              
                           
                        
                     It shows that the final correlation result R(τ, μ) is not only connects with the absolute delay, but also decreases with the increase of the phase error between subcarrier and PRN code. This unsynchronized local replicas will suppress the availability of incoming signal strength.

In region R1, the phase of subcarrier replica lags behind that of code replica where the phase relationship satisfies 
                        
                           −
                           
                              T
                              
                                 s
                                 c
                              
                           
                           <
                           
                              τ
                              
                                 s
                                 c
                              
                           
                           <
                           0
                           ,
                        
                     
                     
                        
                           −
                           
                              T
                              
                                 s
                                 c
                              
                           
                           <
                           μ
                           <
                           0
                        
                      and 
                        
                           −
                           
                              T
                              
                                 s
                                 c
                              
                           
                           <
                           τ
                           <
                           0
                        
                     . Similarly, on the basis described above, the normalized cross-correlation result of region R1 can be simplified as

                        
                           (20)
                           
                              
                                 
                                    R
                                    
                                       R
                                       1
                                    
                                 
                                 
                                    (
                                    τ
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       
                                          (
                                          2
                                          M
                                          −
                                          1
                                          )
                                       
                                       
                                          τ
                                          
                                             s
                                             c
                                          
                                       
                                    
                                    
                                       T
                                       c
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       T
                                       c
                                    
                                 
                                 ,
                                 
                                 −
                                 
                                    T
                                    
                                       s
                                       c
                                    
                                 
                                 <
                                 μ
                                 <
                                 0
                              
                           
                        
                     In this condition, it also implies that the correlation result will decrease with the relative phase error increasing or, in other words, μ decreasing. Thus effective methods should be implemented to alleviate this correlation energy loss.

From Eqs. (19) and (20), it can be seen that, for a specific subcarrier delay τsc
                     , both these two cross-correlation results will get their maximums only when μ reaches zero, i.e. these two independent replicas are perfectly aligned. In other words, when some relative phase offset exists, the peak for the code discriminator will be biased, i.e. the peak in code dimension declares when 
                        
                           
                              τ
                              s
                           
                           =
                           
                              τ
                              
                                 s
                                 c
                              
                           
                           ,
                        
                      not 
                        
                           
                              τ
                              c
                           
                           =
                           0
                        
                     . This phenomenon is shown detailed in Fig. 2(b) with the instance of BOCsin(1,1), which is extracted from Fig. 2(a). Let it assume that the residual subcarrier error is 1/16 code chips, the code discriminator will mistake the peak point A as the true phase, rather than point B. Thus the DLL will try to pull the phase of local code replica toward point A rather than point B. As we all know, a loop can hardly keep perfect tracking of the incoming signal, i.e. there exists some errors among incoming BOC signal, local subcarrier replica and local PRN code replica definitely. Therefore, once the DLL induces some offset errors, it will affect SLL to some extent, and vice versa. This crosstalk between DLL and SLL will decrease the accuracy of ultimate delay estimate [22]. This section aims to promote the tracking accuracy of DET by decreasing the crosstalk between DLL and SLL.

As it is well designed [3,14,15], the PRN code and the subcarrier transmitted by satellites are not independent, i.e. their transition edges are all synchronized. Besides, the delay estimates of PRN code and subcarrier are equivalent to some extent, on considering the periodicity characteristic of subcarrier. To maintain the excellent ranging capability of BOC signals, we should make better use of these priori knowledge.

The concept of carrier aided code tracking (CACT) [16,23] is originally proposed to reduce the dynamics imposed on DLL. In this scene, the DLL is only used to deal with residual slow phase motions. However, it definitely obtains better tracking accuracy with permission of smaller loop bandwidth. Inspired by that, we propose the concept of subcarrier aided code tracking (SACT)to decrease the noise in DLL. Here, the subcarrier can be regarded as a pure carrier with pretty good phase synchronization. This proposed scheme is shown in Fig. 4
                        . It keeps the same SLL and DLL with five local replicas as in DET. However, the numerical controlled oscillator (NCO) of DLL is steered both by code discriminator and subcarrier discriminator. The final delay estimate of DLL is calculated as follows

                           
                              (21)
                              
                                 
                                    
                                       
                                          τ
                                          ˜
                                       
                                       c
                                    
                                    =
                                    h
                                    
                                       τ
                                       c
                                    
                                    +
                                    
                                       τ
                                       
                                          s
                                          c
                                       
                                    
                                    /
                                    k
                                 
                              
                           
                        where k is chip rating ratio of the subcarrier and the PRN code, which is decided by the BOC modulation type; τc
                         is the delay estimate of DLL, τsc
                         is the delay estimate of SLL. Although the delay estimate of subcarrier is equal to that of PRN code theoretically, some bias will exist owing to RF filter and other interference [19]. The adjustment factor h, adopted here, is used to fine tune the DLL.

Unlike the scheme of CACT which takes advantage of the large frequency gap between carrier and code, e.g. the frequency ratio for L1 C/A is 1540 [16], the proposed SACT scheme is kind of phase assistance system, because of the frequency of subcarrier and code in BOC signal is nearly same, e.g. the frequency ratio for BOCsin(1,1) is only 2. In essence, the SACT technique mainly take advantage of the accurate subcarrier phase to decrees noise in code loop. Theoretically, the code loop can be steered completely by the subcarrier estimate on account of the consistency of code and subcarrier. Later numerical analysis will be implemented to demonstrate its effectiveness and performance under different conditions.

From experience of the heritage BPSK system, the choice of loop bandwidth BW is a compromise. It is designed large enough to shorten the convergence state from a worst-case initial error and endure adequate line of sight (LOS) dynamic. On the other hand, it is also request sufficiently narrow to alleviate the amount of environment interference, particularly the thermal noise. For a practical receiver, the loop bandwidth is always specially designed to meet these conflicting environment. In the proposed scheme, the code loop is steered both by subcarrier estimate and code estimate where the factor h and the loop bandwidth will all dominate the ultimate tracking accuracy. These two constants can however be maintained appropriately under well behaved algorithm control. It targets to tolerate outside influence and give full play to its ranging capability.

Owing to the consistency of subcarrier and PRN code, the unambiguous code estimate can reflect the lock-state of tracking loop. To adaptively adjust loop parameters, the code estimate τc
                         is smoothed over a 0.5 s period using a moving average filter. This average filtered error is continuously monitored which represents the degree of deviation from real code phase, denoted as Dm
                         code chip here. The typical raw code estimate and filtered code monitor results of initial convergence stage are shown in Fig. 5
                        . It can be seen that the filtered code monitoring results is very steady and can reflect the real phase offset.

To cognize the state of local tracking loop, it evaluates Dm
                         by the threshold for code discriminator, i.e. we consider the DLL is locked if Dm
                         is small enough. This threshold is computed by assuming that the code error is within the main ACF peak. One rational empirical threshold for BOC(m,n) signal, is defined as

                           
                              (22)
                              
                                 
                                    
                                       D
                                       
                                          t
                                          h
                                          1
                                       
                                    
                                    =
                                    0.8
                                    ·
                                    n
                                    /
                                    m
                                 
                              
                           
                        where the scaling factor 0.8 is chosen to make sure real locked. Moreover, once Dm
                         is smaller than the lower threshold

                           
                              (23)
                              
                                 
                                    
                                       D
                                       
                                          t
                                          h
                                          2
                                       
                                    
                                    =
                                    0.2
                                    ·
                                    n
                                    /
                                    m
                                 
                              
                           
                        where the scaling factor 0.2 is chosen to tolerate thermal noise, it firmly believes that the code tracking is very precise. Fig. 5 marks these two typical threshold for BOCsin(1,1) signal. This code monitoring value Dm
                         will provide reliable reference to further improve tracking accuracy. With these information in mind, it can adjust loop constants adaptively, which are explained detailedly in the next section.

@&#PERFORMANCE EVALUATION@&#

In this section, the noise performance of the proposed method for Galileo E1-C BOCsin(1,1) signal will be evaluated in terms of DLL bandwidth variance, parameter h. The tracking jitter [12] is adopted here to quantify the amount noise transferred by tracking loop. In the case of BOC signal tracking, the delay estimate of SLL is more accurate than that of DLL, therefore the tracking jitter is approximated by SLL completely. All simulations are based on the structure described in Section 5. In this investigation, the sampling rate of RF signal is 16.369 MHz; the RF frontend bandwidth is 4MHz and the nominal intermediate frequency is 4.093 MHz. Other detailed simulation parameters are listed in Table 1
                     . Fig. 6
                      presents the typical simulation results versus parameter h and rbw
                     .

In literature, the bandwidth of DLL is always the same as that of SLL [12]. Actually, one can change the bandwidth of DLL and SLL at ease. Besides, the estimate of subcarrier is nearly the same as that of PRN code to some extent, especially in steady tracking. Thus, for the subcarrier aided code tracking loop, DLL can adopt very small bandwidth which resembles the case of carrier aided code tracking [23]. Here we simulate the tracking jitter in terms of several different bandwidth combinations. From Eq. (6), it is evident that the minimum code tracking error is proportional to the square root of loop bandwidth BL
                         on assuming the constants BLTI
                         is tiny enough. Therefore, it is insignificant to examine its absolute loop bandwidth. Instead, their relative bandwidth is fully considered here. During the simulation process, the bandwidth of SLL is the same which is assumed as 0.5 Hz, while that of DLL is decided by a preset bandwidth ratio rbw
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       r
                                       
                                          b
                                          w
                                       
                                    
                                    =
                                    
                                       
                                          B
                                          
                                             W
                                             
                                                S
                                                L
                                                L
                                             
                                          
                                       
                                       
                                          B
                                          
                                             W
                                             
                                                D
                                                L
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where BWSLL
                         and BWDLL
                         are the bandwidths of SLL and DLL, respectively.

The tracking performance simulation results with rbw
                         range from 1 to 4 are shown in Fig. 6. From Fig. 6 we can see that, as DLL bandwidth decreases while SLL bandwidth is constant, the tracking jitter of SLL decreases too. As is evident in Eq. (6), a small bandwidth will allow less noise entering into the loop. That is to say, as the noise of DLL decreases, the noise performance of SLL gets improvement, which demonstrates the viewpoint described in Section 5, i.e. the crosstalk between DLL and SLL will decrease the accuracy of ultimate delay estimate. By narrowing the bandwidth of DLL, it reduces their crosstalk and improves tracking accuracy eventually. Another obvious phenomenon is that, on average, it can reduce 0.025 m tracking jitter when the bandwidth ratio increases from rbw
                         = 1 to rbw
                         = 2, while it reduces only 0.01 m from rbw
                         = 3 to rbw
                         = 4. The downtrend of code tracking jitter is less obvious as the loop bandwidth decreases. That is because the PRN code is so precise that there is less room to be improved for SLL when the DLL bandwidth is narrow enough.

In the proposed SACT scheme Eq. (21), it can be seen that the final code loop feedback consists of two portions, i.e. one is from subcarrier estimation while the other one is from PRN code. On account of the consistency of subcarrier and PRN code, the code loop can be steered by subcarrier completely. Due to the influence of RF filter and other interference [19], or to the initial code offset, however, the code estimate must be counted in with factor h. In this simulation, it intends to understand how does the parameter h affect the DLL tracking , and in return improves the SLL tracking performance, on assuming that there is no integral Tsc
                         phase error between subcarrier and code delay estimates.

To this end, the bandwidth of SLL is set to 0.5 Hz while that of DLL is defined by rbw
                         as in above subsection for each simulation condition. As for tracking jitter considered here, let it assume that the tracking is in steady tracking state. The tracking performance simulation results with h range from 0.1 to 0.9 are shown in Fig. 6. From Fig. 6, it can see that, as h decreases the subcarrier tracking jitter decreases too. Obviously, this factor h determines the degree of how much does PRN code discriminator affects DLL. As h decreases, the subcarrier estimate will dominates DLL gradually. By weakening the influence of PRN code estimate, it can also reduces their crosstalk and improves tracking accuracy eventually. As is expected, the downtrend from 
                           
                              h
                              =
                              0.3
                           
                         to 
                           
                              h
                              =
                              0.1
                              ,
                           
                         is not obvious as that from 
                           
                              h
                              =
                              0.9
                           
                         to 
                           
                              h
                              =
                              0.7
                           
                        . In essence, it is the same reason that the PRN code is so precise that there is less room to be improved for SLL when DLL is nearly dominated completely by subcarrier estimate.

As is shown above, the subcarrier tracking jitter decreases with the decrease of BWDLL
                         and tuning factor h. Both of them will alleviate thermal noise of code loop and thus in return improve SLL tracking accuracy for a given bandwidth. Comparing the influence of h with that of varying DLL bandwidth, however, the minimum tracking jitter that can be achieved is still heavily dependent on the DLL bandwidth. Thanks to the assistance of subcarrier, the DLL can adopt ultra small bandwidth in practical, and thus further improve tracking accuracy.

To tolerate outside influence and give full play to its ranging capability, the loop constants are adjusted adaptively according the code monitoring results Dm
                        . Given that a side peak is tracked or the pull-in process is ongoing, the monitoring results Dm
                         is significantly above threshold D
                        
                           th1. In this scene, a bigger BWDLL
                         and 
                           
                              h
                              =
                              1
                           
                         will be adopted. It will trust more on code estimate that can tolerate large initial error. As the loop converges, we can gradually decrease BWDLL
                         and h. Once the monitoring results Dm
                         is smaller than the lower threshold D
                        
                           th2, it means that the loop is very steady. The code loop can be completely steered by subcarrier estimate while the code estimate is just a monitor. In this scene, the proposed SACT scheme is employed to fully tap the ranging capability of BOC signal. By evaluating Dm
                         with D
                        
                           th1 and D
                        
                           th2, this adaptive principle guarantees the loop works functionally.

@&#CONCLUSION@&#

The BOC modulated signal possesses excellent ranging capability owing to its large RMS bandwidth. However, the modulation of subcarrier introduces severe ambiguity problem which has to be alleviated with numerous carefully designed techniques. Yet it is hard to make full use of its ranging capability. In this paper, several techniques dedicated to improve tracking accuracy of BOC modulated signals are developed.

First, though analyzing several possible tracking techniques specially focusing on tracking accuracy, it finds that the DET scheme is quite robustness and possesses impressive performance already. Therefore it is adopted as the target to further explore the ranging capability of BOC signals. Then based on the “step-shape” modulated symbols, a general analytical expression of the two-dimension correlation of DET is formulated. Utilizing BOCsin(1,1) signal as an instance, we point out the inconspicuous problem existing in DET. To further improve the tracking accuracy of DET, the SACT technique is proposed, which is kind of phase-assisted system. By monitoring code errors, the tracking channel can tolerate outside influence and give full play to its ranging capability. Finally, numerical analysis demonstrates that the proposed SACT technique can further improve thermal noise performance of DET effectively. Indeed, it is useful not only for DET, but may improve performance for other analogous BOC unambiguous tracking method in GNSS receiver design, or even in other wideband CDMA-based communication systems.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the anonymous reviewers for their judicious comments which helped to greatly improve the quality of this article.

@&#REFERENCES@&#

