@&#MAIN-TITLE@&#Polynomial local shape descriptor on interest points for 3D part-in-whole matching

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We solve the part-in-whole matching problem for 3D models in engineering domain.


                        
                        
                           
                           A local descriptor is proposed to describe the local shape of the interest points.


                        
                        
                           
                           The proposed descriptor is sensitive to the geodesic radius.


                        
                        
                           
                           Interest points are extracted based on the local saliency of the sharp features.


                        
                        
                           
                           We report the properties and the matching performance of the proposed method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Part-in-whole matching

Interest points

Local shape descriptor

Attributed graph

@&#ABSTRACT@&#


               
               
                  Part-in-whole 3D shape matching is to recognize query shapes as sub-parts of a target intact 3D object. It plays a pivotal role in a large number of engineering applications. The most critical component in a part-in-whole search system is the local shape descriptor which encapsulates the identified local feature on the query part and is matched with the local shape descriptors of the parts in the database. We propose a novel local shape descriptor based on the concept that the evolution pattern of geodesic iso-contour’s length is a good representative for surface features. Our local shape descriptor enjoys a unique advantage over most existing ones by being sensitive to the geodesic radius of the local region, and thus is able to capture more comprehensive shape information if the query portion of the shape is larger and includes more complicated surface features. Through a simple approximation scheme, our local shape descriptor is defined as a vector piecewise polynomial function of the geodesic radius of the interest point, thus enabling local matching to be performed quickly by simple curve evaluations. We also introduce a new schema of interest points sampling so that we can reserve the most corresponding information of the model by a small number of local feature descriptors. The proposed part-in-whole matching approach outperforms many existing approaches in matching efficiency and requiring a smaller input region. It is a shortcut solution for incomplete model matching/retrieval.
               
            

@&#INTRODUCTION@&#

In applications of group technology and customized design, manufacturing companies often encounter the task of part-in-whole matching, that is, to recognize given shapes as sub-parts of a target intact 3D object in a database. It is especially applicable when global shape data of a query object is not available (e.g., a broken object) and only limited local features can be reliably used. In the literature, part-in-whole 3D shape matching approaches usually represent a model by a collection of features. In the engineering domain, features  [1–3] are often categorized into machining features (e.g., holes and slots) or design features (e.g., cylinder and cone), but they can only deal with shapes with exact representations. However, due to copyright protection and also large disk space concern, exact representation is not convenient for web communication when compared with approximated representation. Moreover, approximated representations (i.e., polyhedral mesh) are needed to describe data acquired with 3D scanners. Thus, in this paper, we address the part-in-whole 3D object matching problem for shapes with approximated representation, primarily for engineering components.

There are two critical challenges that are still not perfectly answered for part-in-whole matching. One is that the query can share any portion of its intact model and the size of the query usually does not match that of the intact model. Two regions of different surface areas and sizes are not directly comparable by the existing shape descriptors. Currently, multiscale methods  [4–7] are often utilized to mitigate this problem. However, the scale sampling density can only be determined empirically, which makes most current approaches impractical. The other challenge is how to extract efficient interest points that present the distinctive features of the model without losing important information. Comparing to the existing methods, our contribution in this paper lies on two points:
                        
                           (A)
                           We introduce a new local shape descriptor called Local Shape Polynomials (LSP). LSP is a piecewise polynomial that represents the continuous evolution pattern of the length of the geodesic iso-contours for a specified point. LSP enjoys a unique advantage that it is sensitive to the geodesic radius of the target region. It can be evaluated at very large scale and thus can describe a large query object with only one descriptor. We have solved the scale-invariant matching for LSP so that two regions with different surface areas and sizes can be directly compared.

We also propose a new schema of interest point extraction. In addition to the normal sharp edges and junction points, a new type of interest points is introduced based on the idea of minimum geodesic distance between a loop edge and the other interest points. The extracted interest points significantly reduce the computational complexity of the part-in-whole matching, and also collect the most correspondence information of the model.

The overview of our approach can be illustrated by Fig. 1
                     . The models in the database are processed offline one-time only, with every part represented by an attributed relational graph (ARG) of which each node denotes an interest point with its LSP as the attribution and each edge denotes the Euclidean distance between every two interest points. Each LSP is computed using the maximum geodesic radius of the model. At runtime, given as queries a few partial surface patches (either scanned range images or tailed mesh patches) that are obtained around edge junctions or surface protruding points, the interest points are identified. Next, LSP’s of the identified interest points are calculated with the maximum geodesic radii of these partial patches and an ARG is built. This ARG is then matched with the ARGs in the database, and the closest one is returned as the matched part.

The rest of the paper is organized as follows. After a brief review of the related works in Section  2, the details of our local shape descriptor will be presented in Section  3, and the interest point extraction method will be described in Section  4. The implementation in part-in-whole matching will then be described in Section  5. The experimental results will be given in Section  6, followed by the conclusion on the results and possible future work, in Section  7.

@&#RELATED WORKS@&#

Over the last two decades, there has been a large amount of research work in 3D model search systems (refer to the survey paper  [8]). Unlike the general whole-to-whole matching, part-in-whole matching, also called partial matching, allows a query to be incomplete. Liu et al.  [9] carried out a survey on part-in-whole matching. In engineering domain, most of the existing part-in-whole matching approaches  [1,10–13] focus on shapes with exact representations. For models with approximated representation, part-in-whole matching methods were primarily developed for general shapes, and can be classified into two categories: segments based methods and interest points based methods.

By segments based methods  [10,14–16], a model is first hierarchically decomposed into several multi-scale sub-parts. The model matching problem is then localized as a sub-parts matching problem. The main limitation is that it is hard to determine how many sub-parts to decompose, and, more troublesomely, the query shape is required to contain an entire and the same sub-part, which is difficult to satisfy since a query may only have a very small surface region.

By interest points based methods, only the local descriptors at a few interest points are used to represent the whole model. Interest points, which are also called key points or salient points sometimes, are usually defined as the vertices with an infrequent local shape descriptor  [4] or the vertices with local maximum curvature  [5,17–19]. Funkhouser et al.  [4] represented a model by a set of multi-spherical harmonic local features on the points randomly generated with uniform distribution. Distinctive features were then selected for model index. Novatnack et al.  [20] parameterized a 3D model on a 2D plane, and then obtained a 2D normal map. By convolving the normal map with Gaussian kernels of increasing standard deviation, a discrete scale-space is built. The corners and edges detected at individual scales were then combined into a unified representation for the 3D object. Castellani et al.  [18] derived an interest point matching method where interest points were detected at intra-octave locations, whose Laplacian of Gaussian value was higher than 30% of the global maximum over at least three different mesh solution levels. Hidden Markov Model (HMM) was utilized to capture the local features around a point of interest. Ovsjanikov et al.  [7] combined multiscale heat kernel signature (HKS) and bag-of-words approaches and developed a shape Google system. Mian et al.  [19] utilized the covariance matrix to calculate principal curvatures from which the quality value is computed. The vertices with large quality values are selected as the key points, and the depth of the locally fitted surface is utilized as the feature vector. While the selected key points are highly repeatable between the 3D model and its partial 2.5 range images, they are usually very dense and no key point is detected at the center of symmetric surfaces. All these methods adopted multiscale techniques, either for interest point selection or for local shape feature description.

Besides the aforementioned descriptors, there are plenty of other local descriptors suitable for shape matching (e.g., refer to the survey and evaluation by Heider et al.  [21] and Tang et al.  [22]). Ammann et al.  [23] analyzed the relief feature along the neighborhoods of the base surface in uniformly sampled multiple directions around each point. For each direction, a 1D relief function was obtained by cubic polynomial fitting at multiple scales. Mellado et al.  [24] built a scale-space through least-square fits of a low-degree algebraic surface onto neighborhoods of continuously increasing size, and proposed a local geometric variation by combining the curvature, the normal and the distance to 0-isosurface. All these multiscale features can only be evaluated at a relative small scale since they are local properties. Integral invariant (2009)  [25,26] computed the volume occupied by the object in a ball of varying size as a multiscale descriptor. But the Euclidean ball may intersect several un-connected regions on the object, and then the targeted region is no longer local.

As geodesic distance is invariant to isometric transformation, it is usually utilized to describe non-rigid shapes. It was first introduced for shape matching by Hilaga et al.  [27], and since has gained increasing attention, as it describes the intrinsic geometry of a shape and is invariant to isometric deformation. Geodesic fan was developed as a local descriptor by Gatzke et al.  [28]. It was claimed to be insensitive to vertices distribution. However, geodesic fan is not suitable for a large region, since the storage will increase dramatically with the radius growth. Later the temperature distribution descriptor was given by Fang et al.  [29]. It carried more comprehensive information about a surface’s features and showed a good retrieval performance for shapes with deformation. Miao et al.  [30] extract the angle evolution of geodesic iso-curves on the nose tip point for face recognition. Tabia et al.  [6] represented surfaces by 3D geodesic iso-curves.

Our local descriptor is partially inspired by Tevs et al.  [31] which though was derived only as a global shape descriptor. They planted a small number of landmarks on the object as the interest points, and attributed the landmarks with the intrinsic wave descriptor which is the function of mapping the length of geodesic iso-curves to geodesic radius. Their descriptor is not invariant to scale, so all models have to be normalized in pre-processing in order to exhibit a uniform mean intrinsic distance. We propose a piecewise polynomial function to approximate the improved intrinsic wave descriptor, and implement it for part-in-whole matching. We also solve the scale invariance problem from the point of view of matching two piecewise polynomials of different scales.

To evade the challenge of selecting interest features, Attene et al.  [32] described the neighbor regions for all the vertices using a layered onion descriptor, and introduced a fast reject schema to speed up the matching process. The limitation of  [32] is that it is not scale invariant, and the same radius must be used for any target model. V.G. Kim et al.  [33] developed a 3D part-in-whole matching system based on the fuzzy correspondence method, allowing user to specify regions of interest (ROI). Their method requires neither pre-segmentation nor interest point correspondence. Yet, pre-alignment and random sampling for all the shapes in the database are essential. Their method is vulnerable to alignment error and sampling bias, and is unlikely to be suitable for processing scanned data.

SHREC’10 and SHREC’11 robust feature detection and description benchmarks  [34,35] compared 3D salient point detection algorithms. The comparison is based on the repeatability of the detected points under a variety of transformations. However, human judgment of interest points is subjective by nature. Dutagaci et al.  [36] evaluated the performance of several recent interest point detecting approaches regarding to human generated ground truth. The evaluated methods include the mesh saliency (2005)  [37], the salient points (2008)  [18], the 3D-Harris (2010)  [38], the 3D-SIFT (2011)  [39], the SD-corners (2007)  [20] and the HKS (2009)  [40]. They observed that  [18,20,37,38] are sensitive to local perturbation,  [39] sometimes locates interest points onto insignificant regions, and the results of HKS  [40] mostly correspond to human generated ground truth. While other methods tend to mark more interest points than the human subjects, the HKS method often extracts not enough interest points.

Most of the existing interest point detection methods extract interest points with global saliency, e.g., the points with top 30% of the global maximum Laplacian of Gaussian value  [18], and the points with the quality value higher than a global threshold  [19]. The resultant points are usually dense at some areas while some other important areas are ignored. In contrast, our approach will extract sharp features first, and then detect interest points on each sharp feature based on the local saliency. By comparing with Dutagaci’s benchmark  [36], our interest points show higher correspondence with human judged ground truth than many aforementioned existing methods.

We aim at establishing a local shape descriptor that encodes discretized multiscale features in one continuous descriptor. It should be able to evaluate features at any scale including the entire model, so that a complicated surface area can be described with only one descriptor. The good properties of geodesic iso-curve are utilized. On Riemannian manifolds, the geodesic is defined to be the shortest path between points on the model surface. On discrete 3D models, locally a geodesic iso-curve of a source point is a circular arc  [41] with each point on the arc having equal geodesic distance to the source point. One major advantage of the geodesic iso-curve is that it encloses a connected local surface. Another advantage is that geodesic iso-curves can be evaluated at a very large scale until the maximum geodesic distance is reached. In contrast, curvature (e.g., the Gaussian curvature) related properties can only be evaluated based on a small local region.

As depicted in Fig. 2
                        , given a model 
                           M
                         and a source point 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ∈
                           M
                        , the length, denotes as 
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                        , of the geodesic iso-curve of 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         will increase with the geodesic radius 
                           ρ
                        . The derivative of 
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                         varies on different local geometric features. Based on this property, Tevs et al.  [31] proposed an intrinsic wave descriptor. Let 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         denote a geodesic iso-curve on model 
                           M
                         around point 
                           x
                           ∈
                           M
                           :
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                           =
                           
                              {
                              y
                              ∈
                              M
                              |
                              
                                 
                                    d
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              =
                              ρ
                              }
                           
                        , where 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         measures the geodesic distance between points 
                           x
                         and 
                           y
                         on the surface of 
                           M
                        . Starting from point 
                           x
                        , they computed the length of a set of iso-curves at 
                           ρ
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              ]
                           
                        , and normalized each length by 
                           2
                           π
                           ρ
                         to form the intrinsic wave descriptor 
                           
                              
                                 D
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                        . The parameter 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         was typically set to be 5% of the longest side of the bounding box of the object. In their implementation, 
                           
                              
                                 D
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         is a histogram by sampling 16 values of 
                           ρ
                         at a constant interval.

The intrinsic wave descriptor is invariant to isometric transformation and thus is appropriate to describe non-rigid body. When dealing with rigid body, it does not come with uniqueness guarantees. Two distinct local shape features could share the same iso-curve length, such as point 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         in Fig. 3
                        (a). The method of  [31] represents 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         with the same descriptor as illustrated in Fig. 3(b), since the studied surrounding regions of the three points are all identical under isometric transformation. A simple projection can however make the three descriptors distinct from each other. In our approach, we project the iso-curves 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         into their respective least-squares-fitting planes 
                           
                              LSFP
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                        . Let 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         denote the projected curve of 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         in plane 
                           
                              LSFP
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                        . The 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         for point 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         are shown in Fig. 3(c). The figure shows that 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              ,
                              ρ
                              )
                           
                         remains the same as 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              ,
                              ρ
                              )
                           
                        , while 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              ρ
                              )
                           
                         and 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              ρ
                              )
                           
                         are changed to ellipses. We divide the length of 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         by 
                           ρ
                        , and obtain a projected intrinsic wave function 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         by mapping 
                           ρ
                         to the length of 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                        . In Fig. 3(d), the curves of 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         for points 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         are depicted. Fig. 3 shows that the curves of 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         for 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         are more discriminable than 
                           
                              
                                 D
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                           [31] within the local region. Note that the new 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         is not invariant to isometric transformation.

The histogram representation of the intrinsic wave descriptor  [31] depends highly on the parameter 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         and the sampling density of 
                           ρ
                        . Pre-normalization for the model is required before the descriptor extraction. To make the descriptor more flexible and suitable for part-in-whole matching, we strive to find another format of representation for 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                        . We notice that with the increase of 
                           ρ
                        , the surrounding surface features might cause 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         to undergo a drastic change, followed by a new pattern. In other words, at the two sides of a certain geodesic radius, denoted by us as event radius, the 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         can be represented by two different polynomials respectively. An example is given in Fig. 4
                        . Point 
                           x
                         and a few of its iso-curves are displayed on the surface. The curve of 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         is plotted in Fig. 4(b). The figure clearly shows that, when the iso-curve crosses a sharp edge, touches a new surface or leaves the current surface, the curve begins a new and distinct pattern. As depicted in Fig. 4, when 
                           ρ
                           =
                           5
                        , the iso-curve 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              ρ
                              )
                           
                         starts to touch a new surface 
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                        ; and when 
                           ρ
                           =
                           7.1
                         the iso-curve leaves surface 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                        ; consequently, 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           =
                           5
                         and 
                           
                              
                                 ρ
                              
                              
                                 
                                    2
                                 
                              
                           
                           =
                           7.1
                         are two event radii. The method of extracting sharp edges and segmenting faces, which are needed for determining the event radii, will be described later.

We are now ready to define our Local Shape Polynomials (LSP). Let 
                           
                              ER
                           
                           
                              {
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         denote the event radii of a specified point 
                           x
                        , sorted in ascending order. Let 
                           
                              
                                 
                                    er
                                 
                              
                              
                                 0
                              
                           
                           =
                           0
                           ,
                           
                              
                                 
                                    er
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                        , where 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         is the maximum geodesic radius of 
                           x
                         to form a close iso-contour on the given surface. The projected intrinsic wave function 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         can be approximated as a piecewise polynomial with degree 
                           m
                         of the geodesic radius 
                           ρ
                        . On 
                           
                              [
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           
                        , the sub-polynomial can be expressed as: 
                           
                              (1)
                              
                                 
                                    
                                       P
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    ρ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              
                           
                         where 
                           m
                         is the degree of the polynomials, 
                           k
                           +
                           1
                         is the total number of event radii, and 
                           
                              
                                 a
                              
                              
                                 j
                              
                              
                                 i
                              
                           
                         denotes the coefficient of 
                           
                              
                                 ρ
                              
                              
                                 j
                              
                           
                         of the sub-polynomial on 
                           
                              [
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           
                        . The vector that stores the event radii and the coefficients of this piecewise polynomial, i.e., 
                           
                              [
                              0
                              ,
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              ]
                           
                         is defined as the Local Shape Polynomials (LSP) of point 
                           x
                        , which is denoted as 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 x
                              
                           
                        .

We have the following observations regarding the properties of an LSP: 
                           
                              (1)
                              It is invariant under rigid body transformations.

It is robust to small strength of data noisiness, owing to geodesic itself.

The LSP is perfectly inclusive in terms of geodesic disk radius 
                                    ρ
                                 . Specifically, let 
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          2
                                       
                                    
                                  be the two LSP’s of a point 
                                    x
                                 , with respect to two different geodesic disk radii 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                  (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                 ); then 
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ⊂
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          2
                                       
                                    
                                 .

Parameters can be detected automatically without manual interruption.

It encodes discretized multiscale features with an explicit function. Given a specified geodesic radius 
                                    ρ
                                 , the value of the function can be directly calculated.

Although the LSP is partially inspired by the intrinsic wave descriptor  [31], we have improved the uniqueness of the wave descriptor on rigid bodies. Moreover, we introduced the piecewise polynomial function to make it applicable to part-in-whole search. It is the last three properties above that make our LSP particularly desirable for part-in-whole matching. When a database is processed (one time only) offline, the size of the future query is usually unknown. It is not feasible to normalize the query and the models in database to a uniform mean intrinsic distance as done in  [31]. By introducing event radii and piecewise polynomial functions, the incomplete LSP and the intact LSP can be easily matched (details will be given later). When a query comes with an LSP, it can be matched with the LSP’s of the models in the database, with the certain assurance that if the two are matched perfectly, so will be the two local shapes near the two represented interest points, and vice versa.

In Fig. 5
                        , the LSP curve is compared with the intrinsic wave descriptor  [31] and shape histogram descriptor  [42]. During a part-in-whole search, the user input is generally subjective: two users provide patch 1 and patch 2 respectively as the query; both are obtained by scanning around a same feature of the target area, but are of different fractions, i.e., patch 1 has a smaller portion than patch 2. The piecewise polynomial curves in Fig. 5(d) clearly show that 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 1
                              
                           
                           ⊂
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 2
                              
                           
                        , while the intrinsic wave descriptor (Fig. 5(e)) and shape histogram (Fig. 5(f)) describe the patches as almost two different shapes. (In this comparison example, to extract the LSP and intrinsic wave descriptor, the iso-curves are evaluated from the red point in Fig. 5(a) at a geodesic interval 
                           
                              Δ
                           
                           ρ
                           =
                           5
                        , and, to compute the shape histogram, 1600 points are evenly sampled on each patch.)

In order to robustly identify event radii, we have to define and extract model faces. As event radii usually locate on sharp edges, we define the faces to be the model surfaces segmented by sharp edges, where surface tangent derivative discontinuities occur. Compared with general objects, sharp edges commonly exist in engineering models. On the other hand, for the purpose of reducing stress concentration, sharp edges are often replaced by smooth transition borders, such as fillets. Therefore, the transition borders should also be detected. The method of Kim et al.  [43] is adopted by us, mainly owing to its robustness to noise and ability to detect smooth transition borders.

For self-completeness, Kim’s method is briefly described here. The tensor voting technique was adopted to analyze surface shapes, because it shows strong robustness to data noises and is sensitive to sharp features. During tensor voting, input data points are first encoded as second-order symmetric tensors, which then communicate among each other via a voting algorithm. Each point 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         collects all the votes cast at its location and encodes them into a new tensor. The three eigenvalues 
                           
                              {
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                              ≥
                              0
                              }
                           
                         of the resultant tensor carry the local feature of the neighborhood region of the related vertex. For vertices in smooth regions, 
                           
                              
                                 λ
                              
                              
                                 1
                              
                              
                                 i
                              
                           
                         is much larger than 
                           
                              
                                 λ
                              
                              
                                 2
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 3
                              
                              
                                 i
                              
                           
                        ; while at the vertices on sharp edges, 
                           
                              
                                 λ
                              
                              
                                 1
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 2
                              
                              
                                 i
                              
                           
                         are approximately the same but much larger than 
                           
                              
                                 λ
                              
                              
                                 3
                              
                              
                                 i
                              
                           
                        ; and at corner vertices, all the three are of the same magnitude. Based on the above characteristic, the spatial regions can be recovered as follows. First of all, the eigenvalues of the tensor at each vertex are normalized, i.e., 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           =
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           /
                           
                              |
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              |
                           
                           =
                           
                              (
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                        , where 
                           
                              |
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              |
                           
                         means the Euclidean norm of 
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         is the normalized 
                           
                              
                                 λ
                              
                              
                                 1
                              
                              
                                 i
                              
                           
                           ,
                           
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         for 
                           
                              
                                 λ
                              
                              
                                 2
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ˆ
                              
                           
                         for 
                           
                              
                                 λ
                              
                              
                                 3
                              
                              
                                 i
                              
                           
                        . Next, the 
                           K
                        -means algorithm is applied for vertex clustering based on the normalized eigenvalues. The parameter 
                           K
                         adjusts the sensitivity of the edge detection. A larger 
                           K
                         can recognize finer features of the model, and extract smoother edges, yet will also increase the computation complexity. 
                           K
                           =
                           5
                           –
                           10
                         is used in our project. Vertices with the same cluster label may not be in the same region if they are separated by other clusters. A region growing method is utilized for generating connected regions. At the end of the region growing, 
                           t
                         (
                           t
                           ≥
                           K
                        ) connected regions will be obtained. To reduce possible cracks, and also to make the number of regions less dependent on the fixed number 
                           K
                        , a region merging method is implemented to get the final segmentation. As a result, a model 
                           M
                         is in principle segmented into surface regions 
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                              
                              }
                           
                        , and a list of vertices 
                           
                              
                                 
                                    V E
                                 
                              
                              
                                 i
                                 j
                              
                           
                         is used to represent the boundary between any two adjacent surface regions 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                        .

An example of our surface segmentation is illustrated in Fig. 6
                        . The figure depicts four cubes and four cylinders with different transition features. Cube (a) and Cylinder (e) have no fillets, while other models have fillets with three different radii (
                           r
                           =
                           0.05
                        , 0.10, 0.25 respectively). Each segmented surface is assigned a distinct color, and the boundary edges of any two adjacent surfaces are colored in red. The jagged edges in (d) and (h) were due to the low mesh resolution. As shown in Fig. 6(c), (d), (g) and (h), the edges of the large fillets can be detected and preserved. If the area of the fillet region is less than a given minimum area 
                           
                              
                                 A
                              
                              
                                 
                                    min
                                 
                              
                           
                        , such as in Fig. 6(b) and (f), the fillet region is merged to the adjacent region with the closest average 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        . In this paper, we experimentally set the value for 
                           
                              
                                 A
                              
                              
                                 
                                    min
                                 
                              
                           
                         to be 10% of the minimum area of its arbitrary adjacent face.

To compute the LSP for a point 
                           x
                         on model 
                           M
                        , the whole procedure is given in Table 1
                        . First of all, we have to compute the geodesic matrix 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ;
                              ∗
                              )
                           
                         that measures “within-surface” distances between 
                           x
                         and the other vertices of 
                           M
                        . Sethian’s fast marching method  [44] is adopted because it is fast and robust. Secondly, the maximum geodesic radius 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         is determined. Thirdly, a sequence of iso-curves is generated in uniform step from 0 to 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                        . If the radius is large enough, the iso-curve has the possibility of diverging into several disconnected sub-curves  [41]. To get a geodesic iso-curve for point 
                           x
                         with geodesic radius 
                           ρ
                        , we find all the edges that have one end with 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                           ≤
                           ρ
                         and the other end with 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                           >
                           ρ
                         by implementing the stabbing query of interval tree, and apply a linear intersection to find a point 
                           y
                         on each of them with 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ;
                              y
                              )
                           
                           =
                           ρ
                        . Starting from one of the intersections, we expand to its neighboring intersections and connect them one by one to form an iso-curve till the curve is closed or touches the boundary. If not all the intersections are traversed, a new sub-iso-curve is built from one of the remaining intersections. All these computed sub-iso-curves are then projected to their respective least-squares-fitting planes. When an iso-curve leaves a previous segment, touches a new segment, or separates/merges into more/less sub-iso-curves, an event radius is recorded. Folding’s may occur on a projected iso-curve. In this case, the folded parts of the iso-curve are not combined together but are treated as several overlapped curves, because the combination may cause information loss. Finally, based on the length of the projected iso-curves and the event radii, 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 
                                    x
                                 
                              
                           
                         is computed using Eq. (1) by least squares fitting.

For most of the points on a 3D mesh, especially the points on a smooth surface, if the sampling density of 
                           ρ
                         is large enough, the first non-zero value of 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         usually locates in 
                           
                              (
                              0
                              ,
                              2
                              π
                              ]
                           
                        . However, it is not uncommon that 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         could exceed 2
                           π
                        . An example of such situation is given in Fig. 7
                        . In (a), the model is colored by the geodesic distance to the red source point 
                           x
                        . Blue represents small distance while red indicates large. The red curve shows the iso-curve 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              2.0
                              )
                           
                        , where the iso-curve touches a sharp edge and an event radius 
                           
                              
                                 
                                    er
                                 
                              
                              
                                 1
                              
                           
                           =
                           2.0
                         is recorded; the blue curve describes 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              4.0
                              )
                           
                        , where the iso-curve is about to separate into four sub-iso-curves, and another event radius 
                           
                              
                                 
                                    er
                                 
                              
                              
                                 2
                              
                           
                           =
                           4.0
                         is recorded; the yellow curves depict the separated four sub-iso-curves of 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              4.6
                              )
                           
                        ; and the cyan curves depict 
                           
                              
                                 C
                              
                              
                                 M
                              
                           
                           
                              (
                              x
                              ,
                              4.8
                              )
                           
                        , where one of the sub-iso-curves is about to disappear and a new event radius 
                           
                              
                                 
                                    er
                                 
                              
                              
                                 3
                              
                           
                           =
                           4.0
                         is recorded. In (c) the projected iso-curve at 
                           
                              
                                 
                                    er
                                 
                              
                              
                                 2
                              
                           
                           =
                           4.0
                         is displayed. In figure (d), values of sampled 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              ρ
                              )
                           
                         are marked with blue star points, and the fitted 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 x
                              
                           
                         is drawn as a red solid curve. From (c) and (d), we can see that at 
                           ρ
                           =
                           4.0
                         the projected iso-curve is about to overlap itself and 
                           
                              
                                 P
                              
                              
                                 x
                              
                           
                           
                              (
                              4.0
                              )
                           
                         is much larger than 
                           2
                           π
                        . In addition, if the local surface geometry of the interest point is complicated, such as the red point 
                           y
                         of a star like model in Fig. 7(e), even the first non-zero value of 
                           P
                           
                              (
                              ρ
                              )
                           
                         could be larger than 
                           2
                           π
                        . Similar to (a), the model in (e) is also colored by the geodesic distance value from the red source point 
                           y
                        . The sampled 
                           
                              
                                 P
                              
                              
                                 y
                              
                           
                           
                              (
                              ρ
                              )
                           
                         and the curve of 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 y
                              
                           
                         are shown in (h) and the projected iso-curve at the first sampled geodesic radius 
                           ρ
                           =
                           0.018
                         of point 
                           y
                         is drawn in (g). We can read from (g) and (h) that the curve has many in-and-out patterns, and 
                           
                              
                                 P
                              
                              
                                 y
                              
                           
                           
                              (
                              0.018
                              )
                           
                         is much larger than 
                           2
                           π
                        . From figure (g) we can see that in the extreme case the projected iso-curve 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                           
                              (
                              y
                              ,
                              ρ
                              )
                           
                         can overlap itself to fill the disk with radius 
                           ρ
                        , and the maximum value of 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 M
                              
                           
                         could be infinite.

The number of event radii does not depend on the size of the model, but depend on the topological complexity of the model and the given maximum geodesic radius 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                        . As described in Section  3.2, by adjusting the parameters 
                           K
                         and 
                           
                              
                                 A
                              
                              
                                 
                                    min
                                 
                              
                           
                         during the process of region clustering and merging, users can control how fine the detected transition borders can be. In the interest of part-in-whole matching, we focus on local features, which can be represented by the first few piecewise polynomials of LSP. Based on our experiments, in general five sub-polynomials, all with degree 
                           m
                           =
                           3
                        , are sufficient to distinguish a local feature from others. We also tested the number of steps 
                           N
                         for sampling iso-curves. With the increase of 
                           N
                        , one gets smoother LSP curves and smaller approximation error. However, the computation complexity is also increased. We experimentally set 
                           N
                           =
                           60
                         in our project. At this research stage, all the samples are included during the polynomial fitting for computing LSP, and no outliers are excluded.

An example of the LSP curves of four source points is given in Fig. 8
                        . Point A is a random point on a high resolution sphere surface; B is a point on a low resolution sphere surface; C is a junction point on a cube, and D lies on a flat face of the cube. In Fig. 8(d), it is evident that the LSP’s represent distinctive patterns upon different local shapes. Now that points A and B share similar local shapes, their LSP’s should also be close to each other. The LSP curves for point A on two spheres of different diameters are shown in Fig. 8(e). As the maximum geodesic radius of the bigger sphere is larger, the two LSP curves have different scales along the geodesic radius. Fig. 8 illustrates that LSP is sensitive to surface local features and model scale, but robust to mesh density. When the model is scaled larger, the LSP curve will be stretched along the geodesic radius direction but not change along the vertical direction.

Given two LSP’s at two points on two models of the same size, 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                        , let 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 A
                              
                           
                         and 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 B
                              
                           
                         be the maximum geodesic radii for the two respectively, 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 A
                              
                           
                           ≤
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 B
                              
                           
                           ,
                           
                           P
                           C
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    A
                                 
                              
                              )
                           
                         be the piecewise polynomial function of 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                        , and 
                           P
                           C
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    B
                                 
                              
                              )
                           
                         for 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                        . The distance between 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         is defined to be the integration of the absolute difference of the two curves: 
                           
                              (2)
                              
                                 D
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          B
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      max
                                                   
                                                   _
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          |
                                          P
                                          C
                                          
                                             (
                                             
                                                
                                                   
                                                      LSP
                                                   
                                                
                                                
                                                   A
                                                
                                             
                                             )
                                          
                                          −
                                          P
                                          C
                                          
                                             (
                                             
                                                
                                                   
                                                      LSP
                                                   
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       d
                                       ρ
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                max
                                             
                                             _
                                             A
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

We however must consider the case when the studied two models are of two different sizes/dimensions and the two descriptors describe two different portions of their corresponding models. Scale invariant matching problem has been well studied for matching two global shape descriptors, such as  [45]. Fourier transform is usually applied to matching descriptors of different scales in frequency domain. Unfortunately, this method is not applicable to matching partial descriptors. The problem of matching models with both different sizes and fractions is addressed by some point cloud registration approaches  [46,47]. Most of them adopted the Iterative Closest Point (ICP) method. Suitable for registration notwithstanding, the iteration approach is however computationally too expensive for shape matching, because, unlike registration, in shape matching a large collection of models in the database have to be checked.

If two surfaces are similar, their LSP’s of the similar point will have similar event radii distribution. Yet, two similar surfaces may have different mesh resolutions, such as the models (a) and (b) in Fig. 8, therefore the descriptor for one of them may have more or fewer event radii than the other. We make an assumption that once the two models are zoomed to an optimal matching scale, if both of them have one or more event radii in addition to 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                        , at least a pair of their event radii should be coincident. Based on this assumption we propose a method for finding the optimal matching scale between two LSP’s. We zoom one of the studied surface by stretching its LSP at different scales, the optimal scale between two LSP’s is achieved when a pair of their event radii equal to each other and their integral difference is the minimum among all runs of the stretching. Refer to Fig. 9
                        . 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         in Fig. 9(a) have different scales and surface areas; the optimal matching scale between the two must be determined, so that the difference 
                           D
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    B
                                 
                              
                              )
                           
                         is minimized. Let 
                           
                              ER
                           
                           _
                           A
                           
                              {
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    0
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    1
                                 
                                 
                                    A
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    k
                                    +
                                    1
                                 
                                 
                                    A
                                 
                              
                              }
                           
                        , 
                           
                              ER
                           
                           _
                           B
                           
                              {
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    0
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    1
                                 
                                 
                                    B
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    B
                                 
                              
                              }
                           
                         denote the event radii of 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         respectively, and 
                           
                              
                                 P
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    B
                                 
                              
                              )
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 m
                              
                           
                           
                              
                                 a
                              
                              
                                 j
                              
                              
                                 i
                              
                           
                           
                              
                                 ρ
                              
                              
                                 j
                              
                           
                         be the sub-polynomial function of 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         on 
                           
                              [
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    B
                                 
                              
                              ]
                           
                        , where 
                           m
                         is the degree of the polynomial. In case 
                           k
                           <
                           1
                        , we uniformly sample 
                           w
                           =
                           10
                         points between 
                           
                              (
                              0
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       max
                                    
                                    _
                                    A
                                 
                              
                              )
                           
                         for 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         as the temporary event radii. Similar sampling is applied to 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         if 
                           n
                           <
                           1
                        . After stretching 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         by a scale 
                           β
                         along the radius-axis, the new sub-polynomial function of the stretched 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                        , denoted as 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                           
                              (
                              β
                              )
                           
                        , becomes
                           
                              (3)
                              
                                 
                                    
                                       P
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          B
                                       
                                    
                                    
                                       (
                                       β
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ρ
                                             
                                             
                                                β
                                             
                                          
                                          )
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        
                     

The new event radii of 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                           
                              (
                              β
                              )
                           
                         become 
                           
                              ER
                           
                           _
                           
                              
                                 B
                              
                              
                                 ′
                              
                           
                           
                              {
                              β
                              ∗
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    0
                                 
                                 
                                    B
                                 
                              
                              ,
                              β
                              ∗
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    1
                                 
                                 
                                    B
                                 
                              
                              ,
                              …
                              ,
                              β
                              ∗
                              
                                 
                                    
                                       er
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    B
                                 
                              
                              }
                           
                        . Then, the distance between 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                           
                              (
                              β
                              )
                           
                         is calculated as 
                           
                              (4)
                              
                                 D
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          B
                                       
                                    
                                    
                                       (
                                       β
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      max
                                                   
                                                   _
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          |
                                          P
                                          C
                                          
                                             (
                                             
                                                
                                                   
                                                      LSP
                                                   
                                                
                                                
                                                   A
                                                
                                             
                                             )
                                          
                                          −
                                          P
                                          C
                                          
                                             (
                                             
                                                
                                                   
                                                      LSP
                                                   
                                                
                                                
                                                   B
                                                
                                             
                                             
                                                (
                                                β
                                                )
                                             
                                             )
                                          
                                          |
                                       
                                       d
                                       ρ
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                max
                                             
                                             _
                                             A
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Let 
                           
                              
                                 β
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          er
                                       
                                    
                                    
                                       i
                                    
                                    
                                       A
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          er
                                       
                                    
                                    
                                       j
                                    
                                    
                                       B
                                    
                                 
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           k
                           ,
                           
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        . The optimal scale between the two LSP’s is defined as 
                           
                              (5)
                              
                                 
                                    Sca
                                 
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          B
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    {
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             A
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             B
                                          
                                       
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Extracting LSP on all the vertices of the model for part-in-whole matching is not feasible, while generating interest points by random sampling cannot guarantee the accuracy since the interest points are not repeatable. We aim to extract interest points that are sparsely distributed on all detected features. The resultant points should have high repeatability rate regarding to different mesh sampling and noise. In addition, the interest points should be corresponding to human judgment, as the neighborhood region will be identified by the user as the query of the part-in-whole matching.

Since our LSP computation requires surface segments, an intuitive idea is to utilize the detected edges and surfaces for interest point extraction. Fig. 10
                      illustrates our process of interest point identification. Three types of interest points are identified:


                     
                        
                           (1)
                           Type-1: Tip points on a free form surface where local curvature maxima occur, e.g., point tp in Fig. 10.

Type-2: Junction points, where tangent discontinuity occurs, e.g., the square points in Fig. 10.

Type-3: Constrained points on smooth edges. In Fig. 10, loop edge 
                                 b
                               has no Type-1 or Type-2 points. Instead of randomly sampling points on it, we identify points that have the shortest geodesic distance to all the existing interest points. For example, in Fig. 10, the circular points on edges 
                                 b
                               are Type-3 interest points, where the corresponding geodesic paths to edge 
                                 a
                               are depicted in dashed black lines. The details will be given next.

For each segmented face 
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        , we first check if it contains a tip point. We define the Interest value (Iv) for each vertex 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         of the segmented face, and denote it as 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 i
                              
                           
                        : 
                           
                              (6)
                              
                                 
                                    
                                       
                                          Iv
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 /
                                 
                                    [
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

A similar equation is defined in  [48] as the surface variance. At a tip point 
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 1
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                              
                                 t
                              
                           
                        , and 
                           
                              
                                 λ
                              
                              
                                 3
                              
                              
                                 t
                              
                           
                         are approximately of a same value, thus the interest value 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 t
                              
                           
                         should be significantly larger than that of its neighborhood points. If the maximum value of 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 i
                              
                           
                        , denoted as maxIv, is larger than a threshold 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                        , a statistics evaluation is carried out over all the 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        , except for the vertices on the edges. The standard deviation 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                         is calculated as 
                           
                              (7)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          Iv
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Iv
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           N
                         is the number of vertices, and 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 N
                              
                           
                           
                              (
                              
                                 
                                    
                                       Iv
                                    
                                 
                                 
                                    1
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    
                                       Iv
                                    
                                 
                                 
                                    N
                                 
                              
                              )
                           
                        . If 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                         is beyond a predefined limit 
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                        , the region is identified as having one or more protruding points. Thus, the point 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         with the highest value of 
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 i
                              
                           
                         will be identified as an interest point.

In the case of a single-face model, e.g., a sphere, the interest values of all the model vertices might be very close to each other. There may be more than one vertex that has the maximum Iv over the model. Four interest points are randomly selected from the vertices that have the highest interest value. This select criterion makes sense because all these vertices almost carry the same local feature. Some surfaces might not have sharp tipping point like point tp in Fig. 10. Alternatively, there might be smooth tipping end, such as the 2D Gaussian surface in Fig. 11
                        . In this situation, the tipping smooth end can also be detected by our method.

We compare the result of our approach with Mian  [19] in Fig. 11. As shown in Fig. 11(a), Mian  [19] is not able to detect the key point at the peak. Our method has successfully extracted the sole interest point at the center of the smooth tipping end as shown in Fig. 11(b). The 2D Gaussian surface is colored by the interest value; the maxIv occurs at the top of the surface, and is extracted as the interest point (the big and red point). The points that are close to the interest point also have high interest values, e.g., the points with 
                           
                              Δ
                           
                           
                              Iv
                           
                           =
                           
                              maxIv
                           
                           −
                           
                              
                                 
                                    Iv
                                 
                              
                              
                                 i
                              
                           
                           <
                           5
                         are colored red in Fig. 11(c). This example clearly demonstrates the ability of our approach to extract tip points on symmetric surfaces.

A few values of maxIv and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                         for different surfaces are listed in Table 2
                        . In the second row, the surface segmentation results of some typical models are shown. Each segmented face is assigned a distinct color. Note that it is impossible to assign the same color to the corresponding surfaces of two different models. All the models are normalized in a unit bounding box. To simulate small perturbation, a noisy model is obtained by applying zero mean Gaussian noise with standard deviation 
                           σ
                           =
                           2
                           %
                         to its noise-free counterpart. A partial scanned light bulb model and a partial scanned fandisk model are given to show maxIv and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                         on real scanned object. In the third row, the number of vertices for each model is given. The fourth row gives the number of faces for each model. For the surface specified by the color in the fifth row, the corresponding maxIv and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                         are listed in the sixth and the seventh row respectively. E.g., the fourth column of Table 2 describes that the yellow surface of the cube model with 
                           
                              maxIv
                           
                           =
                           1.00
                         and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                           =
                           0.00
                        . We also applied zero mean Gaussian noise 
                           σ
                           =
                           2
                           %
                         to 40 other different faces in some normalized models, and analyzed their maxIv and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                        . In the end, we find that all the faces with a tipping end would have 
                           
                              maxIv
                           
                           >
                           10
                         and 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                           >
                           2
                         (i.e., the cone model in Table 2), while other faces have 
                           
                              maxIv
                           
                           <
                           10
                         or 
                           
                              
                                 σ
                              
                              
                                 
                                    Iv
                                 
                              
                              
                                 k
                              
                           
                           <
                           2
                        . Therefore, we set the thresholds 
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                           =
                           10
                         and 
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                           =
                           2
                         in this project.

Junction points show high interest value compared to their neighborhood points and are usually sparsely distributed. For open edges, where the begin point and end point are different, the end points can be directly identified as the interest points. But, for loop edges, where there is no end point, we need to judge if they have junction points. First, a score of Iv is also computed using Eq. (6) for all the sample points on the edge. Next, the derivative of the Iv vs. arc length is calculated at each point. A point 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         is taken as a junction point if the derivative is larger than the preset threshold 
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                        , which is experimentally set as 40 in this project.

For the remaining edges which do not have junction points, we define a continuous function 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         on each of them. Explicitly, for any point 
                           x
                         on an edge, the 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                         is the minimum of the shortest geodesic distances from 
                           x
                         to the already identified junction or tip points. If there is no Type-1 and Type-2 interest points, but only smooth edges, e.g., a cylinder, we find the edge that has the maximum length, randomly generate 4 points evenly distributed on it, and then continue to compute 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                        . Since by assumption there is not any junction point on such an edge, 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                         must be a closed curve. Therefore, the function 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                         must have a finite number of minima on the loop. Based on the minima of 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                        , interest points can be identified. We first compute the global minimum of 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                         for every remaining edge and put them into a queue in ascending order according to their minima 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         values. Then, the top element in the queue is popped, and a finite number of local minima points of this loop are defined as the interest points for that loop edge. After an edge is popped from the queue, the global minimum 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              )
                           
                         values of the remaining edges in the queue are updated to reflect the addition of the newly added interest points. The top element is popped again. This recursion continues until the queue becomes empty.

We use a fandisk model shown in Fig. 12
                         to demonstrate our interest point identification. Fig. 12(a) shows the noise free original mesh of the CAD model. In Fig. 12(b), the detected edge points by our method from the noise free mesh are displayed in red. Note that our result is sensitive not only to the sharp edges but also to the transition areas. Based on Fig. 12(b), the interest points are extracted by our algorithm and displayed in Fig. 12(c). The interest points for the noisy model by our algorithm are shown in Fig. 12(d), which are consistent with Fig. 12(c). In Fig. 12(e), the key points detected by Mian  [19] with quality value 
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           >
                           50
                         are shown. Fig. 12(f) depicts the key points with quality value 
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           >
                           80
                         by Mian  [19]. As the quality value is different on each edge, a quite large number of redundant key points are extracted on some surfaces, while no key point is extracted on some sharp edges, like the ones in the two circled areas. In Fig. 12(g), the key points are extracted by Mian  [19] (
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           >
                           80
                        ) from the same noisy model as in Fig. 12(d). More than 50% of the interest points in Fig. 12(f) cannot be repeated in Fig. 12(g). The comparisons between Fig. 12(c), (d), (f) and (g) demonstrate that our algorithm is able to identify more representative, meaningful and high repeatable interest points than the simple global thresholding method  [19]. (In this experiment,  [19] is evaluated with their fix parameters setting, as provided by the original work.)

In the following, we assume that we are given a model database 
                        
                           {
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 n
                              
                           
                           }
                        
                      (a collection of engineering parts) and an incomplete object 
                        
                           
                              M
                           
                           
                              q
                           
                        
                      as the query. All of them are differential 2-manifolds embedded in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      and with mesh representation. Model 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      is supposed to be the corresponding intact model of 
                        
                           
                              M
                           
                           
                              q
                           
                        
                     , that is, 
                        
                           
                              M
                           
                           
                              q
                           
                        
                        ⊂
                        
                           
                              M
                           
                           
                              i
                           
                        
                     . Our task is to find 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      from the database, so that there exists a bijective mapping between the subparts of 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              M
                           
                           
                              q
                           
                        
                     . If the perfect bijective mapping does not exist, we detect 
                        
                           
                              M
                           
                           
                              i
                           
                        
                      as the model that has the minimal mapping difference with 
                        
                           
                              M
                           
                           
                              q
                           
                        
                     . We represent a model with a set of local shape descriptors on interest points. Each local descriptor describes a subpart of the model. With the coordinate information between the interest points, an attributed related graph (ARG) is built. The part-in-whole matching problem then becomes a graph optimization problem—finding a mapping that maximizes the similarity between the ARG of 
                        
                           
                              M
                           
                           
                              q
                           
                        
                      and that of 
                        
                           
                              M
                           
                           
                              i
                           
                        
                     .

In the database, each identified interest point on a model is represented as a feature vector, which is a junction of its coordinates and an LSP. The model index is constructed by building a matrix to connect the feature vectors for all the interest points on the model in parallel. With the model index, shape is described as a complete attribute relational graph 
                           G
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                        , of which each node 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           ∈
                           V
                         denotes an identified interest point with its LSP as the attribute and each edge 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                              
                           
                           ∈
                           E
                         indicates the Euclidean distance between every two interest points 
                           
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . Geodesic distance between any two points can also be used to define a graph edge. Nevertheless, if we acquire the query surface patches via a 3D scanner, the Euclidean distance between the interest points can be easily reported by the scanner while the geodesic distance is impossible to obtain if the surface patches are separated. Using Euclidean distance for building the graph edges makes the approach more practical. Two factors determine the similarity between any two nodes of the respective two graphs: the first is the attribute (LSP) similarity of the two interest points themselves, while the second is the similarities between the edges incident at the two nodes.

Each input query 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                           ⊂
                           
                              
                                 M
                              
                              
                                 q
                              
                           
                         can be a partial mesh patch trimmed from a CAD model or obtained by a 3D scanner. 3D scanned data is the most common input format, especially for an incomplete object matching, as the solid model of the incomplete object is practically impossible to obtain. To obtain a connected region, sometimes a single-view scanning is not enough, and two or more views might be required. A scanned mesh often contains noise and is usually not watertight. Pre-processing, such as filling the holes, must be carried out. On the other hand, if the query surface is obtained from a CAD model, the vertices distribution is usually non-uniform, the vertices on curves are much denser than that on straight lines. We need a subdivision pre-processing for the models with very low level of details, because the vertices of the model should be dense enough to provide a reliable result of tensor voting and iso-curve computation.

More than one interest point may be identified from a partial query patch 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                        . The maximum geodesic radii 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         for each of the identified interest points are evaluated. If the query is a scanned surface mesh, 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         is limited by both the technical specifications of the scanner (e.g., the scanning dimensions and the focal depth) and the perceptional visibility from the view point of the shooting position. Only the interest point with largest 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         is treated as the query interest point, denoted as 
                           
                              
                                 V
                              
                              
                                 j
                              
                           
                        , for query 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                        . Next, the local shape descriptor of the query interest point, i.e., 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 j
                              
                           
                        , is computed and matched with models in the database.

Using a single query with a large area portion of 
                           
                              
                                 M
                              
                              
                                 q
                              
                           
                         is enough to find 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        . However, it might be impossible since part of the information of the query object might be missing. Furthermore, sometimes the user is only interested in a few small areas of the object. They could want to find the models that have a few common subparts with the query object but of different general shape. At these situations, multiple queries—query set 
                           
                              Q
                           
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              …
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    s
                                 
                              
                              }
                           
                        , with each query 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                           ⊂
                           
                              
                                 M
                              
                              
                                 q
                              
                           
                         focusing on a distinct interest point—can be applied to find 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        . Multi-query matching is usually performed uncoordinated—each query’s local descriptor is matched against the database, independent of the rest of the queries. Most of today’s scanning apparatuses belong to this category. However, with some more advanced scanning technologies, mutual coordination between scannings can be established in the entirety of the scanning process. Therefore, the Euclidean distances between the interest points of different queries can be reported by the scanner. In this situation, an attribute relational graph (ARG) can be built based on the input query set 
                           
                              Q
                           
                        , and matched with the graphs in the database. We define the former multi-query matching to be uncoordinated matching, and the latter one coordinated matching. Coordinated matching is applicable for searching exactly the same model of the query, while uncoordinated matching is more applicable to the type of partial matching that only a few sub-parts of the model are similar to the query but the whole shape may be different, and the spatial relations between the sub-parts are neither required to be the same with the query.

An example of scanning input is given in Fig. 13
                        . A light bulb object is damaged at the base as illustrated in Fig. 13(a). The boundaries of the broken area are circled. However, the shape of the side and the top area is completely preserved as shown in Fig. 13(b) and (c). To search for the corresponding intact model (d) from the database, a user inputs the scanned range data 
                           A
                         ((e)) and 
                           B
                         ((f)). Interest points 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 B
                              
                           
                         from scannings 
                           A
                         and 
                           B
                         are then extracted respectively. With the registration information recorded by the scanner, scannings 
                           A
                         and 
                           B
                         can be registered in a same shape as depicted in Fig. 13(g). The Euclidean distance between 
                           
                              
                                 V
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 B
                              
                           
                         is obtained, and an edge 
                           
                              
                                 E
                              
                              
                                 A
                                 B
                              
                           
                         in ARG is built. If there are three or more scannings, the coordinated matching can be applied.

To find a matching model in the database for a single query 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                         with descriptor 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 j
                              
                           
                        , a measure of the difference between 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 j
                              
                           
                         and a model 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         is required. Let 
                           
                              {
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    n
                                 
                              
                              }
                           
                         be the LSP’s of 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        . This difference, denoted as 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    M
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , is then defined to be the minimum: 
                           
                              (8)
                              
                                 
                                    
                                       
                                          D
                                       
                                    
                                    
                                       
                                          M
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    min
                                 
                                 
                                    {
                                    
                                       D
                                    
                                    
                                       (
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       D
                                    
                                    
                                       (
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       D
                                    
                                    
                                       (
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                LSP
                                             
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

The similarity between 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 j
                              
                           
                         and any model 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         can be calculated using the following function: 
                           
                              (9)
                              
                                 
                                    sim
                                 
                                 
                                    (
                                    
                                       
                                          
                                             LSP
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               LSP
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                   π
                                                
                                             
                                             ,
                                          
                                          
                                             0
                                             ≤
                                             
                                                
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      M
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         LSP
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             ≤
                                             2
                                             π
                                             ;
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      M
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         LSP
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             >
                                             2
                                             π
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The 
                           
                              sim
                           
                           
                              (
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         for every model in the database is computed, and then the model with the maximum similarity value is returned as the target model of the part-in-whole matching.

Specifically, let 
                           
                              {
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       LSP
                                    
                                 
                                 
                                    s
                                 
                              
                              }
                           
                         be the LSP’s of the query set 
                           
                              Q
                           
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    s
                                 
                              
                              }
                           
                           ⊂
                           
                              
                                 M
                              
                              
                                 q
                              
                           
                        , each focusing on a different local region. Let 
                           S
                         denote the set of matching candidates; initially, it contains all the models in the database. Using 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 1
                              
                           
                         as the query LSP to 
                           S
                        , we remove those models in 
                           S
                         whose similarity with 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 1
                              
                           
                         is lower than a given threshold 
                           
                              
                                 θ
                              
                              
                                 s
                              
                           
                        . This filtering process is then continued with 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 2
                              
                           
                         as the query LSP, and so on; until either a single-element is left in 
                           S
                         or the last query LSP, i.e., 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 s
                              
                           
                        , has been used. The order of the query LSP’s depends on the user’s input sequence. Intuitively, using more distinct features for the input query in the beginning will definitely speed up the search process.

If the query set 
                           
                              Q
                           
                         has more than two elements and the mutual coordination between their interest points is available, the coordinated matching can then be performed. One challenge to our coordinated matching task is that one sub-part in interest of the query object may find more than one similar sub-part on the comparing models in the database. A model with several groups of similar local shapes is shown in Fig. 14
                        . The local shapes around the circular points are all similar to each other within small area, and the same situation exists for the triangular points and the square points. This makes our matching essentially a scale-invariant and many-to-many complete ARG graph matching problem. Another difficulty is that the matching scale is hard to obtain.

Sub-graph matching problem is NP hard  [49,50]. Our solution is principally inspired by the work of Bai  [51], who proposed the algorithm of optimal subsequence bijection (OSB) to match skeleton graphs. Our method is developed based on the critical assumption that if two models of different scales match each other, their graph matching scale should be the same as their local shape descriptor matching scale. To match a query ARG 
                           G
                         with an ARG 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         in the database, we first find the potential sub-graphs of 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        , whose nodes are bijective to 
                           G
                        ; each of these sub-graphs is then deformed to match 
                           G
                        . Our goal is to find the optimal sub-graph whose deformation is the least. Let 
                           K
                           +
                           1
                         and 
                           N
                           +
                           1
                         be the numbers of the nodes in 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         respectively 
                           
                              (
                              2
                              ≤
                              K
                              ≤
                              N
                              )
                           
                        , and 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 j
                              
                              
                                 ′
                              
                           
                         be some nodes of 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        , respectively. The graph-based local shape descriptor matching can be illustrated by a bipartite graph, as shown in Fig. 15
                        . If the LSP similarity between 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 j
                              
                              
                                 ′
                              
                           
                         is above a given threshold 
                           
                              
                                 θ
                              
                              
                                 s
                              
                           
                         (e.g., 0.9), the two nodes are connected in the graph, and the edge is weighted by their similarity. Note that each node of 
                           G
                         can be connected to more than one node of 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        . Several possible bijective matches (PBM) can be enumerated from these match pairs. For example, for the bipartite graph in Fig. 15, one instance of bijection is 
                           
                              {
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       0
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       K
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              }
                           
                        , and another is 
                           
                              {
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       N
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       K
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              }
                           
                        . We need to find the optimal one from these instances, such that not only the LSP’s but also the edges between the nodes of 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         can be best matched to that of 
                           G
                        . Despite each connected pair of nodes having a particular matching scale, we need to find only one suitable scale for each instance. Before the optimal scale is determined, the edge distances between 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         in the instance will remain undetermined.

We enumerate all the PBM’s in this bipartite graph by a brute-force method. Let all these PBM’s be represented as 
                           
                              PBM
                           
                           
                              (
                              0
                              )
                           
                           ,
                           
                              PBM
                           
                           
                              (
                              1
                              )
                           
                           ,
                           
                              PBM
                           
                           
                              (
                              2
                              )
                           
                           ,
                           …
                        . Afterwards, we calculate the matching scale for each 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                         as the average matching scale of its LSP pairs, denoted as 
                           
                              Sca
                           
                           
                              (
                              
                                 PBM
                              
                              
                                 (
                                 i
                                 )
                              
                              )
                           
                        . Specifically, let the 
                           l
                        th local descriptor pair in instance 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                         be represented as 
                           
                              lpsca
                           
                           
                              (
                              i
                              ,
                              l
                              )
                           
                           =
                           
                              (
                              
                                 
                                    
                                       V
                                    
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    
                                       U
                                    
                                 
                                 
                                    l
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 
                                    U
                                 
                              
                              
                                 l
                              
                           
                         is the node of 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         matching node 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 l
                              
                           
                         of 
                           G
                         in 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                        . Then 
                           
                              Sca
                           
                           
                              (
                              
                                 PBM
                              
                              
                                 (
                                 i
                                 )
                              
                              )
                           
                         can be calculated as 
                           
                              (10)
                              
                                 
                                    Sca
                                 
                                 
                                    (
                                    
                                       PBM
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       K
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       k
                                    
                                 
                                 
                                    Sca
                                 
                                 
                                    (
                                    
                                       lpsca
                                    
                                    
                                       (
                                       i
                                       ,
                                       l
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where the optimal matching scale between the two nodes 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 l
                              
                           
                         and 
                           
                              
                                 
                                    U
                                 
                              
                              
                                 l
                              
                           
                         is denoted by 
                           
                              Sca
                           
                           
                              (
                              
                                 lpsca
                              
                              
                                 (
                                 i
                                 ,
                                 l
                                 )
                              
                              )
                           
                        .

The edge dissimilarity, 
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                        , of 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         for 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                         is defined by 
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                           
                              (
                              
                                 PBM
                              
                              
                                 (
                                 i
                                 )
                              
                              )
                           
                        , and can be calculated as 
                           
                              (11)
                              
                                 
                                    
                                       D
                                    
                                    
                                       e
                                    
                                 
                                 
                                    (
                                    
                                       PBM
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       K
                                       
                                          (
                                          K
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                       ,
                                       m
                                       =
                                       0
                                       ,
                                       j
                                       ≠
                                       m
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       
                                          |
                                          d
                                          
                                             (
                                             
                                                
                                                   
                                                      V
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      V
                                                   
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             Sca
                                          
                                          
                                             (
                                             
                                                PBM
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          ⋅
                                          d
                                          
                                             (
                                             
                                                
                                                   
                                                      U
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      U
                                                   
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          |
                                       
                                    
                                    
                                       d
                                       
                                          (
                                          
                                             
                                                
                                                   V
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   V
                                                
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          Sca
                                       
                                       
                                          (
                                          
                                             PBM
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          )
                                       
                                       ⋅
                                       d
                                       
                                          (
                                          
                                             
                                                
                                                   U
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   U
                                                
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           d
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         stands for the Euclidean distance between nodes 
                           x
                         and 
                           y
                         in a same ARG. Obviously, 
                           0
                           ≤
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                           
                              (
                              
                                 PBM
                              
                              
                                 (
                                 i
                                 )
                              
                              )
                           
                           ≤
                           1
                        . In the perfect case that all the nodes and edges of 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         are perfectly matched with each other at the bijection instance 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                        , the dissimilarity would be zero, i.e., 
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                           
                              (
                              
                                 PBM
                              
                              
                                 (
                                 i
                                 )
                              
                              )
                           
                           =
                           0
                        .

Finally, the similarity between two graphs 
                           G
                         and 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                         at the bijection instance 
                           
                              PBM
                           
                           
                              (
                              i
                              )
                           
                         is defined by combining both the node similarity and the edge similarity: 
                           
                              (12)
                              
                                 
                                    sim
                                 
                                 
                                    (
                                    G
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       PBM
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                       −
                                       λ
                                    
                                    
                                       
                                          (
                                          K
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       k
                                    
                                 
                                 
                                    sim
                                 
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          U
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 +
                                 λ
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          e
                                       
                                    
                                    
                                       (
                                       
                                          PBM
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           λ
                           
                           
                              (
                              0
                              ≤
                              λ
                              ≤
                              1
                              )
                           
                         can be a user defined weight to balance the edge similarity to the total similarity. When the query object is matched with the models in the database by graph matching, the ARG of the query object 
                           G
                         is matched with the ARG’s of all the models. The model in the database with the largest similarity with 
                           G
                         is recognized as the target model. Optimization methods such as Genetic Algorithm can be applied to further improve the graph matching efficiency.

@&#EXPERIMENTAL RESULTS@&#

This section discusses our experimental results and performance of applying LSP on interest points for part-in-whole matching. Three large databases, the Purdue Engineering Shape Benchmark (ESB)  [52], the National Design Repository (NDR)  [53], and the 3D interest point Benchmark (IPB)  [36] are used in our experiments as the benchmark databases. The ESB has a total of 866 CAD models classified into 42 categories of similar parts. NDR includes 554 classified CAD models. The IPB collected data via web-based interface from 16 to 23 subjects for 47 models, and constructed the ground truth interest points, which were hand-marked by human subjects, for each model. The experiments were carried out on an Intel Core (TM) i5-2410M, 2.30 GHz, and the program is implemented in VC++.

Most of the models in the ESB have between 500 and 4000 vertices. For each model, only a small number of vertices are identified by our method as interest points. We extracted a total of 42284 interest points for all the 866 models in the ESB dataset. 80% of them have less than 70 interest points. As a specific example, Fig. 16
                         shows four complex models each with more than 50 extracted interest points.

If a model has fillets, the location of the identified interest points will be different from the ones with sharp edges. Fig. 17
                         depicts the extracted interest points (red) of the models in Fig. 6. By marking with “
                           ∗
                        ”, we highlight two groups of the corresponding interest points for cube and cylinder models respectively. The position change of the “
                           ∗
                        ” point on the model surface illustrates the difference between the interest points of the depicted models. Interest points are distributed on the sharp edges on cube (a) and cylinder (e), while on the models (b)–(d) and (f)–(h) they are distributed on the boundary edges of the transition borders. When the fillet areas are small, such as the models in (b) and (f), the shape is very similar to the one without fillets and their interest points are close to each other. If the fillet areas are large, such as (d) and (h), the model is actually deformed into a different shape, thus the extracted interest points will have larger distance to that of the one without fillets, and the number of identified key points will also be affected.

To compare with the existing methods, we have evaluated the performance of our interest point extraction method regarding to human generated ground truth, in Fig. 18
                        . In this experiment, the 3D interest point Benchmark  [36] is utilized. The ground truth points, as displayed in the first column, are obtained with 
                           σ
                           =
                           0.03
                         and 
                           n
                           =
                           3
                        . 
                           σ
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                         is set to be the interest region where 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                         stands for the model diameter. Interest points whose geodesic distances to each other are less than 
                           σ
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                         are grouped together. If the number of points in the group is less than 
                           n
                        , the group is discarded. In other words, for each displayed interest point, there are more than 3 subjects having hand marked an interest point within the local region. The local region is a geodesic disk with radius equal to 
                           0.03
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                        , where 
                           
                              
                                 d
                              
                              
                                 M
                              
                           
                         stands for the largest Euclidean distance between all the pairs of vertices of the model 
                           M
                        . Interest points extracted by the proposed method are shown in the seventh (last) column, and the interest points detected by the mesh saliency method  [37], the salient points method  [18], the 3D-Harris method  [38], the SD-corners method  [20] and the HKS method  [40] are shown in the 2nd–6th columns respectively. Fig. 18 clearly shows that our proposed method can extract interest points that are more close to human generated ground truth for the shown models. For shapes that contain only smooth edges, such as the cup model in Fig. 18, the proposed method tends to extract less interest points than the ground truth.

We further evaluate the false negative error (FNE) and false
                        positive error (FPE) of the proposed method against the existing methods, in Fig. 19
                        . FNE and FPE are both defined by  [36] to evaluate the correspondence of the detected interest points with the human generated ground truth. Similar to the previous experiment, the ground truth points displayed in the first column are obtained with 
                           σ
                           =
                           0.03
                         and 
                           n
                           =
                           3
                        . In addition to the mentioned methods in Fig. 18, 3D-SIFT (2011)  [39] is also compared in Fig. 19. A rapid drop with respect to the localization error tolerance 
                           r
                         in FNE means that the algorithm catches the interest points with a low localization error, while a rapid drop with respect to 
                           r
                         in FPE indicates that the algorithm does not return excessive interest points. The FNE curve of the proposed method is only higher than the Mesh saliency and the 3D-corners method. The FNE error of our approach is mainly because we extract fewer points on smooth edges. The FPE curve of the proposed method is lower than most other methods, except HKS which extracts much fewer points than the ground truth. Evidenced from the FPE curve, the interest points extracted by our method are more corresponding to the ground truth. It means that, using our method, it is less demanding for the user to find an effective query area for the part-in-whole matching.

In the next experiment, by using the benchmark  [34], we will test the repeatability rate of the extracted interest points regarding to three classes of transformations: down sampling (less than 20% of the original points), topology (welding of shape vertices resulting in different triangulations) and additive Gaussian noise. Only three methods in  [36] are compared by  [34], thus the results of the other methods are not presented here. In each class, we apply five different levels (1–5) of strength for the transformation: the higher the number, the stronger the transformation. Repeatability rate is defined in  [34] as the percentage of the detected points that are common in two different instances of an object. Two detected points on the two instances are considered to be common if one falls within a small neighborhood of the other. The repeatability rate of the proposed method is compared with the Salient points  [18], the 3D-Harris  [38] and the HKS  [40] based method in Table 3
                        . From the table, we can observe that our interest point extraction method exhibits a much higher repeatability rate than both the Salient points and the 3D-Harris method in all the three categories. Although the HKS based method demonstrates a higher repeatability, for each model it only extracts an average number of 9 interest points which are not enough in general.

The following part discusses the robustness of LSP on point location change, geometric noise and transition features. The example in Fig. 20
                         illustrates the stability of LSP in respect to variation of interest point computation. The model in (a)–(c) is a same noise free unit cube mesh with 386 vertices and 768 triangles. The noisy cube in (d) is the same noisy cube as shown in column 5, Table 2. We pick five points A–E on the two models and then depict their LSP curves in (e). Point A is one of the interest points extracted by our algorithm; while points B and C are obtained by manually changing the position of A—B is on a sharp edge while C is on a planar face. D and E are two of the interest points extracted by our algorithm on the noisy model. Point D is at its ideal position but point E is not. In order to visualize the spatial behavior of the LSP, we illustrate the differences between the LSP of point A and that of all other points on the surface as a color-code. In (a), where blue indicates no difference and red indicates a large difference. The LSP’s are compared at their maximum scale with 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                        , where 
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                         is the maximum geodesic radius of the Cube model. We also use different colors to indicate the corresponding segmented faces for (b)–(d). Generally, the false interest points were caused by segmentation errors, such as B, C and E. In (e), the sub-polynomial curves of the LSP’s are fitted between the event radii which are computed based on the segmentation result. From Fig. 20, we can observe that 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 D
                              
                           
                         is close to 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                        , while the other three LSP curves are higher than 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         when 
                           ρ
                           <
                           0.8
                        . With the increase of the geodesic radius, the LSP curves become close to each other. This example illustrates that LSP itself is robust to noise, but small variation of source point can cause the LSP to change its first polynomial, especially when 
                           ρ
                         is near 0. Points with similar local shape can be matched by comparing their LSP curves. The difference of the LSP curves for close points are small if they are compared at a large radius.

The robustness of LSP on real scanning models is shown in Fig. 21
                        . (a) and (d) are respectively a noise-free CAD fandisk and its counterpart scanned model, while (b) and (e) are their corresponding segmentation results by our algorithm. Identified faces are shown in different colors. Point A of (c) is an extracted interest point on the noise free model, and point B of (f) is the counterpart interest point on the scanned model. To compute the LSP descriptor for A and B, 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 A
                              
                           
                         is set to be the maximum value of the geodesic field of point A. Because the bottom face of the scanned model is missing, 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 B
                              
                           
                         is set to be the maximum radius when the closed iso-curve is about to break. The iso-curve of B at radius 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 B
                              
                           
                         is displayed as the red curve in (f). The LSP’s of A and B are matched at their optimal matching scale (
                           
                              
                                 
                                    er
                                 
                              
                              
                                 A
                              
                           
                           =
                           350
                        ) and compared in Fig. 21(g). Based on the optimal matching scale, for point A, we can compute the matched geodesic radius 
                           
                              
                                 ρ
                              
                              
                                 A
                              
                           
                         of 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                                 _
                                 B
                              
                           
                        , and the iso-curve of point A with geodesic radius 
                           
                              
                                 ρ
                              
                              
                                 A
                              
                           
                         is shown as the red curve in (c). Because of the scanning noise, the position and the geodesic field of the interest point are changed. When 
                           ρ
                         is close to 0, the iso-curves are more sensitive to noise. However, the general evolution patterns of the LSP curves of points A and B are very similar to each other, with the similarity between 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 
                                    LSP
                                 
                              
                              
                                 B
                              
                           
                         calculated to be 0.992.

In Fig. 22
                        , the influence of different fillets to the robustness of LSP on detected interest point is analyzed. The LSP curves of the interest points marked by red “
                           ∗
                        ” are illustrated. In Fig. 22(a), we compare the difference of LSP on cube models with different fillets, and in Fig. 22(b) we compare the cylinder models. As shown in Fig. 22, the starting point of LSP highly depends on the fillet radius. For the models with fillets, LSP curve starts near 6.0. In contrast, the LSP curve of the interest point on the cube without fillet starts from 4.3. By comparing (a) and (b), we can see that the LSP’s for the two models with the same fillet radius start at the same value. This difference demonstrates that the LSP descriptor is sensitive to local shape features. However, with the geodesic radius increasing, the LSP curves of the cube models with small fillets (
                           r
                           =
                           0.05
                         and 
                           r
                           =
                           0.1
                        ) and without fillets become closer with each other, and so are the cylinder models. When the fillet radius gets larger, e.g., 
                           r
                           =
                           0.25
                         for the unit cube in Fig. 22, the locations of the detected interest points will be significantly altered, as the entire shape now becomes very different from the model without fillets, and the difference between the LSP curves of the model with and without fillet becomes larger.

In Table 4
                        , by using the benchmark  [34], we compare the robustness of our LSP on interest points with the dense HKS using FEM discretization (DHK2) regarding to three classes of transformations: down sampling, topology and additive Gaussian noise. Similar to Table 3, we also apply five different levels of strength for each class of transformation. In Table 4, the robustness is given according to the distance between the descriptors that are extracted from the two instant scenes. A smaller distance indicates a stronger robustness. In the benchmark  [34], DHK2 shows the highest robustness among all the tested methods. Therefore, we only compare our method with DHK2 in this experiment. The distance of DHK2 is measured using the 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         measure. However, we defined our own distance function in formula (2). In this comparison, DHK2 is set as the benchmark presented. Our approach is tested with 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           5
                           %
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                           ,
                           20
                           %
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                           ,
                           50
                           %
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                        , where 
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                         is the maximum geodesic radius of the model 
                           M
                        . By comparing the distance value for LSP with different geodesic radii in Table 4, it can be seen that LSP on interest points is more robust when the radius gets larger. From Table 4, we can also observe that, under lower strengths of the three classes of transformation, the distance of the proposed descriptor keeps low which indicates higher robustness than DHK2. However, under the higher strengths of the three classes of transformation, LSP on interest points is less robust than DHK2, since a strong transformation may affect the direction of the least squares fitting plane of the iso-contour and thus cause the LSP to change.

Several partial search results of the scanned model using ESB as the database are given in Table 5
                        . Note that we added the noise free fandisk model into the database in addition to ESB. The column under “Query” depicts the query models, with the red point indicating the identified interest point and the red curve indicating the geodesic premier of the query region, i.e., only the portion on that model within the red curve will be the input query. The column under “1st result” indicates the matched model in the database with the highest similarity, “2nd result” for the one with the 2nd largest similarity, and so forth. The matched local regions are also circled by red curves on the matched models, with the similarity values to the query given in the parentheses. In Table 5, 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 3
                              
                           
                         represent the same scanned mesh with the same interest point, but with different 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         of 9, 32 and 53, respectively. The search results of 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 3
                              
                           
                         are more relevant than that of 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                        . This indicates that, as expected, the LSP is more robust to noise when the input query sub-surface is larger. Meanwhile, as an input query sub-surface with a larger radius captures more information of the query object near the interest point, the similarity of the irrelevant models is notably decreased in the search results of 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 3
                              
                           
                        .

In Table 6
                        , we compare the partial matching results of two scanned models with the retrieval results on the full scanned models of the multi-decomposition method  [10]. The scanned models are downloaded from http://edge.cs.drexel.edu/repository/Scanned.tar.bz. Same as the method  [10], the search is carried out in the NDR dataset. Since our project only handles connected mesh regions, we performed a preprocessing to stitch the isolated patches together. After the preprocessing, there are still some small holes on the model surface. The boundary edges and the holes are indicated by solid black lines in Table 6. Also, we trimmed the full scanned models and only input the interest portion to test the search performance. Similar to Table 5, the interest point and the iso-curve at 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                         of the query are indicated in red. By comparing with the top three search results, we can see that the LSP based part-in-whole matching is feasible on scanned model query and our retrieval results are more relevant to the query than the method of  [10].

Several single query examples using both ESB and NRD as the database are also given, in Table 7
                        . Only the surface area on that model within the red curve will be the input query. Note that, since the similarity between an LSP on a model and itself is 1, it is not shown in the table. From Table 7, we can observe that, given an interest partial region, the LSP based method is feasible for finding the models that are partially similar to the query model but have different global shapes. In Table 8
                         the search results of the Decomposition based method  [12] and the Thesaurus based method  [14] are compared with our proposed 3D partial matching algorithm in terms of retrieval outcome. To be same with  [12,14], query 1 is carried out on the ESB database and query 2 on the NRD database. The first three similar models for each query model are used to show the comparison results. The query region of our LSP method is indicated by a red circle, and the query region of the method  [12] is highlighted in yellow. The Thesaurus based method searches for the models that include the whole query as its subpart. From Table 8, it is obvious that the retrieval outcome of the LSP method is more relevant to the query model as compared to the other two methods. Moreover, the proposed method requires a smaller input region.

When the radius is small, LSP is more sensitive to noise. However, sometimes it is impossible to obtain a large enough connected region to get a satisfactory matching result. For example, a scanned model may contain small isolated patches with big gap between each other. Multiple queries are helpful in this situation. Un-coordinated matching is applicable to finding the models that share similar sub-parts but are of different global shapes, while coordinated matching is applicable to finding the exact intact model. The search result of the third scanned model of the NDR dataset is shown in Table 9
                        , along with the running time. Instead of performing a preprocessing to fill the holes, we trimmed the model into several connected interest patches as the queries and performed both un-coordinated and coordinated matching. The first two retrieval results are shown. The matched interest points on the resultant models are indicated by circles. Table 9 shows that the search results of the un-coordinated matching have similar subparts with the three queries, and the corresponding intact model is found as the 1st retrieval result when the coordinated matching is applied.

To test our part-in-whole matching algorithm, we classify the ESB database into 84 classes (gears, blocks, shells etc.), where each class has more than one shape that share similar subparts. Since each class focuses on only one subpart, several classes may share some common shapes. We create our own classification mainly because we want to emphasize the robustness of our method for incomplete matching and the existing shape databases do not necessarily cater to this need. Based on our classification and testing results, the Precision–Recall diagram is given in Fig. 23
                        . (The letters “U” and “C” indicate the uncoordinated and the coordinated matching respectively, as also in Table 10
                        .) The performance of our approach is compared with the intrinsic wave descriptor (IWD)  [31] on our extracted interest points. In order to make  [31] comparable to us, we set 
                           
                              
                                 ρ
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           5
                           %
                           
                              
                                 ρ
                              
                              
                                 M
                              
                           
                         for both of them. For noisy queries, we add zero mean Gaussian noise with 
                           σ
                           =
                           2
                           %
                         to all the vertices of each input partial patch. From Fig. 23 we can observe that our approach outperforms IWD  [31] regarding to part-in-whole matching. Although the step of projecting the iso-contour to its least squares fitting plane makes LSP less robust to some extent, it increases the discrimination of the descriptor to local surface deformation. Seen in the figure as well, using coordinated matching can greatly increase the matching accuracy.

In Table 10, we evaluate our approach using the Mean Query Rank (MQR)  [54] in ESB. Given a query, the query rank is the position of the corresponding intact object in the ranked search result list. Given several queries, the mean query rank is the average of query ranks for each query. For instance, for an MQR of 30, on average, one needs to retrieve 30 shapes from the ranked search result list to find the shape that corresponds to the query. For noisy queries, we add zero mean Gaussian noise with 
                           σ
                           =
                           2
                           %
                         to all the vertices of each input partial patch. From the results several observations can be made: (i) LSP gives lower MQR than IWD for the single query matching; (ii) increasing the portion of the query can dramatically lower the MQR; (iii) given the same portion of fractions, with the number of queries increasing, the MQR is reduced rapidly, which indicates that the corresponding intact model is at a higher rank in the resultant matched list. With coordinated matching, the MQR is even lower. We also give the running time consumed by the searching in the third column of Table 10. Although the sub-graph matching algorithm we implemented for coordinated multiple matching is exhaustive in nature, the time consumption increased only by 9.8 s than the un-coordinated matching, while the MQR is decreased from 14.24 to 10.27. This is because the sub-graph matching is only carried out on the models in the list of the uncoordinated matching results, which is generally less than 50, and the number of nodes in each graph is also usually less than 100. We can also observe that increasing the portion of a query is usually more efficient than adding another query of small portion. But this is not always feasible in practice since the query object is incomplete. If one wants to find the exact matching model and the result list of the uncoordinated matching is too long, the coordinated matching saves the need for the user to input another query.

We have proposed a local shape descriptor for 3D models, which is particularly suitable for part-in-whole matching since it allows the query to be an incomplete model. The user input can be one or more 3D scanned meshes on the salient regions of a real object or the surface patches obtained by CAD software. Our experiments have shown certain promising results in applications of part-in-whole matching.

Specific contributions can be summarized as follows. First, we have presented a complete interest point extraction algorithm, which significantly improves the correspondence of the extracted interest points to human judgment. Secondly, a novel local shape descriptor, the Local Shape Polynomial (LSP), is proposed to represent the surrounding shape features of the extracted salient points. This local shape descriptor is particularly suitable for the part-in-whole search task, as it is a function of the size of the query sub-surface, i.e., it is sensitive to the geodesic radius of the query region. It also has other good properties desired for a general shape descriptor, such as invariance under rigid body transformations and being able to be evaluated at a relatively large scale. Finally, based on the introduced LSP measure and utilizing graph matching techniques, we have given a scale-invariant matching algorithm that has shown promising results in our experiments of part-in-whole matching.

A major limitation of LSP is that the input query must be a connected region. A big hole in the mesh can introduce critical errors during the process of geodesic field computation. If the query is a scanned point cloud, more than one view scanning and some preprocessing may be needed. Comparing to other descriptors, LSP curve is sensitive to scale. This property can be an advantage; but on the other side, computing the optimal matching scale of two LSP’s are not straightforward, which is more computational complex.

There are several important issues for further research. First of all, other properties such as the integral volume invariant can be utilized to extract the LSP in additional to the geodesic iso-contour length. Secondly, a more efficient graph matching algorithm is required to speed up the run-time matching process. It will be also interesting to see if modification can be made to the local shape polynomial so that it itself becomes dimension-insensitive, rather than depending on the scale optimization during run-time.

@&#REFERENCES@&#

