@&#MAIN-TITLE@&#Subject-based feature extraction by using fisher WPD-CSP in brain–computer interfaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A subject-based feature extraction method is discussed.


                        
                        
                           
                           The feature extraction method combines wavelet packet decomposition, common spatial patterns and fisher distance.


                        
                        
                           
                           The selection of sub-bands based on fisher distance tells apart those useless sub-bands and remain best sub-bands for each subject.


                        
                        
                           
                           The proposed method can extract suitable features for specific subject and achieve a higher classification accuracy than non-subject-based method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Wavelet packet decomposition (WPD)

Common spatial patterns (CSP)

Fisher distance

Brain–computer interface (BCI)

Electroencephalogram (EEG)

Feature extraction

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Feature extraction of electroencephalogram (EEG) plays a vital role in brain–computer interfaces (BCIs). In recent years, common spatial pattern (CSP) has been proven to be an effective feature extraction method. However, the traditional CSP has disadvantages of requiring a lot of input channels and the lack of frequency information. In order to remedy the defects of CSP, wavelet packet decomposition (WPD) and CSP are combined to extract effective features. But WPD-CSP method considers less about extracting specific features that are fitted for the specific subject. So a subject-based feature extraction method using fisher WPD-CSP is proposed in this paper.
               
               
                  Methods
                  The idea of proposed method is to adapt fisher WPD-CSP to each subject separately. It mainly includes the following six steps: (1) original EEG signals from all channels are decomposed into a series of sub-bands using WPD; (2) average power values of obtained sub-bands are computed; (3) the specified sub-bands with larger values of fisher distance according to average power are selected for that particular subject; (4) each selected sub-band is reconstructed to be regarded as a new EEG channel; (5) all new EEG channels are used as input of the CSP and a six-dimensional feature vector is obtained by the CSP. The subject-based feature extraction model is so formed; (6) the probabilistic neural network (PNN) is used as the classifier and the classification accuracy is obtained.
               
               
                  Results
                  Data from six subjects are processed by the subject-based fisher WPD-CSP, the non-subject-based fisher WPD-CSP and WPD-CSP, respectively. Compared with non-subject-based fisher WPD-CSP and WPD-CSP, the results show that the proposed method yields better performance (sensitivity: 88.7±0.9%, and specificity: 91±1%) and the classification accuracy from subject-based fisher WPD-CSP is increased by 6–12% and 14%, respectively.
               
               
                  Conclusions
                  The proposed subject-based fisher WPD-CSP method can not only remedy disadvantages of CSP by WPD but also discriminate helpless sub-bands for each subject and make remaining fewer sub-bands keep better separability by fisher distance, which leads to a higher classification accuracy than WPD-CSP method.
               
            

@&#INTRODUCTION@&#

A brain–computer interfaces (BCIs) is usually defined as a direct communication pathway between the brain and a computer or a device [1]. And electroencephalogram (EEG) is the most commonly used brain signals for BCIs. Over the last 20 years, with the advances of signal processing, pattern recognition, and machine learning techniques, the BCI research has made great progress [2,3]. Through BCIs, people can directly control an external device just by using EEG signals generated from motor imagery, visual evoked potentials, or people's mental states. Motor imagery, a kind of spontaneous EEG, is now widely used in EEG-based BCIs because it is more natural than using an evoked EEG. However motor imagery EEG signals are different from person to person. The extensive subject training pose major challenges for the successful operation of a BCI. Research into feature extraction and pattern classification of motor imagery EEG are very important for BCI. To be able to classify motor imagery EEG signals with great accuracy, correct and significant features must be extracted from the EEG signals for classifier training [4–6]. The results of feature extraction directly influence the design and performance of pattern classification. So this paper focuses on the feature extraction.

In recent years, common spatial pattern (CSP) has been proven to be an effective feature extraction method by many researchers and is widely used in BCIs [7–10]. However, the traditional CSP have disadvantages of requiring a lot of input channels and the lack of frequency information. Then there is much literature reporting on the use of different frequency bands to optimize the traditional CSP with frequency domain information [11–15]. In 2009, wavelet packet decomposition (WPD) and CSP are firstly applied to low-pass (0–64Hz) and bandpass (8–30Hz) filtered data to extract discriminative features [16]. In 2012, WPD and CSP are combined to extract effective features [15]. And, in 2014, WPD-CSP and Kernel Fisher Support Vector Machine (KF-SVM) is developed and used for EEG recognition in motor imagery BCIs [17], etc. All of above papers proved that WPD is an effective fast algorithm of time-frequency domain and can remedy the defects of CSP. However all these methods consider less about to extract specific features that are fitted for the specific subject. We all know that no two people are the same and so EEG signals vary between subjects. For instance, it is well known that there exists considerable variability in alpha or beta frequency between subjects [18–20]. We cannot expect all subjects have the same kind of features and these features depend on the same frequency bands for all of them. Hence, in this paper, a subject-based fisher WPD-CSP feature extraction method is presented to obtain suitable features for each subject.

The proposed fisher WPD-CSP method decomposes original EEG signals into a series of sub-bands using WPD. Then fisher distance value of each sub-band is computed. Some sub-bands with larger values of fisher distance are selected and regarded as new EEG channels. Those selected sub-bands vary from subjects and they are reconstructed for further feature extraction of the CSP. Then the subject-based feature extraction model is so formed and used as the input of classifier. In this paper, several classification methods have been tested and the probabilistic neural network (PNN) is used as the classifier. Finally the experimental data from six subjects are analyzed and processed by two-fold cross-validation. In the end, the classification accuracy is obtained from the PNN.

The remainder of the paper is organized into four sections. Section 2 discusses the frequency band selection based on the fisher WPD-CSP and its procedure. Section 3 contains details on the datasets and acquisition procedure. Results are presented and discussed in Section 4. In the end, Section 5 presents our conclusion.

@&#METHODS@&#

The WPD is a wavelet transform where the sampled signal is passed through more filters than the discrete wavelet transform (DWT). One step in the wavelet transform is to calculate a low pass filter result and a high pass filter result. Each filter result can be regarded as a subspace. The low pass result recursively becomes the input to the next wavelet step, which calculates another low and high pass result. The DWT only applies the wavelet transform step to the low pass result. The WPD applies the transform step not only to the low pass but also to the high pass result. The WPD can be viewed as a full binary tree. The root of the tree is the original data. The next level of the tree is the result of one step of the wavelet transform. As an example, a three-level sub-band tree is shown in Fig. 1
                        , where S(0, 0) denotes the original data space, S(j, n) denotes the decomposed subspace, j is the decomposition level, and n is the index of the subspace occurring at the jth level. The coefficient of WPD at the jth level and the kth sample can be formulated as follows [15–17]:
                           
                              (1)
                              
                                 
                                    
                                       d
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          2
                                          n
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       ∑
                                       n
                                    
                                    
                                       
                                          h
                                          0
                                       
                                       (
                                       m
                                       −
                                       2
                                       k
                                       )
                                       
                                          d
                                          j
                                          n
                                       
                                       (
                                       m
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       d
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          2
                                          n
                                          +
                                          1
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       ∑
                                       n
                                    
                                    
                                       
                                          h
                                          1
                                       
                                       (
                                       m
                                       −
                                       2
                                       k
                                       )
                                       
                                          d
                                          j
                                          n
                                       
                                       (
                                       m
                                       )
                                    
                                 
                              
                           
                        where k is the number of sampling points. h
                        0(k) and h
                        1(k) are a pair of quadrature mirror filters that are irrelevant to levels but have the following formula (3) relation with each other. The decomposition coefficients at the jth level can be easily calculated by those at (j
                        −1)th level by recursion.
                           
                              (3)
                              
                                 
                                    
                                       h
                                       1
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          1
                                          −
                                          k
                                       
                                    
                                    
                                       h
                                       0
                                    
                                    (
                                    1
                                    −
                                    k
                                    )
                                 
                              
                           
                        
                     

The corresponding frequency range of the subspace S(j, n) is [nf
                        
                           s
                        /2
                           j+1, (n
                        +1)f
                        
                           s
                        /2
                           j+1], where f
                        
                           s
                         is the sampling frequency. From the energy point of view, the signal energy is decomposed into the time-frequency plane by WPD. And the signal energy can be reflected by the module value of WPD coefficients. Due to the good characteristic in the time-frequency domain, WPD is suitable for the non-stationary EEG signal that has remarkable frequency characteristic and strong randomness.

By wavelet CSP (WCSP), signals were decomposed into nine levels by wavelet decomposition and each sub-band signal in each level was decomposed into two orthogonal subspaces (packets) [14]. Then each packet of the ninth level was spatially filtered using CSP [14]. And by WPD-CSP, signals were decomposed into three levels by WPD and the first five sub-bands whose frequencies range from 0Hz to 30Hz were spatially filtered by CSP [15]. No matter in WCSP or in WPD-CSP, the selection of frequency bands based on subjects has not been performed during signal decomposition. However, not all frequency bands are useful to classification and selecting excellent frequency sub-bands fitted for the specific subject based on some criterion will be helpful to EEG recognition. Considering that energy of EEG frequency bands is an important feature of sub-band signal when people perform motor imagery activities, this paper applies the fisher distance of sub-bands energy as the separable criterion to select subject-based sub-bands. According to this fisher distance of sub-band energy, some sub-bands with better separability could be selected for each subject before CSP, which may improve the classification accuracy. And the details of fisher distance employed in this paper are as following description [15–17].

First, we use f
                        
                           l
                        (x) to denote the EEG signal from channel l (l
                        =1, 2, …, L, L is the total number of channels). The corresponding sample sequence f
                        
                           l
                        (k) (k
                        =1, 2, 3, …, N, N is the total sample number) can be decomposed according to WPD. Let 
                           
                              
                                 d
                                 
                                    l
                                    ,
                                    j
                                 
                                 n
                              
                              (
                              k
                              )
                           
                         be decomposition coefficients of channel l at S(j, n) subspace. Compared with raw signal sequence, WPD coefficients have the concentration performance and are feasible to extract features. Let the raw signal have N sample points, 
                           
                              
                                 V
                                 
                                    l
                                    ,
                                    j
                                 
                                 n
                              
                           
                         is average power values of channel l at S(j, n) subspace. 
                           
                              
                                 V
                                 
                                    l
                                    ,
                                    j
                                 
                                 n
                              
                           
                         can be computed according to the following formula [17]:
                           
                              (4)
                              
                                 
                                    
                                       V
                                       
                                          l
                                          ,
                                          j
                                       
                                       n
                                    
                                    =
                                    
                                       N
                                       M
                                    
                                    
                                       ∑
                                       k
                                    
                                    
                                       
                                          
                                             (
                                             
                                                d
                                                
                                                   l
                                                   ,
                                                   j
                                                
                                                n
                                             
                                             (
                                             k
                                             )
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

The decomposition at level j can give rise to M wavelet packet components (subspaces), in which the subspaces whose frequencies are lower than 50Hz are considered relevant components and others with frequencies higher than 50Hz are considered useless components. The 
                           
                              
                                 V
                                 
                                    l
                                    ,
                                    j
                                 
                                 n
                              
                           
                         values of the relevant subspaces are computed. The useless subspaces are discarded from further processing. We sort these 
                           
                              
                                 V
                                 
                                    l
                                    ,
                                    j
                                 
                                 n
                              
                           
                         values by channel, and then we can obtain the following vector:
                           
                              (5)
                              
                                 
                                    V
                                    =
                                    
                                       
                                          
                                             V
                                             
                                                1
                                                ,
                                                j
                                             
                                             0
                                          
                                          ,
                                          
                                             V
                                             
                                                1
                                                ,
                                                j
                                             
                                             1
                                          
                                          ,
                                          
                                             V
                                             
                                                1
                                                ,
                                                j
                                             
                                             2
                                          
                                          ,
                                          …
                                          ;
                                             
                                          
                                             V
                                             
                                                2
                                                ,
                                                j
                                             
                                             0
                                          
                                          ,
                                          
                                             V
                                             
                                                2
                                                ,
                                                j
                                             
                                             1
                                          
                                          ,
                                          
                                             V
                                             
                                                2
                                                ,
                                                j
                                             
                                             2
                                          
                                          ,
                                          …
                                          ;
                                             
                                          …
                                             
                                          ;
                                             
                                          
                                             V
                                             
                                                L
                                                ,
                                                j
                                             
                                             0
                                          
                                          ,
                                          
                                             V
                                             
                                                L
                                                ,
                                                j
                                             
                                             1
                                          
                                          ,
                                          
                                             V
                                             
                                                L
                                                ,
                                                j
                                             
                                             2
                                          
                                          …
                                          ;
                                       
                                    
                                 
                              
                           
                        
                     

For the simplicity of description, according to the original order, V can also be written as:
                           
                              (6)
                              
                                 
                                    V
                                    =
                                    
                                       
                                          
                                             v
                                             1
                                          
                                          ,
                                          
                                             v
                                             2
                                          
                                          ,
                                          
                                             v
                                             3
                                          
                                          ,
                                          …
                                       
                                    
                                 
                              
                           
                        
                     

It should be noted that the deeper the decomposition level j is, the higher frequency resolution we will obtain. However, a deeper decomposition level also results in more complex computation and higher feature dimensions which can lead to poor classification performance. So, we should select j reasonably according to actual requirements. In order to select more useful sub-bands, a criterion called Fisher distance is adopted to evaluate the separability. Fisher distance can be represented as:
                           
                              (7)
                              
                                 
                                    J
                                    =
                                    t
                                    r
                                    (
                                    
                                       S
                                       w
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       S
                                       b
                                    
                                    )
                                 
                              
                           
                        where S
                        
                           b
                         is the distance between classes, S
                        
                           w
                         is the distance within classes, tr is the trace of the 
                           
                              
                                 S
                                 w
                                 
                                    −
                                    1
                                 
                              
                              
                                 S
                                 b
                              
                           
                         matrix. Sub-bands with larger J values are considered to be more pertinent for classification than those with smaller J values. We compute J value for each sub-band from V, respectively. And so a new vector 
                           
                              
                                 V
                                 ′
                              
                              =
                              {
                              
                                 
                                    v
                                    ′
                                 
                                 1
                              
                              ,
                              
                                 
                                    v
                                    ′
                                 
                                 2
                              
                              ,
                              
                                 
                                    v
                                    ′
                                 
                                 3
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                    ′
                                 
                                 D
                              
                              }
                           
                         can be achieved by selecting a subset of D sub-band powers with the highest J values from V. These D sub-bands are considered to contain more important information for classification than other ones and they are reconstructed to form D new EEG signals. These new EEG signals can be written as E
                        
                           D*N
                        , where D is number of new channels. E
                        
                           D*N
                         is used as input of the following CSP.

The CSP technique has become a popular feature extraction approach in EEG-based BCI applications and it essentially finds spatial filters that maximize the variance for one class and simultaneously minimize the variance for the other class [21]. This method decomposes the raw EEG signals into spatial patterns, which are extracted from two classes of single trial EEG. The EEG signals of each trial are E
                        
                           D*N
                        , the detailed computing process of the CSP can be seen in [17]. After the feature extraction by using CSP, a feature vector F
                        ={f
                        1, f
                        2, …, f
                        2m
                        } is obtained and used as an input for the classifier.

From the physiological standpoint, no two people are the same and so EEG signals vary between subjects. It cannot be expected that all subjects share the same features. Features that are best adapted to a specific subject should be appropriate [22]. So this paper presents a method which applies WPD to decompose EEG into several sub-bands and select effective sub-bands for specific subject according to fisher distance of the power values from all sub-bands. Then selected sub-bands are reconstructed as new input channels to CSP to obtain feature vectors. The detailed steps of the subject-based method can be described as follows:
                           
                              (1)
                              Select a subject.

Select an EEG channel.

Select one trial.

Decompose the trial to a given level using a wavelet. The Haar wavelet can be implemented more easily and faster than others which is an appropriate basis for analyzing EEG data. Therefore, it is employed as wavelet packet basis to decompose EEG signals in this study. A three-level decomposition is taken in this paper and so eight sub-bands S(3, 0)–S(3, 7) can be obtained. More levels of decomposition lead to higher classification rate, but more time the algorithm will spend. The classification accuracy does not change obviously when the level of decomposition is larger than three levels according to our experiments testing, so three-level is taken in this paper. Meanwhile, if the sample frequency of EEG is 100Hz, the correspondingly frequency ranges of sub-band S(3, 0)–S(3, 7) are [0, 6.25]Hz, [6.26, 12.5]Hz, …, [43.75, 50]Hz.

Power value 
                                    
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          n
                                       
                                    
                                  of each sub-band is calculated and so power values from these eight sub-bands constitutes a vector 
                                    
                                       {
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          0
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          1
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          2
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          3
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          4
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          5
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          6
                                       
                                       ,
                                       
                                          V
                                          
                                             l
                                             ,
                                             3
                                          
                                          7
                                       
                                       }
                                    
                                  
                                 l
                                 =1, 2, 3, …, 15. It should be noted that the EEG collection includes 15 effective channels (F3, F1, Fz, F2, F4, C5, C3, C1, Cz, C2, C4, C6, P1, Pz, P2) in our following experimental data.

Repeat step (3)–(5) for all fifteen channels and so the following 120-dimensional vector is obtained as:
                                    
                                       
                                          
                                             V
                                             =
                                             
                                                
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      0
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      1
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      2
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      3
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      4
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      5
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      6
                                                   
                                                   ,
                                                   
                                                      V
                                                      
                                                         1,3
                                                      
                                                      7
                                                   
                                                   ;
                                                   
                                                      V
                                                      
                                                         2,3
                                                      
                                                      0
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      V
                                                      
                                                         2,3
                                                      
                                                      7
                                                   
                                                   ;
                                                      
                                                   …
                                                      
                                                   ;
                                                      
                                                   
                                                      V
                                                      
                                                         15,3
                                                      
                                                      0
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      V
                                                      
                                                         15,3
                                                      
                                                      7
                                                   
                                                
                                             
                                              
                                             or
                                              
                                             V
                                             =
                                             
                                                
                                                   
                                                      v
                                                      1
                                                   
                                                   ,
                                                   
                                                      v
                                                      2
                                                   
                                                   ,
                                                   
                                                      v
                                                      3
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      v
                                                      
                                                         120
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Repeat step (2)–(6) for all trials of training samples and so a 120*T power value matrix of training samples is obtained if the number of trials is T.

Calculate average J values for each sub-band 
                                    
                                       
                                          V
                                          
                                             l
                                             ,
                                             j
                                          
                                          n
                                       
                                    
                                  according to formula (7) and sort them in a descending order shown in Fig. 2
                                 . Then a new vector 
                                    
                                       
                                          V
                                          ′
                                       
                                       =
                                       {
                                       
                                          
                                             v
                                             ′
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          2
                                       
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          3
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          D
                                       
                                       }
                                    
                                  can be achieved by selecting the first D sub-bands from V. And the corresponding index of these D sub-bands would be saved as vector b.

From Fig. 2, it can be seen that some points are very close to zero on the terminal of the J curve after descending sort. In this paper, D
                                 =110 is taken, i.e. 
                                    
                                       
                                          V
                                          ′
                                       
                                       =
                                       {
                                       
                                          
                                             v
                                             ′
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          2
                                       
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          3
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                             ′
                                          
                                          
                                             110
                                          
                                       
                                       }
                                    
                                 , which means the last ten sub-bands are eliminated and we adopt the first 110 sub-bands with J values exceeding certain threshold in FD. It should be noted that we have examined many D values (D
                                 =90, 95, 100, 105, 110, 115) during training course, the best result is determined with D
                                 =110 by the following classification accuracy.

All these sub-bands whose sub-band index in V′ are reconstructed to form 110 new EEG channels. These new EEG signals are written as E
                                 110*N
                                 . In this paper, sampling point number of each trial is N
                                 =100.

Extract features. E
                                 110*N
                                  is feed into the CSP and feature vector F
                                 ={f
                                 1, f
                                 2, …, f
                                 2m
                                 } is obtained, which is used as an input for the following classifier. It should be noted that the typical number of projections (2, 4, 6, 8, …, 20) of CSP were investigated to build the feature vector, demonstrating that the optimal number is 6. Therefore, a 6-dimensional feature vector is taken in this paper. That is also to say that m
                                 =3 is taken in this paper.

Repeat (1)–(10) for all subjects.

To be compared with the subject-based method, the non-subject-based fisher WPD-CSP that extracts features without reselecting sub-bands is presented as follows:
                           
                              (1)
                              Select a subject.

Select an EEG channel.

Select one trial.

Decompose the trial, calculate and sort the fisher distance J as described from (4) to (7) in the subject-based method, the corresponding index of 110 sub-bands would be saved as vector b. Then according to the vector b, 110 sub-bands are selected as 
                                    
                                       
                                          V
                                          
                                             s
                                             
                                                1
                                                ′
                                             
                                          
                                       
                                       =
                                       {
                                       
                                          v
                                          1
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                1
                                             
                                          
                                       
                                       ,
                                       
                                          v
                                          2
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                1
                                             
                                          
                                       
                                       ,
                                       
                                          v
                                          3
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                1
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          v
                                          
                                             110
                                          
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                1
                                             
                                          
                                       
                                       }
                                    
                                 , where s
                                 1 represents Subject 1.

Repeat (2)–(4) for all trials of the first subject.

Select subject i (i
                                 =2, 3, 4, 5, 6) and EEG channels of the subject, then decompose trials from this new subject using WPD.

Calculate the fisher distance J and sort them according to vector b obtained by the first subject, 110 sub-bands are selected as 
                                    
                                       
                                          V
                                          
                                             s
                                             
                                                i
                                                ′
                                             
                                          
                                       
                                       =
                                       {
                                       
                                          v
                                          1
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                i
                                             
                                          
                                       
                                       ,
                                       
                                          v
                                          2
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                i
                                             
                                          
                                       
                                       ,
                                       
                                          v
                                          3
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                i
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          v
                                          
                                             110
                                          
                                          
                                             
                                                
                                                   s
                                                   ′
                                                
                                                i
                                             
                                          
                                       
                                       }
                                    
                                 , where s
                                 
                                    i
                                  represents subject i.
                              

Extract features as step (9) and (10) described in the subject-based method.

Repeat (6)–(8) for all subjects.

A probabilistic neural network (PNN) is a feedforward neural network, which was derived from the Bayesian network and a statistical algorithm called Kernel Fisher discriminant analysis. It was introduced by D.F. Specht in the early 1990s. The PNN provides a general solution to pattern classification problems by following an approach developed in statistics, called Bayesian classifiers. Bayesian theory takes into account the relative likelihood of events and uses a priori information to improve prediction [23]. The PNN model is one among the supervised learning networks. It has many features different from those of other networks in the learning processes. The PNN has overcome the limitations of back-propagation (BP) neural network including prolonged training time, no global minimum guarantee and difficult designing of network architecture. With high learning speed, it is often applied to classify signals which depends on sample data and is really a desired classification method [24,25]. There are also several other classifiers which are tested in this paper, such as support vector machines (SVM), K-nearest neighbor (KNN), linear discriminant analysis (LDA), etc. But the PNN is the best one in dealing with experimental data of our laboratory. So this paper employs PNN as the classifier.

In this paper, the PNN architecture is constructed by using newpnn function in MATLAB 2010. The spread value σ of the radial basis function (RBF) in PNN controls the spread of the RBF functions and it has certain impact on the classification accuracy. We examined with different values of σ during training course and the optimal value σ
                        =0.2 is taken for testing course.

Dataset was from the authors’ laboratory experiments. The authors recorded EEG signals using a 16-channel electrode cap. The cap includes 15 effective channels (F3, F1, Fz, F2, F4, C5, C3, C1, Cz, C2, C4, C6, P1, Pz, P2) and one reference channel. The EEG amplifier is a high-precision biological amplifier developed by Tsinghua University. The EEG signals are transformed by a 24-bit A/D converter and then collected through EEG signal acquisition software. The sampling frequency is 100Hz.

All procedures were approved by the local ethical committee, and all the participants gave their written informed consent before the experiment. The authors declare no conflict of interests. In this experiment, each of six healthy subjects (3 females and 3 males: 24±3 years old) was asked to complete 50 trials in one session. And each subject need complete three sessions within 2 months. Each trial included a 2-s prepare time, a 4-s left or right hand motor imagination task and a 2-s rest time, as shown in Fig. 3
                     . The subject sat on a chair and had to perform left/right hand movement imagination according to the cue on the screen. In the first 2s, the monitor would show a “+” on the black background to remind subjects to get ready for imagination. Then the mark on the monitor would turn into a left or right arrow. At this moment, subjects should imagine the corresponding movement (left hand or right hand movement) according the direction of the arrow. This process will last for 4s. Finally, after the 4-s motor imagery (from 2s to 6s), the monitor would turn black again for 2s which reminds subjects a trial has been over and they can have a rest to wait for the next trial. The dataset were band-pass filtered between 0Hz and 50Hz.

@&#RESULTS AND DISCUSSION@&#

@&#RESULTS@&#

Data from six subjects collected in Section 3 are processed by the subject-based fisher WPD-CSP (Method one), the non-subject-based fisher WPD-CSP (Method two) and WPD-CSP (Method three) described in Section 2.4. The experimental data of all the three sessions from six subjects are analyzed and processed by two-fold cross-validation. For one session, in Method one, we can obtain the fisher distance J values of all sub-bands from each subject shown in Fig. 4
                        . More intuitively, J values from each subject are sorted in a descending order in Fig. 5
                        . Each color line represents J values of the specific subject which have been sorted. It can be observed apparently that significant difference exists in the amplitude and waveform, in other words, J values from specific subjects are different from each other. However it is not for sure whether the index of corresponding sub-bands after being sorted from one subject is different from other subjects. To prove that, indexes of the last ten sub-bands after being sorted are listed in Table 1
                        . These ten sub-bands will be rejected for further analysis. According to the table, the number with same color represents different subjects reject the same frequency region. And then, we can observe that no one sub-band is shared by everyone. It is also to say different subjects have different order of sub-bands so that the 110 best sub-bands for each subject are different after J values being sorted. In other words, Fig. 5 and Table 1 show that the best sub-bands vary among subjects. It should be noted that extracted features from a subject depends on the indexes of sub-bands and so extracted features would vary among subjects.

As shown in Table 1, the value of FD for each subject is different and the last ten sub-bands with small fisher distance are being eliminated from 120 ones of all 15 channels. These rejected sub-bands for each subject cover different channels. That is also to say that these sub-bands are not from the same channel. So, all 15 channels must be used in this paper. If channel selection is made, part of some useful information will be abandoned. To prove subject-based feature extraction can select the best feature, we make a comparison among subject-based fisher WPD-CSP (Method one), non-subject-based fisher WPD-CSP (Method two) and WPD-CSP (Method three). The first two methods combine fisher distance with WPD and CSP, but the difference between them is the sub-bands index from vector b. Method one chooses the vector b for each subject and Method two only applies a fixed vector b from one of subjects to others. The average classification accuracies obtained with above methods from all three sessions are shown in Fig. 6
                        , in which Method one represents the subject-based feature extraction using fisher WPD-CSP and Method two represents the non-subject-based method. In Method two, we take average classification rate of all subjects during training course as criterion. The best and worst subjects are selected to make a comparison with Method one. In other words, we choose two different sub-band order vector b in Method two, where the red line (B1) is the worst situation using fixed vector b of Subject 5 and the green line (B2) is the best situation from Subject 4.

In WPD-CSP method (Method three), all subjects use the same 120 sub-bands and 15 channels, which is a non-subject-based approach. There is no sub-band and subject selection in the WPD-CSP method. And as shown in Fig. 6, it is obvious that fisher WPD-CSP is better than WPD-CSP. Meanwhile subject-based fisher WPD-CSP achieves higher classification accuracy than non-subject methods. The average accuracy of Method one for all subjects could be 88.66%. Compared with the Method two (B1 and B2) and Method three, the classification accuracy from subject-based fisher WPD-CSP is increased by 12%, 6% and 14%, respectively.

After comparison of average classification accuracy, the performance of the proposed method was quantified by using the sensitivity and specificity. Sensitivity (also called true positive rate) measures the proportion of actual positives (motor imagery state) which are correctly identified. Specificity (sometimes called the true negative rate) measures the proportion of negatives (no motion or noise, rest state) which are correctly identified [26]. The sensitivity and specificity defined as follows:
                           
                              (8)
                              
                                 
                                    Sensitivity
                                    =
                                    
                                       
                                          TP
                                       
                                       
                                          TP
                                          +
                                          FN
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    Specificity
                                    =
                                    
                                       
                                          TN
                                       
                                       
                                          FP
                                          +
                                          TN
                                       
                                    
                                 
                              
                           
                        where TP (true positive) and FN (false negative) occur in the motor imagery state while FP (false positive) and TN (true negative) occur in the rest state. Thus sensitivity=100% means that all the motor imagery states are correctly detected and specificity=100% means that all the rest states are correctly detected [27]. The ensemble average across subjects when using subject-based fisher WPD-CSP features was (sensitivity: 88.7±0.9%, and specificity: 91±1%) significantly better than WPD-CSP features (sensitivity: 80±1.3%, and specificity: 81±2%). It seems reliable that the proposed subject-based fisher WPD-CSP feature extraction method has better performance than the WPD-CSP method. And, combined with the above results, the proposed subject-based fisher WPD-CSP feature extraction method is a better method in selecting the best-adapted features for a specific subject.

@&#CONCLUSION@&#

This paper applies the WPD to decompose EEG signal into a series of sub-bands. Then the fisher distance of sub-band energy serves as the separable criterion to select subject-based sub-bands. According to fisher distance of sub-band energy, some sub-bands with better separability could be selected for each subject before CSP. Finally, these selected sub-bands are used as input of CSP to extract related features. The proposed fisher WPD-CSP method can not only remedy disadvantages of CSP by WPD but also discriminate helpless sub-bands for each subject and make remaining fewer sub-bands keep better separability by fisher distance, which leads to a higher classification accuracy than WPD-CSP method. Future research should be aimed at testing more experimental data to verify the algorithm more effectively.

None declared.

No reference number. However, all our subjects are from master students and they are given informed consent to the work.

@&#ACKNOWLEDGEMENTS@&#

This project is supported by National Natural Science Foundation of China (No. 60975079, No. 31100709), Innovation project of Shanghai Education Commission (No. 12ZZ099).

@&#REFERENCES@&#

