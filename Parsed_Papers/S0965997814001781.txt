@&#MAIN-TITLE@&#Study of a Jacobian-free approach in the simulation of compressible fluid flows in porous media using a derivative-free spectral method

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We employ the DFSANE algorithm in the simulation of miscible flows in porous media.


                        
                        
                           
                           We report results and comparisons with a Jacobian-free inexact Newton method.


                        
                        
                           
                           The DFSANE was able to simulate miscible processes using the lowest CPU time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Compressible fluids

Miscible flows

Porous media

Jacobian-free approach

Derivative-free spectral method

Large-scale nonlinear systems

@&#ABSTRACT@&#


               
               
                  The development of Jacobian-free software for solving problems formulated by nonlinear partial differential equations is of increasing interest to simulate practical engineering processes. For the first time, this work uses the so-called derivative-free spectral algorithm for nonlinear equations in the simulation of flows in porous media. The model considered here is the one employed to describe the displacement of miscible compressible fluid in porous media with point sources and sinks, where the density of the fluid mixture varies exponentially with the pressure. This spectral algorithm is a modern method for solving large-scale nonlinear systems, which does not use any explicit information associated with the Jacobin matrix of the considered system, being a Jacobian-free approach. Two dimensional problems are presented, along with numerical results comparing the spectral algorithm to a well-developed Jacobian-free inexact Newton method. The results of this paper show that this modern spectral algorithm is a reliable and efficient method for simulation of compressible flows in porous media.
               
            

@&#INTRODUCTION@&#

The simulation of the flow of miscible fluids through porous materials takes place in several situations of interest in applied sciences and engineering, as in oil recovery, subsurface contaminant transport and remediation, supercritical extractions, chromatography processes, etc. In fact, after the initial stages of oil extraction, the enhanced oil recovery techniques use injections of fluids that seek to reduce the viscosity of the resident oil and improving the flow. In general, these fluids comprise gases or liquids that are miscible with oil, such as carbon dioxide, nitrogen, gels, polymer solutions, and other. A large number of chemical substances commonly used in the industrialized world have their fate in the environment. Such events that occur intentionally or accidentally include fertilizer and pesticide applications in agriculture, leaks in industrial (and residential) facilities used for the disposal of waste, and inappropriate choices of waste disposal sites. These chemicals often contaminate sources of subsurface water. Thus, to simulate such events, many of these processes are modeled as the flow of miscible fluids, water and a solute. Various processes for remediation of soil and ground water that use injections of solvents can also be described by these miscible models. In chemical engineering, the study of miscible flows in porous media is important in many practical situations, such as the simulation of supercritical processes used in the extraction of natural products. As an example, we can cite the extraction of caffeine from the injection of carbon dioxide in a supercritical state. In applied analytical chemistry, the flows in porous columns, used in chromatography processes, are in general miscible, where the injected fluid (eluent) can be in a supercritical state.

Generally, the mathematical models used to describe these complex processes are formulated by nonlinear partial differential equations [3,7], which can present solutions with singularities in the injection and production wells.

Thus, the discretization of these problems (governed by nonlinear differential equations) leads to large nonlinear systems of algebraic equations. These equations are commonly solved using the classical Newton method [1]. In spite of this, the convergence of the Newton method depend on the location of the starting point; this iterative method is attractive because it usually presents a local quadratic rate of convergence [9]. However, to simulate the dynamic evolution of the flow, at each time step the Newton method requires the solution of a number of linear systems, where the Jacobians of the nonlinear system evaluated at the current points are the coefficient matrices, which are generally large and sparse.

To minimize the computational cost spent on resolutions of such linear systems, in recent years some researchers in this area have used inexact Newton methods, [4,8,14,16]. Such inexact methods are variants of the Newton method, where linear systems are solved only approximately [10,12,13], what is commonly done using a Krylov method [15].

The Derivative-Free Spectral Algorithm for Nonlinear Equations (DFSANE) is a modern method for solving large-scale nonlinear systems, developed from the spectral gradient method [2,21], which does not solve linear systems, nor use any explicit information associated with the Jacobin matrix, being a Jacobian-free approach with a solid theoretical foundation [17].

The objective of this work is to study the performance of the DFSANE in the numerical simulation of miscible compressible fluid flows in porous media, where the model used considers point sources and sinks, possible large adverse mobility ratio and anisotropic dispersion in tensor form. Furthermore, in this model the density of the fluid mixture varies exponentially with the pressure. In addition, using a pseudo-language, all the algorithms discussed here will be presented in a clear and well-established form, in order to facilitate future applications to engineering problems.

For this, two dimensional problems are presented, along with numerical results comparing the DSANE to a Jacobian-free inexact Newton method.

The remainder of this paper is organized as follows. In Section 2, we describe the mathematical model for the miscible compressible fluid flows in porous media. Section 3 is devoted to the presentation of the DFSANE. In Section 4 we report the numerical results and comparisons. The conclusions are given in Section 5.

In this section, we describe the differential equations that model the isothermal compressible fluid flows in porous media. In addition, we include a discretized form of this mathematical model, which was used to test the spectral method for nonlinear systems of interest here.

We consider flows of binary mixtures (an invading fluid plus a resident fluid) through porous materials associated with processes where the invading fluid and the resident fluid are fully miscible, and flow together as one-phase fluid. Here, these processes are described by the mass conservation equations for the invading fluid and for the mixture, Darcy’s law, and an equation of state, which will provide the thermodynamic properties of the binary mixture [3,7].

Let w be the mass fraction of the invading fluid in the mixture, and t the time. Then, the mass conservation equations of this species is given by
                        
                           (1)
                           
                              ϕ
                              
                                 
                                    ∂
                                    (
                                    ρ
                                    w
                                    )
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              +
                              ∇
                              .
                              (
                              ρ
                              wu
                              )
                              -
                              ∇
                              .
                              (
                              ρ
                              D
                              ∇
                              w
                              )
                              =
                              wq
                              ,
                           
                        
                     where ϕ is the porosity of the porous material, ρ is the mass density of the fluid mixture, q is the source (or sink) term that represents the mass flow rate per unit volume injected into (or produced from) the porous medium, D denotes the tensor of the mass diffusive-dispersive flux of the invading fluid, and u is the velocity of the fluid mixture. Here, this velocity is described using a differential form of Darcy’s law,
                        
                           (2)
                           
                              u
                              =
                              -
                              
                                 
                                    k
                                 
                                 
                                    μ
                                 
                              
                              ∇
                              P
                              ,
                           
                        
                     which disregards gravity effects. In Eq. (2) 
                     k is the permeability of the porous medium, μ and P are, respectively, the viscosity and pressure of the binary mixture. The governing differential equation that describes the conservation of mass for the total fluid mixture is given by
                        
                           (3)
                           
                              ϕ
                              
                                 
                                    ∂
                                    ρ
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              +
                              ∇
                              .
                              
                                 
                                    
                                       ρ
                                       u
                                    
                                 
                              
                              =
                              q
                              .
                           
                        
                     
                  

The viscosity of binary mixture depends on the mass fraction w, being described by the following mixing rule [22],
                        
                           (4)
                           
                              μ
                              (
                              w
                              )
                              =
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          r
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                1
                                                -
                                                w
                                                )
                                                +
                                                w
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      1
                                                      /
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                           
                        
                     where μi
                      and μr
                      are, respectively, the viscosities of the invading and resident fluids.

The density ρ depends only on the pressure of the fluid, and obeys the equation of state [7],
                        
                           (5)
                           
                              ρ
                              (
                              P
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    ref
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    P
                                    -
                                    
                                       
                                          P
                                       
                                       
                                          ref
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     where ρref
                      is the value of ρ at a reference pressure Pref
                     , and cf
                      is the compressibility of the fluid.

For a two-dimensional velocity field of the type u
                     =
                     u
                     1 
                     
                        
                           i
                        
                     
                     +
                     u
                     2 
                     
                        
                           j
                        
                      (where 
                        
                           i
                        
                      and 
                        
                           j
                        
                      are the unit vectors in x-direction and y-direction, respectively), the diffusion–dispersion tensor D takes the form shown in [19],
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  11
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  12
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  21
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  22
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ︸
                                       
                                    
                                 
                                 
                                    D
                                 
                              
                              =
                              ϕ
                              
                                 
                                    d
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   L
                                                
                                             
                                             -
                                             
                                                
                                                   α
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where, from Eq. (2), we have
                        
                           (7)
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              =
                              -
                              
                                 
                                    k
                                 
                                 
                                    μ
                                    (
                                    w
                                    )
                                 
                              
                              
                                 
                                    ∂
                                    P
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              =
                              -
                              
                                 
                                    k
                                 
                                 
                                    μ
                                    (
                                    w
                                    )
                                 
                              
                              
                                 
                                    ∂
                                    P
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              .
                           
                        
                     In Eq. (6), the scalar dM
                      is the coefficient of molecular diffusion, and αT
                      and αL
                      are, respectively, the transverse dispersivity and longitudinal dispersivity of the invading fluid. The coefficient dM
                      has dimension of area per unit time, while αT
                      and αL
                      have dimensions of length.

Let Ω be the spatial domain representing the porous medium, whose boundary is denoted by ∂Ω. The boundary conditions are those that describe the absence of flow in the borders of Ω:
                        
                           (9)
                           
                              ρ
                              u
                              ·
                              n
                              =
                              0
                              ,
                              
                              at
                              
                              ∂
                              Ω
                              ,
                              
                              for all
                              
                              t
                              ≥
                              0
                              ,
                           
                        
                     
                     
                        
                           (10)
                           
                              (
                              ρ
                              wu
                              -
                              ρ
                              D
                              ∇
                              w
                              )
                              ·
                              n
                              =
                              0
                              ,
                              
                              at
                              
                              ∂
                              Ω
                              ,
                              
                              for all
                              
                              t
                              ≥
                              0
                              ,
                           
                        
                     where n is the unit vector normal to ∂Ω.

Here, the spatial domain Ω is (essentially) two-dimensional. This rectangular domain (supposedly horizontal) will be denoted by Ω
                     =[0,
                     Lx
                     ]×[0,
                     Ly
                     ], where Lx
                      and Ly
                      are the lengths of the sides of this rectangular region in x-direction and y-direction, respectively. For the spatial discretization, we use a uniform block-centered grid. Thus, given two integers nx
                      and ny
                     , this grid will be described by 
                        
                           
                              
                                 Ω
                              
                              
                                 ^
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ;
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                    and
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                           
                        
                     , with xi
                     
                     =(i
                     −1/2)Δx and yj
                     
                     =(j
                     −1/2)Δy, such that Δx
                     =
                     Lx
                     /nx
                      and Δy
                     =
                     Ly
                     /ny
                     . Each point 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           
                              
                                 Ω
                              
                              
                                 ^
                              
                           
                        
                      represents a node of the block-centered grid, where the values of the unknown functions of the problem in question are effectively calculated. Given xi
                     
                     +1/2
                     =
                     xi
                     
                     +Δx/2,
                     yj
                     
                     -1/2
                     =
                     yj
                     
                     −Δy/2, etc., the set 
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ij
                              
                           
                           =
                           [
                           
                              
                                 x
                              
                              
                                 i
                                 -
                                 1
                                 /
                                 2
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                                 /
                                 2
                              
                           
                           ]
                           ×
                           [
                           
                              
                                 y
                              
                              
                                 j
                                 -
                                 1
                                 /
                                 2
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                                 +
                                 1
                                 /
                                 2
                              
                           
                           ]
                        
                      denotes a block of 
                        
                           
                              
                                 Ω
                              
                              
                                 ^
                              
                           
                        
                     , whose node is the point (xi
                     ,
                     yj
                     ). Thus, we have nx
                     
                     ×
                     ny
                      discretization blocks. The temporal domain is represented by a closed interval [t
                     0,
                     tf
                     ], where tf
                      denotes the final time and t
                     0(=0) is the initial time. Given an integer nt
                     , this interval will be partitioned in the form 
                        
                           0
                           =
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           <
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           <
                           …
                           <
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           <
                           …
                           <
                           
                              
                                 t
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                        
                     , providing an uniform temporal grid, whose time step is Δt
                     =
                     tn
                     
                     −
                     tn
                     
                     −1, for all n
                     =1,…,
                     nt
                     . Following the traditional notation, 
                        
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 n
                              
                           
                        
                      denotes the value of a function f at the node 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                           ∈
                           
                              
                                 Ω
                              
                              
                                 ^
                              
                           
                        
                     , at the level of time tn
                     .

Replacing Eq. (2) in Eq. (3), we obtain the so-called pressure equation, which for a node (xi
                     ,
                     yj
                     ) takes the form
                        
                           (11)
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                ρ
                                                (
                                                P
                                                )
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         P
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         w
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         P
                                                      
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         p
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         w
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         P
                                                      
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              -
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              0
                           
                        
                     
                  

Similarly, replacing Eq. (3) in Eq. (1), we have the so-called concentration equation
                        
                           (12)
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                (
                                                ρ
                                                (
                                                P
                                                )
                                                w
                                                )
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              -
                              
                                 
                                    w
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              0
                              .
                           
                        
                     In Eq. (12), 
                        
                           
                              
                                 F
                              
                              
                                 x
                              
                           
                        
                      e 
                        
                           
                              
                                 F
                              
                              
                                 y
                              
                           
                        
                      are the total mass flows of the invading fluid in x-direction and y-direction, respectively, given by
                        
                           (13)
                           
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                              
                              =
                              -
                              w
                              
                                 
                                    ρ
                                    (
                                    P
                                    )
                                    k
                                 
                                 
                                    μ
                                    (
                                    w
                                    )
                                 
                              
                              
                                 
                                    ∂
                                    P
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              -
                              ρ
                              (
                              P
                              )
                              
                                 
                                    D
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    ∂
                                    w
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              -
                              ρ
                              (
                              P
                              )
                              
                                 
                                    D
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    ∂
                                    w
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                              
                              =
                              -
                              w
                              
                                 
                                    ρ
                                    (
                                    p
                                    )
                                    k
                                 
                                 
                                    μ
                                    (
                                    w
                                    )
                                 
                              
                              
                                 
                                    ∂
                                    P
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              -
                              ρ
                              (
                              P
                              )
                              
                                 
                                    D
                                 
                                 
                                    21
                                 
                              
                              
                                 
                                    ∂
                                    w
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              -
                              ρ
                              (
                              P
                              )
                              
                                 
                                    D
                                 
                                 
                                    22
                                 
                              
                              
                                 
                                    ∂
                                    w
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              .
                           
                        
                     Eqs. (11) and (12) are integrated in time using a time-marching approach based on the classical IMPES time stepping strategy [1], which is described in Algorithm 1 in Fig. 1
                     . This strategy is characterized by three main aspects: (a) decouples the model equations in each time step; (b) the pressure equation (a nonlinear parabolic partial differential equation) is solved implicitly; (c) the concentration equation (of the type advection–diffusion) is solved explicitly.

In order to carry out the Step 2 of Algorithm 1, the spatial derivatives in Eq. (11) are approximated by centered finite differences. Thus, using the backward-Euler method for time discretization, the pressure equation takes the following discretized form, [1]:
                        
                           (15)
                           
                              ϕ
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    Δ
                                    t
                                 
                              
                              -
                              
                                 
                                    1
                                 
                                 
                                    Δ
                                    x
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                             /
                                             2
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             i
                                             -
                                             1
                                             /
                                             2
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    1
                                 
                                 
                                    Δ
                                    y
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             Δ
                                             y
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                         (
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         k
                                                      
                                                      
                                                         μ
                                                         (
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             -
                                             1
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   -
                                                   1
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             Δ
                                             y
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                        
                     In Eq. (15), on each edge of a block of the block-centered grid the transmissibility 
                        
                           λ
                           ≡
                           
                              
                                 
                                    ρ
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    k
                                    /
                                    μ
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      is calculated by harmonic average [1]. For example: 
                        
                           
                              
                                 λ
                              
                              
                                 i
                                 +
                                 1
                                 /
                                 2
                                 ,
                                 j
                              
                           
                           =
                           2
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              
                                 λ
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           /
                           (
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 i
                                 +
                                 1
                                 ,
                                 j
                              
                           
                           )
                        
                     .

On the other hand, for the implementation of Step 3 of Algorithm 1, the concentration equation (Eq. (12)) is discretized by an explicit scheme,
                        
                           (16)
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    Δ
                                    t
                                 
                                 
                                    ϕ
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             Δ
                                             x
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      /
                                                      2
                                                      ,
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      -
                                                      1
                                                      /
                                                      2
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             Δ
                                             y
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      +
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  n
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Here, to avoid non-physical oscillations and excessive artificial numerical dispersions, in Eq. (16) the advective parts of the total fluxes 
                        
                           
                              
                                 F
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 F
                              
                              
                                 y
                              
                           
                        
                     , across grid block edges, are approximated by a flux limiting scheme, taken in the upstream direction [5]. The approximations of the diffusive parts of 
                        
                           
                              
                                 F
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 F
                              
                              
                                 y
                              
                           
                        
                      follow a finite differences scheme based on a numerical strategy suitable for the discretization of the cross derivatives [11].

In practice, it is often preferable to specify the volumetric rate Q (volume per unit time) instead of q (mass per unit volume, per unit time). For this, we use in Eqs. (15) and (16) the following relationship:
                        
                           (17)
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                b
                                             
                                          
                                          )
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              ,
                           
                        
                     where (Vb
                     )
                        i
                     
                     ,
                     
                        j
                     
                     =ΔxΔyh denotes the volume of the block 
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ij
                              
                           
                        
                     . Here, h is the thickness of the porous medium, a relatively small step taken in z-direction. Thus, in an injection block, the rate 
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 n
                              
                           
                        
                      is specified throughout the injection time. On the other hand, in a production block, 
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 n
                              
                           
                        
                      is described by using a well model,
                        
                           (18)
                           
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              -
                              
                                 
                                    2
                                    π
                                    hk
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          n
                                       
                                    
                                    ln
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   0
                                                
                                             
                                             /
                                             
                                                
                                                   r
                                                
                                                
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             n
                                          
                                       
                                       -
                                       
                                          
                                             P
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where Pw
                      (<
                        
                           
                              
                                 P
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 n
                              
                           
                           )
                        
                      and rw
                     
                     >0 are two previously fixed values called, respectively, well pressure and well radius [1]. In this model, r
                     0 (>
                     rw
                     ) is the equivalent radius of the block 
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ij
                              
                           
                        
                     . Here, as suggested in [20], we use
                        
                           (19)
                           
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              =
                              0.14
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                x
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                Δ
                                                y
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

From Eq. (15) we obtain a system of nonlinear equations, whose solution provides in each time step the pressure field of a compressible flow in a porous medium. This nonlinear system presents some peculiarities, as the singularities associated with the injection and production wells, and the exponential variation of fluid density with respect to the pressure.

In this section, we write this nonlinear system in the form
                        
                           (20)
                           
                              F
                              (
                              x
                              )
                              =
                              0
                              ,
                           
                        
                     where
                        
                           (21)
                           
                              F
                              :
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                              ,
                           
                        
                     is the nonlinear mapping defined by the expression on the left side of Eq. (15), 
                        
                           x
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                      is the vector whose components are the pressure values at each node of the discretization grid, and N
                     =
                     nx
                     
                     ×
                     ny
                     .

Here, we consider the problem of finding 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                     , such that F(x
                     ∗)=0. Classically, this problem has been solved with the Newton method. Using an initial guess 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                     , the Newton method generates an iterative sequence 
                        
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                      defined by 
                        
                           
                              
                                 x
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 d
                              
                              
                                 k
                              
                              
                                 N
                              
                           
                        
                     , where the vector 
                        
                           
                              
                                 d
                              
                              
                                 k
                              
                              
                                 N
                              
                           
                        
                      (the Newton direction) is the solution of the linear system
                        
                           (22)
                           
                              
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    N
                                 
                              
                              =
                              -
                              F
                              (
                              
                                 
                                    x
                                 
                                 
                                    x
                                 
                              
                              )
                              .
                           
                        
                     In Eq. (22), F
                     ′(xk
                     ) is the Jacobian matrix of F at xk
                     , which is supposed invertible.

One of the disadvantages of the Newton method is the necessity to solve the linear system above (Eq. (22)) in each iteration. This is heightened when F(x)=0 is a large-scale nonlinear system, whose solution is required repeatedly, as in the problem addressed here.

In what follows, ||x|| denotes the Euclidean norm of x, i.e., 
                        
                           |
                           |
                           x
                           |
                           |
                           =
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 x
                              
                           
                        
                     .

There is a clear relationship between find 
                        
                           
                              
                                 x
                              
                              
                                 ∗
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                     , such that F(x
                     ∗)=0, and solve the following minimization problem
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Minf
                                                (
                                                x
                                                )
                                                =
                                                ‖
                                                F
                                                (
                                                x
                                                )
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                x
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     In fact, since ∇f(x
                     ∗)=2F
                     ′(x
                     ∗)
                        TF(x
                     ∗), if F
                     ′(x
                     ∗) is invertible, then ∇f(x
                     ∗)=0 if and only if F(x
                     ∗)=0.

Among the methods used to solve the minimization problem shown in Eq. (23) there is a class of iterative algorithms which use low storage, and are more suitable for large problems. In this class is the classical steepest descent method which, unfortunately, converge slowly [9].

Given a differentiable function 
                        
                           f
                           :
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                           →
                           R
                        
                     , in order to accelerate the convergence of the steepest descent method, Barzilai and Borwein [2] proposed an iterative method defined by
                        
                           (24)
                           
                              
                                 
                                    x
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ∇
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     where, for all k
                     ⩾1, the scalar αk
                      is the argument that minimizes the function ‖αsk
                     
                     −1
                     −
                     yk
                     
                     −1‖2, with sk
                     
                     −1
                     =
                     xk
                     
                     −
                     xk
                     
                     −1 and yk
                     
                     −1
                     =∇f(xk
                     )−∇f(xk
                     
                     −1), given by
                        
                           (25)
                           
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                              
                              .
                           
                        
                     If f is a quadratic form of the type 
                        
                           f
                           (
                           x
                           )
                           =
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 x
                              
                              
                                 T
                              
                           
                           Ax
                           -
                           
                              
                                 b
                              
                              
                                 T
                              
                           
                           x
                           +
                           c
                        
                     , where 
                        
                           A
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                                 ×
                                 N
                              
                           
                        
                     , 
                        
                           b
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        
                      and 
                        
                           c
                           ∈
                           R
                        
                     , then ∇f(x)=
                     A
                     x
                     −
                     b. In this case, αk
                      becomes a Rayleigh quotient, given by 
                        
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                              
                                 T
                              
                           
                           
                              
                                 As
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           /
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                              
                                 T
                              
                           
                           
                              
                                 s
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                      
                     [21]. Thus, If A is symmetric and sk
                     
                     −1 is an eigenvector of A, then αk
                      is an eigenvalue of A. For this reason the αk
                      parameter defined in Eq. (25) is called the spectral coefficient, and the method proposed by Barzilai and Borwein [2] is called the spectral gradient method.

To solve the problem shown in Eq. (23), in [18] the authors observed that instead of employing ∇f(x)=2F
                     ′(x)
                        TF(x), the gradient vector of f
                     =‖F(x)‖2 which requires the calculation of the Jacobian F
                     ′(x), is possible to define a spectral method of the form
                        
                           (26)
                           
                              
                                 
                                    x
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              ±
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              F
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     with
                        
                           (27)
                           
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where now we have sk
                     
                     −1
                     =
                     xk
                     
                     −
                     xk
                     
                     −1 e yk
                     
                     −1
                     =
                     F(xk
                     )−
                     F(xk
                     
                     −1). In Eq. (26), the choice of the signs±comes from the fact that the search direction −F(xk
                     ) is not necessarily a descent direction of f(xk
                     )=||F(xk
                     )||2 at xk
                     , i.e., in general, ∇f(xk
                     )
                        Tdk
                     
                     =−2F(xk
                     )
                        TF
                     ′(xk
                     )F(xk
                     ) is not a negative number. In this case, the method selects the search direction +F(xk
                     ).

Using the search directions 
                        
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           =
                           ±
                           
                              
                                 
                                    1
                                    /
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                           F
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                        
                     , the iterations of the so-called DFSANE (Derivative-Free Spectral Algorithm for Nonlinear Equations) are given by [17],
                        
                           (28)
                           
                              
                                 
                                    x
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ±
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   F
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          ︸
                                       
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where, in each iteration, the step length 
                        
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                        
                      is chosen appropriately to force the convergence of the sequence {xk
                     }, regardless of the location of the starting point. This is made employing a globalization step that performs a nonmonotone linear search in the directions dk
                     
                     =±(1/αk
                     )F(xk
                     ), governed by the derivative-free condition
                        
                           (29)
                           
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              )
                              ⩽
                              
                                 
                                    
                                       max
                                    
                                    
                                       0
                                       ⩽
                                       j
                                       ⩽
                                       M
                                    
                                 
                              
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                    -
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    ∊
                                 
                                 
                                    k
                                 
                              
                              -
                              γ
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     where {∊
                        k
                     } is a given convergent sequence, M is a non-negative integer, and γ
                     ∊(0,1).

Thus the DFSANE initially attempts 
                        
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           =
                           1
                        
                     . If this initial step length does not satisfy the condition shown in Eq. (29), then, in order to cause a reduction in the step length, the method makes use of a backtracking strategy. This strategy uses second degree polynomials, 
                        
                           p
                           (
                           λ
                           )
                        
                     , obtained by a two-point interpolation, such that p(0)=
                     f(xk
                     )≡‖F(xk
                     )‖2, p′
                     (0)=−2f(xk
                     )≡−2‖F(xk
                     )‖2 and 
                        
                           p
                           (
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                           )
                           =
                           f
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           )
                           ≡
                           ‖
                           F
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                           +
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           
                              
                                 ‖
                              
                              
                                 2
                              
                           
                        
                     , where 
                        
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                        
                      denotes the current step length that was rejected for not meeting the condition shown in Eq. (29). Thus, we have
                        
                           (30)
                           
                              p
                              (
                              λ
                              )
                              =
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              -
                              2
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              λ
                              +
                              
                                 
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             -
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             +
                                             2
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             
                                                
                                                   λ
                                                
                                                
                                                   c
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     Then, the critical point of 
                        
                           p
                           (
                           λ
                           )
                        
                     is calculated analytically by
                        
                           (31)
                           
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    +
                                    (
                                    2
                                    
                                       
                                          λ
                                       
                                       
                                          c
                                       
                                    
                                    -
                                    1
                                    )
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     which is a minimizer of 
                        
                           p
                           (
                           λ
                           )
                        
                     , if 
                        
                           f
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           )
                           ≥
                           f
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                        
                     . Finally, the next candidate for the step length (denoted here by 
                        
                           
                              
                                 λ
                              
                              
                                 ±
                              
                           
                        
                     ) is computed by
                        
                           (32)
                           
                              
                                 
                                    λ
                                 
                                 
                                    ±
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                <
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                >
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Given an interval [σ
                     0,
                     σ
                     1], the first two terms shown in Eq. (32) are safeguards that guarantee that 
                        
                           
                              
                                 λ
                              
                              
                                 ±
                              
                           
                        
                      is always of the form 
                        
                           
                              
                                 λ
                              
                              
                                 ±
                              
                           
                           =
                           σ
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                        
                     , for some σ
                     ∊[σ
                     0,
                     σ
                     1]. This process is repeated until the step length defined in Eq. (32) satisfies the condition stated in Eq. (29).

More recently, Cheng and Li [6] improved the performance of the DFSANE. For this, these authors exchanged the condition shown in Eq. (29), using one that has proven more suitable for the nonmonotone derivative-free linear search associated with globalization step of this algorithm. This condition, which is also derivative-free, is given by
                        
                           (33)
                           
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              )
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    ∊
                                 
                                 
                                    k
                                 
                              
                              -
                              γ
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     where C
                     0
                     =
                     f(x
                     0), and, for k
                     ⩾1, Ck
                      is updated by the following rules:
                        
                           (34)
                           
                              
                                 
                                    Q
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              +
                              1
                              ,
                           
                        
                     
                     
                        
                           (35)
                           
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          ∊
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    +
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ,
                           
                        
                     with Q
                     0
                     =1 and βk
                     
                     ∊[0,1], for all k.

During the development of this work, we had the opportunity to note that sometimes the original condition described in Eq. (29), which depends on the choice of the integer M, proved inadequate to solve the pressure equation (Eq. (15)), especially when N was chosen to be relatively large. Thus, in this work we chose to use the nonmonotone linear search determined by Eqs. (33)–(35).

Algorithm 2, in Fig. 2
                     , describes in detail the steps of the DFSANE, which are essentially those described in [17] together with the changes proposed in [6]. We consider 
                        
                           γ
                           =
                           
                              
                                 10
                              
                              
                                 -
                                 4
                              
                           
                           ,
                           
                              
                                 ∈
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 ‖
                                 F
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ‖
                                 )
                              
                              
                                 
                                    
                                       (
                                       1
                                       -
                                       k
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      and βk
                     
                     =0.85, for all k
                     ⩾0, [6,17]. In Step 6 of Algorithm 2, it can be seen a practical procedure used to prevent that the magnitude of the spectral coefficient becomes too large or too small.

It can be shown that the nonlinear system of interest in this work has (in each iteration) a Jacobian which is symmetric and diagonally dominant. Thus the matrix F
                     ′(xk
                     ) is always symmetric and positive definite. Consequently, we have ∇f(xk
                     )
                        Tdk
                     
                     =−2F(xk
                     )
                        TF
                     ′(xk
                     )F(xk
                     )<0, if ‖F(xk
                     ‖)≠0. In this case there is no need to employ the alternative direction given by dk
                     
                     =
                     F(xk
                     ), because it will never be selected. Therefore, Steps 3 and 4 of the DFSANE algorithm effectively used here have the simplest shapes shown below:
                        
                           
                              
                              
                                 
                                    
                                       Step 3. Set dk
                                       
                                       =−(1/αk
                                       )F(
                                          k
                                       ), 
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             1
                                          
                                        and 
                                          
                                             
                                                
                                                   ∈
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   ‖
                                                   F
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   ‖
                                                
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         -
                                                         k
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       Step 4. If 
                                          
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   +
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ⩽
                                             
                                                
                                                   C
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   ∈
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             γ
                                             
                                                
                                                   λ
                                                
                                                
                                                   +
                                                
                                                
                                                   2
                                                
                                             
                                             f
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             
                                             then
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             Set
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   λ
                                                
                                                
                                                   +
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       else, set
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   f
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   f
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   +
                                                   (
                                                   2
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                   f
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             λ
                                             +
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ,
                                                               
                                                               if
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               <
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ,
                                                               
                                                               if
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               >
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ,
                                                               otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       and go to Step 4.
                                 
                                 
                                    
                                       end-if.
                                 
                              
                           
                        
                     
                  

It can be seen that the DFSANE is a genuinely spectral method. In fact, from a Taylor series expansion with integral remainder, we can write [9],
                        
                           (36)
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              F
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              )
                              -
                              F
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             td
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       dt
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                     Since 
                        
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           -
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        
                     , then we have
                        
                           (37)
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             td
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       dt
                                    
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              .
                           
                        
                     Using Eq. (37) we obtain
                        
                           (38)
                           
                              
                                 
                                    α
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   td
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             dt
                                          
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                              for all
                              
                              k
                              ⩾
                              0
                              .
                           
                        
                     Thus, the spectral coefficient of the DFSANE method is a Rayleigh quotient associated with the matrix 
                        
                           
                              ∫
                              
                                 0
                              
                              
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              
                                 F
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 td
                              
                              
                                 k
                              
                           
                           )
                           dt
                        
                     , which represents an average of the values of the Jacobian F
                     ′(xk
                     
                     +
                     tdk
                     ) taken when t varies in the range 
                        
                           [
                           0
                           ,
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           ]
                        
                     . So if sk
                     
                     +1 approaches an eigenvector of 
                        
                           
                              ∫
                              
                                 0
                              
                              
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              
                                 F
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 td
                              
                              
                                 k
                              
                           
                           )
                           dt
                        
                     , then spectral coefficient of the DFSANE method approaches an eigenvalue of this matrix.

@&#RESULTS@&#

In this section, we study the performance of the DFSANE in the simulation of compressible fluid flows in porous media, which will be compared to the performance of an inexact Newton–Krylov method [15]. Inexact Newton methods are a class of efficient methods, where (at each iteration) the linear system shown in Eq. (22) is solved only approximately, from an iterative method [10]. Thus, this approach provides two iterative processes, an external process and other internal, with nonlinear iterations on the outside process, and linear iterations on the inside. The balance of the computational effort expended between these two iterative processes is the key to the success of an inexact Newton method. This issue has been resolved with the formulation of the calls sequences of the forcing terms [13], which are essentially dynamic tolerances for the stopping criterion of the iterative method used to solve the linear systems, whose approximate solutions are generally computed by Krylov methods [15]. The convergence of an inexact Newton method can depend on the location of the starting point. To overcome this problem, such methods are commonly equipped with globalization strategies [12]. The steps of the inexact Newton method used here are described in detail in Algorithm A.1, see Appendix. As the Jacobian matrix associated with the pressure equation (Eq. (15)) is symmetric and positive definite, then to solve the linear systems, in Algorithm A.1 we use the conjugate gradient method, which can be regarded as an iterative method on a Krylov space [15]. In the globalization step, Algorithm A.1 uses a monotone linear search based on a sufficient decrease condition previously considered in [15], which also makes use of a backtracking strategy with a two-point parabolic model. Each step of the conjugate gradient method requires the action of a Jacobian on a vector. As shown in Step 4 of Algorithm A.1, this matrix–vector multiplication is not performed. In fact, only the effect of the Jacobian matrix on the referred vector is effectively approximated by a difference quotient [15]. Thus, Algorithm A.1 describes a Jacobian-free Newton method. Consequently, here we compare the results of DFSANE to results obtained by a well-developed Inexact Newton–Conjugate-Gradient (IN/CG) globalized method, a powerful tool for solving large-scale nonlinear systems. In the Algorithms 2 and A.1, we use the same stopping criteria. Furthermore, we also require that these algorithms stop only after executing, at least, one iteration. In a given time level, the initial guess for pressure field, required by both algorithms, is the pressure field on the level of time immediately preceding.

In what follows, we consider three different examples. In all, the rectangular porous material Ω is discretized using a grid with 100×100 blocks, where Δx
                        =Δy
                        =0.1m, resulting in a porous medium with 100 square meters. The time step used is Δt
                        =100s, which was selected after intensive computational tests. The fluid displacement processes are studied between one injection well and one production well, where the alignment of the injector-producer pair is described by the called five-spot pattern. In this pattern, the injection well is located in a block at one of the corners of Ω, while the production well is located in the corner block diametrically opposed to the injection well. The porous medium has porosity ϕ
                        =0.2 and permeability k
                        =0.04935μm2. In the injection well, we consider w(t)=1 and Q(t)=2.0×10−7
                        m3/s, for all t
                        ⩾0. At all points in the porous medium, the pressure at time t
                        =0 is equal to 30.3975×105
                        Pa, and (with the exception of the injection point) at this initial moment the mass fraction of the invading fluid is considered zero. For the equation of state, we consider ρref
                        
                        =9.0×102
                        kg/m3, Pref
                        
                        =1.0133×105
                        Pa, and cf
                        
                        =0.9869×10−12
                        Pa−1. For the well model (Eq. (18)), we assume rw
                        
                        =5.0×10−3
                        m, Pw
                        
                        =20.265×105
                        Pa, and h
                        =0.1m.

The values of μi
                         and μr
                         (the viscosities of the invading and resident fluids), and of the parameters dM
                        , αL
                         and αT
                        , required by the model used for the diffusion–dispersion tensor, will vary according to the examples treated here.

All the numerical results in this work were obtained using a computer equipped with 2 Intel Xeon E5-2420 Hexa-Core processors, with 1.9GHz and 10MB Cache LGA. Our codes were implemented in the FORTRAN 77 language, using the software Intel Parallel Studio XE 2013.

In this example, we assume a purely advective flow, where the coefficient of molecular diffusion (dM
                        ), and the transverse and longitudinal dispersivities of the invading fluid (αT
                         and αL
                        ) are considered zero. The viscosities of the invading and resident fluids are equal, being given by μi
                        
                        =
                        μr
                        
                        =1.0×10−3
                        kgm−1
                        s−1.

For either method (DFSANE and IN/CG), Table 1
                         shows the total number of evaluations of F (NE), CPU time, total number of iterations (NI), total number of globalization steps (NGS) and the final value of ||F|| at the last time step. These quantifiers shown in Table 1 were measured for 10 different moments, which are in a period of time ranging from 30min to 10days of injection.

From the results shown in Table 1, we can state that, despite of the DFSANE require a larger number of iterations, in general this method performs a lower number of evaluations of F compared to IN/CG. Consequently the DFSANE generally consumes less CPU time, being the most efficient for the simulation of compressible miscible flows in porous media. Furthermore, we note that the IN/CG is more accurate than the DFSANE, what is expected, since Newton methods may exhibit asymptotic quadratic convergence. It should also be noted that for the size of the time step used, the IN/CG method did not need to make use of its globalization strategy, this did not occur with DFSANE, which held at the beginning of the simulation (up to 30min of injection) a total of 47 steps of globalization. This total remained constant up to 10days of injection. It may be noted that, although efficient, the DFSANE requires at the beginning of the simulation (within 1h of injection) greater computational effort, indicated by the first two CPU times shown in Table 1.

The results of the simulations using the DFSANE are shown in Fig. 3
                        . This figure illustrates the surface of the function w(x,
                        y,
                        t), its contours and the pressure field of the flow, respectively, for two different instants of injection, 5days and 10days. Observing Fig. 3, under the conditions considered in this example, we note that (for this purely advective flow) the graphs of w does not exhibit spurious oscillations or excessive artificial numerical dispersions.

Finally, for this first example, we note that, with the computational equipment used here, the simulation of 10days of injection consumed around 30.63min of CPU time for the DFSANE, and 32.80min for the NIN/CG.

In this second example, we assume an advective–diffusive flow, where the coefficient of molecular diffusion is dM
                        
                        =1.0×10−5
                        m2/s and αL
                        
                        =
                        αT
                        
                        =0.0m.

Again, the viscosities of the invading and resident fluids are equal, being given by μi
                        
                        =
                        μr
                        
                        =1.0×10−3
                        kgm−1
                        s−1.

For this example, the performance quantifiers are essentially the same as shown in Table 1. Again, although the DFSANE performs the largest number of iterations per time step, in this example the DFSANE also proved to be the most efficient, having consumed the lowest CPU time. However, this time, the higher efficiency of the DFSANE was established only after 6h of injection. This fact confirms once more that, for relatively small injection times, the IN/CG can be (in some cases) the method selected for the simulation of the compressible flow in porous media. However, we note that, to simulate 10h of injection, the IN/CG consumed about 33.1min of CPU time, whereas the DFSANE used about 30.7min. We can also notice that the IN/CG did not use steps of globalization, while the DFSANE required 47 of these steps, which were used to simulate the first hour of injection. As before, the IN/CG presented higher accuracy.

For this advective–diffusive flow, the results of the simulations using the DFSANE are shown in Fig. 4
                        , for two different instants of injection, 5days and 10days. Unlike the geometric aspects shown in Fig. 3, observing Fig. 4 we can now notice a significant smoothing of the surface of w(x,
                        y,
                        t), typical of the phenomenon of molecular diffusion considered in the present example.

In this third example, we assume that the flow has large adverse mobility ratio, which is characterized by a significant difference between the values of viscosities: μi
                        
                        =1.0×10−3
                        kgm−1
                        s−1 and μr
                        
                        =8.0×10−2
                        kgm−1
                        s−1. The transverse and longitudinal dispersivities of the invading fluid have the values αT
                        
                        =5.0×10−2
                        m and αL
                        
                        =5.0×10−3
                        m, respectively. The coefficient of molecular diffusion (dM
                        ) is considered zero.

The performances of the two methods for this latter example are described in Table 2
                        , for different time intervals, with a maximum of 10days of injection. The DFSANE consumed less CPU time, while performing the highest number of iterations, being again the method more efficient. Unlike the previous cases, in this example with adverse mobility ratio, the DFSANE was more efficient than the IN/CG at all times considered in Table 2. To simulate 10h of injection, the IN/CG consumed about 36min of CPU time, while the DFSANE used about 32.7min, a difference of 3.3min of computing time. Again the IN/CG did not need to perform globalization steps. While, to simulate the first hour of injection, the DFSANE held 28 of these steps, and 8 further steps until the second hour of injection.

The results for this flow with adverse mobility ratio using the DFSANE are shown in Fig. 5
                        , for the instants of injection of 2days and 5days, and in Fig. 6
                         for 8days and 10days of injection.

In practice, flows in porous media under adverse mobility ratio tend to exhibit hydrodynamic instability, where part of the invading fluid may advance through the porous medium at velocities much higher than those of the average front, [3]. Although this example considers a flow with adverse mobility ratio (μr
                        /μi
                        
                        =80), we can note that the results shown in Figs. 5 and 6 did not exhibit any effect of this instability phenomenon. As is well known, due to truncation and round-off errors, the capture of the effects of hydrodynamic instabilities in numerical simulations is usually an unsuccessful task. However, there are some approaches that can help to overcome this problem. For example, for a homogeneous porous medium, as used in this work, to observe the effects of a such instability is customary to introduce perturbations in the front at instant t
                        =0. For this, as shown in Fig. 7
                        , here we change the initial conditions for the concentration equation, introducing variations in these conditions over three diagonal of the grid, in a neighborhood of the injection well. These variations correspond to the disturbances caused by fluid inlet conditions in the homogeneous medium. Using these disturbance conditions and considering αT
                        
                        =
                        αL
                        
                        =
                        dM
                        
                        =0, Fig. 8
                         shows results obtained with two different mobility ratios, μr
                        /μi
                        
                        =1 and μr
                        /μi
                        
                        =80, after 10days of injection. As shown in Fig. 8a, the flow with the mobility ratio equal to 1 does not propagate these initial disturbances. In fact, we can notice that (after 10days) the contours of mass fraction shown in Fig. 8a are essentially equal those presented previously in Fig. 3b, where there is no disturbances. On the other hand, as shown in Fig. 8b, the flow that has adverse mobility ratio (μr
                        /μi
                        
                        =80) displays the effects of the phenomenon of hydrodynamic instability, which started during the initial moments of the injection process.

@&#CONCLUSIONS@&#

The DFSANE constitutes a Jacobian-free approach recently developed for solving large-scale nonlinear systems, which does not solve linear systems and nor use any explicit information associated with the Jacobin matrix. In this work, we have applied the DFSANE method to solve the discretized form of the pressure equation, a nonlinear partial differential equation which governs the distribution of the pressure field in the simulation of miscible compressible flows in porous media with point sources and sinks, where the density of the fluid mixture varies exponentially with the pressure. Here, the discretized forms of this differential equation have given rise to non-linear systems with ten thousand variables which have been addressed several times, over many time steps of the considered transient processes. Using a flow pattern of the type five-spot on two-dimensional geometries, we have simulated three different displacements of compressible fluids, including a flow with highly adverse mobility ratio, where the viscosity of the resident fluid is significantly higher than that of the invading fluid. We have compared the performance of the DFSANE to a well-developed Jacobian-free inexact Newton method, in time intervals up to 10h of injection of the invading fluid. In all tests, the DFSANE was able to simulate such process using the lowest CPU time, without introducing non-physical phenomena to numerical solutions.

Thus, we conclude that the o DEFSANE is a reliable and efficient method for simulation of compressible flows in porous media.

@&#ACKNOWLEDGEMENTS@&#

N.H. and W.F.S. gratefully acknowledge the financial support provided by CNPq (Conselho Nacional de Desenvolvimento Científico e Tecnológico, Ministry of Science & Technology, Brazil). G.S. was supported by CAPES (Coordenação de Aperfeiçoamento de Pessoal de Nível Superior, Brazil). The research by N.H. has been carried out in the framework of project PROCIENCIA-UERJ financed by FAPERJ.


                     
                        
                           
                              
                              
                                 
                                    
                                       Algorithm A.1. IN/CG
                                 
                                 
                                    Data: 
                                          
                                             N
                                             ∈
                                             N
                                          
                                       , 
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       , ea
                                       
                                       =10−5, er
                                       
                                       =10−4, γ
                                       =0.9, ηmax
                                       
                                       =0.9999, α
                                       =10−4, σ
                                       0
                                       =0.1, σ
                                       1
                                       =0.5 and δ
                                       =10−7.
                                 
                                 
                                    Step 1: Set k
                                       =0, 
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   e
                                                
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   N
                                                
                                             
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   r
                                                
                                             
                                             ‖
                                             F
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             ‖
                                          
                                       .
                                 
                                 
                                    Step 2: If ‖
                                          
                                             ‖
                                             F
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ‖
                                             ⩽
                                             
                                                
                                                   τ
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       then stop,
                                 
                                 
                                    
                                       else,
                                 
                                 
                                    
                                       
                                       set g(0)=||F(xk
                                       )||2,
                                 
                                 
                                    
                                       end-if.
                                 
                                 
                                    Step 3: (Forcing term)
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                
                                                
                                                   C
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     max
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               k
                                                               =
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               min
                                                               (
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     max
                                                                  
                                                               
                                                               ,
                                                               γ
                                                               
                                                                  
                                                                     F
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     F
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 k
                                                                                 -
                                                                                 1
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               k
                                                               >
                                                               0
                                                               
                                                               and
                                                               
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     k
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               <
                                                               0.1
                                                            
                                                         
                                                         
                                                            
                                                               min
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              η
                                                                           
                                                                           
                                                                              max
                                                                           
                                                                        
                                                                        ,
                                                                        max
                                                                        
                                                                           
                                                                              
                                                                                 γ
                                                                                 
                                                                                    
                                                                                       ‖
                                                                                       F
                                                                                       (
                                                                                       
                                                                                          
                                                                                             x
                                                                                          
                                                                                          
                                                                                             k
                                                                                          
                                                                                       
                                                                                       )
                                                                                       
                                                                                          
                                                                                             ‖
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       F
                                                                                       
                                                                                          
                                                                                             (
                                                                                             
                                                                                                
                                                                                                   x
                                                                                                
                                                                                                
                                                                                                   k
                                                                                                   -
                                                                                                   1
                                                                                                
                                                                                             
                                                                                             )
                                                                                          
                                                                                          
                                                                                             2
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 ,
                                                                                 γ
                                                                                 
                                                                                    
                                                                                       η
                                                                                    
                                                                                    
                                                                                       k
                                                                                       -
                                                                                       1
                                                                                    
                                                                                    
                                                                                       2
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               k
                                                               >
                                                               0
                                                               
                                                               and
                                                               
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     k
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               >
                                                               0.1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             min
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   max
                                                
                                             
                                             ,max
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                
                                                
                                                   C
                                                
                                             
                                             ,
                                             0.5
                                             
                                                
                                                   τ
                                                
                                                
                                                   t
                                                
                                             
                                             /
                                             ‖
                                             F
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ‖
                                             )
                                             )
                                          
                                       .
                                 
                                 
                                    Step 4: (Conjugate gradient iterations)
                                 
                                 
                                    
                                       
                                       rk
                                       
                                       =−F(xk
                                       ),
                                 
                                 
                                    
                                       
                                       ϱ
                                       0
                                       =||rk
                                       ||2,
                                 
                                 
                                    
                                       
                                       i
                                       =1,
                                 
                                 
                                    
                                       while ||rk
                                       ||>
                                       ηk
                                       ||F(xk
                                       )||, set
                                 
                                 
                                    
                                       
                                       if i
                                       =1, set s
                                       =
                                       rk
                                       ,
                                 
                                 
                                    
                                       
                                       else, set β
                                       =
                                       ϱi
                                       
                                       −1/ϱi
                                       
                                       −2 and s
                                       =
                                       rk
                                       
                                       +
                                       βs,
                                 
                                 
                                    
                                       
                                       end-if,
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             ω
                                             =
                                             
                                                
                                                   F
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   δ
                                                   s
                                                   )
                                                   -
                                                   F
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   δ
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             φ
                                             =
                                             
                                                
                                                   
                                                      
                                                         ϱ
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ω
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       
                                       dk
                                       
                                       =
                                       dk
                                       
                                       +
                                       φs,
                                 
                                 
                                    
                                       
                                       
                                       rk
                                       
                                       =
                                       rk
                                       
                                       −
                                       φω,
                                 
                                 
                                    
                                       
                                       
                                       ϱi
                                       
                                       =||rk
                                       ||2,
                                 
                                 
                                    
                                       
                                       
                                       i
                                       =
                                       i
                                       +1,
                                 
                                 
                                    
                                       end-while.
                                 
                                 
                                    Step 5: Set g
                                       ′(0)=−2g(0)−2F(xk
                                       )
                                          Trk
                                       .
                                 
                                 
                                    Step 6: Set 
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             1
                                          
                                       .
                                 
                                 
                                    Step 7: Set 
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       .
                                 
                                 
                                    Step 8: (Monotone linear search)
                                 
                                 
                                    
                                       If ||F(xk
                                       )||<(1−
                                       α)||F(xk
                                       )||, then
                                 
                                 
                                    
                                       set xk
                                       
                                       +1
                                       =
                                       xt
                                       , k
                                       =
                                       k
                                       +1 and go to Step 2,
                                 
                                 
                                    
                                       else, set
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             g
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             =
                                             ‖
                                             F
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   -
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                   (
                                                   g
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   -
                                                   g
                                                   (
                                                   0
                                                   )
                                                   -
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       ,
                                 
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               <
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               >
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               otherwise,
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       and go to Step 6,
                                 
                                 
                                    end-if.
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

