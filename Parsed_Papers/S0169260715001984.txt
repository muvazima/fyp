@&#MAIN-TITLE@&#Improved Fuzzy C-Means based Particle Swarm Optimization (PSO) initialization and outlier rejection with level set methods for MR brain image segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New image segmentation method based on PSO and outlier rejection with level set.


                        
                        
                           
                           The use of PSO algorithm allows an optimal choice of cluster centers.


                        
                        
                           
                           IKPCM lead to a fine segmentation using the level set method.


                        
                        
                           
                           IKPCM shows a significant improvement concerning the robustness to noise.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image segmentation

Outlier rejection

FCM

PSO

Spatial fuzzy clustering

Level set

@&#ABSTRACT@&#


               
               
                  In this paper, a new image segmentation method based on Particle Swarm Optimization (PSO) and outlier rejection combined with level set is proposed. A traditional approach to the segmentation of Magnetic Resonance (MR) images is the Fuzzy C-Means (FCM) clustering algorithm. The membership function of this conventional algorithm is sensitive to the outlier and does not integrate the spatial information in the image. The algorithm is very sensitive to noise and in-homogeneities in the image, moreover, it depends on cluster centers initialization. To improve the outlier rejection and to reduce the noise sensitivity of conventional FCM clustering algorithm, a novel extended FCM algorithm for image segmentation is presented. In general, in the FCM algorithm the initial cluster centers are chosen randomly, with the help of PSO algorithm the clusters centers are chosen optimally. Our algorithm takes also into consideration the spatial neighborhood information. These a priori are used in the cost function to be optimized. For MR images, the resulting fuzzy clustering is used to set the initial level set contour. The results confirm the effectiveness of the proposed algorithm.
               
            

@&#INTRODUCTION@&#

Magnetic Resonance Imaging (MRI) is widely used for the diagnosis of various diseases [1,2]. Several classification techniques are used for brain MR image segmentation among the most well known: thresholding [3] and edge detection [4]. Noise affects the performance of these techniques and thus, leads to incorrect boundaries detection and under or over-segmentation. These image segmentation methods have led to region growing algorithms by considering the homogeneity and connectivity criteria [5]. Region growing algorithms can robustly identify only well-defined regions. Knowing that the above-mentioned techniques are generally used for relatively simple structures, clustering methods are applied for complex data. In clustering, we use homogeneity criteria for grouping data. Fuzzy C-Means (FCM) algorithm [6,7] is the typical clustering method used in image segmentation.

Many modifications of the FCM algorithm have been proposed such as kernel possibilistic c-means (KPCM) [8], intuitionistic FCM [9]. To alleviate the effects of noise, we can cite noisy clustering (NC) [10], FCM with spatial constraints [11], FCM_S1 [12], robust FCM (RFCM) [7] and outlier rejection FCM (ORFCM) [13]. Many researchers proposed to use metaheuristics for optimizing the FCM parameters by means of genetic algorithm [14], Particle Swarm Optimization (PSO) [15]. All these algorithms suffer from the cluster centers initialization problem. Bad initialization can lead to a locally optimum solution. To overcome this problem, Zhang et al. [16] proposed to use PSO algorithm to initialize the cluster centers.

The proposed improved algorithm (IKPCM), inspired by the KPCM clustering algorithm, takes into account many sides (initialization step, distance metric, spatial information and outlier rejection) unlike the existing methods. In the existing literature, the improvement of FCM algorithm applied to image segmentation concerns generally only one side, which is often not enough to yield satisfactory results. Therefore, in our method, we integrate, in a single algorithm, several improvements that we deem to be relevant. Experimental results show that the proposed method gives better segmentation results. For medical images, the clusters boundaries found by the use of IKPCM are used as initial contours for the level set.

This paper is organized as follows; Section 2 is a background concept of the FCM and its limitations. The implementation of the proposed algorithm is described in Section 3. In Section 4, we present the performance of the proposed algorithm using synthetic images, simulated and real MR brain images. Finally, a conclusion and future works are given in Section 5.

@&#BACKGROUND@&#

The FCM clustering algorithm was first introduced by Dunn [17] and then extended by Bezdek [18,19]. Let X
                        =
                        {x
                        
                           i
                        
                        } an image, i
                        ={1,2,3,….} where x
                        
                           i
                         are the pixels of X and n is the total number of pixels.

The FCM algorithm minimizes the objective function [18]:


                        
                           
                              (1)
                              
                                 
                                    
                                       J
                                       
                                          F
                                          C
                                          M
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                k
                                             
                                             m
                                          
                                          
                                             d
                                             2
                                          
                                          (
                                          
                                             x
                                             k
                                          
                                          ,
                                          
                                             V
                                             i
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        where μ
                        
                           ik
                         is the membership function matrix, d the Euclidian distance metric between x
                        
                           j
                         and the cluster center V
                        
                           i
                         and m the degree of fuzziness (m
                        >1).

The membership function μ
                        
                           ik
                         is the heart of the FCM where the membership degrees are given by:
                           
                              (2)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   /
                                                   
                                                      d
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                   /
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The cluster centers are:
                           
                              (3)
                              
                                 
                                    
                                       V
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             
                                                x
                                                k
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The choice of a metric in clustering problems is crucial. The Euclidean distance metric is widely used because of its simplicity, the hypothesis that the data are uncorrelated and the clusters have super spherical shapes. Which is not true in image segmentation; therefore, the Mahalanobis distance is more suitable.

In KFCM, the Euclidian distance in FCM is generalized as [20]:
                           
                              (4)
                              
                                 
                                    d
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          Φ
                                          (
                                          x
                                          )
                                          −
                                          Φ
                                          (
                                          y
                                          )
                                       
                                    
                                 
                              
                           
                        where Φ is a nonlinear function. For a Gaussian kernel:
                           
                              (5)
                              
                                 
                                    K
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    exp
                                    (
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      −
                                                      y
                                                   
                                                
                                             
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                             2
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

Eq. (4) becomes
                           
                              (6)
                              
                                 
                                    d
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          K
                                          (
                                          x
                                          ,
                                          x
                                          )
                                          −
                                          2
                                          K
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          K
                                          (
                                          y
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The KFCM objective function is then:
                           
                              (7)
                              
                                 
                                    
                                       J
                                       
                                          KFCM
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      k
                                                   
                                                   m
                                                
                                                
                                                   
                                                      Φ
                                                      (
                                                      
                                                         x
                                                         k
                                                      
                                                      )
                                                      −
                                                      Φ
                                                      (
                                                      
                                                         V
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       J
                                       
                                          KFCM
                                       
                                    
                                    =
                                    2
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                k
                                             
                                             m
                                          
                                          (
                                          1
                                          −
                                          K
                                          (
                                          
                                             x
                                             k
                                          
                                          ,
                                          
                                             V
                                             i
                                          
                                          )
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The membership degrees become
                           
                              (9)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                K
                                                (
                                                
                                                   x
                                                   k
                                                
                                                ,
                                                
                                                   V
                                                   i
                                                
                                                )
                                                )
                                             
                                             
                                                (
                                                −
                                                1
                                                )
                                                /
                                                (
                                                m
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   K
                                                   (
                                                   
                                                      x
                                                      k
                                                   
                                                   ,
                                                   
                                                      V
                                                      j
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                   /
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The cluster centers are now:
                           
                              (10)
                              
                                 
                                    
                                       V
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             K
                                             (
                                             
                                                x
                                                k
                                             
                                             ,
                                             
                                                V
                                                i
                                             
                                             )
                                             
                                                x
                                                k
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             K
                                             (
                                             
                                                x
                                                k
                                             
                                             ,
                                             
                                                V
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Kernel possibilistic clustering algorithm (KPCM) is considered to overcome the problem of robustness against noise, outliers, and arbitrarily shaped clusters boundaries.

Krishnapuram and Keller [21] proposed the following objective function:
                           
                              (11)
                              
                                 
                                    
                                       J
                                       
                                          P
                                          C
                                          M
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                k
                                             
                                             m
                                          
                                          
                                             d
                                             2
                                          
                                          (
                                          
                                             x
                                             k
                                          
                                          ,
                                          
                                             V
                                             i
                                          
                                          )
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                η
                                                i
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         μ
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where d is the Mahalanobis distance:
                           
                              (12)
                              
                                 
                                    
                                       d
                                       2
                                    
                                    (
                                    
                                       x
                                       k
                                    
                                    ,
                                    
                                       V
                                       i
                                    
                                    )
                                    =
                                    
                                       
                                          (
                                          
                                             x
                                             k
                                          
                                          −
                                          
                                             V
                                             i
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       S
                                       i
                                    
                                    (
                                    
                                       x
                                       k
                                    
                                    −
                                    
                                       V
                                       i
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       S
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   i
                                                
                                                 
                                             
                                          
                                       
                                       
                                          
                                             1
                                             p
                                          
                                       
                                    
                                    
                                       ∑
                                       1
                                       
                                          −
                                          1
                                       
                                    
                                     
                                 
                              
                           
                        
                        p
                        =1, the problem dimension and η
                        
                           i
                         are positive numbers.

The first term of Eq. (11) advocates for a minimum distance between data points and prototypes, the μ
                        
                           ik
                         must be as large as possible. The η
                        
                           i
                         are chosen as:
                           
                              (14)
                              
                                 
                                    
                                       η
                                       i
                                    
                                    =
                                    K
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            k
                                                         
                                                         −
                                                         
                                                            V
                                                            i
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        K is chosen to be 1, and the memberships of PCM are updated as:
                           
                              (15)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          1
                                          +
                                          
                                             
                                                (
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               k
                                                            
                                                            −
                                                            
                                                               V
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                                )
                                                /
                                                (
                                                
                                                   η
                                                   i
                                                
                                                )
                                                )
                                             
                                             
                                                (
                                                1
                                                )
                                                /
                                                (
                                                m
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function of KPCM is:
                           
                              (16)
                              
                                 
                                    
                                       J
                                       
                                          K
                                          P
                                          C
                                          M
                                       
                                    
                                    (
                                    U
                                    ,
                                    V
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                k
                                             
                                             m
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      (
                                                      
                                                         x
                                                         k
                                                      
                                                      )
                                                      −
                                                      Φ
                                                      (
                                                      
                                                         V
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                η
                                                i
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         μ
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As in KFCM, Eq. (6) is considered. The updating of the memberships is then:
                           
                              (17)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            2
                                                            (
                                                            1
                                                            −
                                                            K
                                                            (
                                                            
                                                               x
                                                               k
                                                            
                                                            ,
                                                            
                                                               V
                                                               i
                                                            
                                                            )
                                                            )
                                                         
                                                         
                                                            
                                                               η
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                                /
                                                (
                                                m
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We use a Gaussian function as the kernel function, and η
                        
                           i
                         are estimated using
                           
                              (18)
                              
                                 
                                    
                                       η
                                       i
                                    
                                    =
                                    K
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             2
                                             (
                                             1
                                             −
                                             K
                                             (
                                             
                                                x
                                                k
                                             
                                             ,
                                             
                                                V
                                                i
                                             
                                             )
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Typically, K is chosen to be 1. We summarize the KPCM algorithm as:
                           
                              
                                 
                                 
                                    
                                       
                                          Algorithm 1: KPCM Implementation
                                    
                                    
                                       • Step 1:
                                       
                                    
                                    
                                       
                                           Initialize (c: number of class, m
                                          >1: degree of fuzziness, ɛ: stopping criterion.)
                                    
                                    
                                       •Step 2: Initialize Ut
                                          =0 using random values
                                    
                                    
                                       •Step 3: Estimate η
                                          
                                             i
                                          , Eq. (18)
                                       
                                    
                                    
                                       •Step 4:
                                       
                                    
                                    
                                       
                                          a. Update Vt, Eq. (10)
                                       
                                    
                                    
                                       
                                          b. Update Ut, Eq. (17)
                                       
                                    
                                    
                                       
                                          c. If 
                                             
                                                
                                                   
                                                      
                                                         J
                                                         
                                                            K
                                                            P
                                                            C
                                                            M
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         J
                                                         
                                                            K
                                                            P
                                                            C
                                                            M
                                                         
                                                         t
                                                      
                                                   
                                                
                                                <
                                                ε
                                             
                                           stop, else return to step 3
                                       
                                    
                                 
                              
                           
                        
                     

All these algorithms suffer from the problems of initialization step, distance metric, spatial information and outlier rejection. We propose to take into account all these aspects in a single algorithm.

In this section, we propose to modify the algorithm (KPCM) by considering the fuzzy partition matrix, pixel's spatial information and the initialization cluster centers. The proposed segmentation method is described in these steps:
                           
                              1.
                              Initialization of cluster centers and membership using PSO algorithm.

The membership function of the KPCM algorithm is modified by considering outlier rejection.

Spatial information is taken care of by using a square window around the current pixel.

Using level set to finalize the segmentation.

For the initialization step, a PSO is used to initialize the cluster centers and membership function. Kennedy and Eberhart [22,23] proposed a population based stochastic optimization algorithm inspired by fish schooling and bird flocking.

The following equations govern the evolution of the swarm:
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                =
                                             
                                          
                                          
                                             
                                                w
                                                
                                                   V
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                +
                                                
                                                   c
                                                   1
                                                
                                                
                                                      rand
                                                   1
                                                
                                                (
                                                
                                                   pbest
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                −
                                                
                                                   X
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                              
                                          
                                          
                                             
                                                 
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                      rand
                                                   2
                                                
                                                (
                                                
                                                   gbest
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                −
                                                
                                                   X
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       X
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       V
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    
                                       X
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

X, V, pbest are respectively the position, the velocity and the best position of the particle. gbest is the global best position of the swarm. rand1 and rand2 are random values between 0 and 1.

The values used for the parameters of Eq. (19) are given in Table 1
                        . The values of c
                        1 and c
                        2 are those recommended by Trelea [24]. The inertia weight w is adapted over the PSO iterations; this parameter varies linearly from 0.9 to 0.4 for nb
                        
                           maxiter
                         iterations. A high starting value of this parameter promotes diversification (exploration). A decrease of this value favors intensification (exploitation). This scenario, often used in metaheuristics, allows an optimization of the results by regulating the balance between exploration and exploitation of the search space. Tests show that these values insure a faster convergence of the algorithm.

For the stopping conditions, we used two criteria:

A maximum number of iterations nb
                        
                           maxiter
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∀
                                                k
                                                ∈
                                                [
                                                0
                                                ,
                                                n
                                                
                                                   b
                                                   
                                                      max
                                                      i
                                                      t
                                                      e
                                                      r
                                                   
                                                
                                                ]
                                                ,
                                                ∀
                                                n
                                                ∈
                                                [
                                                k
                                                ,
                                                k
                                                +
                                                n
                                                
                                                   b
                                                   
                                                      e
                                                      r
                                                      p
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                      (
                                                      n
                                                      +
                                                      1
                                                      )
                                                      −
                                                      J
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                <
                                                Eps
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The initialization algorithm using PSO is given by:
                           
                              
                                 
                                 
                                    
                                       
                                          Algorithm 2: Clustering initialization using PSO
                                    
                                    
                                       •Step 1:
                                       
                                    
                                    
                                       
                                          
                                          Initialize (c: number of class, m
                                          >1: degree of fuzziness, PSO parameters using Table 1).
                                    
                                    
                                       
                                          
                                          Initialize randomly position (V
                                          (0)
                                          i) and velocity of each particle.
                                    
                                    
                                       •Step 2:
                                       
                                    
                                    
                                       Compute the membership degrees (u
                                          
                                             (0)
                                          
                                          
                                             ik
                                          ) by Eq. (17) using the Euclidean distance.
                                    
                                    
                                       
                                          For p=1 to nbmaxiter 
                                          do
                                       
                                    
                                    
                                       
                                          
                                          For each particle do
                                       
                                    
                                    
                                       •Compute the Mahalanobis distance U(p−1) in Eqs. (12) and (13).
                                    
                                    
                                       •Compute U(p), Eq. (17).
                                    
                                    
                                       •Compute the fitness function based on the Mahalanobis distance.
                                    
                                    
                                       •Update the individual best solution pbest and find the global best solution gbest.
                                    
                                    
                                       •Compute the particle velocity and position Eq. (19) and (20).
                                    
                                    
                                       
                                          End for
                                       
                                    
                                    
                                       
                                          
                                          If condition (21) 
                                          then
                                       
                                    
                                    
                                       
                                          Goto step 3
                                       
                                    
                                    
                                       
                                          End if
                                       
                                    
                                    
                                       
                                          End for
                                       
                                    
                                    
                                       •Step 3:
                                       
                                    
                                    
                                       
                                          Return Vi (particles positions), the cluster centers and the membership degrees μ
                                          
                                             ik
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 1
                         presents an example of segmentation results using PSO initialization. We use a synthetic 116×116 image having 4 clusters with gray levels 0, 85, 170 and 255, affected by a Gaussian noise of variance 0.01. First, the initial cluster centers are set randomly (8, 63, 83 and 197). The final cluster centers without PSO initialization are (10.02, 72.21, 192.16 and 214.28). With PSO initialization, the final cluster centers are (2.23, 83.77, 169.88 and 253.73). The gray level of the cluster centers are close to the gray levels in the original image.

As shown in Section 2, the FCM or KPCM uses a metric that is very sensitive to the outliers. The membership function of the KPCM is modified by considering the outliers rejection; Eq. (16) becomes:
                           
                              (22)
                              
                                 
                                    
                                       J
                                       
                                          I
                                          K
                                          P
                                          C
                                          M
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                k
                                             
                                             m
                                          
                                          
                                             α
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                            (
                                                            
                                                               x
                                                               k
                                                            
                                                            )
                                                            −
                                                            Φ
                                                            (
                                                            
                                                               V
                                                               i
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                η
                                                i
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         μ
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The model of the IKPCM is:
                           
                              (23)
                              
                                 
                                    min
                                    
                                       J
                                       
                                          I
                                          K
                                          P
                                          C
                                          M
                                       
                                    
                                    =
                                    min
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      k
                                                   
                                                   m
                                                
                                                
                                                   α
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Φ
                                                                  (
                                                                  
                                                                     x
                                                                     k
                                                                  
                                                                  )
                                                                  −
                                                                  Φ
                                                                  (
                                                                  
                                                                     V
                                                                     i
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   c
                                                
                                                
                                                   
                                                      η
                                                      i
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               μ
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The membership function of the KPCM algorithm is modified by replacing the original distance term in Eq. (17).
                           
                              (24)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Φ
                                                                              (
                                                                              
                                                                                 x
                                                                                 k
                                                                              
                                                                              )
                                                                              −
                                                                              Φ
                                                                              (
                                                                              
                                                                                 V
                                                                                 i
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               η
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                      m
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       η
                                       i
                                    
                                    =
                                    K
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                             
                                                α
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                               (
                                                               
                                                                  x
                                                                  k
                                                               
                                                               )
                                                               −
                                                               Φ
                                                               (
                                                               
                                                                  V
                                                                  i
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                μ
                                                
                                                   i
                                                   k
                                                
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The role of the exponent α is to limit the partial distribution of the points among 2 neighboring clusters rather than to all clusters.

α is defined as:
                           
                              (26)
                              
                                 
                                    α
                                    =
                                    
                                       
                                          (
                                          intensity range in the image
                                          )
                                          +
                                          1
                                       
                                       
                                          maximum intensity range
                                          +
                                          1
                                       
                                    
                                    +
                                    1
                                 
                              
                           
                        
                     

For an 8 bits greyscale image, Eq. (26) is:
                           
                              (27)
                              
                                 
                                    α
                                    =
                                    
                                       
                                          (
                                          
                                             X
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             X
                                             
                                                min
                                             
                                          
                                          )
                                          +
                                          1
                                       
                                       
                                          256
                                       
                                    
                                    +
                                    1
                                 
                              
                           
                        where X
                        max and X
                        min are respectively, the maximum and the minimum intensity in the image. α is between 1 and 2.

If the image has a large intensity range, α is close to 2, the partial distribution of the pixels between 2 adjacent clusters is reduced. Unlikely, if the image has a small intensity range, α is close to 1 and the partial distribution of the pixels is only among the adjacent clusters.

In the example, the data set has an intensity range from 1 to 120. We want to cluster the data in 3 clusters c
                        1, c
                        2, and c
                        3 using FCM. The membership functions u
                        1 (red), u
                        2 (green), and u
                        3 (blue) are shown in (Fig. 2
                        ). In the range 41 to 120, the membership u
                        1 is supposed to be null. However, due to ripples, data which do not belong to the cluster c1, can be assigned to c1. These outliers could pull away the cluster center from its optimum value.

Using IKPCM, we can see that the outliers have a membership value close to zero (Fig. 3
                        ).

Neighboring pixels in an image are highly correlated. For this, we define a spatial function as:
                           
                              (28)
                              
                                 
                                    
                                       h
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                          B
                                          (
                                          
                                             x
                                             k
                                          
                                          )
                                       
                                    
                                    
                                       
                                          μ
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        where NB(x
                        
                           k
                        ) is a square window centered on the pixel x
                        
                           j
                        . We use a 3×3 window and h
                        
                           ik
                         is the probability that the pixel x
                        
                           k
                         belongs to the ith cluster.

The membership function in Eq. (24) becomes:
                           
                              (29)
                              
                                 
                                    
                                       μ
                                       
                                          i
                                          k
                                       
                                       *
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             p
                                          
                                          
                                             
                                                
                                                   h
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             q
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                p
                                             
                                             
                                                
                                                   
                                                      h
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                q
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where p and q are parameters used to control the weight of each function.

Segmenting images by means of active contours is a well-known approach [25–27]. Instead of a parametric characterization of the active contours, level set method embed them into a time dependent partial differential equation function ψ(t, x, y). It is then possible to approximate the evolution of the active contours implicitly by tracking the level set Γ(t). To initialize automatically the initial contour of the level set, we use the resulting clustering achieved by IKPCM.
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ψ
                                                      (
                                                      t
                                                      ,
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      <
                                                      0
                                                   
                                                
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                         
                                                      is inside
                                                         
                                                      Γ
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ψ
                                                      (
                                                      t
                                                      ,
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      =
                                                      0
                                                   
                                                
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                         
                                                      is at
                                                         
                                                      Γ
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ψ
                                                      (
                                                      t
                                                      ,
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      >
                                                      0
                                                   
                                                
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                         
                                                      is inside
                                                         
                                                      Γ
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Γ may be comprised of a single or a series of zero isocontours. It can be easily determined by checking the values of the level set function ψ, which adapts to the topological changes of the implicit interface Γ. The evolution ending is determined by:
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            ψ
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      +
                                                      F
                                                      
                                                         
                                                            ∇
                                                            ψ
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ψ
                                                      (
                                                      0
                                                      ,
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      =
                                                      
                                                         ψ
                                                         0
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ∇
                                    ψ
                                 
                              
                           
                         is the normal direction, ψ
                        0(x, y) is the initial contour and F represents the comprehensive forces. The evolving force F has to be regularized by an edge indication function g in order to stop the level set evolution near the optimal solution.
                           
                              (32)
                              
                                 
                                    g
                                    =
                                    
                                       1
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   
                                                      ∇
                                                      (
                                                      
                                                         G
                                                         σ
                                                      
                                                      *
                                                      I
                                                      )
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where G
                        
                           σ
                        
                        *
                        I is the convolution between a Gaussian kernel G
                        
                           σ
                         and the image I. ∇ denotes the gradient operator.

Level set segmentation is formulated as:
                           
                              (33)
                              
                                 
                                    
                                       
                                          ∂
                                          ψ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    g
                                    
                                       
                                          ∇
                                          ψ
                                       
                                    
                                     
                                    
                                       
                                          d
                                          i
                                          v
                                          
                                             
                                                
                                                   
                                                      ∇
                                                      ψ
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                            ψ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          ν
                                       
                                    
                                 
                              
                           
                        where 
                           
                              d
                              i
                              v
                              
                                 
                                    
                                       
                                          ∇
                                          ψ
                                       
                                       
                                          
                                             
                                                ∇
                                                ψ
                                             
                                          
                                       
                                    
                                 
                              
                           
                         approximates the mean curvature к and v is a customable balloon force.

A fast level set algorithm was proposed by [28]:
                           
                              (34)
                              
                                 
                                    
                                       
                                          ∂
                                          ψ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    μ
                                    ζ
                                    (
                                    ψ
                                    )
                                    +
                                    ξ
                                    (
                                    g
                                    ,
                                    ψ
                                    )
                                 
                              
                           
                        where ζ(ψ) is the penalty momentum of ψ and ξ(g, ψ) is an image gradient information
                           
                              (35)
                              
                                 
                                    ξ
                                    (
                                    g
                                    ,
                                    ψ
                                    )
                                    =
                                    λ
                                    δ
                                    (
                                    ψ
                                    )
                                    +
                                    d
                                    i
                                    v
                                    
                                       
                                          g
                                          
                                             
                                                ∇
                                                ψ
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      ψ
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    ν
                                    g
                                    δ
                                    (
                                    ψ
                                    )
                                 
                              
                           
                        where δ(ψ) is the Dirac function. ν, μ and λ are parameters to control the level set evolution.

To summarize the steps of the algorithm, we use the diagram described in Fig. 4
                        .

@&#EXPERIMENTS AND RESULTS@&#

In this section, the results of the IKPCM algorithm are presented and compared to the most known algorithms: FCM, FCM_S1, RFCM, and KPCM. The different algorithms are implemented in Matlab version 2010 and run on a 3.10GHz Pentium® Core™ i3-2100 CPU, under Microsoft Windows 7 operating system.

For synthetic data, we used a set of two images corrupted by different levels and types of noise. Simulated MRI brain images and real medical images are also used.

We use a first synthetic image (Fig. 5
                        ) (128×128) with two gray levels and Gaussian noise, with different levels (1%, 5% and 9%), located at the image center (Figs. 6–10
                        
                        
                        
                        
                        ).

Then we use a second synthetic image (Fig. 11
                        ) (181×140) with five gray levels and different type of noises (salt & pepper, Gaussian and uniform).

For the first synthetic image, although the FCM algorithm can segment the image into two regions, noise remains. For noisy images, FCM_S1, RFCM and KPCM algorithms outperform the conventional FCM. From the figures, we see clearly that the proposed IKPCM gives the best results. For the second synthetic image, corrupted with salt & pepper (5% noise level), Gaussian (variance=0.02) or uniform (variance=0.01) noises, the segmentation results are illustrated in Figs. 12–17
                        
                        
                        
                        
                        
                        . Visually, we can see that IKPCM gives coherent results and better contours in the case of salt & pepper and Gaussian noise. However, artifacts are still present in the case of uniform noise, but it still outperforms the other algorithms.

To evaluate the clustering performances, we use two functions: partition entropy Vpe and partition coefficient Vpc 
                        [29]. They are defined as follows:
                           
                              (36)
                              
                                 
                                    V
                                    p
                                    e
                                    =
                                    
                                       1
                                       n
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    V
                                    p
                                    c
                                    =
                                    
                                       1
                                       n
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          log
                                          (
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

These validity functions are used to compare the results of the different algorithms. A best clustering is achieved if the value V
                        
                           pe
                         is minimal or V
                        
                           pc
                         is maximal. Another validity function based on the features structure is used [29]:
                           
                              (38)
                              
                                 
                                    
                                       V
                                       
                                          x
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             c
                                          
                                          
                                             n
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      j
                                                   
                                                   2
                                                
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                      −
                                                      
                                                         V
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      i
                                                      ≠
                                                      k
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                     k
                                                                  
                                                                  −
                                                                  
                                                                     V
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Tables 2 and 3
                        
                         show that IKPCM outperforms the other algorithms, especially in the presence of noise. The quantitative comparisons of the algorithms confirm the visual evaluation. These results are also illustrated in Figs. 21 and 22.

Healthy brain matter can be classified into three tissues, white matter (WM), cerebro-spinal fluid (CSF) and gray matter (GM) [6]. Because of the non availability of segmentation ground truth for real MR images, we use simulated MR brain images from the Brain Web Simulated Brain Database [30]. This database is used since the scientific community frequently uses it as a benchmark. For experimentation, we have chosen three noise levels (0%, 5% and 9%). The parameters of the algorithm, namely the values of m, the number of clusters c, and finally the vectors form representing the image pixels are defined. The number of clusters is set to 4: cerebrospinal fluid, white matter, gray matter and background.


                        Fig. 18
                         presents the segmentation results using FCM without noise. Figs. 19 and 20
                        
                         show a comparison of segmentation results between FCM and IKPCM. From these images, the traditional FCM is not suitable to classify the images but IKPCM gives good results despite the fact that the images were affected by noise. Because of its ability to cope with noise, IKPCM gives better results than FCM. Obviously, with an increase of the noise level, the segmentation results of FCM degrade rapidly (Figs. 21–23
                        
                        
                        ; Table 4
                        ).

In this experiment, we choose the 96th slice corrupted the 9% noise and we proceed to the extraction of the brain MR tissue (WM, GM and CSF), using FCM KPCM, and IKPCM. The results are shown in Figs. 24–26
                           
                           
                            respectively. A quantitative performance evaluation is also given in Table 5
                           .

For a quantitative evaluation of the results, a pixel based evaluation approach is used. A comparison is made between pixels of the resulting image (Rt) and the ground truth (Rg).

The following measures are used; Dice index, Jaccard index, True Positive Fraction (TPF), False Negative Fraction (FNF), False Positive Fraction (FPF) and True Negative Fraction (TNF) [31–33]. Better performances are achieved for high values of the Dice index, Jaccard index, TPF and TNF measures. However, higher values of MCR, FNF and FPF lead to worst performances.
                              
                                 (39)
                                 
                                    
                                       Dice
                                       =
                                       
                                          
                                             2
                                             
                                                
                                                   
                                                      R
                                                      t
                                                   
                                                   ∩
                                                   
                                                      R
                                                      g
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                      t
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      R
                                                      g
                                                   
                                                
                                             
                                          
                                       
                                       ;
                                       Jaccard
                                       =
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             ∩
                                             
                                                R
                                                g
                                             
                                          
                                          
                                             
                                                R
                                                t
                                             
                                             ∪
                                             
                                                R
                                                g
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (40)
                                 
                                    
                                       T
                                       P
                                       F
                                       =
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             ∩
                                             
                                                R
                                                g
                                             
                                          
                                          
                                             
                                                R
                                                g
                                             
                                          
                                       
                                       ;
                                       F
                                       N
                                       F
                                       =
                                       
                                          
                                             
                                                R
                                                g
                                             
                                             −
                                             
                                                R
                                                t
                                             
                                          
                                          
                                             
                                                R
                                                g
                                             
                                          
                                       
                                       ;
                                       F
                                       P
                                       F
                                       =
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             −
                                             
                                                R
                                                g
                                             
                                          
                                          
                                             
                                                R
                                                g
                                             
                                          
                                       
                                       ;
                                       T
                                       N
                                       F
                                       =
                                       1
                                       −
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             −
                                             
                                                R
                                                g
                                             
                                          
                                          
                                             
                                                R
                                                g
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For the next experiment, we use real medical images (liver tumor) with two cancerous regions.

From Fig. 27
                        , we can clearly see that IKPCM outperforms the other methods.

Finally, for the second test, we use real brain MR images from the Internet Brain Segmentation Repository (IBSR) [34] from the center for Morphometric Analysis at Massachusetts General Hospital. Fig. 28
                         shows the segmentation results using the 115th slice of 18 normal T1-weighted brain images.

From Fig. 28, we can visually see that IKPCM outperforms the other methods. From Table 6
                        , we can also see that IKPCM gives the best results (Figs. 29 and 30
                        
                        ).

Usually, it is difficult to initialize manually the level set initial contour. The goals of the third step of our algorithm is to, automatically, initialize the level set initial contour using the resulting clustering obtained by IKPCM.

To evaluate the usefulness of an initial fuzzy clustering for level set segmentation, the experiments were carried on firstly MR slice of cerebral tissues and then on the previous liver tumor image.


                        Table 7
                         shows the controlling parameters associated with the level set segmentation. These values are those taken in [28].


                        Figs. 31 and 32
                        
                         present the results after several iterations. A good segmentation is achieved thanks to the use of an initial IKPCM clustering step for the initialization of the level set. The initial contour issued from the IKPCM is close to the final contour using the level set evolution (Fig. 33
                        ).

Because of the weak and irregular boundaries of the cancerous tissues, the segmentation is difficult. Moreover, due to blood vessels, the liver tissue itself is inhomogeneous. It is often difficult to choose an optimal initialization for the level set.

@&#CONCLUSION@&#

In this paper, we have presented an improved KPCM algorithm where, in the original KPCM algorithm, we have incorporated the spatial neighborhood information, PSO algorithm for cluster centers and membership initialization. The IKPCM was tested on synthetic, simulated and real medical images. We have compared the performances of FCM, FCM_S1, RFCM, KPCM and IKPCM algorithms. The results reveal that the algorithm shows a significant improvement concerning the robustness to noise. For medical images, IKPCM was used to find the initial contour for the level set evolution. A fine segmentation and the extraction of the various tissues were achieved. Finally, it is noteworthy to integrate other constraints on the pixels, combine several classification algorithms working in cooperation and adapt data driven terms for the level set evolution.

@&#REFERENCES@&#

