@&#MAIN-TITLE@&#Impact of forecast errors on expansion planning of power systems with a renewables target

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A two-stage market properly models the effects of forecast errors on system operation.


                        
                        
                           
                           Expansion models are formulated as stochastic single/bilevel programming problems.


                        
                        
                           
                           Production forecast errors have a high impact on power system expansion planning.


                        
                        
                           
                           A market that efficiently handles forecast errors involves cheaper expansion plans.


                        
                        
                           
                           The consequences of disregarding forecast errors depend on the market design.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Bilevel programming

Expansion planning

Renewable energy sources

Market design

@&#ABSTRACT@&#


               
               
                  This paper analyzes the impact of production forecast errors on the expansion planning of a power system and investigates the influence of market design to facilitate the integration of renewable generation. For this purpose, we propose a programming modeling framework to determine the generation and transmission expansion plan that minimizes system-wide investment and operating costs, while ensuring a given share of renewable generation in the electricity supply. Unlike existing ones, this framework includes both a day-ahead and a balancing market so as to capture the impact of both production forecasts and the associated prediction errors. Within this framework, we consider two paradigmatic market designs that essentially differ in whether the day-ahead generation schedule and the subsequent balancing re-dispatch are co-optimized or not. The main features and results of the model set-ups are discussed using an illustrative four-node example and a more realistic 24-node case study.
               
            

@&#INTRODUCTION@&#

With an aim to reduce greenhouse gas emissions, ensure adequacy of energy resources and guarantee the security of energy supply, many governments employ policy targets for the exploitation of renewable energy sources. As an example, the European Union has agreed to cover 20 percent of its total energy consumption with renewable production by 2020, whereas some EU countries aim for even higher shares (European Comission, 2009). Such ambitious targets will inevitably demand a paradigm shift in the design of future electricity markets and the configuration of future power systems.

In contrast to conventional power sources, renewable production, such as wind and solar power, is characterized by being highly variable, largely unpredictable and non-dispatchable. For the purpose of power system expansion planning, it is therefore necessary to account for both the variability of stochastic production throughout the planning horizon and the forecast errors caused by the limited predictability of these energy sources (Bludszuweit, Dominguez-Navarro, & Llombart, 2008; Ela et al., 2014).

Power system expansion planning under uncertainty has long been subject to extensive study in the literature (Latorre, Member, Areiza, Cruz, & Villegas, 2003; Lee, Ng, Zhong, & Wu, 2006). References (Gorenstin, Campodonico, Costa, Pereira, & da Costa, 1993; Mo, Hegge, & Wangensteen, 1991) consider, for example, the expansion of generating capacity under demand, cost and technical uncertainty. Likewise, the authors in (Alvarez, 2007; Torre, Conejo, Contreras, Member, & de la Torre, 2008) determine the optimal expansion plan for the generation and transmission while taking into account uncertainty in the future demand, availability of generation plants and capacity factors for transmission lines. An overview of generation and transmission investment and operation models is provided in Hobbs (1995).

More recent contributions (Arabali et al., 2014; Baringo & Conejo, 2012; De Jonghe, Delarue, Belmans, & D’haeseleer, 2011; Lynch, Tol, & O’Malley, 2012; Munoz, Sauma, & Hobbs, 2013; Neuhoff et al., 2008; Orfanos, Georgilakis, & Hatziargyriou, 2013) further investigate how the transmission expansion planning of a power system is affected by variability in wind power production. However, these models disregard forecast errors of the stochastic generating units and thus, fail to capture the impact of uncertainty in wind power production on expansion planning decisions.

In this paper, we address the generation and transmission expansion planning of a power system with a significant share of renewable generation, considering both the variability and limited predictability of the stochastic production. We propose a programming framework to determine the expansion plan (for stochastic and dispatchable production capacity as well as for the transmission network) that minimizes investment and system operating costs, while ensuring a given target of renewable generation in the electricity supply. Unlike in existing ones, the operation costs computed in our modeling framework include two terms: a day-ahead dispatch cost, which depends on the forecast of stochastic production and demand, and a balancing cost, which is a function of the forecast errors and the flexibility provided by the conventional generating units. To the best of our knowledge, our model is the first to explicitly consider the impact of production forecast errors on the optimal expansion planning of generation and transmission capacity.

To properly incorporate the impact of forecast errors, we require two electricity trading floors: the day-ahead market, which is cleared 24 to 36 hours in advance of system operation and the balancing market, which copes with real-time energy imbalances (Kirschen & Strbac, 2004). Furthermore, we consider in this paper two paradigmatic market designs, which represent two extremes of day-ahead market clearing in view of potential forecast errors in renewable production:

                        
                           –
                           The first is an ideal market-clearing procedure that efficiently handles forecast errors by jointly optimizing the operation in the day-ahead and balancing markets (Morales, Conejo, Madsen, Pinson, & Zugno, 2013; Pritchard, Zakeri, & Philpott, 2010). This market design is formulated as a two-stage stochastic programming problem (Birge & Louveaux, 2011).

The second represents an inefficient market design where the day-ahead generation schedule and the subsequent balancing re-dispatch are not jointly optimized. To capture the sequential and non-cooptimized clearings of the day-ahead and balancing markets of this market design, we formulate the model as a bi-level program (Dempe, 2002).

We adopt the view of a central planner that minimizes the costs of power system expansion and operation (Alvarez, 2007; Escobar, Gallego, & Romero, 2004; Unsihuay-Vila, Marangon-Lima, Zambroni De Souza, & Perez-Arriaga, 2011). It can be mathematically proved that, under some convexity assumptions, the generation expansion decisions made by a central planner are equivalent to those made by the individual producers participating in an electricity market under perfect competition (Ehrenmann & Smeers, 2011). For investment models that account for imperfect competition among power producers, the reader is referred to Murphy and Smeers (2005) 
                     Nanduri, Das, and Rocha (2009) 
                     Wogrin, Barquin, and Centeno (2013). Moreover, references Motamedi, Zareipour, Buygi, and Rosehart (2010) 
                     Pozo, Sauma, and Contreras (2013) 
                     Roh, Shahidehpour, and Wu (2009) 
                     Sauma and Oren (2007) propose models to determine transmission investments assuming imperfect competition at the generation expansion level. It should be remarked, however, that due to the complexity of these models, they do not often allow for the inclusion of uncertainty.

We consider here a dynamic approach to expansion planning where the optimal size, placement and timing of generation and transmission investment projects are determined throughout a multi-year horizon. The variability of stochastic power production and demand throughout each year of the planning horizon is represented using time segments. This facilitates computations at the expense of disregarding chronological features. Likewise, the probability distributions of the forecast errors for each time segment are assumed known and independent of the installed capacity at each location. Furthermore, by linearization of the non-linear terms in the formulations and using the optimality conditions in the bi-level problem, we cast the proposed expansion planning models as single-level mixed-integer linear programs.

In summary, the main contributions of this paper are the following:

                        
                           1.
                           The proposal of a comprehensive set of generation and transmission expansion problems that properly model the impact of power forecast errors on the short-term operation of a power system through a two-stage electricity market that includes a day-ahead and a balancing market.

The proposal of optimization models to determine the optimal generation and transmission expansion planning of a power system under two market designs that differ on how efficiently the available flexible generation is used to cope with power forecast errors.

The analysis of how forecast errors and market design influence the optimal generation and transmission expansion planning decisions.

The comparison of the pernicious effects of disregarding power forecast errors when devising expansion plans for different short-term market designs.

The paper is structured as follows. Section 1 introduces and motivates the expansion planning problem in power systems with high penetration of renewable energy. In Section 2 we first present the generation and transmission expansion planning problem assuming perfect forecasts of stochastic production. We then extend this problem to include forecast errors under the two market designs outlined above. The characterization of the uncertain parameters involved is explained in Section 3. Section 4 provides an illustrative four-node example of the expansion problem. A more realistic 24-node case study is presented in Section 5. Finally, Section 6 concludes the paper.

In this paper, we consider a power system that consists of a set 
                        
                           g
                           ∈
                           G
                        
                      of generating units, a set 
                        
                           j
                           ∈
                           J
                        
                      of demands and a set 
                        
                           l
                           ∈
                           L
                        
                      of transmission lines. The proposed mathematical programming models determine the optimal decisions among a set of available projects to expand the generation and transmission capacity to minimize the sum of operating and investment costs while ensuring that at least ηy
                      percent of the electricity consumption is covered by renewable electricity production in year y. The models also include a yearly demand growth and a discount rate r. In order to model different states of the power system throughout each year of the planning horizon, a set of time segments s is considered. The duration of each time segment is denoted by τs
                     , such that 
                        
                           
                              ∑
                              s
                           
                           
                              τ
                              s
                           
                           =
                           8760
                        
                      hours.

Generating units 
                        
                           g
                           ∈
                           G
                        
                      are modeled by a capacity 
                        
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                           ,
                        
                      a fuel cost 
                        
                           c
                           g
                           fuel
                        
                      and a capacity factor ρgs
                      that depends on the time segment s. Note that 
                        
                           c
                           g
                           fuel
                        
                      is assumed to be zero for stochastic generating units, denoted by 
                        
                           G
                           W
                        
                     . Besides, 
                        
                           
                              p
                              ¯
                           
                           
                              g
                              y
                           
                        
                      is a known and fixed parameter for existing units 
                        
                           g
                           ∈
                           
                              G
                              E
                           
                           ,
                        
                      while it represents a variable for new generating units 
                        
                           g
                           ∈
                           
                              G
                              N
                           
                        
                     . Each generation capacity expansion project is limited by a maximum capacity 
                        
                           
                              p
                              ¯
                           
                           g
                           max
                        
                      and involves an annualized fixed investment cost 
                        
                           c
                           g
                           fix
                        
                      and an annualized variable investment cost 
                        
                           c
                           g
                           var
                        
                     . Generation investment decisions are modeled by the binary variable ugy
                     , which is equal to 1 if the project is carried out in year y or before, and 0 otherwise. Parameter ρgs
                      can be used to characterize both the occurrence of unexpected unit failures and the variable generation from stochastic generating units, such as wind or solar power plants. In the latter case, ρgs
                      is a function of the weather conditions at a given location and the power curves of the wind turbines or the solar panels. We disregard interactions between the stochastic generating units and assume that this parameter is independent of the installed capacity.

The transmission network is modeled using DC power flow equations, in which transmission lines have a capacity 
                        
                           
                              f
                              ¯
                           
                           
                              l
                              y
                           
                        
                      and a susceptance bl
                     . Like for generating units, 
                        
                           
                              f
                              ¯
                           
                           
                              l
                              y
                           
                        
                      is a known and fixed parameter for the existing lines 
                        
                           l
                           ∈
                           
                              L
                              E
                           
                           ,
                        
                      and a variable for the new ones 
                        
                           l
                           ∈
                           
                              L
                              N
                           
                        
                     . Likewise, 
                        
                           
                              
                                 f
                                 ¯
                              
                              l
                              max
                           
                           ,
                        
                     
                     
                        
                           
                              c
                              l
                              fix
                           
                           ,
                        
                     
                     
                        
                           c
                           l
                           var
                        
                      and vly
                      denote, respectively, the maximum capacity, the fix and variable investment costs of each transmission project, and a binary variable vly
                      that is equal to 1 if the transmission project is undertaken in year y or before, and 0 otherwise. The parameter aln
                      represents the line indicator, which is equal to 1/-1 if bus n is the sending/receiving bus of line l, and 0 otherwise. Variable δnsy
                      stands for the voltage angle at bus n, time segment s, and year y, and is limited by the voltage angle limit 
                        
                           δ
                           n
                           max
                        
                     .

The demand level for each consumption unit 
                        
                           j
                           ∈
                           J
                        
                      at each time segment s in each year y is denoted by 
                        
                           
                              d
                              ¯
                           
                           
                              j
                              s
                              y
                           
                        
                     . Satisfied demand is denoted by djsy
                     , while load shedding is penalized in the objective function with a cost of 
                        
                           c
                           j
                           shed
                        
                     .

According to these data and following a network-constrained economic dispatch, the market operator determines the production of generating units (pgsy
                     ) and the power flows through the transmission lines (flsy
                     ) that minimize the operating cost for each time segment s and year y.

Due to the high predictability of electricity demand and the low penetration of stochastic production, classical expansion planning models systematically disregard the effect of forecast errors. In this vein, we present a generic generation and transmission expansion planning formulation that accounts for the variability of demand and stochastic production throughout the planning horizon, but ignores the associated forecast errors.

                        
                           (1a)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Minimize
                                             
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             y
                                          
                                          
                                             
                                                1
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      r
                                                      )
                                                   
                                                   y
                                                
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   g
                                                   fix
                                                
                                                
                                                   u
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   l
                                                   fix
                                                
                                                
                                                   v
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   l
                                                   var
                                                
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             +
                                             
                                                ∑
                                                s
                                             
                                             
                                                τ
                                                s
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   g
                                                
                                                
                                                   c
                                                   g
                                                   fuel
                                                
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      y
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   j
                                                
                                                
                                                   c
                                                   j
                                                   shed
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                         ¯
                                                      
                                                      
                                                         j
                                                         s
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         j
                                                         s
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1b)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                g
                                                ∈
                                                
                                                   G
                                                   W
                                                
                                                ,
                                                s
                                             
                                          
                                          
                                             τ
                                             s
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          ≥
                                          
                                             η
                                             y
                                          
                                          
                                             ∑
                                             
                                                g
                                                s
                                             
                                          
                                          
                                             τ
                                             s
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1c)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          =
                                          
                                             ∑
                                             b
                                          
                                          
                                             z
                                             
                                                g
                                                b
                                                y
                                             
                                          
                                          
                                             
                                                p
                                                ^
                                             
                                             g
                                          
                                          
                                             2
                                             
                                                (
                                                b
                                                −
                                                1
                                                )
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ∈
                                          
                                             G
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1d)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          =
                                          
                                             ∑
                                             b
                                          
                                          
                                             x
                                             
                                                l
                                                b
                                                y
                                             
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             l
                                          
                                          
                                             2
                                             
                                                (
                                                b
                                                −
                                                1
                                                )
                                             
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ∈
                                          
                                             L
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1e)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ≥
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ∈
                                          
                                             G
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1f)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ≥
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ∈
                                          
                                             L
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1g)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ≤
                                          
                                             u
                                             
                                                g
                                                y
                                             
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             g
                                             max
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ∈
                                          
                                             G
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1h)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ≤
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             l
                                             max
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ∈
                                          
                                             L
                                             N
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1i)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             f
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          =
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          
                                             b
                                             l
                                          
                                          
                                             ∑
                                             n
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             δ
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1j)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                g
                                                ∈
                                                
                                                   G
                                                   n
                                                
                                             
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   n
                                                
                                             
                                          
                                          
                                             d
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             ∑
                                             l
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             f
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1k)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          ≤
                                          
                                             ρ
                                             
                                                g
                                                s
                                             
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1l)
                           
                              
                                 
                                    
                                    
                                       
                                          −
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ≤
                                          
                                             f
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          ≤
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1m)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             d
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          ≤
                                          
                                             
                                                d
                                                ¯
                                             
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1n)
                           
                              
                                 
                                    
                                    
                                       
                                          −
                                          
                                             δ
                                             n
                                             max
                                          
                                          ≤
                                          
                                             δ
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          ≤
                                          
                                             δ
                                             n
                                             max
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1o)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   n
                                                   1
                                                
                                                s
                                                y
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1p)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             u
                                             
                                                g
                                                y
                                             
                                          
                                          ,
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          ,
                                          
                                             z
                                             
                                                g
                                                b
                                                y
                                             
                                          
                                          ,
                                          
                                             x
                                             
                                                l
                                                b
                                                y
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ∈
                                          
                                             G
                                             N
                                          
                                          ,
                                          ∀
                                          l
                                          ∈
                                          
                                             L
                                             N
                                          
                                          ,
                                          ∀
                                          b
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1q)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          =
                                          1
                                          ,
                                          
                                          ∀
                                          l
                                          ∈
                                          
                                             L
                                             E
                                          
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           G
                           n
                        
                      and 
                        
                           J
                           n
                        
                      represent the set of generating units and loads connected to bus n, respectively.

Objective function (1a) minimizes the investment cost plus operating costs throughout the planning horizon. Constraint (1b) ensures that at least ηy
                      percent of the demand of year y is covered with electricity produced by renewable generating units. Eq. (1c) and (1d) discretize the capacity of the available expansion projects using the binary expansion approach used in Pereira, Granville, Fampa, Dix, and Barroso (2005) 
                     Wogrin, Centeno, and Barquín (2011), where 
                        
                           
                              p
                              ^
                           
                           g
                        
                      and 
                        
                           
                              f
                              ^
                           
                           l
                        
                      represent the block size of the generation and transmission expansion projects, respectively; and zgby, xlby
                      are binary variables. Constraints (1e)–(1f) ensure that the project capacities increase over time. The capacity of new generating units and transmission lines is, in turn, bounded by the maximum capacity of each project through (1g) and (1h). Eq. (1i) computes the power flows as a function of the voltage angles of the buses. Constraint (1j) ensures the power balance at each node. Generation levels and power flows are limited by their corresponding capacities in (1k) and (1l), respectively. Eq. (1m) limits load shedding. Constraints (1n) impose voltage angle limits. Eq. (1o) arbitrarily sets the voltage angle at bus n
                     1 to 0. Finally, (1p) and (1q) are binary variable declarations.

Optimization model (1) is a deterministic model in which the variability of the capacity factors throughout each year of the planning horizon is represented by a duration curve, which is discretized into a finite number of time segments. The decisions of this model include investment decisions (
                        
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                           ,
                           
                              
                                 f
                                 ¯
                              
                              
                                 l
                                 y
                              
                           
                        
                     ), which are made at the beginning of each year of the planning horizon, and operation decisions (pgsy, djsy, flsy
                     ), which may vary according to the capacity factor values for each time segment (ρgs
                     ). Note that constraint (1i) includes the product of continuous (δnsy
                     ) and binary variables (vly
                     ), which can be linearized according to the procedure presented in Floudas (1995). In this fashion, we can cast model (1) as a mixed-integer linear programming problem that can be solved using commercial software.

This model of the electricity market could represent two situations according to how power systems are operated today. One could think of it as a real-time market in which all generating units are assumed to be completely flexible and able to instantaneously adapt their output to the status of the system. Another interpretation could be a day-ahead market cleared with perfect forecasts of the demand and stochastic power production. However, irrespective of the market design, most generating units have technical constraints regarding their response time to unexpected events and therefore, the realized values of demand and stochastic power production differ from the forecasted ones.

In this paper, we propose to overcome these shortcomings by including an additional decision stage in model (1). This allows us to more accurately characterize the stochastic parameters involved by taking into account the probability distributions of the corresponding forecast errors, and to model technical constraints on the flexibility provided by generating units. The two-stage modeling of the market is to be interpreted as the clearing of a day-ahead market taking place 24–36 hours in advance according to forecasts followed by a balancing market that copes with forecast errors. In balancing markets, generating units indicate how much they are willing to deviate with respect to their day-ahead dispatch. For example, a generating unit g can offer up- and down-balancing energy up to 
                        
                           
                              Δ
                              g
                              +
                           
                           
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                        
                      and 
                        
                           
                              Δ
                              g
                              −
                           
                           
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                        
                      megawatt at a cost of 
                        
                           c
                           g
                           +
                        
                      and 
                        
                           c
                           g
                           −
                        
                      $/megawatt-hour, respectively. Likewise, we assume that inflexible loads can work as up-balancing resources through curtailment, whereas stochastic generating units can provide down-balancing service through spillage.

Considering both a day-ahead and a balancing market raises further questions on whether the level of coordination between these two markets may influence the expansion planning of a power system. To address this issue, we propose two different optimization models that differ in whether forecast errors are accounted for or not when deciding on the day-ahead dispatch. First, and following the proposal described in Morales et al. (2013); Pritchard et al. (2010), we present an expansion planning model in which the clearing of the day-ahead and the balancing markets is co-optimized:

                        
                           (2a)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Minimize
                                             
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                             
                                          
                                          
                                             ∑
                                             y
                                          
                                          
                                             
                                                1
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      r
                                                      )
                                                   
                                                   y
                                                
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   g
                                                   fix
                                                
                                                
                                                   u
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   l
                                                   fix
                                                
                                                
                                                   v
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   l
                                                   var
                                                
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                τ
                                                s
                                             
                                             
                                                π
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   g
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      g
                                                      fuel
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      g
                                                      +
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      +
                                                   
                                                   −
                                                   
                                                      c
                                                      g
                                                      −
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   j
                                                
                                                
                                                   c
                                                   j
                                                   shed
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                         ¯
                                                      
                                                      
                                                         j
                                                         s
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         j
                                                         s
                                                         r
                                                         y
                                                      
                                                      B
                                                   
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2b)
                           
                              
                                 
                                    
                                    
                                       
                                          subject
                                          
                                          to
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                g
                                                ∈
                                                
                                                   G
                                                   W
                                                
                                                ,
                                                s
                                                r
                                             
                                          
                                          
                                             τ
                                             s
                                          
                                          
                                             π
                                             
                                                s
                                                r
                                             
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ≥
                                          
                                             η
                                             y
                                          
                                          
                                             ∑
                                             
                                                g
                                                s
                                                r
                                             
                                          
                                          
                                             τ
                                             s
                                          
                                          
                                             π
                                             
                                                s
                                                r
                                             
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ,
                                          
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2c)
                           
                              
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          c
                                          )
                                          −
                                          (
                                          1
                                          q
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2d)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             d
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          =
                                          
                                             
                                                d
                                                ¯
                                             
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2e)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          =
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             +
                                          
                                          −
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             −
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2f)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             f
                                             
                                                l
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          =
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          
                                             b
                                             l
                                          
                                          
                                             ∑
                                             n
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             δ
                                             
                                                n
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2g)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                g
                                                ∈
                                                
                                                   G
                                                   n
                                                
                                             
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   n
                                                
                                             
                                          
                                          
                                             d
                                             
                                                j
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          +
                                          
                                             ∑
                                             l
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             f
                                             
                                                l
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2h)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ≤
                                          
                                             
                                                ρ
                                                ˜
                                             
                                             
                                                g
                                                s
                                                r
                                             
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2i)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             +
                                          
                                          ≤
                                          
                                             Δ
                                             g
                                             +
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2j)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             p
                                             
                                                g
                                                s
                                                r
                                                y
                                             
                                             −
                                          
                                          ≤
                                          
                                             Δ
                                             g
                                             −
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2k)
                           
                              
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             d
                                             
                                                j
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ≤
                                          
                                             
                                                d
                                                ¯
                                             
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2l)
                           
                              
                                 
                                    
                                    
                                       
                                          −
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ≤
                                          
                                             f
                                             
                                                l
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ≤
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          ,
                                          
                                          ∀
                                          l
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2m)
                           
                              
                                 
                                    
                                    
                                       
                                          −
                                          
                                             δ
                                             n
                                             max
                                          
                                          ≤
                                          
                                             δ
                                             
                                                n
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          ≤
                                          
                                             δ
                                             n
                                             max
                                          
                                          ,
                                          ∀
                                          n
                                          ,
                                          
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2n)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   n
                                                   1
                                                
                                                s
                                                r
                                                y
                                             
                                             B
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∀
                                          s
                                          ,
                                          ∀
                                          r
                                          ,
                                          ∀
                                          y
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                  

where 
                        
                           
                              p
                              
                                 g
                                 s
                                 r
                                 y
                              
                              B
                           
                           ,
                        
                     
                     
                        
                           
                              f
                              
                                 l
                                 s
                                 r
                                 y
                              
                              B
                           
                           ,
                        
                     
                     
                        
                           d
                           
                              j
                              s
                              r
                              y
                           
                           B
                        
                      and 
                        
                           δ
                           
                              n
                              s
                              r
                              y
                           
                           B
                        
                      denote the generation level, the power flow, the satisfied demand and the voltage angle at the balancing stage, respectively. For each time segment s, the uncertainty pertaining to the realization of the capacity factors at the balancing stage 
                        
                           
                              ρ
                              ˜
                           
                           
                              g
                              s
                              r
                           
                        
                      is characterized by a set of scenarios r whose probability of occurrence is denoted by πsr
                     . For simplicity, the probability distribution of the capacity factors is assumed to be the same for all years of the planning horizon.

Objective function (2a) minimizes the investment cost plus the expected operation cost, which includes both the day-ahead dispatch and the balancing re-dispatch costs. Eq. (2b) ensures the minimum penetration of renewable electricity production in year y. Constraints (1c)–(1q) in the simplified expansion model (1) are repeated to model the clearing of the day-ahead market. Without loss of generality, Eq. (2d) imposes that load shedding always occurs at the balancing stage. In the same fashion as in formulation (1), Eqs. (2e), (2f), (2g), (2h), (2i), (2j), (2k), (2l), (2m) and (2n) compute the power flow through the transmission lines and the generation levels at the balancing stage, ensure the power balance at each bus, limit the dispatch and re-dispatch of generating units, impose bounds on load shedding and power flows, enforce voltage angle limits and arbitrarily set bus n
                     1 as the reference node at the balancing stage, respectively.

Optimization problem (2) determines optimal investment decisions (
                        
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                           ,
                           
                              
                                 f
                                 ¯
                              
                              
                                 l
                                 y
                              
                           
                        
                     ) for a given planning horizon in which the different system states of each year are represented by a number of time segments, each characterized by the probability distributions of the capacity factors. Therefore, operation decisions for each time segment are now determined by solving a two-stage stochastic programming problem in which the day-ahead dispatch (pgsy, djsy, flsy
                     ) consist of first-stage decisions that are made facing uncertainty in the stochastic capacity factors, while re-dispatch actions (
                        
                           
                              p
                              
                                 g
                                 s
                                 r
                                 y
                              
                              B
                           
                           ,
                           
                              d
                              
                                 j
                                 s
                                 r
                                 y
                              
                              B
                           
                           ,
                           
                              f
                              
                                 l
                                 s
                                 r
                                 y
                              
                              B
                           
                        
                     ) are second-stage decisions that depend on each realization of the capacity factors at the balancing stage (
                        
                           
                              ρ
                              ˜
                           
                           
                              g
                              s
                              r
                           
                        
                     ). Note that each time segment is characterized by different probability distributions of the generation capacity factors. By linearizing the product of continuous and binary variables of constraints (1i) and (2f), this model can likewise be solved as a mixed-integer linear problem.

Note that model (2) determines the optimal expansion plan assuming an ideal market in which forecast errors of stochastic power units are handled as efficiently as possible. In order to investigate how the expansion plan is affected by the market’s handling of forecast errors, we build the alternative expansion planning model (3). Contrary to model (2), model (3) determines day-ahead market decisions without considering future balancing market decisions, thus failing to make an efficient use of the available flexible generation in the day ahead dispatch (Morales et al., 2013). The alternative expansion planning model is:

                        
                           (3a)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Minimize
                                             
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                             
                                          
                                          
                                             ∑
                                             y
                                          
                                          
                                             
                                                1
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      r
                                                      )
                                                   
                                                   y
                                                
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   g
                                                   fix
                                                
                                                
                                                   u
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   l
                                                   fix
                                                
                                                
                                                   v
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   l
                                                   var
                                                
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                τ
                                                s
                                             
                                             
                                                π
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   g
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      g
                                                      fuel
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      g
                                                      +
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      +
                                                   
                                                   −
                                                   
                                                      c
                                                      g
                                                      −
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   j
                                                
                                                
                                                   c
                                                   j
                                                   shed
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                         ¯
                                                      
                                                      
                                                         j
                                                         s
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         j
                                                         s
                                                         r
                                                         y
                                                      
                                                      B
                                                   
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3b)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          c
                                          )
                                          −
                                          (
                                          1
                                          h
                                          )
                                          ,
                                          (
                                          1
                                          p
                                          )
                                          ,
                                          (
                                          1
                                          q
                                          )
                                          ,
                                          (
                                          2
                                          b
                                          )
                                          ,
                                          (
                                          2
                                          e
                                          )
                                          −
                                          (
                                          2
                                          n
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

Observe that both the objective function and all constraints of model (2) are also considered in model (3). Therefore, and similarly to model (2), the operation decisions for each time segment are also made according to a two-stage stochastic programming model in which first-stage decisions are further constrained by a lower-level optimization problem to ensure that the day-ahead dispatch follows the classical merit-order principle. By doing so, model (3) determines the optimal expansion decisions under a market design in which forecast errors are inefficiently handled. The aim of proposing expansion models (2) and (3) is to investigate whether an efficient treatment of forecast errors entails a generation and transmission expansion plan cheaper than the one required under a conventional and independent clearing of the two markets.

Problem (3) has a bilevel structure, and to solve it, the linear level convex problem (3c)–(3i) is replaced with its KKT conditions or, alternatively, with its primal constraints, dual constraints, and the strong duality condition as follows (Motto, Arroyo, & Galiana, 2005):

                        
                           (4a)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Minimize
                                             
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   p
                                                   
                                                      g
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                                ,
                                                
                                                   f
                                                   
                                                      l
                                                      s
                                                      r
                                                      y
                                                   
                                                   B
                                                
                                             
                                          
                                          
                                             ∑
                                             y
                                          
                                          
                                             
                                                1
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      r
                                                      )
                                                   
                                                   y
                                                
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   g
                                                   fix
                                                
                                                
                                                   u
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      g
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      N
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   l
                                                   fix
                                                
                                                
                                                   v
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                +
                                                
                                                   c
                                                   l
                                                   var
                                                
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      l
                                                      y
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                τ
                                                s
                                             
                                             
                                                π
                                                
                                                   s
                                                   r
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   g
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      g
                                                      fuel
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      g
                                                      +
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      +
                                                   
                                                   −
                                                   
                                                      c
                                                      g
                                                      −
                                                   
                                                   
                                                      p
                                                      
                                                         g
                                                         s
                                                         r
                                                         y
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   j
                                                
                                                
                                                   c
                                                   j
                                                   shed
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                         ¯
                                                      
                                                      
                                                         j
                                                         s
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         j
                                                         s
                                                         r
                                                         y
                                                      
                                                      B
                                                   
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4b)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          1
                                          c
                                          )
                                          −
                                          (
                                          1
                                          h
                                          )
                                          ,
                                          (
                                          1
                                          p
                                          )
                                          ,
                                          (
                                          1
                                          q
                                          )
                                          ,
                                          (
                                          2
                                          b
                                          )
                                          ,
                                          (
                                          2
                                          e
                                          )
                                          −
                                          (
                                          2
                                          n
                                          )
                                          ,
                                          (
                                          3
                                          d
                                          )
                                          −
                                          (
                                          3
                                          i
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4c)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ̲
                                             
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                α
                                                ¯
                                             
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             λ
                                             
                                                
                                                   n
                                                   g
                                                
                                                s
                                                y
                                             
                                          
                                          =
                                          
                                             c
                                             g
                                             fuel
                                          
                                          ,
                                          
                                          ∀
                                          g
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4d)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ϕ
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                                ̲
                                             
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                                ¯
                                             
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          −
                                          
                                             ∑
                                             n
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             λ
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∀
                                          l
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4e)
                           
                              
                                 
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             l
                                          
                                          
                                             v
                                             
                                                l
                                                y
                                             
                                          
                                          
                                             b
                                             l
                                          
                                          
                                             a
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             ϕ
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                τ
                                                ̲
                                             
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                τ
                                                ¯
                                             
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   ξ
                                                   
                                                      s
                                                      y
                                                   
                                                
                                                )
                                             
                                             
                                                n
                                                =
                                                
                                                   n
                                                   1
                                                
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4f)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             g
                                          
                                          
                                             c
                                             g
                                             fuel
                                          
                                          
                                             p
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          =
                                          
                                             ∑
                                             j
                                          
                                          
                                             λ
                                             
                                                
                                                   n
                                                   j
                                                
                                                s
                                                y
                                             
                                          
                                          
                                             
                                                d
                                                ¯
                                             
                                             
                                                j
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             ∑
                                             g
                                          
                                          
                                             ρ
                                             
                                                g
                                                s
                                             
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                g
                                                y
                                             
                                          
                                          
                                             
                                                α
                                                ¯
                                             
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          +
                                          
                                             ∑
                                             l
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             
                                                l
                                                y
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   θ
                                                   ¯
                                                
                                                
                                                   l
                                                   s
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   θ
                                                   ̲
                                                
                                                
                                                   l
                                                   s
                                                   y
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          +
                                          
                                             ∑
                                             n
                                          
                                          
                                             δ
                                             n
                                             max
                                          
                                          
                                             (
                                             
                                                
                                                   τ
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   τ
                                                   ̲
                                                
                                                
                                                   n
                                                   s
                                                   y
                                                
                                             
                                             )
                                          
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4g)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ¯
                                             
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                                ¯
                                             
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                                ¯
                                             
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          ≤
                                          0
                                          ,
                                          ∀
                                          g
                                          ,
                                          ∀
                                          l
                                          ,
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4h)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ̲
                                             
                                             
                                                g
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                                ̲
                                             
                                             
                                                l
                                                s
                                                y
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                                ̲
                                             
                                             
                                                n
                                                s
                                                y
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          ∀
                                          g
                                          ,
                                          ∀
                                          l
                                          ,
                                          ∀
                                          n
                                          ,
                                          ∀
                                          s
                                          ,
                                          ∀
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                  

where ng
                      and nj
                      denote the bus to which generator g and demand j are connected, respectively. Eqs. (4c)–(4e) are the dual constraints corresponding to the lower-level problem (3c)–(3i), and constraint (4f) formulates the strong primal-dual condition. Finally, Eqs. (4g) and (4h) are negative and positive declarations of dual variables, respectively. Note that the following non-linear terms in Eq. (4f)
                     
                        
                           
                              
                                 p
                                 ¯
                              
                              
                                 g
                                 y
                              
                           
                           
                              
                                 α
                                 ¯
                              
                              
                                 g
                                 s
                                 y
                              
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 f
                                 ¯
                              
                              
                                 l
                                 y
                              
                           
                           
                              
                                 θ
                                 ¯
                              
                              
                                 l
                                 s
                                 y
                              
                           
                        
                      and 
                        
                           
                              
                                 f
                                 ¯
                              
                              
                                 l
                                 y
                              
                           
                           
                              
                                 θ
                                 ̲
                              
                              
                                 l
                                 s
                                 y
                              
                           
                        
                      can be linearized using (1c), (1d) and the procedure to linearize the product of continuous and binary variables. In doing so, problem (4) is also formulated as a mixed-integer linear optimization problem.

Observe that the two market designs considered in this paper represent two poles apart on how reserves are allocated to handle the system imbalances. On the one hand, the efficient market design included in model (2) dispatches generating units so that the uncommitted capacity (i.e., the reserve) is sufficient to handle the imbalances of the system at the minimum expected cost. Therefore, this market design endogenously determines the optimal amount of operating reserves according to the system uncertainty and the available flexibility (Wang, Gong, & Jiang, 2014). In other words, the results obtained by this model can be used as a proxy of a perfectly efficient market that would determine the optimal dispatch of energy and reserves to minimize expected costs. On the other hand, the inefficient market design modeled in (3) represents a market in which operating reserves are allocated subsequently to the clearing of the day-ahead market. This market design thus involves higher costs at the balancing stage due to an inefficient reserve allocation. Comparing the results of these two models allows us to draw relevant conclusions regarding the impact of the market design on the optimal expansion of current power systems.

It is worth mentioning that, for the sake of simplicity, long-term uncertainties corresponding to demand growth or fuel costs are not modeled in the proposed generation and transmission expansion models. Note, however, that such models can be extended to incorporate scenarios associated to these long term uncertainties as explained in (Ahmed, King, & Parija, 2003; Bakirtzis, Biskas, & Chatziathanasiou, 2012; Garcia & Shen, 2010; Gorenstin et al., 1993; Parpas & Webster, 2014; Pisciella, Bertocchi, & Vespucci, 2014).

Finally, notice that formulations (2) and (3) can be modified to incorporate additional constraints of generating units such as start-up costs or minimum up- and down-times. However, including additional binary variables to represent the status of the generating units involves undesired consequences, which are of different nature for formulations (2) and (3). For the single-level expansion model (2), these constraints would be straightforward to include, although at the expense of increasing the number of binaries and thereby the computational burden (Palmintier & Webster, 2011). With the inclusion of binaries, the lower-level problem in expansion model (3) would no longer be convex and, as such, could not be replaced with its KKT conditions to obtain an equivalent single-level optimization problem. Other solution algorithms should thus be explored to solve a bi-level model with a mixed-integer lower-level problem (Dempe, Kalashnikov, Pérez-Valdés, & Kalashnikova, 2015).

Expansion models (1)–(3) account for the variability and uncertainty of stochastic power generation through the capacity factors ρgs
                      and 
                        
                           
                              ρ
                              ˜
                           
                           
                              g
                              s
                              r
                           
                        
                     . Since forecast errors are disregarded in model (1), each time segment is characterized by known capacity factor values ρgs
                      in this model. Conversely, each time segment in models (2) and (3) includes a set of scenarios characterizing the probability distributions of the capacity factors 
                        
                           
                              ρ
                              ˜
                           
                           
                              g
                              s
                              r
                           
                        
                      to account for forecast errors at the balancing stage. This uncertainty arises from short-term variations of weather parameters such as the wind speed, and therefore it applies to both existing and newly installed capacity.

For computational tractability, the generation and transmission expansion models proposed in this paper overlook the inter-temporal operating constraints and therefore the variability of stochastic parameters throughout the planning horizon are characterized using their stationary probability distributions. This is the most common approach followed in the technical literature (Baringo & Conejo, 2012; Ehrenmann & Smeers, 2011; Murphy & Smeers, 2005; Orfanos et al., 2013; Torre et al., 2008; Wang, Shahidehpour, Li, & Botterud, 2009). The interested reader is referred to Burke and O’Malley (2009) for inspiration on how to capture the variability cost of wind power production using time series models within capacity expansion models.

In the steps below, we describe how the variability and uncertainty of these capacity factors are characterized in this paper.

                        
                           1.
                           First, we determine the duration curve associated with the wind speed during a year at a given location. Using the power curve of the wind turbines, wind speed values are converted into capacity factors ranging between 0 (no production) and 1 (full capacity).

This duration curve is approximated by Ns
                               time segments of different durations τs
                               as in Baringo and Conejo (2012) 
                              Ehrenmann and Smeers (2011) 
                              Murphy and Smeers (2005) 
                              Orfanos et al. (2013) 
                              Torre et al. (2008) 
                              Wang et al. (2009).

For time segment s characterized by the capacity factor ρgs
                               computed in Step 2, we determine a probability distribution characterizing the forecast error of the wind power production value. The probability distribution of the forecast error is modeled as a beta distribution, whose parameters are estimated according to the procedure presented in Fabbri, GomezSanRoman, RivierAbbad, and MendezQuezada (2005).

For each time segment s, we discretize the probability distribution determined in Step 3 by random sampling from the beta distribution. This leaves us with a set of equiprobable scenarios for the forecast error.

Steps 1–4 illustrate the procedure to characterize the variability of the wind power capacity factor and its forecast error at a single location. Incorporating the correlation among wind power production at different geographical locations to generate scenarios significantly complicates this procedure and is therefore left out of this document. The interested reader can find the details about this methodology in (Morales, Mínguez, & Conejo, 2010). Note that scenario reduction techniques can be applied to reduce the size of the scenario sets obtained in step 4 while maintaining the main statistical features of the forecast errors (Morales, Pineda, Conejo, & Carrion, 2009).

Next a small example is used to provide intuition about the three expansion planning models previously described. For the sake of illustration, a single target year is considered (Baringo & Conejo, 2012; Chung, Li, & Wang, 2004; Kazempour & Conejo, 2012; Latorre et al., 2003; Wang et al., 2009). Despite its reduced size, this example provides evidence to the fact that the limited predictability of renewable energy sources impacts the optimal expansion planning of a power system. Furthermore, the magnitude of this impact is contingent on the design of the electricity market that governs the short-term operation of the system.


                        Fig. 1 shows a small power system that initially consists of one load j
                        1 and an inflexible generating unit g
                        1 (solid lines). Fig. 2
                         plots the load duration curve of the per-unit consumption at the pre-existing node n
                        1, with a peak load of 500 megawatt. The marginal cost and capacity of g
                        1 are equal to $10/megawatt-hour and 500 megawatt, respectively.

In order to increase the contribution of renewables to the electricity supply (e.g., to comply with a certain target), the system in Fig. 1 can be expanded through the following available projects (dashed lines):

                           
                              –
                              The installation of a wind farm with a capacity of up to 1000 megawatt at n
                                 2. This site is characterized by the duration curve of the per-unit wind power production depicted in Fig. 2. The fixed and variable annualized investment costs associated with this project are 
                                    
                                       c
                                       
                                          g
                                          2
                                       
                                       fix
                                    
                                  = $25 000 and 
                                    
                                       c
                                       
                                          g
                                          2
                                       
                                       var
                                    
                                  = $50 000/megawatt.

Two new thermal generating units, g
                                 3 and g
                                 4, at nodes n
                                 3 and n
                                 4, respectively. The characteristics of these units are collated in Table 1
                                 . Note that both units have the same marginal cost 
                                    
                                       c
                                       g
                                       fuel
                                    
                                  and the same investment costs 
                                    
                                       
                                          c
                                          g
                                          fix
                                       
                                       ,
                                       
                                          c
                                          g
                                          var
                                       
                                       ,
                                    
                                  and that, unlike the pre-existing generator g
                                 1, they are flexible, i.e., they both provide energy for balancing. More specifically, unit g
                                 4 offers more expensive upward regulation than unit g
                                 3, but is also willing to repurchase energy in the balancing market at a much higher price.

Three new transmission lines, l
                                 1, l
                                 2 and l
                                 3, to connect the pre-existing bus n
                                 1 with the wind farm, unit g
                                 3, and unit g
                                 4, respectively. The data pertaining to the new transmission lines is provided in Table 2. Lines l
                                 2 and l
                                 3 have the same length, which is in turn five times shorter than the length of l
                                 1. Correspondingly, the investment costs of l
                                 2 and l
                                 3 are five times lower than those of l
                                 1.

For
                         simplicity, unexpected failures of thermal generating units are disregarded here, i.e., 
                           
                              
                                 ρ
                                 
                                    g
                                    s
                                 
                              
                              =
                              
                                 
                                    ρ
                                    ˜
                                 
                                 
                                    g
                                    s
                                    r
                                 
                              
                              =
                              1
                              ,
                              
                              ∀
                              g
                              ∈
                              
                                 {
                                 
                                    g
                                    1
                                 
                                 ,
                                 
                                    g
                                    3
                                 
                                 ,
                                 
                                    g
                                    4
                                 
                                 }
                              
                              ,
                              ∀
                              s
                              ,
                              ∀
                              r
                           
                        . Moreover, load j
                        1 is assumed to be inelastic with 
                           
                              c
                              
                                 j
                                 1
                              
                              shed
                           
                         = $500/megawatt-hour. Finally, the capacity of the available expansion projects is discretized in 1 megawatt blocks, i.e., 
                           
                              
                                 
                                    p
                                    ^
                                 
                                 g
                              
                              =
                              
                                 
                                    f
                                    ^
                                 
                                 l
                              
                              =
                              1
                              ,
                              ∀
                              g
                              ∈
                              
                                 G
                                 N
                              
                              ,
                              ∀
                              l
                              ∈
                              
                                 L
                                 N
                              
                           
                        .

The variability of the forecasts for wind power production and demand throughout the planning horizon is approximated by 20 time segments. Likewise, a set of 30 scenarios is generated for each time segment to characterize the forecast errors of the wind power production as explained in Section 3.

The plans to expand the power system, together with their associated total investment costs from expansion planning models (1)–(3) are compared in Table 3 as a function of a minimum target of wind power penetration. Recall that model (1) disregards the forecast errors of wind power production, while these are considered in both (2) and (3). However, whereas (2) assumes that forecast errors are efficiently handled by a market organization that optimally coordinates the day-ahead generation scheduling with the subsequent balancing operation of the power system, (3) presupposes no coordination at all. Note also that the optimal investments in lines l
                        2 and l
                        3 are not included here because they turn out to be in all cases equal to the capacities of generating units g
                        3 and g
                        4, respectively.

As expected, the expansion model (1) does not suggest investing in the flexible generating units g
                        3 or g
                        4, since it assumes that the wind power production is perfectly predictable. Furthermore, notice that, according to (3), a central planner seeking to meet the renewable energy target should invest in flexible unit g
                        2 (with a less expensive upward balancing service), but not in flexible unit g
                        4 (which offers cheaper downward regulation). The reason for this is that, in order for the system to fully benefit from the cheap downward regulation of g
                        4, this unit needs to be dispatched in the day-ahead market out of merit order. This is, however, not possible under the market design considered in expansion model (3) due to the optimality condition (3c). In contrast, such dispatch decisions are feasible under the market design in expansion model (2). Accordingly, model (2) suggests investing in unit g
                        4 and not in unit g
                        3, with the consequent increase in system efficiency as downward regulation brings fuel cost savings. Finally, observe that considering forecast errors involves an increase of the installed capacity of wind farm g
                        2 in models (2) and (3) compared to model (1), being such capacity higher for the inefficient market design considered in expansion model (3).

Regarding investment costs, expansion model (1) unsurprisingly yields the least costly expansion plan, as it supposes an utopian power system operation without wind power forecast errors. The impact of these errors on the investment costs depends on both the underlying market design and the wind energy target. Indeed, for low wind power penetration levels, the efficient market design in expansion model (2) and the inefficient market design in model (3) induce expansion plans that are similar in terms of investment costs. However, as the wind energy target is increased, the inefficient market design prompts an expansion plan which is gradually more expensive than the one triggered by the efficient market design.

In this section we present the results from expansion models (1)–(3) in a more realistic 24-bus power system (Grigg et al., 1999). Due to computational limitations, the first part of the case study considers one single target year, while the last part determines the generation and transmission expansion decisions for a three-year planning horizon. The characteristics of the existing generating units are listed in Table 4
                     . Line susceptances are those in Grigg et al. (1999), while the capacities of all lines are reduced to 175 megawatt. The demand at each bus is determined according to the parameters provided in Grigg et al. (1999) for a peak demand equal to 2850 megawatt for the single year case. As in the illustrative example, the demand is assumed to be inelastic, and failures of units and lines are disregarded for simplicity (Pineda, Morales, Ding, & Østergaard, 2014).

In order to increase the penetration of renewable electricity production, the following projects are available:

                        
                           –
                           Wind farms of 1000 megawatt maximum (in blocks of 50 megawatt) to be located at buses n
                              6, n
                              8, n
                              13 and n
                              23 with a fixed investment cost 
                                 
                                    c
                                    g
                                    fix
                                 
                               = $25 000/year and a variable investment cost of 
                                 
                                    c
                                    g
                                    var
                                 
                               = $75 000/megawatt · year.

Reinforcement of some existing lines from single to double circuit (n
                              6
                              n
                              10, n
                              8
                              n
                              9, n
                              11
                              n
                              13 ,n
                              11
                              n
                              14, n
                              12
                              n
                              23, n
                              14
                              n
                              16) and the construction of a new line of 51 miles from n
                              12 to n
                              21 of 175 or 350 megawatt of capacity and a susceptance of 37.8 p.u. Fixed and variable investment costs of transmission lines amount to $16 400/mile · year and $2.88/megawatt mile · year , respectively.

Six flexible generating units which makes up the installation of one or two additional generating groups to the existing gas-based power plants at buses n
                              18, n
                              21 and n
                              22 with the same characteristics as those provided in Table 4. Fixed and variable investment costs amount to $20 000/year and $25 000/megawatt · year.

Wind speed data of 2006 provided by the National Renewable Energy Laboratory (NREL) and corresponding to four sites with coordinates (42°21’ N, 95°45’ W), (42°21’ N, 95°20’ W), (42°26’ N, 95°4’ W) and (45°13’ N, 96°55’ W) is employed in this analysis to model wind power productions at buses n
                     6, n
                     8, n
                     13 and n
                     23, respectively. The linear correlation parameters characterizing the spatial dependence of the wind power production at different buses are provided in Table 5
                     . These data can be freely downloaded from NREL (2013). A set of 10 time segments is used to characterize the variability of demand and stochastic production throughout the planning horizon. Besides, a set of 10 scenarios modeling the uncertainty of the forecast errors is generated for each time segment.


                     Table 6
                      provides expansion planning results for a renewable target of 20 percent. Observe that unlike model (1), expansion models (2) and (3) propose the installation of additional flexible generation as well as the line n
                     12
                     n
                     21 or the lines n
                     11
                     n
                     14 and n
                     14
                     n
                     16 connecting the area of flexible generation (north) with the area of wind production (east). In addition, it is worth mentioning that the expansion plan suggested by model (3) entails an investment cost 4.7 percent higher than that of model (2), which highlights the benefits of an efficient market design in reducing the expansion efforts required to integrate a given amount of renewable production into a power system.

To complement this analysis, we now discuss the implications of disregarding forecast errors by evaluating the expansion plan that results from model (1). Assuming a market design that efficiently handles forecast errors, the first two rows of Table 7
                      provide, for different renewable targets, the total expected cost (including both investment and system operating costs in m$) and the actual level of wind penetration (in parentheses) that result from the expansion plans proposed by models (2) and (1), respectively. Observe that, although the expansion plan given by model (1) involves very similar total cost, the realized wind penetration level is significantly reduced. The reason is that in view of the lack of investments in flexible assets in model (1), an efficient market would reduce the dispatch of stochastic generation to keep the balancing costs low, thus reducing the operational costs, but also the wind penetration level.

Similarly, the third and fourth rows present analogous results considering an inefficient treatment of forecast errors by the market and compare the expansion plans corresponding to models (3) and (1). Note that under this type of market design, the expansion plan of model (1) results in a total cost significantly higher than the optimal one, but achieves a wind share level fairly close to the target. This is due to the fact that an inefficient market would dispatch a high amount of cheap, but uncertain renewable generation and then resort to uneconomical balancing resources (e.g., involuntary load curtailment) to accommodate energy deviations. As a result, the wind target is approximately reached but at an extremely high cost.

In summary, the results in Table 7 show that, irrespective of how efficiently forecast errors are handled by the market, disregarding these forecast errors when making expansion planning decisions entails undesired outcomes either in terms of system cost or in the achievement of a pre-established renewable target.

To conclude this section, expansion models (1)–(3) are also solved for a three-year planning horizon. All the data corresponding to generating units, the network, and the available expansion projects are equal to those previously considered for the case of a single target year. The yearly demand growth and discount rate are the same for the three years and equal to 3 percent and 2 percent, respectively. Likewise, the renewable targets for the first, second and third year are equal to 6.7 percent, 13.3 percent and 20 percent, respectively. Table 8
                      provides the optimal expansion decisions for each year together with the total investment costs for each of the market designs presented in this paper.

Similarly to Table 6, results in Table 8 for a three-year planning horizon confirm two findings. First, that forecast errors of renewable power production significantly impacts the expansion planning of a power system. Second, that the investment cost required to reach a given penetration of renewable energy sources (20 percent in this case) is lower under a market design that efficiently copes with the forecast errors of renewable power production.

The simulations presented in this paper are solved using CPLEX 12.3.0 under GAMS on a Linux-based server with eight processors clocking at 1.6 gigahertz and 48 gigabyte of RAM. The approximated computational times required to solve optimization models (1)–(3) for a planning horizon of one target year and a gap of 0 percent are 1, 3 and 100 hours, respectively. For a planning horizon of three years and a gap of 1 percent, these times amount to 60, 115 and 200 hours, respectively.

@&#CONCLUSION@&#

This paper investigates the impact of forecast errors from uncertain renewable generation on the optimal expansion planning of a power system. To this end, we introduce three generation and transmission expansion models that differ in how these errors are handled by the underlying electricity market. Model (1), which is the most widespread in the technical literature, simply ignores that these errors occur, while the other two explicitly account for a balancing mechanism to deal with them. Model (2), as opposed to (3), represents a market organization where prediction errors are “perfectly” managed by co-optimizing the day-ahead and balancing stages. By comparing these three expansion models, we show that:

                        
                           1.
                           Disregarding forecast errors may lead to a highly suboptimal expansion plan.

The way this expansion plan is suboptimal, i.e., either in terms of cost efficiency or in terms of renewable energy penetration, is dependent on how efficient the electricity market is in coping with forecast errors.

A market design that efficiently handles forecast errors requires lower expansion efforts to integrate a given amount of renewable production into a power system.

A possible direction of future research is the expansion of the proposed models to include long-term uncertainties and compare their relative impact with that associated to short-term uncertainties such as power forecast errors. Likewise, investigating how to incorporate inter-temporal constraints such as ramp limits and minimum times into the two-stage electricity market designs considered and analyzing their impact on generation and transmission expansion planning are also ground for future research. Another aspect that requires further investigation is the use of dedicated computational methods to solve the proposed expansion models for realistic power systems with more than 24 buses as well as the analysis of the scalability of these models (Lumbreras & Ramos, 2013). Finally, relaxing the perfect competition assumption to propose generation and transmission expansion models that incorporate the potential exercise of market power by producers and investors is also worth investigating.

@&#ACKNOWLEDGMENTS@&#

S. Pineda and T. K. Boomsma thank the Danish Council for Strategic Research for support through 5s – Future Electricity Markets project, no. 12-132636/DSF. The work of J.M. Morales is partly funded by DSF (Det Strategiske Forskningsrå d) through ENSYMORA (no. 10-093904) and CITIES (no. 1035-00027B) projects.

@&#REFERENCES@&#

