@&#MAIN-TITLE@&#Assessment of health status over time by Prevalence and Weighted Prevalence functions: Interface in R

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The importance of evaluating complications has been stressed in many publications.


                        
                        
                           
                           Descriptive analysis may not be sufficient to evaluate long-term complications.


                        
                        
                           
                           This paper provides two R functions using Prevalence and Weighted Prevalence.


                        
                        
                           
                           This method considers duration and repetitions unlike conventional methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Complication

Health state

Survival analysis

Prevalence function

R software

@&#ABSTRACT@&#


               
               
                  The importance of evaluating complications and toxicity during and following treatment has been stressed in many publications. In most studies, these endpoints are presented descriptively and summarized by numbers and percentages but descriptive methods are rarely sufficient to evaluate treatment-related complications. Pepe and Lancar developed Prevalence and Weighted Prevalence functions which take into account the duration and the severity of complication unlike conventional methods of survival analysis or competing risks which are limited to the time to first event. The purpose of this paper is to describe features and use of two R functions, main.preval.func and main.wpreval.func, which were designed for the analysis of survival adjusted for quality of life. These functions compute descriptive statistics, survival and competing risks analysis and especially Prevalence and Weighted Prevalence estimations with confidence intervals and associated test statistics. The use of these functions is illustrated by several examples.
               
            

@&#INTRODUCTION@&#

In cancer clinical trials, survival is often used as the primary endpoint of interest. However, assessment of side effects in patients during and after the initial treatment phase has become an important factor in the evaluation of therapeutic strategies. In fact, new targeted therapies have permitted an increase in patient survival, but to the detriment of early and/or late side effects, which can evolve over time in severity. They can get better or worse or disappear altogether. Those that persist may have a negative impact on quality of life. Taking into account the nature of these side effects as well as their intensity in the evaluation of the quality of survival is an important challenge. When outcomes are considered similar, say, in terms of overall survival, an individual may not necessarily assign the same utility to various side effects: “While the risk of dying from the primary cancer is a consequence of disease itself, treatment-related side-effects are more difficult to accept psychologically, even if they can be seen as the price for surviving the cancer, as they are actively inflicted by the therapy” [1].

The importance of evaluating complications and toxicity during and following treatment has been stressed in many publications in particular for radiation therapy [2,3]. Multiple scales are available for the coding of these deleterious effects, NCI-CTC being the most common. From the perspective of the patient quality of life may be encoded by scales such as the SF-36 or other QLQC-30 [4]. Whatever the scale, all allow a classification into a particular health state which can be classified into categories ranging from 0 to 5. In most studies, these health states are presented descriptively and summarized by numbers and percentages. However, these methods are rarely sufficient to evaluate treatment-related complications. Pepe [5] proposed the prevalence function, defined as the probability of being in a specific health state at time t among patients alive without relapse. This method takes into account duration and transitions between the state of complication unlike conventional methods of survival analysis or competing risks which are limited to the time to first event. Lancar [6] developed a Weighted Prevalence function, which is obtained from the weighted sum of the prevalence function associated with a specific severity category at a specific time point. This generalization produces a score that takes into account not only the duration of the transitions but also the severity of complications.

This paper provides two R functions for the analysis of survival adjusted for quality of life using Prevalence and Weighted Prevalence functions respectively. Methods as well as a small example are presented in Section 2. Both R functions are described in Section 3. In Section 4, results of a phase III randomized trial comparing two pre-operative brachytherapy low dose rates in patients with localized stage cervix carcinoma will be used for illustration [6–8].

@&#METHODOLOGY@&#

During treatment and follow-up, let us suppose that patients are exposed to a finite number of health states which can be categorized according to complications, relapse or death. The term “complication” will be used to refer to categories of toxicity, quality of life or health states in general. The term “cure” will be used to refer to the state “alive with no complication”. The term “relapse/death” will be used to refer to the state of relapse or death.

The different transitions between health states are illustrated in Fig. 1
                        . At the start of treatment, patients are considered to be in the “initial” state, that is, complication and relapse free. Patients can stay in this state or move to either the “complication” or “relapse/death” states. When the patient enters into the “complication” state, there are two possible transitions either to the “cure” state or to the “relapse/death” state. Patients cannot go directly from the “initial” state to the “cure” state because they must first go through the “complication” state to eventually be cured from complications.

The “initial” state is considered as a transient state because patients cannot go back to this state once another state has been reached. The “complication” and “cure” states are considered as recurrent states because patients can move back and forth from one of these states to another. And finally, the “relapse/death” state is defined as an absorbent state since for the purposes of this analysis patients cannot move out of this state.

The state “Complication” is composed of K grades of severity (max(K)=5). Patients can enter into a complication states C
                        1 to C
                        
                           K
                        , before exiting the complication and can move between severity grades. Severity can decrease by moving from C
                        4 to C
                        3 or C
                        3 to C
                        1 and can increase moving from C
                        1 to C
                        2 or C
                        2 to C
                        4 for example.

Since patients can present several complications of varying severity, the worst grade method, commonly used in the literature, defines the severity of the health state at a particular point in time by the maximum grade for each patient. Other methods can be used of course to attribute a patient's health to a particular state. In oncology, one such commonly used method can be the ECOG performance status. Other methods can use results from quality of life scales to classify patients into health categories. Nevertheless, the frequency of each health state can be summarized and the Pearson Chi-square or the Fisher exact test can be used to compare the distribution of health states between groups.

This method however, compares only the percentage of complications in each severity category, which is not sufficient to describe the dynamic nature of the side effects, especially long term health indicators. They can be misleading in the situation where complications can occur after a long follow-up period but where most patients only have a short follow-up.

Event-free survival (EFS) can be used as an indicator of treatment failure, by including complications, relapses and deaths as events. Another more specific terminology can be also used: Complication relapse death free survival (CRDFS). With this event definition, only patients lost to follow-up are considered as censored observations at the time of last visit. This composite endpoint represents the probability to be alive without complication and relapse-free at time t. Let t
                           1
                           <
                           t
                           2
                           <⋯<
                           t
                           
                              N
                            represent N ordered time to first events, the EFS rates estimated by Kaplan–Meier approach are the following [9]:
                              
                                 
                                    
                                       
                                          
                                             S
                                             ˆ
                                          
                                          
                                             E
                                             F
                                             S
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∏
                                          
                                             
                                                t
                                                j
                                             
                                             ≤
                                             t
                                          
                                       
                                       
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      d
                                                      (
                                                      
                                                         t
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      n
                                                      (
                                                      
                                                         t
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Where d(t
                           
                              j
                           ) represents the number of events at time t
                           
                              j
                            and n(t
                           
                              j
                           ) the number of patients at risk at time t
                           
                              i
                           . In other words, only time to fist event whatever its nature is analyzed.

The logrank test can be used to compare EFS between groups [10].

When relapse or death are relatively frequent, the probability of experiencing complications can be altered by these competing events, and relapse or death cannot be considered in the same manner as lost to follow-up. The methodology proposed by Kalbfleish and Prentice takes into account the informative nature of the censoring [11]. The cumulative incidence or “crude” probability associated with the complication state at time t, I
                           
                              C
                           (t), defined by the cumulative probability of complication having occurred in the presence of death and relapse as competing events, is estimated by:
                              
                                 
                                    
                                       
                                          
                                             I
                                             ˆ
                                          
                                          C
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             
                                                t
                                                j
                                             
                                             ≤
                                             t
                                          
                                       
                                       
                                          
                                             
                                                S
                                                ˆ
                                             
                                             
                                                E
                                                F
                                                S
                                             
                                          
                                          (
                                          
                                             t
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          )
                                          ×
                                          
                                             
                                                h
                                                ˆ
                                             
                                             C
                                          
                                          (
                                          
                                             t
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           with 
                              
                                 
                                    
                                       h
                                       ˆ
                                    
                                    C
                                 
                                 (
                                 
                                    t
                                    j
                                 
                                 )
                              
                            the estimated hazard function at time t
                           
                              i
                            for complication conditional on no other events having occurred earlier, is given by:
                              
                                 
                                    
                                       
                                          
                                             h
                                             ˆ
                                          
                                          C
                                       
                                       (
                                       
                                          t
                                          j
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                d
                                                C
                                             
                                             (
                                             
                                                t
                                                j
                                             
                                             )
                                          
                                          
                                             n
                                             (
                                             
                                                t
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where d
                           
                              C
                           (t
                           
                              j
                           ) represents the number of entries in complication state at time t
                           
                              i
                           .

This expression shows that cumulative incidence is a function of both the probability of not having failed from any type of first events up to time t, 
                              
                                 
                                    
                                       S
                                       ˆ
                                    
                                    
                                       E
                                       F
                                       S
                                    
                                 
                                 (
                                 t
                                 )
                              
                           , and the cause specific hazard of the event of interest 
                              
                                 
                                    
                                       h
                                       ˆ
                                    
                                    C
                                 
                                 (
                                 t
                                 )
                              
                           . This method is defined as the Include method [12] and provides information concerning the cumulative incidence of patients entering in a complication state by time t and does not make the assumption of independence between the different types of events.

This method can also be used to estimates cumulative incidence of relapse or death:
                              
                                 
                                    
                                       
                                          
                                             I
                                             ˆ
                                          
                                          
                                             R
                                             D
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             
                                                t
                                                j
                                             
                                             ≤
                                             t
                                          
                                       
                                       
                                          
                                             S
                                             ˆ
                                          
                                          (
                                          
                                             t
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          )
                                          ×
                                          
                                             
                                                h
                                                ˆ
                                             
                                             
                                                R
                                                D
                                             
                                          
                                          (
                                          
                                             t
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           with 
                              
                                 
                                    
                                       h
                                       ˆ
                                    
                                    
                                       R
                                       D
                                    
                                 
                                 (
                                 
                                    t
                                    j
                                 
                                 )
                              
                            the estimated hazard function for relapse/death at time t
                           
                              j
                            conditional on no other events having occurred earlier, is given by:
                              
                                 
                                    
                                       
                                          
                                             h
                                             ˆ
                                          
                                          
                                             R
                                             D
                                          
                                       
                                       (
                                       
                                          t
                                          j
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                d
                                                
                                                   R
                                                   D
                                                
                                             
                                             (
                                             
                                                t
                                                j
                                             
                                             )
                                          
                                          
                                             n
                                             (
                                             
                                                t
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where d
                           
                              RD
                           (t
                           
                              j
                           ) represents the number of relapse/death at time t
                           
                              j
                           .

The EFS can be decomposed according to the proportion of each type of event. The sum of the two cumulative incidence estimates is equal to the complement of the EFS:
                              
                                 
                                    
                                       
                                          
                                             I
                                             ˆ
                                          
                                          C
                                       
                                       (
                                       t
                                       )
                                       +
                                       
                                          
                                             I
                                             ˆ
                                          
                                          
                                             R
                                             D
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       1
                                       −
                                       
                                          
                                             S
                                             ˆ
                                          
                                          
                                             E
                                             F
                                             S
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        

The Gray test, based on subdistribution functions, can be used to compare cumulative incidence functions between groups [13].

Although these methods are being used more and more in the analysis of competing risks, they have their limitations in the analysis of events such as late complications, since they do not take into account duration, severity or repetitions of these events. In fact, these methods consider complications as irreversible events and thus attach more importance to the occurrence of the first complication which may occur early. Other long term complications experienced by patients who already had a complication early on during follow-up will thus be ignored. With this method, patients are at risk of only one event.

The prevalence Q
                        
                           k
                        (t) of a given early event at a specified time-point is defined as the proportion of patients in a complication state k(C
                        
                           k
                        ) relative to the total number of patients at risk at time t. When no patient is in a complication state, that is all complications are cured among those patients still alive, then the prevalence is zero at that time point.

Prevalence can be easily adapted in the presence of censored information using survival analysis for late complications [5]. The prevalence can be written as the probability having a specific type and grade of complication C
                           
                              k
                            at time t conditionally on being alive and relapse free at time t:
                              
                                 
                                    
                                       
                                          Q
                                          k
                                       
                                       (
                                       t
                                       )
                                       =
                                       P
                                       [
                                       alive in
                                        
                                       
                                          C
                                          k
                                       
                                        
                                       at
                                        
                                       t
                                        
                                       |
                                       alive and relapse-free at
                                        
                                       t
                                       ]
                                    
                                 
                              
                           
                        

In order to take into account several possible entries into the complication state C
                           
                              k
                           , this prevalence function can be rewritten as:
                              
                                 
                                    
                                       
                                          Q
                                          k
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          P
                                          [
                                          alive in
                                           
                                          
                                             C
                                             k
                                          
                                           
                                          for the
                                           
                                          m
                                          th
                                           
                                          time at
                                           
                                          t
                                           
                                          |
                                          alive and relapse-free at
                                           
                                          t
                                          ]
                                       
                                    
                                 
                              
                           where M corresponds to the number of maximum possible entries in the complication state C
                           
                              k
                           . This function can be re-written as:
                              
                                 
                                    Q
                                    k
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       
                                          P
                                          [
                                          RD
                                           
                                          or
                                           
                                          
                                             C
                                             k
                                          
                                           
                                          for the
                                           
                                          m
                                          th
                                           
                                          time at
                                           
                                          t
                                          ]
                                          −
                                          P
                                          [
                                          RD
                                           
                                          or
                                           
                                          cure from
                                           
                                          
                                             C
                                             k
                                          
                                           
                                          for the
                                           
                                          m
                                          th
                                           
                                          time at
                                           
                                          t
                                          ]
                                       
                                       
                                          P
                                          [
                                          RD alive and relapse-free at
                                           
                                          t
                                          ]
                                       
                                    
                                 
                              
                           
                        

To obtain the mathematical expression, (2M+1) random variables are defined which correspond to the following events:
                              
                                 -
                                 
                                    CT
                                    
                                       m
                                    : time until entry into complication state C
                                    
                                       k
                                     for the mth time or until relapse or death (m
                                    =1,…,M)


                                    CU
                                    
                                       m
                                    : time until exit from complication state C
                                    
                                       k
                                     for the mth time or until relapse or death (m
                                    =1,…,M)


                                    RD: time until relapse or death

The (2M+1) survival functions associated with these random variables can be estimated using the Kaplan–Meier method, and then combined to estimate prevalence Q
                           
                              k
                           (t). The combination of the (2M+1) estimated survival functions at time t for the corresponding events defined above [9] can be easily rewritten to obtain 
                              
                                 
                                    
                                       Q
                                       ˆ
                                    
                                    k
                                 
                                 (
                                 t
                                 )
                              
                           , the estimated prevalence of complication state k:
                              
                                 
                                    
                                       
                                          
                                             Q
                                             ˆ
                                          
                                          k
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                                [
                                                
                                                   
                                                      S
                                                      ˆ
                                                   
                                                   
                                                      C
                                                      U
                                                   
                                                   m
                                                
                                                (
                                                t
                                                )
                                                −
                                                
                                                   
                                                      S
                                                      ˆ
                                                   
                                                   
                                                      C
                                                      T
                                                   
                                                   m
                                                
                                                (
                                                t
                                                )
                                                ]
                                             
                                          
                                          
                                             
                                                
                                                   S
                                                   ˆ
                                                
                                                
                                                   R
                                                   D
                                                
                                             
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        

These K prevalence functions, k
                           =1,…,K, provide information on the duration and possible repetitions of each k event contrary to competing risks and the usual survival analysis methods, with complications defined as a reversible event. In a yes/no situation, the K event categories are usually regrouped into two mutually exclusive categories, for example, k
                           ≥1 versus k
                           =0, or k
                           ≥2 versus k
                           ≤1. The advantage of using prevalence functions is that this method takes into account the evolution (recovery or worsening) of complications with time. When recovery occurs, the prevalence decreases over time. This information is just as important in the evaluation of treatment strategies as in patient counseling.

The preceding method takes into account duration and possible repetitions of a complication state, but it only treats severity in an individual manner. In order to use the ordered nature of severity, Weighted Prevalence has been proposed [6,7].

First of all, for each complication severity category, individual prevalence needs to be estimated. The Weighted Prevalence can then be expressed as the sum of the separate prevalence functions for each complication severity grade with pre-defined increasing weights. In the case of K severity grades the Weighted Prevalence is estimated by:
                              
                                 
                                    
                                       w
                                       
                                          Q
                                          ˆ
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             w
                                             k
                                          
                                          
                                             
                                                Q
                                                ˆ
                                             
                                             k
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       Q
                                       ˆ
                                    
                                    k
                                 
                                 (
                                 t
                                 )
                              
                            is the estimated prevalence associated with each complication severity grade and 0<
                           w
                           1
                           <
                           w
                           2
                           <⋯<
                           w
                           
                              K
                           
                           <
                           ∞ the corresponding weights. These weights need to be fixed in advance. One possibility is to define each weight as the same value as the corresponding grade. This hypothesis assumes that a grade 2 complication is half severe as a grade 4. Other grading systems can be used. For example, the classification into a particular severity category can take into account the cost associated with being in a particular complication state.

The prevalence estimates the proportion of patients present in a particular complication severity grade at a specific point in time among those patients who are still alive and considered at risk of a complication. The interpretation of Weighted Prevalence is more difficult than individual prevalence since it corresponds to a score and results can be different according to the chosen weights, which do not represent a proportion of patients but rather a mean score.

Let us consider the following example with no censoring, ten patients and only two grades of severity. In this fictive study spanning 7 years, 6 relapses or deaths are observed, 5 patients entered in the complication state (C
                           1 or C
                           2) and only 1 patient moved from the complication state. Life histories of patients are summarized in Table 1
                           .

To estimate the prevalence function at each time, the Kaplan–Meier survival estimates associated with the corresponding variables defined in 2.4.1 was used. In this example, M
                           =1 so only first entries are considered. Patients can be in the complication state with two different grades but this will be not taken into account in the estimation because individual prevalence does not consider severity. Results of prevalence function estimates are displayed in Table 2
                            and shown in Fig. 2
                           .

For example, at t
                           =2, 2 patients entered in the complication state (npat
                           =8 and 9) no patients moved from the complication state and 1 patient relapsed (npat
                           =3). 
                              
                                 
                                    
                                       S
                                       ˆ
                                    
                                    
                                       C
                                       T
                                    
                                 
                                 (
                                 2
                                 )
                                 =
                                 0.8
                                 ×
                                 (
                                 1
                                 −
                                 3
                                 /
                                 8
                                 )
                                 =
                                 0.5
                              
                            and 
                              
                                 
                                    
                                       S
                                       ˆ
                                    
                                    
                                       C
                                       U
                                    
                                 
                                 (
                                 2
                                 )
                                 =
                                 
                                    
                                       S
                                       ˆ
                                    
                                    
                                       R
                                       D
                                    
                                 
                                 (
                                 2
                                 )
                                 =
                                 1
                                 ×
                                 (
                                 1
                                 −
                                 1
                                 /
                                 10
                                 )
                                 =
                                 0.9
                              
                            according to the Kaplan–Meier estimation method so 
                              
                                 
                                    
                                       Q
                                       ˆ
                                    
                                    C
                                 
                                 (
                                 2
                                 )
                                 =
                                 (
                                 0.9
                                 −
                                 0.5
                                 )
                                 /
                                 0.9
                                 =
                                 0.444
                              
                           . At year 4, the prevalence is estimated at 50%, meaning that one half of patients alive and relapse-free were in the complication state at this time. Prevalence increases to 62.5% until 3 years and then decreases to 25%. This is due to patients relapsing or dying whereas they were in the complication state so they were no longer considered in the estimation.

Weighted Prevalence is the sum of individual prevalence for each grade with a respective weight. Assuming that (w
                           1,w
                           2)=(1,2) means that grade 2 is considered two times more severe than a grade 1. Results of Weighted Prevalence estimation function are displayed in Table 3
                            and shown in Fig. 2.

For example, at t
                           =3, 1 patient entered in C
                           1 (npat
                           =6), 1 patient moved from C
                           1 and entered in C
                           2 (npat
                           =1) and 1 patient relapsed (npat
                           =2). The individual prevalence of grade 1 (resp. grade 2) is equal to 0.5 (resp. 0.125) so 
                              
                                 w
                                 
                                    Q
                                    ˆ
                                 
                                 (
                                 3
                                 )
                                 =
                                 
                                    w
                                    1
                                 
                                 
                                    
                                       Q
                                       ˆ
                                    
                                    
                                       
                                          C
                                          1
                                       
                                    
                                 
                                 (
                                 3
                                 )
                                 +
                                 
                                    w
                                    2
                                 
                                 
                                    
                                       Q
                                       ˆ
                                    
                                    
                                       
                                          C
                                          2
                                       
                                    
                                 
                                 (
                                 3
                                 )
                                 =
                                 0.75
                              
                           . Weighted estimates are equal to prevalence estimation at time 1, 2, 6 and 7 but they are higher at the other times because two patients enter in C
                           2 at respectively 3 and 4 years. At year 4, Weighted Prevalence is estimated at 0.667 versus 0.5 for the prevalence estimate. Weighted Prevalence is interpreted as a score and does not represent a proportion of patients.

Prevalence and Weighted Prevalence functions can be estimated for several groups. In the case of two groups, the weighted generalized Kaplan–Meier statistic [14] can be used to test differences between these functions under the following hypothesis:
                              
                                 
                                    
                                       
                                          H
                                          0
                                       
                                       :
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            A
                                                         
                                                         (
                                                         t
                                                         )
                                                         =
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            B
                                                         
                                                         (
                                                         t
                                                         )
                                                         ∀
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            A
                                                         
                                                         (
                                                         t
                                                         )
                                                         =
                                                         w
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            B
                                                         
                                                         (
                                                         t
                                                         )
                                                         ∀
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          H
                                          1
                                       
                                       :
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            A
                                                         
                                                         (
                                                         t
                                                         )
                                                         >
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            B
                                                         
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            A
                                                         
                                                         (
                                                         t
                                                         )
                                                         >
                                                         w
                                                         
                                                            
                                                               Q
                                                               ˆ
                                                            
                                                            B
                                                         
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

This statistic takes the following form:
                              
                                 
                                    
                                       
                                          U
                                          Q
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      A
                                                   
                                                   
                                                      n
                                                      B
                                                   
                                                
                                                
                                                   
                                                      n
                                                      A
                                                   
                                                   +
                                                   
                                                      n
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             C
                                             ˆ
                                          
                                          (
                                          t
                                          )
                                          [
                                          
                                             
                                                Q
                                                ˆ
                                             
                                             A
                                          
                                          (
                                          t
                                          )
                                          −
                                          
                                             
                                                Q
                                                ˆ
                                             
                                             B
                                          
                                          (
                                          t
                                          )
                                          ]
                                          ∂
                                          t
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          U
                                          
                                             w
                                             Q
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      A
                                                   
                                                   
                                                      n
                                                      B
                                                   
                                                
                                                
                                                   
                                                      n
                                                      A
                                                   
                                                   +
                                                   
                                                      n
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             C
                                             ˆ
                                          
                                          (
                                          t
                                          )
                                          [
                                          w
                                          
                                             
                                                Q
                                                ˆ
                                             
                                             A
                                          
                                          (
                                          t
                                          )
                                          −
                                          w
                                          
                                             
                                                Q
                                                ˆ
                                             
                                             B
                                          
                                          (
                                          t
                                          )
                                          ]
                                          ∂
                                          t
                                       
                                    
                                 
                              
                           where T is the total study time and n
                           
                              A
                            and n
                           
                              B
                            correspond to the number of patients in groups A and B respectively. In this comparison, the two functions (Prevalence or Weighted Prevalence) are weighted by 
                              
                                 
                                    C
                                    ˆ
                                 
                                 (
                                 t
                                 )
                              
                           , the left continuous Kaplan–Meier estimate of the censoring distribution. This decreasing weight function takes into account the importance of the variability in the right hand part of the curve due to the smaller amount of information available. For example, in the absence of censoring 
                              
                                 
                                    C
                                    ˆ
                                 
                                 (
                                 t
                                 )
                              
                            is equal to 1. Bootstrap methods or “permutation” methods [2] permit to test for statistical significance, via the calculation of an empirical p-value.

Two functions main.preval.func and main.wpreval.func are presented in this section. Both are written in the R language and compute descriptive statistics, survival and competing risks analysis, Prevalence and Weighted Prevalence estimates, confidence intervals and tests for the comparison between two groups.

The first step consists in downloading two R packages: survival 
                     [15] and cmprsk 
                     [16]. Information and details of how to install packages for other operating systems are available in the R Installation and Administration manual (http://www.Rproject.org) [17]. These functions must be loaded in each work session and require several arguments:
                        
                           
                              main.preval.func(visit,fu,gm,tmax,tp,met,N,export)
                           


                              main.wpreval.func(visit,fu,gm,p,tmax,tp,met,N,export)
                           

Data files can be read into R in a variety of formats and these are fully explained in the R Data Import/Export manual. Two data files are needed in input arguments, and must be expressed as an R numeric matrix. The “visit” file contains information about patient's health state during the study, the number of columns being equal to three:
                              
                                 •
                                 Column 1: Patient identification (integer)

Column 2: Time until complication (calculated from patient entry into the study) (>0)

Column 3: Severity grade of complication (integer 0 to 5, 0 corresponding to no complication)

The “fu” file contains information about patient's follow-up and disease status, the number of rows being equal to the number of patients and the number of columns being equal to six:
                              
                                 •
                                 Column 1: Patient identification (integer)

Column 2: Time until relapse (or last follow-up news otherwise) (>0)

Column 3: Relapse status (0 no relapse, 1 relapse)

Column 4: Time until death (or last follow-up news otherwise) (>0)

Column 5: Death status (0 alive, 1 death)

Column 6: Group membership (consecutive integers)

All times are calculated from patient entry into the study. Several data checks are performed by the program: time until relapse should not exceed time until death, and visits in the “visit” file should occur before the times until relapse or death or last follow-up in the “fu” file. In the first situation, the program will stop. In the second situation, visits after relapse or death or last-follow-up are ignored.


                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                gm
                                             :
                                          minimum severity grade taken into account in the analysis. For example, if gm
                                             =2, patients who entered in C
                                             1 are not considered in the complication state.
                                       
                                       
                                          
                                             
                                                p
                                             :
                                          numeric vector of weights according to each severity grade of complication, this parameter is only used in main.wpreval.func. For example if gm = 1, p = c(1,2,3,4,5) and if gm = 2, p = c(2,3,4,5).
                                       
                                       
                                          
                                             
                                                tmax
                                             :
                                          maximum delay taken into account in the analysis (tmax
                                             >0)
                                       
                                       
                                          
                                             
                                                tp
                                             :
                                          timepoint for which point estimates are displayed in the output.
                                       
                                       
                                          
                                             
                                                met
                                             :
                                          logical vector to select type of tests and 95% confidence intervals for Prevalence or Weighted Prevalence. met
                                             =
                                             c((1),(2),(3)) where (1), (2), (3) correspond to bootstrap test (T or F), “permutation” test (T or F) [5] and bootstrap confidence intervals (T or F). For example, if 
                                                met = c(T,F,T)
                                              the bootstrap test and confidence intervals are computed.
                                       
                                       
                                          
                                             
                                                N
                                             :
                                          number of iterations (>20) in tests and confidence intervals computing.
                                       
                                       
                                          
                                             
                                                export
                                             :
                                          logical parameter, if 
                                                export=T
                                              the graph of the Prevalence or Weighted Prevalence function is exported to the current work file in pdf format.
                                       
                                    
                                 
                              
                           
                        

@&#RESULTS@&#

The example presented in Section 2.4.3 is used to illustrate the outputs of the R functions. The two data files “visit” and “fu” are presented below for one group (Tables 4 and 5
                        
                        ).

For both functions, gm=1, tmax=7 and tp=4 indicating that all complications are taken into account, that the study duration is 7 time units and that estimates are required at t
                        =4 time units.

In main.wpreval.func, p=c(1,2,3,4,5), indicating that a grade 2 is twice more severe than a grade 1. Tests and confidence intervals are not computed in this example (
                           met=c(F,F,F)) so the parameter N does not need to be specified.

The program first verifies consistencies in the data files and input parameters, error messages can be displayed. For example, if tp
                        >
                        tmax or gm
                        >5, the program stops and signals that “Parameter tp (or gm) not appropriate!”. If there is no problem and the data files are considered OK and calculations can continue:
                           
                              
                           
                        
                     

Then the two functions display descriptive statistics of the data, worst grade method, survival and competing risks analysis.

The output below gives us the number of patients in the study (n
                        =10), the number of first entries which correspond to the number of patients who enter at least once into the complication state (n
                        =5). The total number of entries (n
                        =5) and the number of exits to the complication state (n
                        =1) which correspond to the number of patients who were cured from all complications. The number of patients who relapse or die (n
                        =6), the number of patients who relapse or die while in the complication state (n
                        =3) and the number of patients alive and relapse-free (RFS) being in the complication state (n
                        =1).
                           
                              
                           
                        
                        
                           
                              
                           
                        
                     

The worst grade method presents the distribution of patients according to whether their maximum grades observed are above or below gm. In the case of two groups, chi-square or Fisher's exact test is computed to compare the distribution.
                           
                              
                           
                        
                     

The next output summarizes the results of survival analysis computed with the function survfit from the survival package. The event of interest is the occurrence of the first complication or relapse or death (EFS). The Kaplan–Meier survival estimate at tp is displayed (
                           
                              
                                 S
                                 ˆ
                              
                              (
                              4
                              )
                              =
                              0.3
                           
                        ) with the upper and lower 95% confidence intervals (95% CI: [0.116; 0.773]).
                           
                              
                           
                        
                     

The next output summarizes the results of competing risks analysis computed with the cuminc function from the cmprsk package. The occurrences of first complication and relapse or death are considered as competing events. Cumulative incidences estimates at tp are displayed (
                           
                              
                                 
                                    I
                                    ˆ
                                 
                                 C
                              
                              (
                              4
                              )
                              =
                              0.5
                           
                         and 
                           
                              
                                 
                                    I
                                    ˆ
                                 
                                 
                                    R
                                    D
                                 
                              
                              (
                              4
                              )
                              =
                              0.2
                           
                        ) with the upper and lower 95% confidence intervals (95% CI: [0.166; 0.765] and [0.026; 0.493]).
                           
                              
                           
                        
                     

The next output displays Prevalence (main.preval.func) or Weighted Prevalence (main.wpreval.func) function estimate at tp (
                           
                              
                                 Q
                                 ˆ
                              
                              (
                              4
                              )
                              =
                              0.5
                           
                         and 
                           
                              w
                              
                                 Q
                                 ˆ
                              
                              (
                              4
                              )
                              =
                              0.5
                           
                        ) and eventually with upper and lower 95% confidence intervals (depending on parameter met).
                           
                              
                           
                        
                        
                           
                              
                           
                        
                     

In addition to the outputs presented above, the two functions return a list of objects containing:
                           
                              •
                              
                                 
                                    desc.stat
                                 : descriptive statistics matrix.


                                 
                                    time
                                 : time vector.


                                 
                                    Q (resp wQ)
                                 : Prevalence (resp Weighted Prevalence) estimation matrix at each time point for each group.


                                 
                                    U (resp wU)
                                 : Weighted Kaplan–Meier statistic of Prevalence (resp Weighted Prevalence).


                                 
                                    p.boot
                                 : empirical p-value (bootstrap test).


                                 
                                    p.perm
                                 : empirical p-value (“permutation” test).


                                 
                                    IC
                                 : 95% bootstrap confidence intervals of Prevalence (resp Weighted Prevalence) matrix.

Graphical outputs are also available and are presented in the next section.

In this section, the two R functions were used to analyze a Phase III trial [6–8]. This study compares two low dose rates in brachytherapy, 204 patients were randomized between two groups (0.4Gy/h (Group A) and 0.8Gy/h (Group B)). Prevalence and Weighted Prevalence functions were used to evaluate the type and severity of acute and chronic complications over time.

First, the data files corresponding to this study need to be load in R. All severity grade of complications will be taken into account (gm = 1), that means C
                     1 to C
                     5 are considered as the same health state in Prevalence estimation. A vector of weight has to be defined in order to take into account severity in Weighted Prevalence estimation, w
                     
                        i
                     
                     =
                     i, i
                     =1,…,5 (p=1:5). The length of the study period is fixed at 5 years (or 1825 days) (tmax=1825), the time at which the estimates will be displayed at 2 years (730 days) (tp=730) and the two tests and confidence intervals will be computed (met=c(T,T,T)) with 2000 iterations (N=2000).

The corresponding parameters are provided below.
                        
                           
                              main.preval.func(visit,fu,1,1825,730,c(T,T,T),2000,T)
                           


                              main.wpreval.func(visit,fu,1,1:5,1825,730,c(T,T,T),2000,T)
                           

The data check and the input parameters are “OK”. However, a warning message is displayed in the first output to point out that one or more visits in the “visit” file are ignored because they occur after the date of last news.
                        
                           
                        
                     
                  

The output below shows that more complications occur in group B than in group A (all grades combined). In group A, 63 patients entered at least once into a complication state and 76 patients in group B. Also, there were more relapses or deaths in group B (n
                     =35) than in group A (n
                     =26).
                        
                           
                        
                     
                     
                        
                           
                        
                     
                  

The chi-square test does not allow to conclude in a statistically significant difference in the number of patients with complications (irrespective of when they occur) between the two groups (p
                     =0.071).
                        
                           
                        
                     
                  

The event-free survival rate is estimated at 28.3% in group A and 16.0% in group B at 2 years. The difference in the hazard rates of first event (complication, relapse or death in our example) between the groups is not statistically significant according to the logrank test (p
                     =0.125).
                        
                           
                        
                     
                     
                        
                           
                        
                     
                  

The cumulative incidence of first complication at 2 years is estimated at 0.624 in group A and 0.731 in group B. Concerning relapse or death, the cumulative incidence is estimated at 0.093 in group A and 0.109 in group B. In both cases, there is a non statistically significant difference between the two groups according to the Gray test (p
                     =0.23 for event C and p
                     =0.718 for event RD). Note that the sum of the two cumulative incidence functions is equal to 1 minus the complication relapse death free survival rate.
                        
                           
                        
                     
                  

At 2 years, the Prevalence function is estimated at 0.305 (95% CI: [0.204; 0.414]) in group A and 0.528 (95% CI: [0.413; 0.642]) in group B. In group A about one third of patients are in the complication state at this time point versus about a half of patients in group B. Unlike the worst grade method, survival and competing risks analysis, there is a statistically significant difference between the groups according to the “permutation” and bootstrap tests (p
                     =0.002).
                        
                           
                        
                     
                  

The graphical output of main.preval.func is displayed in Fig. 3
                     . It includes 4 graphs, the event (complication or relapse or death in our example) free survival, the cumulative incidences of first complication and relapse/death and the Prevalence function for each group.

The differences between the Weighted Prevalence functions are also statistically significant (p
                     =0.002 and p
                     =0.004) and they are estimated at 0.509 (95% CI: [0.325; 0.713]) and 0.898 (95% CI: [0.682; 1.126]) at 2 years. These estimates cannot be expressed as percentages because they do not represent a proportion of patients as does the prevalence function, but rather a mean score which depends of course on the chosen weights. Interpretation however may be more difficult in this case because results can differ according to the chosen weights.
                        
                           
                        
                     
                  

The graphical output of main.wpreval.func is displayed in Fig. 4
                     . As Fig. 3, it includes 4 graphs, the same survival and cumulative incidences curves and the Weighted Prevalence function for each group.

@&#CONCLUSION@&#

The two R functions presented in this paper permit to study quality of life survival adjusted analysis using Prevalence and Weighted Prevalence. These functions compute descriptive statistics, survival and competing risks analysis and especially Prevalence and Weighted Prevalence estimations with confidence intervals and associated test statistics. Results obtained in Section 4 show that there is a statistically significant difference between groups with Prevalence and Weighted Prevalence functions whereas it was not demonstrated with the other methods. To analyze long-term complications, these non-parametric methods seem more suitable because they take into account duration and possible re-occurrences of complications unlike survival and competing risks analysis which are limited to the first event. Descriptive analysis with only numbers and percentages may not be sufficient to evaluate complications especially long-term effects.

Gelber and Goldhirsch [18] proposed another method to analyze quality of survival named Q-TWiST (Quality-Adjusted Time Without Symptoms or Toxicity) which takes into account time periods during which the patients are symptomatic and/or present complications, by applying a weight to each component. This method is an extension of TWiST [19] which consists in comparing mean survival durations during which patients present neither signs of toxicity nor disease recurrence. Although the TWiST method allows a comparison of weighted time spent in each of the three states, interpretation is different because TWiST is based on cumulative survival time while Prevalence function allows a more dynamic approach for evaluating the proportion of patients in a particular state at each time point.

Additional analysis can be performed using the list of objects returned by both R functions and other graphics can be plotted directly in R. The aim of our functions is to make easier Prevalence and Weighted Prevalence analysis and to compare them with other quality of survival methods.

The program can be obtained from the corresponding author upon request.

The authors have no conflict of interest to disclose regarding this work.

@&#ACKNOWLEDGEMENTS@&#

This study was funded by ITMO Cancer and IReSP-2012 (
                     Institut de Recherche en Santé Publique
                  ) within the French Cancer Plan 2009–2013.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cmpb.2014.12.006.

The following are the supplementary data to this article:
                        
                           
                        
                     
                     
                        
                           
                        
                     
                     
                        
                           
                        
                     
                     
                        
                           
                        
                     
                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

