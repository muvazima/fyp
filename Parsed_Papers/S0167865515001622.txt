@&#MAIN-TITLE@&#The Parzen Window method: In terms of two vectors and one matrix

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We revisit the Parzen Window approach widely employed in pattern recognition.


                        
                        
                           
                           The Parzen Window approach can suffer from a severe computational bottleneck.


                        
                        
                           
                           This manuscript introduces a new scheme to ameliorate this computational drawback.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Probability density function

Kernel functions

Parzen Window

@&#ABSTRACT@&#


               
               
                  Pattern classification methods assign an object to one of several predefined classes/categories based on features extracted from observed attributes of the object (pattern). When L discriminatory features for the pattern can be accurately determined, the pattern classification problem presents no difficulty. However, precise identification of the relevant features for a classification algorithm (classifier) to be able to categorize real world patterns without errors is generally infeasible. In this case, the pattern classification problem is often cast as devising a classifier that minimizes the misclassification rate. One way of doing this is to consider both the pattern attributes and its class label as random variables, estimate the posterior class probabilities for a given pattern and then assign the pattern to the class/category for which the posterior class probability value estimated is maximum. More often than not, the form of the posterior class probabilities is unknown.
                  The so-called Parzen Window approach is widely employed to estimate class-conditional probability (class-specific probability) densities for a given pattern. These probability densities can then be utilized to estimate the appropriate posterior class probabilities for that pattern. However, the Parzen Window scheme can become computationally impractical when the size of the training dataset is in the tens of thousands and L is also large (a few hundred or more). Over the years, various schemes have been suggested to ameliorate the computational drawback of the Parzen Window approach, but the problem still remains outstanding and unresolved.
                  In this paper, we revisit the Parzen Window technique and introduce a novel approach that may circumvent the aforementioned computational bottleneck. The current paper presents the mathematical aspect of our idea. Practical realizations of the proposed scheme will be given elsewhere.
               
            

@&#INTRODUCTION@&#

In mathematical pattern recognition, the problem of pattern classification entails assigning an object – based on a number of specific features of the object – to one of a finite set of predefined classes/categories ωj
                     , where j =1, 2,…, J, with J being the number of classes/categories of interest. Typically the object (or simply the pattern) is represented by an L-dimensional vector x whose elements, 
                        
                           (
                           
                              x
                              1
                           
                           ,
                           
                              x
                              2
                           
                           ,
                           …
                           ,
                           
                              x
                              L
                           
                           )
                           ,
                        
                      are values assumed to contain the appropriate information about the specific pattern features utilized to accurately classify the pattern represented by x.

When L discriminatory features for a pattern can be determined accurately, the pattern classification problem presents no difficulty: it reduces to a simple look-up table scheme. However, identifying the relevant features to classify realistic patterns without classification errors is generally impossible. Thus, the pattern classification problem is often cast as the task of finding a classifier that minimizes the misclassification rate [1]. One popular way of achieving this objective is to treat both the pattern vector x and the class label ωj
                      as random variables. In this case, the posterior class probabilities p(ωj
                     |x) for a given pattern x is computed; then pattern x is assigned to the class, for which the p(ωj
                     |x) value is maximum [1–6]. (In the last step it is being assumed that all misclassification errors are equally bad [1,3,4].)

However, in practice, the form of the function p(ωj
                     |x) is unknown; instead, N patterns x
                     
                        i
                      and their corresponding correct class labels 
                        
                           
                              y
                              i
                           
                           ∈
                           
                              {
                              
                                 ω
                                 1
                              
                              ,
                              
                                 ω
                                 2
                              
                              ,
                              …
                              ,
                              
                                 ω
                                 J
                              
                              }
                           
                        
                      – i.e., 
                        
                           D
                           =
                           
                              
                                 {
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ,
                                    
                                       y
                                       i
                                    
                                    )
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              N
                           
                           ,
                        
                      assumed to constitute a representative dataset of the joint probability density function p(ωj
                     , x) for ωj
                      and x – are usually available. It is from these prototype patterns x
                     
                        i
                      and their corresponding class labels yi
                      that one tries to estimate p(ωj
                     |x).

According to basic probability rules [1–7],
                        
                           (1)
                           
                              
                                 p
                                 
                                    (
                                    
                                       ω
                                       j
                                    
                                    |
                                    x
                                    )
                                 
                                 p
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 p
                                 
                                    (
                                    
                                       ω
                                       j
                                    
                                    ,
                                    x
                                    )
                                 
                                 =
                                 p
                                 
                                    (
                                    x
                                    |
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                              
                           
                        
                     These rules allow one to modularize the estimation problem and estimate p(ωj
                     |x) (and, of course, p(x)) in terms of p(x|ωj
                     ) and p(ωj
                     ):

                        
                           (2)
                           
                              
                                 p
                                 
                                    (
                                    
                                       ω
                                       j
                                    
                                    |
                                    x
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                       
                                          (
                                          x
                                          |
                                          
                                             ω
                                             j
                                          
                                          )
                                       
                                       p
                                       
                                          (
                                          
                                             ω
                                             j
                                          
                                          )
                                       
                                    
                                    
                                       p
                                       (
                                       x
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                     whereby we may have a better chance of being able to estimate p(x|ωj
                     ) and p(ωj
                     ) from 
                        D
                      than estimating p(ωj
                     |x) directly from 
                        D
                     . In the denominator, 
                        
                           p
                           
                              (
                              x
                              )
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              J
                           
                           p
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                           p
                           
                              (
                              
                                 ω
                                 j
                              
                              )
                           
                        
                     .

In the Bayesian statistics framework, p(ωj
                     ) is referred to as the class prior probability, which is the probability that a member of class ωj
                      will occur. The function p(x|ωj
                     ) is called the class-conditional probability density function, i.e. the probability density of observing pattern x given that x is a member of class ωj
                     . The denominator term on the right hand side of Eq. 2 is often called the “evidence” or “marginal likelihood”. For the purpose of this paper we can afford to simply view this term as a normalization factor.

If there is evidence that the number of prototype patterns per class is an indication of the importance of that class, then a sensible approximation of p(ωj
                     ) can be

                        
                           (3)
                           
                              
                                 p
                                 
                                    (
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                    N
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              ν
                              
                                 j
                              
                              i
                           
                           =
                           1
                        
                      if the ith prototype x
                     
                        i
                      belongs to class ωj
                     , otherwise 
                        
                           
                              ν
                              
                                 j
                              
                              i
                           
                           =
                           0
                        
                     ; and N is as described before. Nonetheless, p(ωj
                     ) is typically assumed to be uniform, i.e., 
                        
                           p
                           
                              (
                              
                                 ω
                                 j
                              
                              )
                           
                           =
                           
                              1
                              J
                           
                           ,
                        
                      where J is as defined before.

Estimating p(x|ωj
                     ) from 
                        D
                      is not straightforward [1–5]. In the last half-century, a plethora of methods have been proposed for estimating p(x|ωj
                     ) based on 
                        
                           D
                           ,
                        
                      the so-called training set. There are ample excellent reviews and text books on this topic; for example, the two books – one by Hand [4] and the other by Murphy [8] – give adequate and accessible descriptions of the bulk of these approaches devised in recent (and not so recent) years.

In this paper we are concerned with one particular approach that is widely thought to be apropos to the task of estimating p(x|ωj
                     ) from a representative training dataset: the so-called Parzen Window method [1,2,4,9,10], also known as Parzen estimator, Potential function technique [10], to name but a few.

In the preceding discussion and in the rest of the paper, the terms “class”, “label”, “class label” and “category” are employed interchangeably. For notational simplicity we use x, x
                     
                        i
                      and ωj
                      both as random variables and their realizations. Furthermore we follow (in line with the current trend in machine learning and statistics) the convenient – but not necessarily correct – practice of using the term “density” for both a discrete random variable’s probability function and for the probability function of a continuous random variable. An implicit assumption being made throughout the paper is that all spaces, matrices, vectors, functions and variables (discrete or not), etc., are real.

@&#LITERATURE REVIEW@&#

The Parzen Window approach can approximate p(x|ωj
                     ) by a simple formula [1,2,10]:

                        
                           (4)
                           
                              
                                 
                                    p
                                    ^
                                 
                                 
                                    (
                                    x
                                    |
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 
                                    ν
                                    
                                       j
                                    
                                    i
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              x
                              i
                           
                           ∈
                           D
                        
                      denotes prototype patterns and 
                        
                           ν
                           
                              j
                           
                           i
                        
                      is as defined before. K(x, x
                     
                        i
                     ; λ) – commonly known as the kernel function – is a two-variable function with specific properties, which are abundantly covered in the statistical pattern recognition literature [1,2,9,10]. At any rate, it might be helpful to think of K(x, x
                     
                        i
                     ; λ) as a measure of similarity returning how similar patterns x and x
                     
                        i
                      are, λ being a tunable (smoothing) parameter. In other words, the kernel function peaks at x = x
                     
                        i
                      and decays away elsewhere; the λ parameter, inter alia, has an important role in determining the rate of the decay.


                     Eq. 4 indicates that 
                        
                           
                              p
                              ^
                           
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                        
                      is formed from the superposition of kernel function K(x
                     
                        i
                     , x; λ) values at the given prototype patterns x
                     
                        i
                      for class ωj
                     . The Parzen Window method is powerful in the sense that, with enough representative data points (prototypes/references), its estimate of the class conditional probability density converges to p(x|ωj
                     ) (see Ref. [1], Chapter 4). Although Eq. 4 is conceptually simple and capable of providing a good estimate of p(x|ωj
                     ), it can computationally suffer from the requirements that all the prototypes/references x
                     
                        i
                      for class ωj
                      must be retained in main-memory to compute 
                        
                           
                              p
                              ^
                           
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                           ,
                        
                      the estimate of p(x|ωj
                     ). Furthermore, considerable CPU-time may be required each time this method is used to estimate p(x|ωj
                     ) to classify a novel pattern. The fact that the size of the reference pattern vectors x
                     
                        i
                      can be easily in the hundreds (or more) may exacerbate the main-memory and CPU-time requirements.

Over the years, various schemes have been developed to address the computational drawback of this otherwise elegant and powerful method. For example, one of these schemes entails – see Ref. [1] (Chapter 4), Ref. [4] (Chapter 2) and Ref. [10] (Chapters 6) for detailed technical and practical discussions – expressing the kernel function as a finite series expansion

                        
                           (5)
                           
                              
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     which renders the right hand side of Eq. 4
                     
                        
                           (6)
                           
                              
                                 
                                    1
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 
                                    ν
                                    
                                       j
                                    
                                    i
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ν
                                    
                                       j
                                    
                                    i
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     with 
                        
                           
                              {
                              
                                 ϕ
                                 m
                              
                              }
                           
                           
                              m
                              =
                              1
                           
                           M
                        
                      being appropriate basis functions (not necessarily polynomials) defined in the feature space in which the pattern vectors x and x
                     
                        i
                      reside.

From Eqs. 4 and 6, we have

                        
                           (7)
                           
                              
                                 
                                    p
                                    ^
                                 
                                 
                                    (
                                    x
                                    |
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    c
                                    
                                       m
                                       
                                          ω
                                          j
                                       
                                    
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 ,
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    c
                                    
                                       m
                                       
                                          ω
                                          j
                                       
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ν
                                    
                                       j
                                    
                                    i
                                 
                                 
                                    ϕ
                                    m
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     with 
                        
                           
                              ν
                              
                                 j
                              
                              i
                           
                           =
                           1
                        
                      if pattern x
                     
                        i
                      belongs to class ωj
                     , otherwise 
                        
                           
                              ν
                              j
                              i
                           
                           =
                           0
                        
                     .

This scheme certainly removes the reference patterns’ storage problem. However, it can create a computational problem of its own, in particular when both M and L are large, which is often the case in real world classification problems. Computing M basis functions of L variables to classify a new pattern x is not a trivial computational task [1–4,10–12].

Another approach – albeit a particular case of the scheme above – is that proposed by Specht [13]. It was based on a Taylor series expansion of ρ(x, x
                     
                        i
                     ; λ) (see Eq. 8), such that an rth order polynomial in L variables was required to estimate and store 
                        
                           (
                           
                              
                                 L
                                 +
                                 r
                              
                              L
                           
                           )
                        
                      terms to approximate 
                        
                           
                              p
                              ^
                           
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                        
                      
                     [10,13,14]. For short but “insightful” descriptions of the relationship between an appropriate value of r and the smoothing parameter λ, see Ref. [1] (Chapter 4) and Ref. [14] (Chapter 4). In principle, Specht’s scheme has a strong appeal of simplicity providing the number of terms required in the Taylor series can be held to a practical limit. Unfortunately, both r and L can be large in current realistic classification problems [1,4,10].

Despite these (and many other) efforts, to the best of our knowledge, the computational bottleneck that the Parzen Window method encounters, when N and L are large, remains an unresolved issue.

Thus, the motivation for this paper is to introduce yet another scheme that might be able to circumvent the aforementioned computational bottleneck problem, while retaining the estimation power and conceptual simplicity of the Parzen Window method. This work is confined to Parzen Window based approaches, in which the kernel function is – or can be expressed – in the form

                        
                           (8)
                           
                              
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 =
                                 A
                                 f
                                 
                                    (
                                    x
                                    ;
                                    λ
                                    )
                                 
                                 ρ
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 f
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 ,
                              
                           
                        
                     where A > 0; f(x; λ) and f(x
                     
                        i
                     ; λ) are any real functions defined in the feature space; ρ(x, x
                     
                        i
                     ; λ) is a polynomial in x and x
                     
                        i
                     ; and λ is as defined before. The kernel functions that are or can be written in the form above are ubiquitous nowadays in data analysis [4,6,8]. They have most often been successfully applied to discrete data; for this reason we decided to confine attention to the discrete case. For illustrative purposes, we focus on binary data, i.e., xl
                      = 0 or 1 denoting absence or presence of feature xl
                      in the pattern vector, respectively. That is to say, both x (test pattern vector) and x
                     
                        i
                      (reference/prototype pattern vector) reside in a binary feature space 
                        
                           X
                           =
                           
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              L
                           
                        
                     .

The extension of the proposed scheme to continuous data – i.e., 
                        
                           X
                           =
                           
                              
                                 R
                              
                              L
                           
                        
                      – is straightforward.

One final, but important remark is that Specht’s approach and our proposed scheme are arguably similar in spirit. However there are crucial differences: unlike Specht’s formulation, our scheme does not estimate 
                        
                           (
                           
                              
                                 L
                                 +
                                 r
                              
                              L
                           
                           )
                        
                      terms, it does not retain 
                        
                           (
                           
                              
                                 L
                                 +
                                 r
                              
                              L
                           
                           )
                        
                      terms in main-memory, nor does the variable r feature in the final form of our algorithm – instead, in our case, only two L-dimensional vectors and one L-by-L matrix are required to retain in main-memory. The two vectors and the matrix can notably be highly sparse. We will briefly expound on this assertion shortly.

As a concrete example, we use the widely utilized kernel function (albeit in cheminformatics [15,16], and references therein) introduced by Aitchison and Aitken (AA–kernel) [17,18],

                        
                           (9)
                           
                              
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 =
                                 
                                    λ
                                    L
                                 
                                 
                                    
                                       (
                                       
                                          
                                             1
                                             −
                                             λ
                                          
                                          λ
                                       
                                       )
                                    
                                    
                                       d
                                       (
                                       x
                                       ,
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                     where 0.5 < λ < 1 and d(x, x
                     
                        i
                     ) denotes the number of components in which x and x
                     
                        i
                      disagree. This dissimilarity measure d(x, x
                     
                        i
                     ) can be conveniently expressed as [4]
                     
                        
                           (10)
                           
                              
                                 d
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 x
                                 −
                                 2
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    i
                                    T
                                 
                                 
                                    x
                                    i
                                 
                              
                           
                        
                     In passing, the AA–kernel is basically a discrete analogue of an isotropic Gaussian kernel [17,18].

From Eqs. 9 and 10, and the fact that 
                        
                           
                              e
                              
                                 ln
                                 w
                              
                           
                           =
                           w
                           ,
                        
                      we have

                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          K
                                          (
                                          x
                                          ,
                                          
                                             x
                                             i
                                          
                                          ;
                                          λ
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             λ
                                             L
                                          
                                          
                                             e
                                             
                                                ln
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         −
                                                         λ
                                                      
                                                      λ
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   x
                                                   +
                                                   
                                                      x
                                                      
                                                         i
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          ×
                                          
                                             e
                                             
                                                −
                                                2
                                                ln
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         −
                                                         λ
                                                      
                                                      λ
                                                   
                                                   )
                                                
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             λ
                                             L
                                          
                                          
                                             e
                                             
                                                −
                                                α
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                x
                                                +
                                                
                                                   x
                                                   
                                                      i
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          ×
                                          
                                             e
                                             
                                                2
                                                α
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             λ
                                             L
                                          
                                          
                                             e
                                             
                                                −
                                                α
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                x
                                                )
                                             
                                          
                                          ×
                                          
                                             e
                                             
                                                2
                                                α
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                             
                                          
                                          ×
                                          
                                             e
                                             
                                                −
                                                α
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           α
                           =
                           ln
                           (
                           
                              λ
                              
                                 1
                                 −
                                 λ
                              
                           
                           )
                        
                     . The term 
                        
                           e
                           
                              2
                              α
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 x
                                 i
                              
                           
                        
                      can be written as

                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          e
                                          
                                             2
                                             α
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                x
                                                i
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                r
                                                =
                                                0
                                             
                                             ∞
                                          
                                          
                                             
                                                
                                                   (
                                                   2
                                                   α
                                                   )
                                                
                                                r
                                             
                                             
                                                r
                                                !
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             r
                                          
                                          =
                                          
                                             ∑
                                             
                                                r
                                                =
                                                0
                                             
                                             ∞
                                          
                                          
                                             γ
                                             r
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             r
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where γr
                      = 
                        
                           
                              
                                 (
                                 2
                                 α
                                 )
                              
                              r
                           
                           
                              r
                              !
                           
                        
                     .

Inserting Eq. 12 into Eq. 11 yields

                        
                           (13)
                           
                              
                                 K
                                 
                                    (
                                    x
                                    ,
                                    
                                       x
                                       i
                                    
                                    ;
                                    λ
                                    )
                                 
                                 =
                                 
                                    λ
                                    L
                                 
                                 
                                    e
                                    
                                       −
                                       α
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       x
                                       )
                                    
                                 
                                 
                                    [
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       ∞
                                    
                                    
                                       γ
                                       r
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             T
                                          
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       r
                                    
                                    ]
                                 
                                 
                                    e
                                    
                                       −
                                       α
                                       (
                                       
                                          
                                             x
                                          
                                          i
                                          T
                                       
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     (cf. 
                     Eq. 8).

From Eqs. 13 and 4, we have

                        
                           (14)
                           
                              
                                 
                                    p
                                    ^
                                 
                                 
                                    (
                                    x
                                    |
                                    
                                       ω
                                       j
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          λ
                                          L
                                       
                                       
                                          e
                                          
                                             −
                                             α
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ν
                                          
                                             j
                                          
                                          i
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ν
                                    
                                       j
                                    
                                    i
                                 
                                 
                                    e
                                    
                                       −
                                       α
                                       (
                                       
                                          x
                                          
                                             i
                                          
                                          T
                                       
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       r
                                       =
                                       0
                                    
                                    ∞
                                 
                                 
                                    γ
                                    r
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    r
                                 
                              
                           
                        
                     
                  

Now we come to the main contribution of this paper: removing the requirement for retaining all the reference/prototype patterns for class ωj
                      in main-memory to compute 
                        
                           
                              p
                              ^
                           
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                        
                      in order to estimate 
                        
                           
                              p
                              ^
                           
                           
                              (
                              
                                 ω
                                 j
                              
                              |
                              x
                              )
                           
                        
                      to classify a new pattern x. However, first we simplify the notation by defining these variables 
                        
                           
                              N
                              
                                 ω
                                 j
                              
                           
                           ,
                        
                      
                     a, z and z′, which will be consistently used throughout, as follows: 
                        
                           
                              N
                              
                                 ω
                                 j
                              
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              N
                           
                           
                              ν
                              
                                 j
                              
                              i
                           
                           ;
                           
                              β
                              i
                           
                           =
                           
                              e
                              
                                 −
                                 α
                                 (
                                 
                                    
                                       x
                                    
                                    i
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                           
                           ;
                           a
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              β
                              i
                           
                           ;
                           z
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              x
                              i
                           
                           ;
                        
                      and 
                        
                           
                              
                                 z
                              
                              ′
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              β
                              i
                           
                           
                              x
                              i
                           
                           ,
                        
                      where 
                        
                           N
                           
                              ω
                              j
                           
                        
                      refers to the number of patterns in the training dataset that belong to class ωj; N, α and 
                        
                           ν
                           j
                           i
                        
                      are as described before. In our new notation, Eq. 14 becomes

                        
                           (15)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          
                                             (
                                             x
                                             |
                                             
                                                ω
                                                j
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          B
                                          
                                             [
                                             
                                                γ
                                                0
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                β
                                                i
                                             
                                             +
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   1
                                                
                                                ∞
                                             
                                             
                                                γ
                                                r
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                β
                                                i
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                r
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          B
                                          
                                             [
                                             
                                                γ
                                                0
                                             
                                             a
                                             +
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   1
                                                
                                                ∞
                                             
                                             
                                                γ
                                                r
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      β
                                                      i
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   r
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           B
                           =
                           
                              
                                 
                                    λ
                                    L
                                 
                                 
                                    e
                                    
                                       −
                                       α
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       x
                                       )
                                    
                                 
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                        
                     .

The main contribution of the paper is formulating Eq. 15 in terms of γr
                      , a, z, z′ and an L-by-L matrix, Q which will be defined shortly. The task of this formulation basically amounts to expressing 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 (
                                 
                                    β
                                    i
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              )
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              
                                 r
                                 −
                                 1
                              
                           
                        
                      in terms of z, z′ and Q. In doing this, we hope to ameliorate the computational drawback of the Parzen Window method based on kernel functions in the form given in Eq. 8.

@&#RESULTS@&#

When 
                        
                           r
                           =
                           1
                           ,
                        
                      the task is trivial: 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 (
                                 
                                    β
                                    i
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              )
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              
                                 r
                                 −
                                 1
                              
                           
                        
                      reduces to

                        
                           (16)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       
                                          ω
                                          j
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    (
                                    
                                       β
                                       i
                                    
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    
                                       z
                                    
                                    ′
                                 
                              
                           
                        
                     where, by definition (see Section 3), 
                        
                           
                              
                                 z
                              
                              ′
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 β
                                 i
                              
                              
                                 x
                                 i
                              
                              )
                           
                        
                     .

However, when r > 1, the task can be taxing. To this end, we make use of a simple – but useful – proposition (Proposition 1, whose proof is provided in Appendices A and B) to demonstrate that 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 (
                                 
                                    β
                                    i
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              )
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              
                                 r
                                 −
                                 1
                              
                           
                        
                      for r > 1 can be written as (see Eq. 19 in Appendix C)

                        
                           (17)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       
                                          ω
                                          j
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       T
                                    
                                    
                                       (
                                       
                                          β
                                          i
                                       
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       T
                                    
                                    Q
                                    x
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       z
                                       )
                                    
                                    
                                       r
                                       −
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                     where Q is just an L-by-L matrix, (see Eq. 19).

Inserting Eqs. 16 and 17 into Eq. 15 results in

                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          
                                             (
                                             x
                                             |
                                             
                                                ω
                                                j
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          B
                                          
                                             [
                                             
                                                γ
                                                0
                                             
                                             a
                                             +
                                             
                                                γ
                                                1
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   
                                                      z
                                                   
                                                   ′
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                Q
                                                x
                                                )
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   2
                                                
                                                ∞
                                             
                                             
                                                γ
                                                r
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   z
                                                   )
                                                
                                                
                                                   r
                                                   −
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          B
                                          
                                             [
                                             
                                                γ
                                                0
                                             
                                             a
                                             +
                                             
                                                γ
                                                1
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   
                                                      z
                                                   
                                                   ′
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      4
                                                      
                                                         α
                                                         2
                                                      
                                                      
                                                         (
                                                         
                                                            e
                                                            μ
                                                         
                                                         −
                                                         μ
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                Q
                                                x
                                                )
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           B
                           =
                           
                              
                                 
                                    λ
                                    L
                                 
                                 
                                    e
                                    
                                       −
                                       α
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       x
                                       )
                                    
                                 
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                        
                     ; 
                        
                           
                              ∑
                              
                                 r
                                 =
                                 2
                              
                              ∞
                           
                           
                              γ
                              r
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 z
                                 )
                              
                              
                                 r
                                 −
                                 2
                              
                           
                           =
                           
                              
                                 4
                                 
                                    α
                                    2
                                 
                                 
                                    (
                                    
                                       e
                                       μ
                                    
                                    −
                                    μ
                                    −
                                    1
                                    )
                                 
                              
                              
                                 μ
                                 2
                              
                           
                           ,
                        
                      with 
                        
                           μ
                           =
                           2
                           α
                           (
                           
                              
                                 x
                              
                              T
                           
                           z
                           )
                           ,
                        
                      
                     γr
                      = 
                        
                           
                              
                                 
                                    (
                                    2
                                    α
                                    )
                                 
                                 r
                              
                              
                                 r
                                 !
                              
                           
                           ,
                        
                     
                     
                        
                           α
                           =
                           ln
                           (
                           
                              λ
                              
                                 1
                                 −
                                 λ
                              
                           
                           )
                        
                      and 0.5 < λ < 1

Evidently, Eq. 18 illustrates that it is not necessary to retain all reference/prototype patterns for a given class in main-memory to compute the value of 
                        
                           
                              p
                              ^
                           
                           
                              (
                              x
                              |
                              
                                 ω
                                 j
                              
                              )
                           
                        
                      for a test pattern x; instead, all that is required is an L-by-L matrix Q and two L size vectors (z and z′), which are computed once and then retained in main-memory. This was the objective we set out to achieve in this paper.

One final, but important, remark is that z, z′ and Q can be highly sparse in real world applications when xl
                      ∈ {0, 1}, in particular if the value of L is large. The fundamental reason for this sparsity is that in a high-dimensional reference pattern vector x
                     
                        i
                      there is the potential of many of its components being zero – i.e., many of the features are very likely to be absent in x
                     
                        i
                     .

In passing, if we are dealing with continuous data, whereby 
                        
                           
                              x
                              i
                           
                           ∈
                           
                              
                                 R
                              
                              L
                           
                           ,
                        
                      the vectors z, z′ and matrix Q could be dense. Nonetheless, storing Q can still be computationally cheaper than retaining 
                        
                           N
                           
                              ω
                              j
                           
                        
                      reference patterns x
                     
                        i
                      per class in main-memory – providing that 
                        
                           
                              N
                              
                                 ω
                                 j
                              
                           
                           >
                           L
                        
                     .

The current paper presents the mathematical aspect of our idea. Practical realizations of the proposed scheme will be given elsewhere.

@&#CONCLUSION@&#

The Parzen Window method is a powerful tool for estimating class conditional probability density functions. However, it can suffer from a severe computational bottleneck when the training dataset is large. Over the years, attempts have been made to rectify this computational drawback of the method. To the best of our knowledge the issue has remained unsolved. In this paper we have proposed a novel scheme, which we hope contributes to our endeavor of alleviating the computational bottleneck from which the Parzen Window algorithm suffers when the training dataset is large.

@&#ACKNOWLEDGMENTS@&#

We thank the BBSRC for funding this research through Grant BB/I00596X/1. JBOM thanks the Scottish Universities Life Sciences Alliance (SULSA) for fin ancial support.


                     
                        Proposition 1
                        Let ai
                            and bi
                            be real variables ∈ [0, ∞). Then the product of 
                              
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       b
                                       i
                                    
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          a
                                          i
                                       
                                       )
                                    
                                    q
                                 
                              
                            can be given as 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    b
                                    i
                                 
                                 
                                    
                                       (
                                       
                                          a
                                          i
                                       
                                       )
                                    
                                    q
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    q
                                 
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          a
                                          i
                                       
                                       )
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                 
                                 
                                    a
                                    i
                                 
                                 
                                    ∑
                                    
                                       
                                          i
                                          ′
                                       
                                       ≠
                                       i
                                    
                                    n
                                 
                                 
                                    b
                                    
                                       i
                                       ′
                                    
                                 
                                 
                                    
                                       (
                                       
                                          a
                                          
                                             i
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       q
                                       −
                                       j
                                    
                                 
                                 ,
                              
                            where 
                              
                                 
                                    i
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                            with n and q
                           
                              
                                 ∈
                                 
                                    Z
                                    +
                                 
                              
                           .

Let us suppose, with no loss of generality, that 
                              
                                 n
                                 =
                                 4
                              
                            and 
                              
                                 q
                                 =
                                 3
                              
                           . In this scenario, we have the product 
                              
                                 
                                    (
                                    
                                       b
                                       1
                                    
                                    +
                                    
                                       b
                                       2
                                    
                                    +
                                    
                                       b
                                       3
                                    
                                    +
                                    
                                       b
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       a
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    +
                                    
                                       a
                                       3
                                    
                                    +
                                    
                                       a
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       a
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    +
                                    
                                       a
                                       3
                                    
                                    +
                                    
                                       a
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       a
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    +
                                    
                                       a
                                       3
                                    
                                    +
                                    
                                       a
                                       4
                                    
                                    )
                                 
                              
                           . For the sake of clarity, we write the product as 
                              
                                 
                                    (
                                    
                                       d
                                       1
                                    
                                    +
                                    
                                       d
                                       2
                                    
                                    +
                                    
                                       d
                                       3
                                    
                                    +
                                    
                                       d
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       c
                                       1
                                    
                                    +
                                    
                                       c
                                       2
                                    
                                    +
                                    
                                       c
                                       3
                                    
                                    +
                                    
                                       c
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       a
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    +
                                    
                                       a
                                       3
                                    
                                    +
                                    
                                       a
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       b
                                       1
                                    
                                    +
                                    
                                       b
                                       2
                                    
                                    +
                                    
                                       b
                                       3
                                    
                                    +
                                    
                                       b
                                       4
                                    
                                    )
                                 
                                 ,
                              
                            where 
                              
                                 
                                    a
                                    i
                                 
                                 =
                                 
                                    c
                                    i
                                 
                                 =
                                 
                                    d
                                    i
                                 
                                 ,
                              
                            with i being 1, 2, 3, 4. To labour the obvious, we express 
                              
                                 
                                    (
                                    
                                       d
                                       1
                                    
                                    +
                                    
                                       d
                                       2
                                    
                                    +
                                    
                                       d
                                       3
                                    
                                    +
                                    
                                       d
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       c
                                       1
                                    
                                    +
                                    
                                       c
                                       2
                                    
                                    +
                                    
                                       c
                                       3
                                    
                                    +
                                    
                                       c
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       a
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    +
                                    
                                       a
                                       3
                                    
                                    +
                                    
                                       a
                                       4
                                    
                                    )
                                 
                                 ×
                                 
                                    (
                                    
                                       b
                                       1
                                    
                                    +
                                    
                                       b
                                       2
                                    
                                    +
                                    
                                       b
                                       3
                                    
                                    +
                                    
                                       b
                                       4
                                    
                                    )
                                 
                              
                            as follows

                              
                                 (1)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      d
                                                      1
                                                   
                                                   +
                                                   
                                                      d
                                                      2
                                                   
                                                   +
                                                   
                                                      d
                                                      3
                                                   
                                                   +
                                                   
                                                      d
                                                      4
                                                   
                                                   )
                                                
                                                ×
                                                
                                                   (
                                                   
                                                      c
                                                      1
                                                   
                                                   +
                                                   
                                                      c
                                                      2
                                                   
                                                   +
                                                   
                                                      c
                                                      3
                                                   
                                                   +
                                                   
                                                      c
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                   (
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                ×
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   b
                                                   1
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   d
                                                   1
                                                
                                                +
                                                
                                                   b
                                                   2
                                                
                                                
                                                   a
                                                   2
                                                
                                                
                                                   c
                                                   2
                                                
                                                
                                                   d
                                                   2
                                                
                                                +
                                                
                                                   b
                                                   3
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   c
                                                   3
                                                
                                                
                                                   d
                                                   3
                                                
                                                +
                                                
                                                   b
                                                   4
                                                
                                                
                                                   a
                                                   4
                                                
                                                
                                                   c
                                                   4
                                                
                                                
                                                   d
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   
                                                      c
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   
                                                      c
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   
                                                      c
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   
                                                      c
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   
                                                      c
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   
                                                      c
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   
                                                      c
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   
                                                      c
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   
                                                      c
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   
                                                      c
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   
                                                      c
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   
                                                      c
                                                      3
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   1
                                                
                                                
                                                   (
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   (
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   3
                                                
                                                
                                                   (
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   4
                                                
                                                
                                                   (
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      a
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   
                                                      a
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   1
                                                
                                                
                                                   [
                                                   
                                                      c
                                                      1
                                                   
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   +
                                                   …
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      c
                                                      1
                                                   
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   +
                                                   …
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   3
                                                
                                                
                                                   [
                                                   
                                                      c
                                                      1
                                                   
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   +
                                                   …
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   d
                                                   4
                                                
                                                
                                                   [
                                                   
                                                      c
                                                      1
                                                   
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   +
                                                   …
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   c
                                                   4
                                                
                                                
                                                   (
                                                
                                                
                                                   a
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   a
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      4
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   4
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      1
                                                   
                                                   +
                                                   
                                                      b
                                                      2
                                                   
                                                   +
                                                   
                                                      b
                                                      3
                                                   
                                                   )
                                                
                                                
                                                   )
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           which can be written more compactly as:

                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      4
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   3
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   b
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   3
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   4
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   4
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         4
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   4
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    i
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           ; note that in Eq. 2 we have made use of fact that, by definition, 
                              
                                 
                                    a
                                    i
                                 
                                 =
                                 
                                    c
                                    i
                                 
                                 =
                                 
                                    d
                                    i
                                 
                              
                           . It readily follows that for the general case

                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      2
                                                   
                                                
                                                +
                                                …
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                …
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           or in a more compact form

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      j
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           which can be immediately proved by induction, see Appendix B.

This completes the proof of the proposition.□

Clearly Eq. 3 can be rearranged to give

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             q
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             q
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                q
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                q
                                                −
                                                2
                                             
                                          
                                          −
                                          …
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          …
                                          −
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                q
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        Remark 1
                        From Eqs. 1–3, one does not fail to observe that, if n is large (i.e. asymptotically),

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             >
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             >
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      3
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             >
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      4
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             >
                                          
                                          
                                             
                                                …
                                                >
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                                >
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Furthermore, a closer look at the terms above also reveals that one might – albeit asymptotically – view

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                …
                                                ,
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ≠
                                                      i
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      q
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   b
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         i
                                                      
                                                      )
                                                   
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           as a geometric progression whose common ratio is in the interval (0,1).

When n is large (that is, asymptotically), another important inference that one could glean from Eqs. 1–3 is that

                              
                                 (7)
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                i
                                                ′
                                             
                                             ≠
                                             1
                                          
                                          n
                                       
                                       
                                          b
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          
                                             (
                                             
                                                a
                                                
                                                   i
                                                   ′
                                                
                                             
                                             )
                                          
                                          m
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                i
                                                ′
                                             
                                             ≠
                                             2
                                          
                                          n
                                       
                                       
                                          b
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          
                                             (
                                             
                                                a
                                                
                                                   i
                                                   ′
                                                
                                             
                                             )
                                          
                                          m
                                       
                                       =
                                       
                                          ∑
                                          
                                             
                                                i
                                                ′
                                             
                                             ≠
                                             3
                                          
                                          n
                                       
                                       
                                          b
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          
                                             (
                                             
                                                a
                                                
                                                   i
                                                   ′
                                                
                                             
                                             )
                                          
                                          m
                                       
                                       =
                                       …
                                       =
                                       
                                          ∑
                                          
                                             
                                                i
                                                ′
                                             
                                             ≠
                                             n
                                          
                                          n
                                       
                                       
                                          b
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          
                                             (
                                             
                                                a
                                                
                                                   i
                                                   ′
                                                
                                             
                                             )
                                          
                                          m
                                       
                                       ,
                                    
                                 
                              
                           and even more so in our pattern recognition context whose basic credo is that all reference/prototype patterns x
                           
                              i
                            for a given class are similar. 
                              
                                 
                                    i
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                            and 
                              
                                 m
                                 =
                                 q
                                 −
                                 l
                                 ,
                              
                            where 
                              
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 q
                                 −
                                 1
                              
                           
                        


                     Proposition 1 , Remarks 1 and 2 essentially form the theoretical basis for the algorithm proposed in this work.

Based on Remark 1, it is justifiable to assume that Eq. 5 can be well approximated as

                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             q
                                          
                                       
                                    
                                    
                                       ≈
                                    
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             q
                                          
                                          −
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                q
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                q
                                                −
                                                2
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             a
                                             
                                                i
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Due to space constraints, practical realization and validation of Eq. 8 will be given in application journals on pattern recognition and cheminformatics.

Proof of Eq. 4 by induction.


                     Base case: when 
                        
                           q
                           =
                           1
                           ,
                        
                      from Eq. 4 we have

                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             1
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             1
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                1
                                                −
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Clearly the left hand side of the equation can be expressed as 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              b
                              i
                           
                           
                              a
                              i
                           
                           +
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                        
                      and the right hand side of the equation is 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              b
                              i
                           
                           
                              a
                              i
                           
                           +
                           
                              ∑
                              i
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                        
                     . Thus Eq. 9 holds for 
                        
                           q
                           =
                           1
                        
                     .


                     General case:
                  

Assume that Eq. 4 is correct for some positive integer 
                        
                           k
                           ∈
                           
                              Z
                              +
                           
                        
                     . From Eq. 4 we have

                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             i
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                                −
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     We now show that the equation above holds also for 
                        
                           k
                           +
                           1
                        
                     . Starting with the left hand side, we have

                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                                −
                                                j
                                             
                                          
                                          )
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where we have made use of the assumption that Eq. 10 is correct; hence

                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             j
                                          
                                          
                                             ∑
                                             i
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             ∑
                                             
                                                
                                                   i
                                                   ′
                                                
                                                ≠
                                                i
                                             
                                             n
                                          
                                          
                                             b
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                                −
                                                j
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              b
                              i
                           
                           
                              
                                 (
                                 
                                    a
                                    i
                                 
                                 )
                              
                              k
                           
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 a
                                 i
                              
                              )
                           
                        
                      can be expressed as

                        
                           (13)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    b
                                    i
                                 
                                 
                                    
                                       (
                                       
                                          a
                                          i
                                       
                                       )
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       a
                                       i
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    b
                                    i
                                 
                                 
                                    
                                       (
                                       
                                          a
                                          i
                                       
                                       )
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    i
                                 
                                 
                                    ∑
                                    
                                       
                                          i
                                          ′
                                       
                                       ≠
                                       i
                                    
                                    n
                                 
                                 
                                    b
                                    
                                       i
                                       ′
                                    
                                 
                                 
                                    
                                       (
                                       
                                          a
                                          
                                             i
                                             ′
                                          
                                       
                                       )
                                    
                                    k
                                 
                              
                           
                        
                     Inserting Eq. 13 into Eq. 12 results in

                        
                           (14)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             k
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                a
                                                i
                                             
                                             
                                                ∑
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   ≠
                                                   i
                                                
                                                n
                                             
                                             
                                                b
                                                
                                                   i
                                                   ′
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      a
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                k
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                k
                                             
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      a
                                                      i
                                                   
                                                   )
                                                
                                                j
                                             
                                             
                                                ∑
                                                i
                                             
                                             
                                                a
                                                i
                                             
                                             
                                                ∑
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   ≠
                                                   i
                                                
                                                n
                                             
                                             
                                                b
                                                
                                                   i
                                                   ′
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      a
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   k
                                                   −
                                                   j
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           [
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                           
                              
                                 (
                                 
                                    a
                                    
                                       i
                                       ′
                                    
                                 
                                 )
                              
                              k
                           
                           +
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              k
                           
                           
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    i
                                 
                                 )
                              
                              j
                           
                           
                              ∑
                              i
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                           
                              
                                 (
                                 
                                    a
                                    
                                       i
                                       ′
                                    
                                 
                                 )
                              
                              
                                 k
                                 −
                                 j
                              
                           
                           ]
                        
                      is basically 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              k
                           
                           
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    i
                                 
                                 )
                              
                              j
                           
                           
                              ∑
                              i
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                           
                              
                                 (
                                 
                                    a
                                    
                                       i
                                       ′
                                    
                                 
                                 )
                              
                              
                                 k
                                 −
                                 j
                              
                           
                           ,
                        
                      which can be rewritten as 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    i
                                 
                                 )
                              
                              
                                 j
                                 −
                                 1
                              
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                           
                           
                              a
                              i
                           
                           
                              ∑
                              
                                 
                                    i
                                    ′
                                 
                                 ≠
                                 i
                              
                              n
                           
                           
                              b
                              
                                 i
                                 ′
                              
                           
                           
                              
                                 (
                                 
                                    a
                                    
                                       i
                                       ′
                                    
                                 
                                 )
                              
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                                 −
                                 j
                              
                           
                        
                     . Inserting this expression in Eq. 14 and rewriting 
                        
                           
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    a
                                    i
                                 
                                 )
                              
                              k
                           
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 a
                                 i
                              
                              )
                           
                        
                      on the left hand side of Eq. 14 as 
                        
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 a
                                 i
                              
                              )
                           
                           
                              k
                              +
                              1
                           
                        
                      yield

                        
                           (15)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                             [
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      a
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                             
                                             
                                                a
                                                i
                                             
                                             
                                                ∑
                                                
                                                   
                                                      i
                                                      ′
                                                   
                                                   ≠
                                                   i
                                                
                                                n
                                             
                                             
                                                b
                                                
                                                   i
                                                   ′
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      a
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   −
                                                   j
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     which is what we set out to prove. Thus, Eq. 4 (and for that matter Eq. 3) in Appendix A hold for all values of 
                        
                           q
                           ∈
                           
                              Z
                              +
                           
                        
                     .

In this work: 
                        
                           
                              b
                              i
                           
                           =
                           
                              
                                 x
                              
                              T
                           
                           
                              (
                              
                                 β
                                 i
                              
                              
                                 x
                                 i
                              
                              )
                           
                        
                     ; 
                        
                           
                              b
                              
                                 i
                                 ′
                              
                           
                           =
                           
                              
                                 x
                              
                              T
                           
                           
                              (
                              
                                 β
                                 
                                    i
                                    ′
                                 
                              
                              
                                 x
                                 
                                    i
                                    ′
                                 
                              
                              )
                           
                        
                     ; 
                        
                           
                              a
                              i
                           
                           =
                           
                              
                                 x
                              
                              T
                           
                           
                              x
                              i
                           
                        
                     ; 
                        
                           
                              a
                              
                                 i
                                 ′
                              
                           
                           =
                           
                              
                                 x
                              
                              T
                           
                           
                              x
                              
                                 i
                                 ′
                              
                           
                        
                     ; q = r - 1; and n = 
                        
                           
                              N
                              
                                 ω
                                 j
                              
                           
                           ,
                        
                      where x, βi
                     , 
                        
                           
                              β
                              
                                 i
                                 ′
                              
                           
                           ,
                        
                      
                     x
                     
                        i
                     , x
                     
                        
                           
                              
                              
                                 i
                                 ′
                              
                           
                           ,
                        
                      
                     r and 
                        
                           N
                           
                              ω
                              j
                           
                        
                      are as described in the main text (see Section 3). Hence, from Eq. 8 we have

                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                
                                                   ω
                                                   j
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                
                                                   β
                                                   i
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       ≈
                                    
                                    
                                       
                                          
                                             c
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   β
                                                   i
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             c
                                             
                                                r
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                x
                                                i
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ≠
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                
                                                   β
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             c
                                             
                                                r
                                                −
                                                3
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                x
                                                i
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ≠
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      β
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           c
                           =
                           (
                           
                              
                                 x
                              
                              T
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              x
                              i
                           
                           )
                        
                     .

Making use of the two definitions 
                        
                           
                              
                                 z
                              
                              ′
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 β
                                 i
                              
                              
                                 x
                                 i
                              
                              )
                           
                        
                      and 
                        
                           z
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              x
                              i
                           
                        
                      given in Section 3 in the main text and with some algebraic manipulation (such as the fact that g
                     
                        T
                     
                     h = h
                     
                        T
                     
                     b for any vectors g and h), the three lines on the right hand side of Eq. 16 can be recast in a more simple and familiar form:

                        
                           •
                           Line 1: 
                                 
                                    
                                       c
                                       
                                          r
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             
                                                ω
                                                j
                                             
                                          
                                       
                                       
                                          (
                                          
                                             β
                                             i
                                          
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             T
                                          
                                          z
                                          )
                                       
                                       
                                          r
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       T
                                    
                                    
                                       
                                          z
                                       
                                       ′
                                    
                                 
                              
                           

Line 2: 
                                 
                                    
                                       c
                                       
                                          r
                                          −
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             T
                                          
                                          z
                                          )
                                       
                                       
                                          r
                                          −
                                          2
                                       
                                    
                                    ,
                                 
                               whereas

                                 
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                x
                                                i
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ≠
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                
                                                   β
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             T
                                          
                                          Y
                                          x
                                          ,
                                       
                                    
                                 
                              where 
                                 
                                    Y
                                    =
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          
                                             ω
                                             j
                                          
                                       
                                    
                                    
                                       x
                                       i
                                    
                                    
                                       ∑
                                       
                                          i
                                          ≠
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          N
                                          
                                             ω
                                             j
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             β
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                ′
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    )
                                 
                               is an L-by-L matrix.

Line 3: 
                                 
                                    
                                       c
                                       
                                          r
                                          −
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             T
                                          
                                          z
                                          )
                                       
                                       
                                          r
                                          −
                                          3
                                       
                                    
                                    ,
                                 
                               whereas

                                 
                                    (17)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                            
                                                               ω
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         T
                                                      
                                                      
                                                         x
                                                         i
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ≠
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         
                                                            N
                                                            
                                                               ω
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            T
                                                         
                                                         
                                                            (
                                                            
                                                               β
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            
                                                               x
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            T
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                         
                                                            ω
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ≠
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      
                                                         N
                                                         
                                                            ω
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         (
                                                         
                                                            β
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         
                                                            x
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                            ′
                                                         
                                                         T
                                                      
                                                      )
                                                   
                                                   x
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         x
                                                      
                                                      T
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                         
                                                            ω
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         T
                                                      
                                                      
                                                         S
                                                         i
                                                      
                                                      x
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       S
                                       i
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ≠
                                          
                                             i
                                             ′
                                          
                                       
                                       
                                          N
                                          
                                             ω
                                             j
                                          
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             β
                                             
                                                i
                                                ′
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ′
                                          
                                          T
                                       
                                       )
                                    
                                 
                               is an L-by-L matrix.

According to Eq. 7, the matrices 
                                 
                                    
                                       S
                                       1
                                    
                                    ,
                                    
                                       S
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       S
                                       
                                          N
                                          
                                             ω
                                             j
                                          
                                       
                                    
                                 
                               can be considered equivalent/similar. Hence, Eq. 17 modifies to

                                 
                                    (18)
                                    
                                       
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                x
                                                i
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ≠
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                
                                                   N
                                                   
                                                      ω
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      β
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             z
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             S
                                             x
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where S = S
                              
                                 i
                               and 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          T
                                       
                                       z
                                       )
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       T
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          
                                             ω
                                             j
                                          
                                       
                                    
                                    
                                       x
                                       i
                                    
                                 
                              
                           

Expressed in terms of Y, S, z′ and z, Eq. 16 becomes

                        
                           (19)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                
                                                   ω
                                                   j
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                
                                                   β
                                                   i
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ≈
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                
                                                   z
                                                
                                                ′
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             
                                                r
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                Y
                                                +
                                                S
                                                )
                                             
                                             x
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             
                                                r
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   
                                                      z
                                                   
                                                   ′
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                Y
                                                +
                                                S
                                                )
                                             
                                             x
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             
                                                r
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                
                                                   
                                                      z
                                                   
                                                   ′
                                                
                                                
                                                   
                                                      z
                                                   
                                                   T
                                                
                                                x
                                                )
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             
                                                (
                                                Y
                                                +
                                                S
                                                )
                                             
                                             x
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   T
                                                
                                                z
                                                )
                                             
                                             
                                                r
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                T
                                             
                                             Q
                                             x
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           Q
                           =
                           
                              
                                 z
                              
                              ′
                           
                           
                              
                                 z
                              
                              T
                           
                           −
                           
                              (
                              Y
                              +
                              S
                              )
                           
                           ,
                        
                      an L-by-L matrix.

Note that 
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 z
                                 )
                              
                              
                                 r
                                 −
                                 2
                              
                           
                           ≥
                           0
                           ,
                        
                     
                     
                        
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 
                                    z
                                 
                                 ′
                              
                              
                                 
                                    z
                                 
                                 T
                              
                              x
                              )
                           
                           ≥
                           
                              
                                 x
                              
                              T
                           
                           
                              (
                              Y
                              +
                              S
                              )
                           
                           x
                        
                     ; hence, 
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 z
                                 )
                              
                              
                                 r
                                 −
                                 2
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              Q
                              x
                              )
                           
                           ≥
                           0
                        
                      as it should be – because, by definition, 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                                 
                                    ω
                                    j
                                 
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 T
                              
                              
                                 (
                                 
                                    β
                                    i
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              )
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    T
                                 
                                 
                                    x
                                    i
                                 
                                 )
                              
                              
                                 r
                                 −
                                 1
                              
                           
                           ≥
                           0
                        
                     .

@&#REFERENCES@&#

