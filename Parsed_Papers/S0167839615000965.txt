@&#MAIN-TITLE@&#A geometric method for computation of geodesic on parametric surfaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An efficient geometric algorithm aims to trace geodesic on parametric surfaces.


                        
                        
                           
                           Independent of the complex description of the geodesic equations.


                        
                        
                           
                           Simpler and faster than the existing geometric method.


                        
                        
                           
                           Step size of the algorithm adapts to the geometry of parametric surface.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometric

Geodesic

Geodesic equations

Tessellated surface

@&#ABSTRACT@&#


               
               
                  This paper proposes a geometric algorithm for computation of geodesic on surfaces. The geodesics on surfaces are traced in a simple way which is independent of the complex description of the geodesic equations. Through derivation process, the calculation error of this algorithm is obtained. A step size adjustment strategy which enables the step size adapt to the geometry of surface is introduced. The proposed method is also compared to some other well-known methods in this study. Many geodesics computed using these approaches on various B-spline surfaces or their equivalent tessellated surfaces have been presented. Experiments demonstrate that the proposed algorithm is efficient. Meanwhile, the results show that the step size adjustment strategy works well for most of the cases.
               
            

@&#INTRODUCTION@&#

Geodesic on a surface is an intrinsic geometric feature that plays an important role in a diversity of applications. The importance of geodesic is well known in the computer simulation of design and manufacturing process of composite components. For tape laying process, geodesic allows minimizing the steering of the tape (Debout et al., 2011). For filament winding process, it would be impossible to lay a filament in any way other than along a geodesic on a frictionless convex surface. Geodesic also finds its application in surface and shape processing, such as surface flattening (Azariadis and Aspragathos, 1997, 2001), segmentation, sampling, meshing and comparison of shapes (Peyré et al., 2010).

A curve on a surface is called a geodesic if and only if the normal vector to the curve is everywhere parallel to the normal vector of the surface. A geodesic can also be defined as a curve with zero geodesic curvature.

Available approaches for the computation of geodesic on surfaces can be classified broadly as analytical and numerical, and the later one is more widely used than the former one recently. The analytical approaches presented by Do Carmo (1976) are quite complex and closed form solutions cannot be found for geodesic on general surfaces. As for the numerical approaches, Beck et al. (1986) computed geodesic paths on a bicubic spline surface by using the fourth order Runge–Kutta method. Patrikalakis and Badris (1989) examined geodesic curves on parametric surfaces when they constructed offset curves on Rational B-spline surfaces. Sneyd and Peskin (1990) investigated the computation of geodesic paths on a generalized cylinder using a second order Runge–Kutta method. Hotz and Hagen (2000) presented a geometric method for the construction of geodesics on arbitrary surface. Their method is based on the fundamental property that geodesics are a generalization of straight lines on planes. The superiority of this method is that it makes us independent of the complex description of the surface. Ying and Candes proposed an approach for rapidly computing a very large number of geodesics on a smooth surface. Their approach is built upon the phase flow method and is especially well suited for the problem of computing creeping rays (Maekawa, 1996).

Finding the shortest path between two points on surface is a classical problem and it has many important applications. Maekawa introduced an approach for finding the shortest path between two points on a free-form parametric surface based on a relaxation method relying on finite difference discretization (Ying and Candes, 2006). Kasap et al. (2005) presented a numerical method for the computation of geodesic between two points on surface. They solve the nonlinear differential equations of geodesic via the finite-difference method and the iterative method. Chen (2010) proposed a geodesic-like curve that approaches to the geodesic on surface when the order of the curve reaches to infinity. Chen's geodesic-like curve has been proved to be accurate.

Many accurate discrete methods approach geodesics or the shortest paths on tessellated surfaces (Tucker, 1997; Ravi Kumar et al., 2003), polygonal surfaces (Polthier and Schmies, 1998; Kanai and Suzuki, 2001) and triangular meshes (Martinez et al., 2005; Surazhsky et al., 2005). Bose et al. (2011) did a survey which gave an overview of theoretically and practically relevant algorithms to compute geodesic paths and distances on three-dimensional surfaces. The algorithms are differentiated based on theoretical time complexity and approximation ratio.

In general, conventional approaches for computation of geodesic can be classified broadly into three types. First, solve the nonlinear differential equations of geodesic by using a numerical integration method such as Runge–Kutta method. Second, compute discrete geodesics on discrete surfaces by following some rules. Last, construct geodesics on smooth surfaces by using geometric methods. The first type is elegant and accurate, but the differential equations of geodesic are very complicated and generally not easy to solve. Discrete geodesics have been gaining attention as computer becomes increasingly more powerful and discretized models become more prevalent in geometric modeling. However, the discrete geodesics cannot be computed directly on the original smooth surface. There is little work on constructing geodesics directly on smooth surfaces by using geometric methods. The geometric method presented by Hotz and Hagen is complicated as it needs to compute projection of point of tangent plane in each step. Ravi Kumar's method can be extended to estimate geodesics on regular surfaces (Chen, 2010). However, this method does not perform on regular surfaces directly. The discrete geodesic is computed at first and then projected to the regular surface. In this work, we present a compact geometric method for constructing geodesics directly on smooth surfaces. Firstly, principle of the method is described in detail. Then, calculation error of the method is provided through derivation process. Finally, the method is tested on a group of different surfaces. See Table 1
                      for used notations.

This work describes an efficient method which aims to trace geodesic on parametric surfaces. The presented approach is independent of the complex description of the geodesic equations and is summarized as follows:

We look at a surface S which is given by a parameterization 
                        r
                        (
                        u
                        ,
                        v
                        )
                        =
                        [
                        x
                        (
                        u
                        ,
                        v
                        )
                        ,
                        y
                        (
                        u
                        ,
                        v
                        )
                        ,
                        z
                        (
                        u
                        ,
                        v
                        )
                        ]
                     , where x, y and z are differentiable functions of the parameters u and v. As this work focus on providing a computational method for the geodesic, we assume that S is regular.

A curve C lying entirely on the surface S can be expressed in parametric form by:
                        
                           (1)
                           
                              
                                 u
                                 =
                                 u
                                 (
                                 s
                                 )
                                 ,
                                 
                                 v
                                 =
                                 v
                                 (
                                 s
                                 )
                                 ,
                              
                           
                        
                      where s is the arc length.

Let 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        =
                        r
                        (
                        
                           
                              u
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              0
                           
                        
                        )
                      denote a starting point on curve C in three-dimensional space, and 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      the unit tangent vector of curve C at 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                     .

Then the three-dimensional directional vector 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      is pulled back to the parametric domain adopting a simple procedure (Piegl and Tiller, 1997), and we get the direction of 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      at 
                        
                           
                              q
                           
                           
                              0
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              0
                           
                        
                        )
                      which can be represented as 
                        
                           
                              L
                           
                           
                              0
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              0
                           
                        
                        )
                        ,
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              0
                           
                        
                        )
                        )
                     . Here 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      and 
                        
                           
                              q
                           
                           
                              0
                           
                        
                      are the preimage of curve C and point 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      in the parametric domain, respectively.

Assume that 
                        
                           
                              q
                           
                           
                              1
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              1
                           
                        
                        )
                      is the point lying in the neighborhood of 
                        
                           
                              q
                           
                           
                              0
                           
                        
                      on 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                     , and it can be approximated as:
                        
                           (2)
                           
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    Δ
                                    s
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    Δ
                                    s
                                    )
                                 
                                 ,
                              
                           
                        
                      where Δs is arch length increment.

Let 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        =
                        r
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              1
                           
                        
                        )
                      denote the three-dimensional image point of 
                        
                           
                              q
                           
                           
                              1
                           
                        
                      on S. According to the Frenet–Serret formulas, the unit tangent vector of curve C at 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      can be approximated as:
                        
                           (3)
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                                 Δ
                                 s
                                 ,
                              
                           
                        
                      where 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      is the unit tangent vector of curve C at 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              k
                           
                           
                              0
                           
                        
                      is the curvature of curve C at 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              β
                           
                           
                              0
                           
                        
                      is the principal normal vector of curve C at 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                     .

Suppose curve C is geodesic on surface S, and then Eq. (3) can be rewritten as:
                        
                           (4)
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 ±
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 Δ
                                 s
                                 ,
                              
                           
                        
                      where 
                        
                           
                              n
                           
                           
                              0
                           
                        
                      is the unit normal vector of surface S at 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      which is parallel to 
                        
                           
                              β
                           
                           
                              0
                           
                        
                      and is given by:
                        
                           (5)
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ×
                                       
                                          
                                             r
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       |
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ×
                                       
                                          
                                             r
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       |
                                    
                                 
                                 .
                              
                           
                        
                      
                     
                        
                           
                              r
                           
                           
                              u
                           
                        
                      and 
                        
                           
                              r
                           
                           
                              v
                           
                        
                      are the first order parametric derivatives of the surface patch with respect to u and v, respectively.

Then we consider the curvature of curve C at 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                     .

Let a denote the included angle made by 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              1
                           
                        
                     , and 
                        
                           
                              n
                           
                           
                              1
                           
                        
                      the unit normal vector of surface S at 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      (see Fig. 1
                     ).

From the definition of curvature, 
                        
                           
                              k
                           
                           
                              0
                           
                        
                      can be obtained as:
                        
                           (6)
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    lim
                                    
                                       Δ
                                       s
                                       →
                                       0
                                    
                                 
                                 ⁡
                                 
                                    |
                                    
                                       a
                                       
                                          Δ
                                          s
                                       
                                    
                                    |
                                 
                                 .
                              
                           
                        
                     
                  

Assume Δs is small, 
                        
                           
                              k
                           
                           
                              0
                           
                        
                      is approached as follows:
                        
                           (7)
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       sin
                                       ⁡
                                       a
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       .
                                       
                                          
                                             T
                                          
                                          
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 .
                              
                           
                        
                     
                  

To obtain the sign of 
                        
                           
                              n
                           
                           
                              1
                           
                        
                        .
                        
                           
                              T
                           
                           
                              0
                           
                        
                      in Eq. (7), the neighborhood of 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      on curve C is approached by using a circular-arc approximation, as illustrated in Fig. 2
                     . In this work, the circular-arc approximation is deemed to be accurate enough as it is of second order accuracy.

In Fig. 2, 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      are both located on the circular-arc, and the direction in which the circular-arc is turning is determined by 
                        
                           
                              β
                           
                           
                              0
                           
                        
                     .

As seen in Fig. 2, when 
                        
                           
                              β
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              n
                           
                           
                              0
                           
                        
                      are in the same direction, 
                        
                           
                              k
                           
                           
                              0
                           
                        
                        =
                        −
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              .
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                           
                           
                              Δ
                              s
                           
                        
                     . Substitute it into Eq. (4) then it follows that:
                        
                           (8)
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       .
                                       
                                          
                                             T
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 Δ
                                 s
                                 .
                              
                           
                        
                     
                  

Similarly, when 
                        
                           
                              β
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              n
                           
                           
                              0
                           
                        
                      are in the opposite direction, 
                        
                           
                              k
                           
                           
                              0
                           
                        
                        =
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              .
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                           
                           
                              Δ
                              s
                           
                        
                     . Substitute it into Eq. (4), and then we get the same equation as Eq. (8).

In summary, a universal equation is obtained to calculate 
                        
                           
                              T
                           
                           
                              1
                           
                        
                     . Next, 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      is pulled back to the parametric domain, thus we get 
                        
                           
                              L
                           
                           
                              1
                           
                        
                     , where 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              1
                           
                        
                        )
                        ,
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              1
                           
                        
                        )
                        )
                      is the direction of 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      at 
                        
                           
                              q
                           
                           
                              1
                           
                        
                     .

Next, we can get point 
                        
                           
                              q
                           
                           
                              2
                           
                        
                        (
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        )
                      lying in the neighborhood of 
                        
                           
                              q
                           
                           
                              1
                           
                        
                     . Similarly, the subsequent geodesic points can be computed until the boundary of the surface is reached or the number of computed points exceeds a maximal point number. The sequence of geodesic points gives a unique parametric geodesic using 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      as initial value.

We are tracing a geodesic on surface S using 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      as initial values.

The main algorithm flow is described as follows:
                        
                           1.
                           The three-dimensional directional vector 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               is pulled back to the parametric domain of the surface S, and the direction of curve 
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                               at 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                               is obtained.

Based on the direction of curve 
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                               at 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                              , the point lying in the neighborhood of 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                               on 
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                               is derived as 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              .

The unit normal vector of surface S at 
                                 
                                    
                                       Q
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                               is obtained as 
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                               separately through a simple procedure.

After the steps above, the three-dimensional directional vector 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                               can be obtained through Eq. (8).

Then 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                               are used to compute the subsequent geodesic point. The sequence of geodesic points gives a unique parametric geodesic using 
                                 
                                    
                                       Q
                                    
                                    
                                       0
                                    
                                 
                               as initial value.

The rest of the paper is organized as follows. In Section 3, the calculation error of this algorithm is obtained. In Section 4, we introduce a strategy which enables the step size adapt to the geometry of surface during the computation process. Section 5 shows the experimental results and Section 6 concludes the paper.

Let 
                        
                           
                              q
                           
                           
                              i
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              i
                           
                        
                        )
                      denote the point calculated by the proposed method in step i 
                     
                        (
                        i
                        =
                        2
                        …
                        m
                        ,
                        
                        m
                        ≥
                        2
                        )
                     , the exact position of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      is represented as 
                        
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           ‾
                        
                        =
                        (
                        
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ‾
                        
                        ,
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ‾
                        
                        )
                     . The three-dimensional image point of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           ‾
                        
                      on S is represented as 
                        
                           
                              Q
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 Q
                              
                              
                                 i
                              
                           
                           ‾
                        
                     , respectively. The main focus in this section is to acquire the difference between 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           ‾
                        
                     . 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      is the starting point of the geodesic, so 
                        
                           
                              q
                           
                           
                              0
                           
                        
                        =
                        
                           
                              
                                 q
                              
                              
                                 0
                              
                           
                           ‾
                        
                     .

As presented in Section 2, the position of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      is obtained as:
                        
                           (9)
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 Δ
                                 s
                                 ,
                              
                           
                        
                      where 
                        
                           
                              L
                           
                           
                              i
                              −
                              1
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              i
                              −
                              1
                           
                        
                        )
                        ,
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              q
                           
                           
                              i
                              −
                              1
                           
                        
                        )
                        )
                      is the direction of 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      at point 
                        
                           
                              q
                           
                           
                              i
                              −
                              1
                           
                        
                     .

From the Taylor expansion, it follows that:
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ‾
                                 
                                 =
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 +
                                 
                                    
                                       
                                          L
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 Δ
                                 s
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              
                                 L
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              
                                 q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        )
                        ,
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              
                                 q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        )
                        )
                     , 
                        
                           
                              M
                           
                           
                              i
                              −
                              1
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              ″
                           
                        
                        (
                        
                           
                              
                                 q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        )
                        ,
                        
                           
                              v
                           
                           
                              ″
                           
                        
                        (
                        
                           
                              
                                 q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        )
                        )
                      and 
                        O
                        (
                        
                        )
                      is big O notation. 
                        
                           
                              u
                           
                           
                              ′
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              ′
                           
                        
                      are the first-order partial derivatives of 
                        u
                        (
                        s
                        )
                      and 
                        v
                        (
                        s
                        )
                      with respect to s, while 
                        
                           
                              u
                           
                           
                              ″
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              ″
                           
                        
                      are the second-order partial derivatives of 
                        u
                        (
                        s
                        )
                      and 
                        v
                        (
                        s
                        )
                     .

Combine Eq. (9) with Eq. (10), the position calculation error of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      is obtained as:
                        
                           (11)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       
                                          L
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 Δ
                                 s
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where the superscript p of 
                        
                           
                              E
                           
                           
                              i
                           
                        
                      specifies the position calculation error.

By referring to Eq. (11), 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      consists of three parts:
                        
                           1.
                           The position calculation error of 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                              :
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             ‾
                                          
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

The error caused by the direction calculation error of 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                              :
                                 
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                E
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                             
                                                l
                                             
                                          
                                          Δ
                                          s
                                          ,
                                       
                                    
                                 
                               where 
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       
                                          L
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                              . The superscript l of 
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                               specifies the direction calculation error.

The neglected remainder of the Taylor expansion:
                                 
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          Δ
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          O
                                          
                                             (
                                             Δ
                                             
                                                
                                                   s
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

In Eq. (11), 
                        
                           
                              ε
                           
                           
                              1
                           
                        
                        +
                        
                           
                              ε
                           
                           
                              2
                           
                        
                      is the local truncation error in step i. As can be seen from above, 
                        
                           
                              ε
                           
                           
                              2
                           
                        
                      is on the order of 
                        O
                        (
                        Δ
                        
                           
                              s
                           
                           
                              2
                           
                        
                        )
                     . However, it is not easy to determine the order of 
                        
                           
                              ε
                           
                           
                              1
                           
                        
                      as we do not know the expression of 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              l
                           
                        
                     . 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              l
                           
                        
                      will affect 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      while will be affected by 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              p
                           
                        
                     , which reveals that there is a coupling relationship between ‘position calculation error’ and ‘direction calculation error’. In the subsequent part, in order to decoupling and acquire 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                     , we will perform an overall analysis.

First of all, we make an assumption that this algorithm is of kth-order accuracy, where 
                        k
                        =
                        0
                      or 
                        k
                        =
                        1
                     . Then 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      can be represented as:
                        
                           (12)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                      is constant depends on variable i.

Next, we are going to show that 
                        k
                        =
                        1
                     .

By referring to Section 2, 
                        
                           
                              L
                           
                           
                              i
                              −
                              1
                           
                        
                      is derived by solving the following system of linear equations:
                        
                           (13)
                           
                              
                                 
                                    
                                       A
                                       L
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       B
                                       T
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        A
                        =
                        
                           [
                           
                              
                                 
                                    
                                       
                                          |
                                          
                                             
                                                r
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    .
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    .
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                r
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           ]
                        
                     , 
                        B
                        =
                        
                           [
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                           ]
                        
                      and 
                        
                           
                              T
                           
                           
                              i
                              −
                              1
                           
                        
                      is the unit tangent vector at 
                        
                           
                              Q
                           
                           
                              i
                              −
                              1
                           
                        
                     .

At the same time, 
                        
                           
                              
                                 L
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                      can be got by solving a system of linear equations quite similar to Eq. (13):
                        
                           (14)
                           
                              
                                 
                                    A
                                    ‾
                                 
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ‾
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    B
                                    ‾
                                 
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ‾
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           A
                           ‾
                        
                        =
                        
                           [
                           
                              
                                 
                                    
                                       
                                          |
                                          
                                             
                                                r
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             ‾
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                    .
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                    .
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                r
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             ‾
                                          
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           ]
                        
                     , 
                        
                           B
                           ‾
                        
                        =
                        
                           [
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ‾
                                    
                                    )
                                 
                              
                           
                           ]
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                      is the unit tangent vector at 
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                     .

From the Taylor expansion, it follows that:
                        
                           (15)
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 
                                 )
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 
                                 )
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

From Eq. (13), Eq. (14), Eq. (15) and Eq. (16), through simplification, the following equation is expressed:
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                             E
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             l
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             B
                                             E
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              t
                           
                        
                        =
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        −
                        
                           
                              T
                           
                           
                              i
                              −
                              1
                           
                        
                     . The superscript t of 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                        
                      specifies the unit tangent vector calculation error.

With Eq. (17), in order to obtain 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              l
                           
                        
                     , 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              t
                           
                        
                      is investigated.

By referring to the Taylor expansion, it follows that:
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    ‾
                                 
                                 +
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       ‾
                                    
                                    )
                                    |
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    ‾
                                 
                                 Δ
                                 s
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       T
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       )
                                    
                                    ‾
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                      is the unit tangent vector at 
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                        .
                        |
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                        )
                        |
                      and 
                        
                           
                              
                                 β
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                      is the curvature and principal normal vector of 
                        
                           C
                           ‾
                        
                      at 
                        
                           
                              
                                 Q
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                     , respectively. 
                        
                           C
                           ‾
                        
                      represents the ideal geodesic with 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      as initial values.

The unit tangent vector calculation error of 
                        
                           
                              Q
                           
                           
                              i
                              −
                              1
                           
                        
                      is obtained as:
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          ‾
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             |
                                             
                                                
                                                   T
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      i
                                                      −
                                                      2
                                                   
                                                
                                                ‾
                                             
                                             )
                                             |
                                          
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   −
                                                   2
                                                
                                             
                                             ‾
                                          
                                          −
                                          
                                             
                                                |
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                .
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      i
                                                      −
                                                      2
                                                   
                                                
                                                |
                                             
                                             
                                                Δ
                                                s
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          )
                                       
                                       Δ
                                       s
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   −
                                                   2
                                                
                                             
                                             )
                                          
                                          ‾
                                       
                                       Δ
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       O
                                       
                                          (
                                          Δ
                                          
                                             
                                                s
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          ‾
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             |
                                             
                                                
                                                   T
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      i
                                                      −
                                                      2
                                                   
                                                
                                                ‾
                                             
                                             )
                                             |
                                          
                                          −
                                          
                                             
                                                |
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                .
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      i
                                                      −
                                                      2
                                                   
                                                
                                                |
                                             
                                             
                                                Δ
                                                s
                                             
                                          
                                          )
                                       
                                       
                                          
                                             β
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       Δ
                                       s
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   −
                                                   2
                                                
                                             
                                             )
                                          
                                          ‾
                                       
                                       Δ
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       O
                                       
                                          (
                                          Δ
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                +
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              n
                           
                           
                              i
                              −
                              1
                           
                        
                      is the unit normal vector of S at 
                        
                           
                              Q
                           
                           
                              i
                              −
                              1
                           
                        
                      and 
                        
                           
                              β
                           
                           
                              i
                              −
                              2
                           
                        
                      is the principal normal vector of C at 
                        
                           
                              Q
                           
                           
                              i
                              −
                              2
                           
                        
                     .

Move 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                      to a same starting point O, and draw a unit circle with O as center (see Fig. 3
                     ). This unit circle will pass through the end points of 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                     , and the included angle 
                        
                           a
                           ‾
                        
                      made by 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ‾
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                      is equal to the length of arc MN.

As illustrated in Fig. 3, the following equation is obtained:
                        
                           (20)
                           
                              
                                 
                                    
                                       |
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ‾
                                       
                                       .
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          ‾
                                       
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       sin
                                       ⁡
                                       
                                          a
                                          ‾
                                       
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             M
                                             N
                                          
                                          |
                                       
                                       
                                          →
                                       
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 
                                    
                                       |
                                       sin
                                       ⁡
                                       
                                          a
                                          ‾
                                       
                                       |
                                    
                                    
                                       
                                          |
                                          
                                             M
                                             N
                                          
                                          |
                                       
                                       
                                          →
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             M
                                             N
                                          
                                          |
                                       
                                       
                                          →
                                       
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 
                                    |
                                    cos
                                    ⁡
                                    
                                       
                                          a
                                          ‾
                                       
                                       2
                                    
                                    |
                                 
                                 ,
                              
                           
                        
                      where we assume 
                        |
                        cos
                        ⁡
                        
                           
                              a
                              ‾
                           
                           2
                        
                        |
                        =
                        1
                      when ‘Δs’ is small.

Now we consider 
                        |
                        
                           
                              M
                              N
                           
                           
                              →
                           
                        
                        |
                     :
                        
                           (21)
                           
                              
                                 
                                    
                                       |
                                       
                                          M
                                          N
                                       
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 =
                                 |
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    ‾
                                 
                                 |
                                 =
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       ‾
                                    
                                    )
                                    Δ
                                    s
                                    +
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          T
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       ‾
                                    
                                    )
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    O
                                    
                                       (
                                       Δ
                                       
                                          
                                             s
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 .
                              
                           
                        
                     
                  

Substitute Eq. (21) into Eq. (20), the following equation is expressed:
                        
                           (22)
                           
                              
                                 −
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    
                                       |
                                       
                                          
                                             T
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       )
                                       |
                                    
                                    Δ
                                    s
                                    +
                                    O
                                    
                                       (
                                       Δ
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       |
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ‾
                                       
                                       .
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          ‾
                                       
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 −
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    )
                                    |
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    )
                                    |
                                 
                                 Δ
                                 s
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Substitute 
                        
                           
                              
                                 n
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                        =
                        
                           
                              n
                           
                           
                              i
                              −
                              1
                           
                        
                        +
                        O
                        (
                        Δ
                        
                           
                              s
                           
                           
                              k
                              +
                              1
                           
                        
                        )
                      into Eq. (22), the following equation is derived:
                        
                           (23)
                           
                              
                                 −
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    
                                       |
                                       
                                          
                                             T
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       )
                                       |
                                    
                                    Δ
                                    s
                                    +
                                    O
                                    
                                       (
                                       Δ
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       |
                                       
                                          
                                             n
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       .
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                                −
                                                2
                                             
                                          
                                          ‾
                                       
                                       |
                                    
                                    
                                       Δ
                                       s
                                    
                                 
                                 −
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    )
                                    |
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                                 
                                    |
                                    
                                       
                                          T
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    )
                                    |
                                 
                                 Δ
                                 s
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

As 
                        k
                        =
                        0
                      or 
                        k
                        =
                        1
                     , let 
                        |
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        (
                        
                           
                              Q
                           
                           
                              i
                              −
                              2
                           
                        
                        )
                        |
                        =
                        
                           
                              |
                              
                                 
                                    n
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              .
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ‾
                              
                              |
                           
                           
                              Δ
                              s
                           
                        
                        +
                        O
                        (
                        Δ
                        
                           
                              s
                           
                           
                              k
                           
                        
                        )
                     . Substitute it into Eq. (19), we arrive at a recursion formula:
                        
                           (24)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 +
                                 
                                    (
                                    |
                                    
                                       
                                          n
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    .
                                    
                                       
                                          
                                             T
                                          
                                          
                                             i
                                             −
                                             2
                                          
                                       
                                       ‾
                                    
                                    |
                                    −
                                    |
                                    
                                       
                                          n
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    .
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    |
                                    )
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

By referring to the recursion formula, the unit tangent vector calculation error of 
                        
                           
                              Q
                           
                           
                              i
                              −
                              1
                           
                        
                      is obtained as:
                        
                           (25)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              ω
                           
                           
                              2
                           
                        
                      is constant dependent on variable i.

With Eq. (25) and Eq. (17), 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              l
                           
                        
                      can be derived as follows:
                        
                           (26)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              ω
                           
                           
                              3
                           
                        
                      is constant.

Substitute 
                        
                           
                              E
                           
                           
                              i
                              −
                              1
                           
                           
                              l
                           
                        
                      into Eq. (11), 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      is obtained as:
                        
                           (27)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

With Eq. (27), it is acquired that 
                        k
                        =
                        1
                     . At the same time, 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      can be simplified as:
                        
                           (28)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ‾
                                 
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

By using the recursion formula as Eq. (28), the position calculation error of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      is obtained:
                        
                           (29)
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    i
                                 
                                 
                                    
                                       M
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 O
                                 
                                    (
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Although Eq. (29) is obtained when 
                        i
                        ≥
                        2
                     , it can also be applied to the position calculation error of 
                        
                           
                              q
                           
                           
                              1
                           
                        
                     .

In this section, a strategy which enables the step size adapt to the geometry of surface is introduced.

By referring to the mean value theorem, the local truncation error of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      can be rewritten as:
                        
                           (30)
                           
                              
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       ε
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    Δ
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where both of 
                        
                           
                              δ
                           
                           
                              i
                              −
                              1
                           
                        
                      and 
                        
                           
                              φ
                           
                           
                              i
                              −
                              1
                           
                        
                      are located between 
                        
                           
                              
                                 q
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ‾
                        
                      and 
                        
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           ‾
                        
                      on curve 
                        
                           C
                           ‾
                        
                     .

Let λ denote the upper limit of the local truncation error of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                     , we get:
                        
                           (31)
                           
                              
                                 
                                    (
                                    
                                       |
                                       
                                          
                                             u
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    +
                                    
                                       |
                                       
                                          
                                             v
                                          
                                          
                                             ″
                                          
                                       
                                       (
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    )
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 2
                                 λ
                                 .
                              
                           
                        
                     
                  

In each calculation step, we choose 
                        Δ
                        s
                        =
                        
                           
                              
                                 2
                                 λ
                              
                              
                                 (
                                 |
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 |
                                 +
                                 |
                                 
                                    
                                       v
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 |
                                 )
                              
                           
                        
                      as the step size.

Then the position calculation error of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      is estimated as:
                        
                           (32)
                           
                              
                                 
                                    |
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    |
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    |
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    |
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    |
                                 
                                 Δ
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 i
                                 λ
                                 .
                              
                           
                        
                     
                  

In the subsequent part, the approximate values of 
                        
                           
                              u
                           
                           
                              ″
                           
                        
                        (
                        s
                        )
                      and 
                        
                           
                              v
                           
                           
                              ″
                           
                        
                        (
                        s
                        )
                      are considered.

From the derivation formula of composite function, it follows that:
                        
                           (33)
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     
                  

Take the derivative of Eq. (33) on both sides with respect to s, and it follows:
                        
                           (34)
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ″
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ″
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 M
                                 ,
                              
                           
                        
                      where 
                        M
                        =
                        
                           
                              r
                           
                           
                              ″
                           
                        
                        (
                        s
                        )
                        −
                        
                           
                              r
                           
                           
                              u
                              u
                           
                        
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        
                           
                              (
                              s
                              )
                           
                           
                              2
                           
                        
                        −
                        2
                        
                           
                              r
                           
                           
                              u
                              v
                           
                        
                        
                           
                              u
                           
                           
                              ′
                           
                        
                        (
                        s
                        )
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        (
                        s
                        )
                        −
                        
                           
                              r
                           
                           
                              v
                              v
                           
                        
                        
                           
                              v
                           
                           
                              ′
                           
                        
                        
                           
                              (
                              s
                              )
                           
                           
                              2
                           
                        
                     .

By left multiply 
                        
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                              )
                           
                           
                              T
                           
                        
                      on both sides of Eq. (34), we get:
                        
                           (35)
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                             .
                                             
                                                
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                             .
                                             
                                                
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ″
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ″
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   u
                                                
                                             
                                             .
                                             M
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   v
                                                
                                             
                                             .
                                             M
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     
                  

By solving this system of linear equations, we can get 
                        
                           
                              u
                           
                           
                              ″
                           
                        
                        (
                        s
                        )
                      and 
                        
                           
                              v
                           
                           
                              ″
                           
                        
                        (
                        s
                        )
                     .

Here is the detail of the step size adjustment strategy:

We start with a starting point 
                        
                           
                              q
                           
                           
                              0
                           
                        
                        (
                        
                           
                              u
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              0
                           
                        
                        )
                      and a starting direction 
                        
                           
                              T
                           
                           
                              0
                           
                        
                     . Further we have an initial step size 
                        
                           
                              h
                           
                           
                              0
                           
                        
                      and λ.
                        
                           1.
                           By using the starting direction 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               and initial step size 
                                 
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                              , 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                               is obtained.


                              
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                                 )
                               are obtained by solving Eq. (35), where 
                                 −
                                 
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       .
                                       
                                          
                                             T
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       
                                          
                                             n
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                 
                               is used to approach 
                                 
                                    
                                       r
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       0
                                    
                                 
                                 )
                              .

Change the step size into 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          2
                                          λ
                                       
                                       
                                          (
                                          |
                                          
                                             
                                                u
                                             
                                             
                                                ″
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          |
                                          +
                                          |
                                          
                                             
                                                v
                                             
                                             
                                                ″
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          |
                                          )
                                       
                                    
                                 
                              , where 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                               is the step size to calculate the position of 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              .

The position of 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                               is acquired as (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                              ). Similarly, the subsequent geodesic points (
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                              , 
                                 
                                    
                                       q
                                    
                                    
                                       4
                                    
                                 
                                 …
                              ) can be computed.

In each step, we need to compute the position of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      and the step size 
                        
                           
                              h
                           
                           
                              i
                           
                        
                      for the next step. Although the time costs increases in each step, the overall time costs decreases generally.


                     
                        Remark
                        The quality of result is influence by step size, curve curvature and parameterization. Therefore, for different parameterization or curve curvature, we adjust the step size to maintain result with good quality.

In this section, we perform comparisons between our method and some existing elegant methods. At first, our approach is compared with Beck's approach on accuracy and efficiency as both approaches work directly on the original surface.

Then, both of the two methods mentioned above are compared with Ravi Kumar's discrete method. Ravi Kumar's discrete method had been extended to estimate geodesics on regular surfaces in Chen's work. This method does not perform on regular surfaces directly. The discrete geodesic is computed at first and then projected to the regular surface. In this work, Liu's (2009) point projection method is adopted.

Next, various surfaces are adopted to validate the proposed algorithms. All computer programs of the proposed algorithms are written in MATLAB 7.0 and run on a personal computer [Intel Core (TM) i5 Duo Processor, 2.8 GHz, 2 GB memory] to test the accuracy and the efficiency.

In the present work, all the geodesics are computed until they reach the boundary of the surface and the computation time is recorded. In order to measure the accuracy of the three kinds of algorithms, we record the distance 
                        
                           dist
                        
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              i
                              d
                           
                        
                        )
                      between last point 
                        
                           
                              q
                           
                           
                              co
                           
                        
                        (
                        u
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        )
                        ,
                        v
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        )
                        )
                      of the computed geodesic and last point 
                        
                           
                              q
                           
                           
                              i
                              d
                           
                        
                        (
                        u
                        (
                        
                           
                              q
                           
                           
                              id
                           
                        
                        )
                        ,
                        v
                        (
                        
                           
                              q
                           
                           
                              id
                           
                        
                        )
                        )
                      of the ideal geodesic, where 
                        
                           dist
                        
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              i
                              d
                           
                        
                        )
                      equals to 
                        |
                        u
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        )
                        −
                        u
                        (
                        
                           
                              q
                           
                           
                              id
                           
                        
                        )
                        |
                        +
                        |
                        v
                        (
                        
                           
                              q
                           
                           
                              co
                           
                        
                        )
                        −
                        v
                        (
                        
                           
                              q
                           
                           
                              id
                           
                        
                        )
                        |
                     . The ideal geodesic on B-spline surface is not readily available, so we use the geodesic computed by using the fourth order Runge–Kutta method with extremely small step size as the ideal geodesic.

Now, we will introduce the first two examples, respectively. In both of the two examples, our approach is compared with Beck's approach on accuracy and efficiency. For the two approaches, we record their computation errors at a group of equal step size and their computation time required to achieve a given level of accuracy, respectively. For the purpose of equity, step size of the two algorithms in both of the examples is fixed. Meanwhile, the accuracy and efficiency of Ravi Kumar's discrete method are also presented.

In the first example, we consider a 
                        2
                        ×
                        2
                      B-spline surface. As illustrated in Fig. 4
                     , the geodesics are computed on this surface in three different directions. The results of the comparison are demonstrated in Figs. 5–7
                     
                     
                     . The results of Ravi Kumar's discrete method are shown in Fig. 8
                     . In this work, we simply record the efficiency of Ravi Kumar's discrete method in 
                        
                           
                              V
                           
                           
                              0
                           
                        
                        (
                        d
                        u
                        :
                        d
                        v
                        =
                        1
                        :
                        1
                        )
                      as the results in 
                        
                           
                              V
                           
                           
                              1
                           
                        
                        (
                        d
                        u
                        :
                        d
                        v
                        =
                        1
                        :
                        2
                        )
                      and 
                        
                           
                              V
                           
                           
                              2
                           
                        
                        (
                        d
                        u
                        :
                        d
                        v
                        =
                        2
                        :
                        1
                        )
                      share a quite similar tendency as 
                        
                           
                              V
                           
                           
                              0
                           
                        
                     .

For the 
                        2
                        ×
                        2
                      B-spline surface, as can be seen in Fig. 5(b), Fig. 6(b) and Fig. 7(b), although Beck's approach is more accurate, our method is always able to achieve a given level of accuracy with less computation time, which indicates that our method is more efficient. This is mainly due to that the divergence of accuracy between the two approaches is not significant on the 
                        2
                        ×
                        2
                      B-spline surface.

In the second example, we consider a 
                        6
                        ×
                        4
                      B-spline surface. The geodesics are computed on this surface in three different directions, as illustrated in Fig. 9
                     . The ideal geodesic on B-spline surface is calculated in a same way as in the first example. The results of the comparison are presented in Figs. 10–12
                     
                     
                     . The results of Ravi Kumar's discrete method are shown in Fig. 13
                     .

The difference on efficiency of the two kinds of algorithm for the 
                        6
                        ×
                        4
                      B-spline surface is clearly illustrated in Fig. 10(b), Fig. 11(b) and Fig. 12(b). As shown in these diagrams, the comparison results of the two algorithms on efficiency in 
                        
                           
                              V
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              V
                           
                           
                              1
                           
                        
                      depend on the level of the specified accuracy. To be more specifically, our approach is more efficient when the specified computation error is greater than 
                        5
                        ×
                        
                           
                              10
                           
                           
                              −
                              5
                           
                        
                      while Beck's approach is more efficient when the computation error is less than 
                        1
                        ×
                        
                           
                              10
                           
                           
                              −
                              5
                           
                        
                     . This is because Beck's method is much more accurate than our approach with the equal step size when the specified computation error is less than 
                        1
                        ×
                        
                           
                              10
                           
                           
                              −
                              5
                           
                        
                     . In this case, to obtain equivalent accuracy as Beck's method, our approach generally has to adopt very small step size, which is at the expense of computational efficiency. The comparison results in 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      demonstrate that the divergence of accuracy between the two kinds of approaches is not significant and our method is more efficient, which is quite different from the results in 
                        
                           
                              V
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              V
                           
                           
                              1
                           
                        
                     . This is mainly due to the improvement of accuracy of our approach in 
                        
                           
                              V
                           
                           
                              2
                           
                        
                     , which can be seen when we compare Fig. 12(a) with Fig. 10(a) and Fig. 11(a).

As shown Figs. 5–7 and Figs. 10–12, when the step size decreases, the errors generally decrease. Meanwhile, the time costs increase. For each step size, the errors of Beck's algorithm are always smaller than those of our method, and this is more obvious in Example 2, which indicates that Beck's method is more accurate. However, as for the efficiency of the two kinds of algorithms about achieving a given level of accuracy, the results are different. Since our approach is less accurate, to acquire equivalent accuracy as Beck's method, our approach have to adopt smaller step size. The step size of our approach depends on the level of divergence of accuracy between the two approaches. If the accuracy of Beck's method is significantly better than our approach, the latter method might have to use very small step size, which will increase the time cost largely. It is well known that Beck's method is computationally intensive. In this work, we have found that the time costs of Beck's method is approximately 7 times larger than that of our approach with the same step size. Then, we have an estimation that our algorithm will be more efficient when the step size of our approach is bigger than 1/7 of the step size of Beck's approach.

The computational results of Ravi Kumar's discrete method are presented in Fig. 8 and Fig. 13. As shown in these figures, the accuracy and time costs of Ravi Kumar's discrete method are influenced by the grid quantity instead of the step size. With the increase of the grid quantity, the tessellated surface gets closer to the original surface, and the computation errors generally decrease. However, the reorganization time increases obviously. The results show that the time needed to compute geodesic on tessellated surface is much less than that needed to reorganize data structure of the tessellated surface. The reorganization process is computationally expensive, so Ravi Kumar's discrete method is more suitable for computation of massive geodesics on one surface. In this case, the average reorganization time in each computation is reduced largely.

As shown in Figs. 5–8 and Figs. 10–13, all of the three algorithms are able to compute geodesic on surface. Both of our algorithm and Beck's method have better accuracy than Ravi Kumar's discrete method as the former two directly use information of the original surface.

Experimental results show that our algorithm is efficient, and the geodesics which are completely on the surfaces can be obtained. Meanwhile, we do not need to solve the differential equations of geodesic which are quite complicated.

Next, in order to validate the effectiveness of our step size adjustment strategy, we will introduce another two examples. For convenience, our approach with step size adjustment strategy is called variable step algorithm, and with fixed step size is called fixed step algorithm. Then, variable step algorithm is compared with fixed step algorithm on accuracy and efficiency. The step size of the fixed step algorithm is determined by the minimum step size of the variable step algorithm.

In the third example, the geodesics are computed on the surface given by the first example in three different directions. The results of the comparison are recorded in Table 2
                     .

As shown in Table 2, the accuracy of the fixed step algorithm is better than the variable step algorithm. This is due to the fact that the step size of the former algorithm is always not greater than the latter. However, as for the computational efficiency, the variable step algorithm has superiority. Furthermore, the number of discrete points on the geodesics computed by the variable step algorithm is smaller than half of that of the fixed step algorithm, which means the geodesics computed by the former algorithm are more compact.

In the fourth example, we consider another 
                        2
                        ×
                        2
                      B-spline. The geodesics are computed on this surface in three different directions, as illustrated in Fig. 14
                     . The results of the comparison are recorded in Table 3
                     .

As shown in Table 3, the comparison results of Example 4 in direction 
                        
                           
                              V
                           
                           
                              1
                           
                        
                      and direction 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      are quite similar to the results of Example 3. However, as for direction 
                        
                           
                              V
                           
                           
                              0
                           
                        
                     , it takes the variable step algorithm more time on computational process even though the number of steps decreases, which means the reduced time costs due to the decrease of step numbers does not make up for the sum of the increased time costs in each step. As illustrated in Table 1 and Table 2, the average time costs in each step of the fixed step algorithm and the variable step algorithm are 1.2 ms and 2.1 ms, respectively. According to this, we have an estimate that the variable step algorithm is more efficient than the fixed step algorithm when the number of discrete points computed by the former algorithm is smaller than 4/7 of that of the latter.

Generally speaking, our variable step algorithm works well for most of the cases. The location of discrete points obtained by this algorithm distributes reasonably according to the geometry of the surface, and this could contribute to outstanding reduction of the number of discrete points on the geodesic, which means the geodesic computed by the variable step algorithm is more compact.

@&#CONCLUSION@&#

This paper presents a geometric method for computation of geodesic on parametric surfaces. The geodesic which is completely on the surface can be obtained by this algorithm. Furthermore, we do not need to solve the differential equations of geodesic which are quite complicated and generally not easy to solve.

Experimental results indicate that our approach is more efficient than Beck's method on a 
                        2
                        ×
                        2
                      B-spline surface while the efficiency of our approach on a 
                        6
                        ×
                        4
                      B-spline surface depends on the tracing direction and the level of the specified accuracy. Generally speaking, our approach is more suitable in two cases. First, the parametric surface is relative flat. Second, the requirement for the accuracy is modest. In these cases, the accuracy of our algorithm is guaranteed. At the same time, our approach will trace the geodesic efficiently as we do not need to use quite small step size. One possible application of our method is path planning in the tape laying process. In this process, the composite tapes generally follow geodesic path on a mould surface which is nearly flat or nearly conventional cylindrical.

Comparison results show that both of our algorithm and Beck's method have better accuracy than Ravi Kumar's discrete method. At the same time, Ravi Kumar's discrete method is more suitable for computation of massive geodesics on one surface.

The results also demonstrate that our step size adjustment strategy works well for most of the cases. The step size adjustment strategy has contributed to outstanding reduction of the number of discrete points on the geodesic, which means the geodesic computed with the step size adjustment strategy is more compact.

However, there are also limitations in our algorithm. The function of the parameterized surface must be given in advance, which means this algorithm does not apply to general surfaces. In addition, the surface should contain no singular point. This is due to that we need to pull the direction of the curve back to the parametric domain in each step.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the National Basic Research Program of China (2013CB035805) and the National Science and Technology Major Project of China (2010ZX04016-013).

@&#REFERENCES@&#

