@&#MAIN-TITLE@&#A sparse representation-based algorithm for the voltage fluctuation detection of a power system

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Convert the fundamental signal estimation problem to a convex optimization problem.


                        
                        
                           
                           Estimate the voltage fluctuation based on signal inpainting and sparse representation.


                        
                        
                           
                           Develop the upper bound on the recover error of the voltage fluctuation component.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Power system

Voltage fluctuation

Signal inpainting

Sparse representation

Orthogonal matching pursuit

@&#ABSTRACT@&#


               
               
                  This paper proposes a novel algorithm for the voltage fluctuation detection of a power system based on sparse representation modeling. The contents of this research mainly include: (1) By first constructing a proper objective function of the frequency and phase, we convert the fundamental signal estimation problem to a simple mathematical convex optimization problem, which can be easily solved using an exhaustive search strategy. (2) From the viewpoint of signal restoration, we regard the voltage fluctuation detection as a signal inpainting problem and then develop an 
                        
                           
                              l
                           
                           
                              0
                           
                        
                      norm-based optimization equation that exploits the sparsity prior of fluctuation component to recover the desired representation vector. (3) With the assumption that the voltage envelope changes smoothly, we establish an 
                        
                           
                              l
                           
                           
                              2
                           
                        
                      norm-based regularization equation to further improve the regularity of the result. Experimental results show that the proposed algorithm performs well on demodulating the fundamental signal and voltage fluctuation component, with good ability of noise robustness, when compared to the classical Hilbert transform-based detection method and square demodulation method.
               
            

@&#INTRODUCTION@&#

Voltage fluctuation is a phenomenon of voltage amplitude instability that originates from fast load variations [1], and it is considered to be a major factor that degrades the power quality. In this paper, we address the classic voltage fluctuation detection problem
                        
                           (1)
                           
                              s
                              (
                              t
                              )
                              =
                              u
                              (
                              t
                              )
                              (
                              1
                              +
                              v
                              (
                              t
                              )
                              )
                              +
                              e
                              (
                              t
                              )
                           
                        
                      where 
                        s
                        (
                        t
                        )
                      stands for the measured voltage signal, 
                        u
                        (
                        t
                        )
                        =
                        
                           
                              a
                           
                           
                              0
                           
                        
                        
                           cos
                        
                        (
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        t
                        +
                        
                           
                              φ
                           
                           
                              0
                           
                        
                        )
                      and 
                        v
                        (
                        t
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              a
                           
                           
                              i
                           
                        
                        
                           cos
                        
                        (
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        t
                        +
                        
                           
                              φ
                           
                           
                              i
                           
                        
                        )
                      denote the fundamental signal and voltage fluctuation component, respectively. 
                        e
                        (
                        t
                        )
                      is a zero-mean white Gaussian noise with identically distributed entries, drawn from 
                        N
                        (
                        0
                        ,
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        )
                     . We desire to develop an algorithm to demodulate the fundamental signal 
                        u
                        (
                        t
                        )
                      and the fluctuation component 
                        v
                        (
                        t
                        )
                     , getting as close as possible to the true one.

Voltage envelope tracking plays a key role for voltage fluctuation detection. Over the past 20 years, extensive works on this problem are reported in the literature, using various techniques. Fast Fourier transform [2,3], Kalman filtering [4–7], wavelet transform [8–11], Hilbert transform [12–15], neuron network [16,17], S-transform [18,19], genetic algorithm [20], energy operator [21,22], and more, are some of the many directions explored in dealing with this problem. Each family of algorithms has its own merits and weak points, and choosing between these various options depends on the practical application and situation at hand.

The demodulation of 
                        v
                        (
                        t
                        )
                      is the core task for voltage envelope tracking, which is of the form 
                        w
                        (
                        t
                        )
                        =
                        
                           
                              a
                           
                           
                              0
                           
                        
                        (
                        1
                        +
                        v
                        (
                        t
                        )
                        )
                      and appears as a linear function of 
                        v
                        (
                        t
                        )
                     . The voltage envelope tracking is important, not only because the evident applications it serves but also it provides a platform that algorithms toward various inverse problems can be tested and perfected. The voltage signal observation model defined by equation (1) in fact describes a typical signal restoration problem, where 
                        x
                        (
                        t
                        )
                        =
                        1
                        +
                        v
                        (
                        t
                        )
                      goes through a point-wise degradation operation 
                        u
                        (
                        t
                        )
                     , followed by an additive noise. When 
                        u
                        (
                        t
                        )
                      is known and contains zeros, equation (1) specializes to the inpainting problem 
                        s
                        (
                        t
                        )
                        =
                        u
                        (
                        t
                        )
                        x
                        (
                        t
                        )
                        +
                        e
                        (
                        t
                        )
                     , which can also be regarded as a generalized signal interpolation problem where the mask (sub-sampling) operator 
                        u
                        (
                        t
                        )
                      randomly nulls samples from 
                        x
                        (
                        t
                        )
                      and is highly ill-posed with infinite solutions.

Signals in the real world are sparse in essential, because most of them are spatially and temporally correlative, implying that they can be represented at a relatively low dimension. As a research hotspot, using sparse representations with specific choices of a redundant dictionary as a driving force for signal restoration has drawn a lot of attention and achieves great success in noise removing [23–25], deconvolution [26], inpainting [27,28], super-resolution [29,30], and so on. Generally speaking, these methods can lead to the best known performance in their respective fields, and rank among the best performing methods that define the current state-of-the-art. In our opinion, the key for success of these sparse representation-based methods is that they have well exploited the sparsity prior of signals. Based on this insight, this paper proposes a novel algorithm for voltage fluctuation component demodulation based on signal inpainting using sparse representation modeling. The rest of the paper is organized as follows. In Section 2, we construct a proper objective function and convert the fundamental signal estimation problem to a simple mathematical convex optimization problem and use the exhaustion method to solve it. In Section 3, we develop an 
                        
                           
                              l
                           
                           
                              0
                           
                        
                      norm-based optimization equation that exploits the sparsity prior of 
                        v
                        (
                        t
                        )
                      and use the orthogonal matching pursuit (OMP) sparse coding algorithm [31] to recover the desired representation vector of the fluctuation component, which is then used to evaluate the flicker severity by computing the short-term flicker indicator 
                        
                           
                              P
                           
                           
                              st
                           
                        
                     . With the assumption that 
                        v
                        (
                        t
                        )
                      is piecewise smooth, an 
                        
                           
                              l
                           
                           
                              2
                           
                        
                      norm-based regularization equation, with a closed-form solution, is established to further improve the regularity of the result. Details of the numerical algorithm for solving the above optimization equations are provided in Section 4, followed by the experimental validations of the proposed method and comparisons, visually and quantitatively, with the classical Hilbert transform-based detection method and the square demodulation method in Section 5. Conclusions are given in Section 6.

Using the product-to-sum formula, the voltage signal 
                        s
                        (
                        t
                        )
                      formulated by equation (1) can be expended to a set of cosine functions with different frequencies and phases
                        
                           (2)
                           
                              
                                 
                                    
                                       s
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       
                                          cos
                                       
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       t
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       +
                                       e
                                       (
                                       t
                                       )
                                       .
                                    
                                 
                              
                           
                        
                      Recall that the cosine function has orthogonality such that
                        
                           (3)
                           
                              
                                 1
                                 π
                              
                              
                                 ∫
                                 0
                                 
                                    2
                                    π
                                 
                              
                              
                                 cos
                              
                              (
                              j
                              t
                              )
                              
                                 cos
                              
                              (
                              k
                              t
                              )
                              d
                              t
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                          ,
                                       
                                       
                                          j
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          0
                                          ,
                                       
                                       
                                          j
                                          ≠
                                          k
                                       
                                    
                                 
                              
                           
                        
                      In this section, we use 
                        s
                        (
                        t
                        )
                      as the integral kernel to construct an objective function that is similar to equation (3) and then use it to recover the fundamental signal 
                        u
                        (
                        t
                        )
                      by searching the optimal parameters to maximize it.

Define
                        
                           (4)
                           
                              
                                 
                                    
                                       G
                                       (
                                       ω
                                       ,
                                       φ
                                       )
                                       =
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          cos
                                       
                                       (
                                       ω
                                       t
                                       +
                                       φ
                                       )
                                       s
                                       (
                                       t
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                       
                                       ω
                                       ∈
                                       [
                                       
                                          
                                             Ω
                                          
                                          
                                             u
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             Ω
                                          
                                          
                                             u
                                          
                                          
                                             max
                                          
                                       
                                       ]
                                       ,
                                       φ
                                       ∈
                                       [
                                       0
                                       ,
                                       2
                                       π
                                       )
                                    
                                 
                              
                           
                        
                      which can be expended as
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                       G
                                       (
                                       ω
                                       ,
                                       φ
                                       )
                                    
                                 
                                 
                                    
                                    
                                       
                                       =
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          2
                                       
                                       
                                          cos
                                       
                                       (
                                       (
                                       ω
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       t
                                       +
                                       φ
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       
                                          cos
                                       
                                       (
                                       ω
                                       t
                                       +
                                       φ
                                       )
                                       e
                                       (
                                       t
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       
                                       =
                                       
                                          
                                             G
                                          
                                          
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             −
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             −
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             −
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             e
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                      Supposing that 
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        ∈
                        [
                        
                           
                              Ω
                           
                           
                              u
                           
                           
                              min
                           
                        
                        ,
                        
                           
                              Ω
                           
                           
                              u
                           
                           
                              max
                           
                        
                        ]
                      and 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        ∈
                        [
                        
                           
                              Ω
                           
                           
                              v
                           
                           
                              min
                           
                        
                        ,
                        
                           
                              Ω
                           
                           
                              v
                           
                           
                              max
                           
                        
                        ]
                     , the ranges of the frequency variants 
                        ω
                        +
                        
                           
                              ω
                           
                           
                              0
                           
                        
                     , 
                        ω
                        +
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        +
                        
                           
                              ω
                           
                           
                              i
                           
                        
                     , 
                        ω
                        +
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        −
                        
                           
                              ω
                           
                           
                              i
                           
                        
                     , 
                        ω
                        −
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        +
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      and 
                        ω
                        −
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        −
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      can be obtained as
                        
                           (6)
                           
                              
                                 
                                    R
                                    (
                                    ω
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    [
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          min
                                       
                                    
                                    ,
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          max
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    R
                                    (
                                    ω
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    [
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          min
                                       
                                    
                                    +
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          min
                                       
                                    
                                    ,
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          max
                                       
                                    
                                    +
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          max
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    R
                                    (
                                    ω
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    [
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          min
                                       
                                    
                                    −
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          max
                                       
                                    
                                    ,
                                    2
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                       
                                          max
                                       
                                    
                                    −
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          min
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    R
                                    (
                                    ω
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    [
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          min
                                       
                                    
                                    −
                                    Δ
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          max
                                       
                                    
                                    +
                                    Δ
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    R
                                    (
                                    ω
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    [
                                    −
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          max
                                       
                                    
                                    −
                                    Δ
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    −
                                    
                                       
                                          Ω
                                       
                                       
                                          v
                                       
                                       
                                          min
                                       
                                    
                                    +
                                    Δ
                                    
                                       
                                          Ω
                                       
                                       
                                          u
                                       
                                    
                                    ]
                                 
                              
                           
                        
                      where 
                        Δ
                        
                           
                              Ω
                           
                           
                              u
                           
                        
                        =
                        
                           
                              Ω
                           
                           
                              u
                           
                           
                              max
                           
                        
                        −
                        
                           
                              Ω
                           
                           
                              v
                           
                           
                              min
                           
                        
                     . In the condition that
                        
                           (7)
                           
                              
                                 
                                    Ω
                                 
                                 
                                    v
                                 
                                 
                                    min
                                 
                              
                              >
                              Δ
                              
                                 
                                    Ω
                                 
                                 
                                    u
                                 
                              
                              
                              
                              and
                              
                              
                              
                                 
                                    Ω
                                 
                                 
                                    v
                                 
                                 
                                    max
                                 
                              
                              <
                              2
                              
                                 
                                    Ω
                                 
                                 
                                    u
                                 
                                 
                                    min
                                 
                              
                           
                        
                      it is easy to know that none of the ranges in expression (6) contains zero elements. Thus, the corresponding integrals in equation (5) become
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    =
                                    
                                       lim
                                       
                                          T
                                          →
                                          ∞
                                       
                                    
                                    ⁡
                                    
                                       
                                          2
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          T
                                          (
                                          ω
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       sin
                                    
                                    (
                                    τ
                                    T
                                    +
                                    φ
                                    +
                                    
                                       
                                          φ
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          τ
                                          =
                                          0
                                       
                                       
                                          τ
                                          =
                                          ω
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             lim
                                             
                                                T
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                T
                                                (
                                                ω
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             sin
                                          
                                          (
                                          τ
                                          T
                                          +
                                          φ
                                          +
                                          
                                             
                                                φ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                τ
                                                =
                                                0
                                             
                                             
                                                τ
                                                =
                                                ω
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             lim
                                             
                                                T
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                T
                                                (
                                                ω
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             sin
                                          
                                          (
                                          τ
                                          T
                                          +
                                          φ
                                          +
                                          
                                             
                                                φ
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                τ
                                                =
                                                0
                                             
                                             
                                                τ
                                                =
                                                ω
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             lim
                                             
                                                T
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                T
                                                (
                                                ω
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             sin
                                          
                                          (
                                          τ
                                          T
                                          +
                                          φ
                                          −
                                          
                                             
                                                φ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                τ
                                                =
                                                0
                                             
                                             
                                                τ
                                                =
                                                ω
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             lim
                                             
                                                T
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                T
                                                (
                                                ω
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             sin
                                          
                                          (
                                          τ
                                          T
                                          +
                                          φ
                                          −
                                          
                                             
                                                φ
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                τ
                                                =
                                                0
                                             
                                             
                                                τ
                                                =
                                                ω
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Moreover, by exploiting the inequality
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       ≤
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       |
                                       
                                          cos
                                       
                                       (
                                       ω
                                       t
                                       +
                                       φ
                                       )
                                       |
                                       e
                                       (
                                       t
                                       )
                                       d
                                       t
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          lim
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       ⁡
                                       
                                          2
                                          T
                                       
                                       
                                          ∫
                                          0
                                          T
                                       
                                       e
                                       (
                                       t
                                       )
                                       =
                                       2
                                       E
                                       (
                                       e
                                       (
                                       t
                                       )
                                       )
                                       =
                                       0
                                    
                                 
                              
                           
                        
                      we plug these two expressions into equation (5) and get
                        
                           (10)
                           
                              G
                              (
                              ω
                              ,
                              φ
                              )
                              =
                              
                                 lim
                                 
                                    T
                                    →
                                    ∞
                                 
                              
                              ⁡
                              
                                 2
                                 T
                              
                              
                                 ∫
                                 0
                                 T
                              
                              
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 2
                              
                              
                                 cos
                              
                              (
                              (
                              ω
                              −
                              
                                 
                                    ω
                                 
                                 
                                    0
                                 
                              
                              )
                              t
                              +
                              φ
                              −
                              
                                 
                                    φ
                                 
                                 
                                    0
                                 
                              
                              )
                              d
                              t
                           
                        
                      which can be easily computed by
                        
                           (11)
                           
                              G
                              (
                              ω
                              ,
                              φ
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          
                                             cos
                                          
                                          (
                                          φ
                                          −
                                          
                                             
                                                φ
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ,
                                       
                                       
                                          ω
                                          =
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                          ,
                                       
                                       
                                          ω
                                          ≠
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Clearly, when 
                        ω
                        =
                        
                           
                              ω
                           
                           
                              0
                           
                        
                      and 
                        φ
                        =
                        
                           
                              φ
                           
                           
                              0
                           
                        
                     , the objective function 
                        G
                        (
                        ω
                        ,
                        φ
                        )
                      reaches its maximal value 
                        
                           
                              a
                           
                           
                              0
                           
                        
                     . This means that the estimation of the fundamental signal 
                        u
                        (
                        t
                        )
                        =
                        
                           
                              a
                           
                           
                              0
                           
                        
                        
                           cos
                        
                        (
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        t
                        +
                        
                           
                              φ
                           
                           
                              0
                           
                        
                        )
                      becomes a simple convex optimization task of 
                        G
                        (
                        ω
                        ,
                        φ
                        )
                     .

For the digitalized voltage signal with sampling frequency 
                        
                           
                              f
                           
                           
                              s
                           
                        
                      (according to the Nyquist sampling theory, 
                        
                           
                              f
                           
                           
                              s
                           
                        
                      should be no less than 
                        2
                        
                           
                              f
                           
                           
                              0
                           
                        
                        =
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        /
                        π
                     ), the number of samples per period of 
                        u
                        (
                        t
                        )
                      is 
                        M
                        =
                        2
                        π
                        
                           
                              f
                           
                           
                              s
                           
                        
                        /
                        
                           
                              ω
                           
                           
                              0
                           
                        
                     , which corresponds to a phase interval of 
                        Δ
                        φ
                        =
                        2
                        π
                        /
                        M
                        =
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        /
                        
                           
                              f
                           
                           
                              s
                           
                        
                     . Thus the restoration error of 
                        
                           
                              φ
                           
                           
                              0
                           
                        
                      satisfies
                        
                           (12)
                           
                              |
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    φ
                                 
                                 
                                    0
                                 
                              
                              |
                              ≤
                              
                                 
                                    Δ
                                    φ
                                 
                                 2
                              
                              =
                              
                                 
                                    
                                       ω
                                    
                                    
                                       0
                                    
                                 
                                 
                                    2
                                    
                                       
                                          f
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                              .
                           
                        
                      It is evident that a large 
                        
                           
                              f
                           
                           
                              s
                           
                        
                      leads to a small error bound but at the price of more computation and memory usage.

Denote
                        
                           (13)
                           
                              y
                              (
                              t
                              )
                              =
                              s
                              (
                              t
                              )
                              −
                              u
                              (
                              t
                              )
                              =
                              u
                              (
                              t
                              )
                              v
                              (
                              t
                              )
                              +
                              e
                              (
                              t
                              )
                           
                        
                      and rewrite the expression above equivalently in matrix form
                        
                           (14)
                           
                              y
                              =
                              
                                 Uv
                              
                              +
                              e
                           
                        
                      where 
                        U
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              n
                           
                        
                      is a diagonal matrix with the main-diagonal containing 
                        u
                        (
                        1
                        )
                     , 
                        u
                        (
                        2
                        )
                        …
                        u
                        (
                        n
                        )
                      on the main-diagonal and represents a pointwise multiplication operator on the desired fluctuation vector v. Using the sparse representation modeling, suppose that v can be formulated as a linear combination of the columns (normalized) of a redundant dictionary 
                        A
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              m
                           
                        
                      with 
                        n
                        <
                        m
                     
                     
                        
                           (15)
                           
                              v
                              =
                              A
                              x
                              .
                           
                        
                      By recovering the sparsest solution
                        
                           (16)
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    argmin
                                 
                                 x
                              
                              
                              
                                 
                                    ‖
                                    x
                                    ‖
                                 
                                 
                                    0
                                 
                              
                              
                              
                              subject to
                              
                              
                              v
                              =
                              A
                              x
                           
                        
                      a plausible estimation of 
                        
                           
                              v
                           
                           
                              ˆ
                           
                        
                        =
                        A
                        
                           
                              x
                           
                           
                              ˆ
                           
                        
                      can be obtained.

At first glance, solving equation (16) seems to be an impossible task because we do not have access to the true vector v. To find a good approximation to 
                        
                           
                              x
                           
                           
                              ˆ
                           
                        
                     , we turn to solve the alternative equation
                        
                           (17)
                           
                              
                                 
                                    x
                                 
                                 
                                    ⋆
                                 
                              
                              =
                              
                                 
                                    argmin
                                 
                                 x
                              
                              
                              
                                 
                                    ‖
                                    x
                                    ‖
                                 
                                 
                                    0
                                 
                              
                              
                              
                              subject to
                              
                              
                              
                                 
                                    ‖
                                    y
                                    −
                                    
                                       UAx
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ≤
                              ρ
                              n
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                      and discuss how good this approximation will be in terms of the mean-squared-error (MSE) between 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      and 
                        
                           
                              x
                           
                           
                              ˆ
                           
                        
                     . A constant value of ρ is used in equation (17) to control the error tolerance.

Consider the upper bound of 
                        
                           
                              ‖
                              y
                              −
                              
                                 UAx
                              
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                      such that
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             y
                                             −
                                             
                                                UAx
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             ‖
                                             U
                                             (
                                             v
                                             −
                                             
                                                Ax
                                             
                                             )
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ‖
                                                U
                                                (
                                                v
                                                −
                                                
                                                   Ax
                                                
                                                )
                                                ‖
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ‖
                                                v
                                                −
                                                
                                                   Ax
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             ‖
                                             v
                                             −
                                             
                                                Ax
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          
                                             λ
                                          
                                          
                                             max
                                          
                                       
                                       (
                                       
                                          
                                             U
                                          
                                          
                                             T
                                          
                                       
                                       U
                                       )
                                       ⋅
                                       
                                          
                                             ‖
                                             v
                                             −
                                             
                                                Ax
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             max
                                          
                                          
                                             2
                                          
                                       
                                       ⋅
                                       
                                          
                                             ‖
                                             v
                                             −
                                             
                                                Ax
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                      where the definition of the 
                        
                           
                              l
                           
                           
                              2
                           
                        
                     -induced matrix norm, 
                        
                           
                              ‖
                              U
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                        =
                        
                           
                              max
                           
                           
                              c
                           
                        
                        ⁡
                        
                           
                              ‖
                              
                                 Uc
                              
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                        /
                        
                           
                              ‖
                              c
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              max
                           
                        
                        (
                        
                           
                              U
                           
                           
                              T
                           
                        
                        U
                        )
                     , is exploited, which is equal to the largest eigenvalue of 
                        
                           
                              U
                           
                           
                              T
                           
                        
                        U
                     . Replace 
                        
                           
                              ‖
                              y
                              −
                              
                                 UAx
                              
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                      by this bound in equation (17), leading to
                        
                           (19)
                           
                              
                                 
                                    ‖
                                    v
                                    −
                                    
                                       Ax
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 
                                    ρ
                                    n
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       max
                                    
                                    
                                       2
                                    
                                 
                              
                              .
                           
                        
                      The above expression implies that the sparsest solution 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      of equation (17) is also a feasible solution to equation (19). Denote 
                        
                           spark
                        
                        (
                        A
                        )
                      as the sparse rank of matrix A that equals the smallest number of columns from A that are linearly dependent. According to the stability of the sparsest solution theory [32], we know that when the number of non-zeros entries of 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      satisfies 
                        
                           
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    ⋆
                                 
                              
                              ‖
                           
                           
                              0
                           
                        
                        ≤
                        0.5
                        ⋅
                        
                           spark
                        
                        (
                        A
                        )
                     , the sparsest solution of an error-tolerant version of equation (16)
                     
                        
                           (20)
                           
                              
                                 
                                    x
                                 
                                 
                                    ϵ
                                 
                              
                              =
                              
                                 
                                    argmin
                                 
                                 x
                              
                              
                              
                                 
                                    ‖
                                    x
                                    ‖
                                 
                                 
                                    0
                                 
                              
                              
                              
                              subject to
                              
                              
                              
                                 
                                    ‖
                                    v
                                    −
                                    
                                       Ax
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 
                                    ϵ
                                 
                                 
                                    2
                                 
                              
                           
                        
                      must obey
                        
                           (21)
                           
                              
                                 
                                    ‖
                                    
                                       
                                          x
                                       
                                       
                                          ϵ
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 
                                    4
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    μ
                                    (
                                    A
                                    )
                                    (
                                    2
                                    
                                       
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                ⋆
                                             
                                          
                                          ‖
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    1
                                    )
                                 
                              
                           
                        
                      where 
                        μ
                        (
                        A
                        )
                      is the mutual-coherence of matrix A, which is defined as the largest absolute normalized inner product between different columns such that
                        
                           (22)
                           
                              μ
                              (
                              A
                              )
                              =
                              
                                 max
                                 
                                    i
                                    ≠
                                    j
                                 
                              
                              ⁡
                              
                                 
                                    |
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    |
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                              =
                              
                                 max
                                 
                                    i
                                    ≠
                                    j
                                 
                              
                              ⁡
                              |
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                              |
                              .
                           
                        
                      Let 
                        
                           
                              ϵ
                           
                           
                              2
                           
                        
                        =
                        ρ
                        n
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        /
                        
                           
                              u
                           
                           
                              max
                           
                           
                              2
                           
                        
                     . When 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      is sparse enough, we can regard it as a good approximation to the sparsest solution 
                        
                           
                              x
                           
                           
                              ϵ
                           
                        
                      of equation (20), and thus
                        
                           (23)
                           
                              
                                 MSE
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ⋆
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              
                                 1
                                 m
                              
                              ⋅
                              
                                 
                                    ‖
                                    
                                       
                                          x
                                       
                                       
                                          ⋆
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 n
                                 m
                              
                              ⋅
                              
                                 
                                    4
                                    ρ
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          max
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    −
                                    μ
                                    (
                                    A
                                    )
                                    (
                                    2
                                    
                                       
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                ⋆
                                             
                                          
                                          ‖
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    1
                                    )
                                    )
                                 
                              
                              .
                           
                        
                      Furthermore, the MSE error between 
                        
                           
                              v
                           
                           
                              ⋆
                           
                        
                        =
                        
                           
                              Ax
                           
                           
                              ⋆
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              ˆ
                           
                        
                      can also be bounded by
                        
                           (24)
                           
                              
                                 
                                    
                                       
                                          MSE
                                       
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             ⋆
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       =
                                       
                                          1
                                          n
                                       
                                       ⋅
                                       
                                          
                                             ‖
                                             A
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   ⋆
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          1
                                          n
                                       
                                       ⋅
                                       
                                          
                                             ‖
                                             A
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       ⋅
                                       
                                          
                                             ‖
                                             
                                                
                                                   x
                                                
                                                
                                                   ⋆
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          
                                             4
                                             ρ
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   max
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   T
                                                
                                             
                                             A
                                             )
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   max
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             1
                                             −
                                             μ
                                             (
                                             A
                                             )
                                             (
                                             2
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                   ‖
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             1
                                             )
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      where the matrix compatibility inequality 
                        
                           
                              ‖
                              
                                 PQ
                              
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                        ≤
                        
                           
                              ‖
                              P
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                        ⋅
                        
                           
                              ‖
                              Q
                              ‖
                           
                           
                              2
                           
                           
                              2
                           
                        
                      is exploited.

According to the Gershgorin disk theorem [33], the i-th eigenvalue of 
                        
                           
                              A
                           
                           
                              T
                           
                        
                        A
                        =
                        G
                      satisfies
                        
                           (25)
                           
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                              −
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              G
                              )
                              |
                              ≤
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              G
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 m
                              
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              |
                              .
                           
                        
                      For the left hand side we have
                        
                           (26)
                           
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                              −
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              G
                              )
                              |
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              G
                              )
                              −
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                              |
                              =
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              G
                              )
                              −
                              1
                              .
                           
                        
                      For the right hand side, by exploiting the definition of the mutual-coherence, we know that 
                        |
                        
                           
                              g
                           
                           
                              i
                              ,
                              j
                           
                        
                        |
                        =
                        |
                        
                           
                              a
                           
                           
                              i
                           
                           
                              T
                           
                        
                        
                           
                              a
                           
                           
                              j
                           
                        
                        |
                        ≤
                        μ
                        (
                        A
                        )
                     , and this leads to
                        
                           (27)
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 m
                              
                              |
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              |
                              ≤
                              (
                              m
                              −
                              1
                              )
                              μ
                              (
                              A
                              )
                              .
                           
                        
                      Plugging the two bound above into equation (25), we obtain
                        
                           (28)
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              )
                              ≤
                              
                                 
                                    λ
                                 
                                 
                                    max
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              )
                              ≤
                              1
                              +
                              (
                              m
                              −
                              1
                              )
                              μ
                              (
                              A
                              )
                           
                        
                      and thus
                        
                           (29)
                           
                              
                                 MSE
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    ⋆
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              ≤
                              
                                 
                                    4
                                    ρ
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    +
                                    (
                                    m
                                    −
                                    1
                                    )
                                    μ
                                    (
                                    A
                                    )
                                    )
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          max
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    −
                                    μ
                                    (
                                    A
                                    )
                                    (
                                    2
                                    
                                       
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                ⋆
                                             
                                          
                                          ‖
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    1
                                    )
                                    )
                                 
                              
                              .
                           
                        
                     
                  

Equation (29) poses an upper bound on the recover error when using equation (17) to approximately estimate the fluctuation vector 
                        
                           
                              v
                           
                           
                              ˆ
                           
                        
                     , which is determined by equation (16). As seen in this expression, the choice of the dictionary has a crucial effect on the performance of our algorithm. Indeed, equation (29) provides a criterion that guides us on how to choose a proper dictionary, which should have the two following properties: (1) a small mutual-coherence 
                        μ
                        (
                        A
                        )
                      and (2) an ability to sparsely represent the fluctuation vector v, which is aligned with a small 
                        
                           
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    ⋆
                                 
                              
                              ‖
                           
                           
                              0
                           
                        
                     . However, it is always hard to find an ideal dictionary that can meet the above two properties at the same time, because they often conflict with each other. For example, a family of matrices with randomized entries named Grassmannian Frames may be a good choice for a dictionary because they lead to the smallest possible mutual-coherence, 
                        μ
                        (
                        A
                        )
                        =
                        
                           
                              (
                              m
                              −
                              n
                              )
                              /
                              (
                              n
                              (
                              m
                              −
                              1
                              )
                              )
                           
                        
                        ≈
                        1
                        /
                        
                           n
                        
                     , but the produced representation vector 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      is not necessarily the sparsest one. In this paper, we do not intend to discuss the details of how to wisely choose an optimized dictionary but simply use the 2D separable redundant DCT matrices with a redundancy factor of 4 as the dictionary, which is created by a Kronecher-product of two 1D-DCT matrix 
                        A
                        =
                        
                           
                              A
                           
                           
                              1
                              D
                           
                        
                        ⊗
                        
                           
                              A
                           
                           
                              1
                              D
                           
                        
                     . The j-th atom 
                        
                           
                              a
                           
                           
                              j
                           
                        
                      of 
                        
                           
                              A
                           
                           
                              1
                              D
                           
                        
                      is computed by 
                        
                           cos
                        
                        (
                        (
                        i
                        −
                        1
                        )
                        (
                        j
                        −
                        1
                        )
                        /
                        4
                        π
                        )
                        ,
                        i
                        =
                        1
                        ,
                        2
                        …
                        4
                        n
                     . All atoms apart from the first are further processed by removing their mean.

With the assumption that the voltage envelope changes smoothly (which implies that 
                        v
                        (
                        t
                        )
                      is composed of piecewise smooth curves), we construct an optimization equation to update the coefficients of the sparse solution 
                        
                           
                              x
                           
                           
                              ⋆
                           
                        
                      over its support 
                        S
                      by using a derivative expression to penalize non-smooth behavior in order to promote better regularity in the solution
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             S
                                          
                                          
                                             ⋆
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             argmin
                                          
                                          
                                             
                                                x
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                       
                                          
                                             ‖
                                             y
                                             −
                                             
                                                Uv
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       η
                                       
                                          
                                             ‖
                                             
                                                Dv
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             argmin
                                          
                                          
                                             
                                                x
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                       
                                          
                                             ‖
                                             y
                                             −
                                             
                                                
                                                   UA
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   S
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       η
                                       
                                          
                                             ‖
                                             
                                                
                                                   DA
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   S
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             argmin
                                          
                                          
                                             
                                                x
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                       L
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             S
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                      where D is a first-order differential matrix and 
                        
                           
                              A
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              x
                           
                           
                              S
                           
                        
                      present the sub-dictionary and sub-vector that belong to A and x over 
                        S
                     , respectively. Constant η is used for controlling the weight of the smoothness constraint contributing to the penalty function. Taking a derivative of 
                        L
                        (
                        
                           
                              x
                           
                           
                              S
                           
                        
                        )
                      with respect to 
                        
                           
                              x
                           
                           
                              S
                           
                        
                      and setting it to zero gives
                        
                           (31)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          S
                                       
                                    
                                 
                              
                              =
                              −
                              
                                 
                                    A
                                 
                                 
                                    S
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                              (
                              y
                              −
                              
                                 
                                    UA
                                 
                                 
                                    S
                                 
                              
                              )
                              +
                              η
                              
                                 
                                    A
                                 
                                 
                                    S
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    T
                                 
                              
                              D
                              
                                 
                                    A
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    S
                                 
                              
                              =
                              
                                 0
                              
                           
                        
                      and the solution is given in closed-form as
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    S
                                 
                                 
                                    ⋆
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          S
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          UA
                                       
                                       
                                          S
                                       
                                    
                                    +
                                    η
                                    
                                       
                                          A
                                       
                                       
                                          S
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          DA
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    S
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                              y
                              .
                           
                        
                     
                  

Similar to the analysis in equation (12), the phase accuracy of 
                        v
                        (
                        t
                        )
                      is also affected by the sampling frequency 
                        
                           
                              f
                           
                           
                              s
                           
                        
                      such that 
                        |
                        
                           
                              
                                 
                                    φ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              i
                           
                        
                        −
                        
                           
                              φ
                           
                           
                              i
                           
                        
                        |
                        ≤
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        /
                        2
                        
                           
                              f
                           
                           
                              s
                           
                        
                      (without considering the error introduced by equation (29)), where 
                        
                           
                              φ
                           
                           
                              i
                           
                        
                      stands for the phase of the i-th Fourier expansion component of 
                        v
                        (
                        t
                        )
                      and 
                        
                           
                              f
                           
                           
                              s
                           
                        
                        ≥
                        2
                        
                           
                              f
                           
                           
                              i
                           
                        
                        =
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        /
                        π
                     .

Once 
                        v
                        (
                        t
                        )
                      is found, the instantaneous flicker sensing function 
                        J
                        (
                        t
                        )
                      can be computed from the diagram shown in Fig. 1
                     , which is used to simulate the response of the lamp-eye-brain chain.

The transfer functions of the weighting filter in block 1 and first order sliding mean filter in block 2 are
                        
                           (33)
                           
                              
                                 
                                    F
                                 
                                 
                                    WF
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    k
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    s
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    γ
                                    s
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⋅
                              
                                 
                                    1
                                    +
                                    s
                                    /
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    s
                                    /
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    (
                                    1
                                    +
                                    s
                                    /
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              
                           
                        
                      and
                        
                           (34)
                           
                              
                                 
                                    F
                                 
                                 
                                    MF
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 1
                                 
                                    1
                                    +
                                    0.3
                                    s
                                 
                              
                           
                        
                      where the parameters k, γ, 
                        
                           
                              q
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              q
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              q
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              q
                           
                           
                              4
                           
                        
                      used in equation (33) are 1.7480, 
                        2
                        π
                        ⋅
                        4.0598
                     , 
                        2
                        π
                        ⋅
                        9.1549
                     , 
                        2
                        π
                        ⋅
                        2.2798
                     , 
                        2
                        π
                        ⋅
                        1.2254
                      and 
                        2
                        π
                        ⋅
                        21.9
                     , respectively. Using the operator 
                        v
                        (
                        t
                        )
                        ∘
                        F
                        (
                        s
                        )
                      to notate the filtering process on signal 
                        v
                        (
                        t
                        )
                      with transfer function 
                        F
                        (
                        s
                        )
                     , the relation between 
                        J
                        (
                        t
                        )
                      and 
                        v
                        (
                        t
                        )
                      can be written as
                        
                           (35)
                           
                              J
                              (
                              t
                              )
                              =
                              
                                 
                                    (
                                    v
                                    (
                                    t
                                    )
                                    ∘
                                    
                                       
                                          F
                                       
                                       
                                          WF
                                       
                                    
                                    (
                                    s
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              ∘
                              
                                 
                                    F
                                 
                                 
                                    MF
                                 
                              
                              (
                              s
                              )
                              .
                           
                        
                      Denoting the frequency distribution function of 
                        J
                        (
                        t
                        )
                      as 
                        h
                        (
                        k
                        )
                        =
                        P
                        (
                        J
                        (
                        t
                        )
                        =
                        k
                        )
                     , the cumulative probability function of 
                        J
                        (
                        t
                        )
                      can be expressed as
                        
                           (36)
                           
                              
                                 
                                    
                                       H
                                       (
                                       k
                                       )
                                       =
                                       
                                          ∫
                                          k
                                          ∞
                                       
                                       h
                                       (
                                       p
                                       )
                                       d
                                       p
                                    
                                    
                                       =
                                       P
                                       (
                                       J
                                       (
                                       t
                                       )
                                       ≥
                                       k
                                       )
                                    
                                 
                                 
                                    
                                    
                                       =
                                       P
                                       (
                                       
                                          
                                             (
                                             v
                                             (
                                             t
                                             )
                                             ∘
                                             
                                                
                                                   F
                                                
                                                
                                                   WF
                                                
                                             
                                             (
                                             s
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ∘
                                       
                                          
                                             F
                                          
                                          
                                             MF
                                          
                                       
                                       (
                                       s
                                       )
                                       ≥
                                       k
                                       )
                                       .
                                    
                                 
                              
                           
                        
                      Based on 
                        H
                        (
                        k
                        )
                     , the flicker severity can be evaluated by the short-term flicker indicator 
                        
                           
                              P
                           
                           
                              st
                           
                        
                      by
                        
                           (37)
                           
                              
                                 
                                    P
                                 
                                 
                                    st
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          0.1
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          0.1
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          3
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          10
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          50
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          50
                                          s
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              1
                              s
                           
                        
                        =
                        (
                        
                           
                              P
                           
                           
                              0.7
                           
                        
                        +
                        
                           
                              P
                           
                           
                              1
                           
                        
                        +
                        
                           
                              P
                           
                           
                              1.5
                           
                        
                        )
                        /
                        3
                     , 
                        
                           
                              P
                           
                           
                              3
                              s
                           
                        
                        =
                        (
                        
                           
                              P
                           
                           
                              2.2
                           
                        
                        +
                        
                           
                              P
                           
                           
                              3
                           
                        
                        +
                        
                           
                              P
                           
                           
                              4
                           
                        
                        )
                        /
                        3
                     , 
                        
                           
                              P
                           
                           
                              10
                              s
                           
                        
                        =
                        (
                        
                           
                              P
                           
                           
                              6
                           
                        
                        +
                        
                           
                              P
                           
                           
                              8
                           
                        
                        +
                        
                           
                              P
                           
                           
                              10
                           
                        
                        +
                        
                           
                              P
                           
                           
                              13
                           
                        
                        +
                        
                           
                              P
                           
                           
                              17
                           
                        
                        )
                        /
                        5
                      and 
                        
                           
                              P
                           
                           
                              50
                              s
                           
                        
                        =
                        (
                        
                           
                              P
                           
                           
                              30
                           
                        
                        +
                        
                           
                              P
                           
                           
                              50
                           
                        
                        +
                        
                           
                              P
                           
                           
                              80
                           
                        
                        )
                        /
                        3
                     . 
                        
                           
                              P
                           
                           
                              x
                           
                        
                        =
                        H
                        (
                        x
                        
                           
                              J
                           
                           
                              max
                           
                        
                        /
                        100
                        )
                      stands for the probability that 
                        J
                        (
                        t
                        )
                      exceeds 
                        x
                        %
                      times its peak value 
                        
                           
                              J
                           
                           
                              max
                           
                        
                     . The parameters 
                        
                           
                              K
                           
                           
                              0.1
                           
                        
                     , 
                        
                           
                              K
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              K
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              K
                           
                           
                              10
                           
                        
                      and 
                        
                           
                              K
                           
                           
                              50
                           
                        
                      are 0.0314, 0.0525, 0.0657, 0.28 and 0.08, respectively.

Denote 
                        Q
                        (
                        k
                        )
                      as the half period RMS voltage characteristics of signal 
                        s
                        (
                        t
                        )
                     
                     
                        
                           (38)
                           
                              Q
                              (
                              k
                              )
                              =
                              
                                 
                                    
                                       1
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       ∫
                                       
                                          k
                                          
                                             
                                                T
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                          
                                             
                                                T
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    d
                                    t
                                 
                              
                              
                              
                              
                              
                              ,
                              k
                              =
                              0
                              ,
                              1
                              ,
                              2
                              …
                           
                        
                      where 
                        
                           
                              T
                           
                           
                              h
                           
                        
                        =
                        π
                        /
                        
                           
                              ω
                           
                           
                              0
                           
                        
                        =
                        1
                        /
                        2
                        
                           
                              f
                           
                           
                              0
                           
                        
                      equals the half period of fundamental signal 
                        u
                        (
                        t
                        )
                     . Based on 
                        Q
                        (
                        k
                        )
                     , we use the maximum relative voltage change indicator to evaluate the voltage fluctuation severity
                        
                           (39)
                           
                              q
                              =
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          max
                                       
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          min
                                       
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       N
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              Q
                           
                           
                              max
                           
                        
                      and 
                        
                           
                              Q
                           
                           
                              min
                           
                        
                      are the maximum and minimum values of 
                        Q
                        (
                        k
                        )
                     , respectively. 
                        
                           
                              U
                           
                           
                              N
                           
                        
                      is the nominal voltage of the measured signal. According to the signal model posed in equation (1), this value is 
                        
                           
                              a
                           
                           
                              0
                           
                        
                        /
                        
                           2
                        
                     .

Using the Schwartz inequality, equation (38) satisfies (without considering the noise term 
                        e
                        (
                        t
                        )
                     )
                        
                           (40)
                           
                              
                                 
                                    
                                       Q
                                       (
                                       k
                                       )
                                    
                                    
                                       =
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   u
                                                   (
                                                   t
                                                   )
                                                   +
                                                   u
                                                   (
                                                   t
                                                   )
                                                   v
                                                   (
                                                   t
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             d
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             d
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             d
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             d
                                             t
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                      Similarly, the lower bound of 
                        Q
                        (
                        k
                        )
                      can also be obtained as
                        
                           (41)
                           
                              Q
                              (
                              k
                              )
                              ≥
                              
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    
                                       1
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       ∫
                                       
                                          k
                                          
                                             
                                                T
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                          
                                             
                                                T
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    d
                                    t
                                 
                              
                              .
                           
                        
                      Combining the two bounds above with equation (39), we have
                        
                           (42)
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       =
                                       
                                          
                                             
                                                2
                                             
                                             (
                                             
                                                
                                                   Q
                                                
                                                
                                                   max
                                                
                                             
                                             −
                                             
                                                
                                                   Q
                                                
                                                
                                                   min
                                                
                                             
                                             )
                                          
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                       
                                       ≤
                                       
                                          
                                             2
                                             
                                                2
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             d
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       2
                                       
                                          2
                                       
                                       ⋅
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                ∫
                                                
                                                   k
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   cos
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                             t
                                             +
                                             
                                                
                                                   φ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             d
                                             t
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                      The right-hand-side of the above expression imposes an upper bound on the voltage fluctuation severity indicator q. Clearly, this bound explicitly depends on the voltage fluctuation signal 
                        v
                        (
                        t
                        )
                     .

To sum up, we use the algorithm listed below for the voltage fluctuation detection:
                        
                           •
                           
                              Estimate the fundamental signal u(t):
                              
                                 
                                    (a)
                                    Search through the collection of 
                                          (
                                          ω
                                          ,
                                          φ
                                          )
                                       , 
                                          ω
                                          ∈
                                          [
                                          
                                             
                                                Ω
                                             
                                             
                                                u
                                             
                                             
                                                min
                                             
                                          
                                          ,
                                          
                                             
                                                Ω
                                             
                                             
                                                u
                                             
                                             
                                                max
                                             
                                          
                                          ]
                                       , 
                                          φ
                                          ∈
                                          [
                                          0
                                          ,
                                          2
                                          π
                                          )
                                        with accuracy Δω and Δφ to find the optimal 
                                          (
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                        that maximizes the objective function 
                                          
                                             
                                                G
                                             
                                             
                                                max
                                             
                                          
                                          (
                                          ω
                                          ,
                                          φ
                                          )
                                          =
                                          G
                                          (
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       .

The fundamental signal is recovered by 
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             cos
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          t
                                          +
                                          
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       .


                              Estimate the fluctuation component v(t):
                              
                                 
                                    (a)
                                    Compute 
                                          y
                                          =
                                          s
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                        and partition y into overlapping segments 
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          …
                                          
                                             
                                                y
                                             
                                             
                                                N
                                             
                                          
                                        with length of L.

For each segment 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                       :
                                          
                                             –
                                             Apply the OMP sparse coding algorithm to solve equation (17) to obtain the representation vector 
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                 and its support 
                                                   S
                                                .

Use equation (32) to update the desired solution 
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         S
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                .

Recover the i-th fluctuation vector segment 
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         S
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                .

Merge the recovered segments 
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          …
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                N
                                             
                                          
                                        by averaging them one on top of the other to obtain an estimate of the fluctuation vector 
                                          
                                             
                                                v
                                             
                                             
                                                ˆ
                                             
                                          
                                       .

@&#EXPERIMENTAL RESULTS@&#

In this section, several experimental results of the proposed sparse representation-based (SR) voltage fluctuation detection algorithm are reported to show the performance and to compare this method with the classical Hilbert transform-based (HT) detection method and square demodulation (SD) method, where the latter is recommended by the International Electrotechnical Commission (IEC) [34] and the Institute of Electrical and Electronics Engineers (IEEE) [35]. These algorithms are applied to several test voltage signals with a sampling frequency of 
                        
                           
                              f
                           
                           
                              s
                           
                        
                        =
                        6400
                         
                        Hz
                     . According to equation (12), this value corresponds to a recovery error bound of 
                        |
                        
                           
                              
                                 
                                    φ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                        −
                        
                           
                              φ
                           
                           
                              0
                           
                        
                        |
                        ≤
                        0.0245
                      rad (this bound can be compared to the experimental results listed in Table 1
                     ). The recovered voltage fluctuation component 
                        v
                        (
                        t
                        )
                      is depicted in the form of the voltage envelope 
                        w
                        (
                        t
                        )
                     . We shall evaluate the performance of these methods in terms of three aspects: 1) the relative 
                        
                           
                              l
                           
                           
                              2
                           
                        
                      recovery error of fluctuation vector v, defined as
                        
                           (43)
                           
                              
                                 
                                    E
                                 
                                 
                                    v
                                 
                              
                              =
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             v
                                          
                                          
                                             ˆ
                                          
                                       
                                       −
                                       v
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ‖
                                       v
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      2) the absolute estimation error of the short-term flicker indicator 
                        
                           
                              P
                           
                           
                              st
                           
                        
                      that
                        
                           (44)
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          st
                                       
                                    
                                 
                              
                              =
                              |
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    st
                                 
                              
                              −
                              
                                 
                                    P
                                 
                                 
                                    st
                                 
                              
                              |
                           
                        
                      and 3) the robustness to noise. For the proposed SR method, the relative recovery error of 
                        
                           
                              a
                           
                           
                              0
                           
                        
                      and the absolute recovery errors of 
                        
                           
                              ω
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              φ
                           
                           
                              0
                           
                        
                     , which are computed by
                        
                           (45)
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                              
                              ,
                              
                              
                              
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              |
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    ω
                                 
                                 
                                    0
                                 
                              
                              |
                              ,
                              
                              
                              
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              |
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    φ
                                 
                                 
                                    0
                                 
                              
                              |
                           
                        
                      are also used for evaluating the performance of fundamental signal estimation. In our algorithm, the chosen parameters are listed below:
                        
                           •
                           The searching accuracy Δω and Δφ are set to 0.01 and 
                                 2
                                 π
                                 /
                                 360
                              , respectively.

The signal segment length 
                                 L
                                 =
                                 
                                    
                                       (
                                       25
                                       +
                                       σ
                                       ⋅
                                       50
                                       )
                                    
                                    
                                       2
                                    
                                 
                              .

The constants ρ and η are set to 1 and 0.05, respectively.

The sparse coding threshold in the OMP algorithm is set to 
                                 σ
                                 
                                    
                                       ρ
                                       L
                                    
                                 
                              .


                     Fig. 3
                      shows the detection results on a single modulation frequency test voltage signal, 
                        
                           
                              s
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              u
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        (
                        1
                        +
                        
                           
                              v
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        )
                     , with a noise standard-deviation of 
                        σ
                        =
                        0.01
                      and a signal length of 
                        T
                        =
                        30
                      seconds. The fundamental signal 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                      and fluctuation component 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                      are set as
                        
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.92
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.15
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       136
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.11
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       8.25
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       157
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                       ,
                                    
                                 
                              
                           
                        
                      where the corresponding voltage fluctuation severity indicator q is 0.2277. The recovered fundamental signal is
                        
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 0.9138
                                 ⋅
                                 
                                    cos
                                 
                                 (
                                 50.15
                                 ⋅
                                 2
                                 π
                                 t
                                 +
                                 135
                                 ⋅
                                 2
                                 π
                                 /
                                 360
                                 )
                              
                           
                        
                      and the estimated short-term flicker indicator 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              st
                           
                        
                      is 0.6765.


                     Fig. 4
                      and Fig. 5
                      further present the detection results on two multiple modulation frequencies test voltage signals, 
                        
                           
                              s
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              u
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        (
                        1
                        +
                        
                           
                              v
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        )
                      and 
                        
                           
                              s
                           
                           
                              3
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              u
                           
                           
                              3
                           
                        
                        (
                        t
                        )
                        (
                        1
                        +
                        
                           
                              v
                           
                           
                              3
                           
                        
                        (
                        t
                        )
                        )
                     , where the original fundamental signals and fluctuation components are set as
                        
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.96
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.05
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       226
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.12
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       5.52
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       26
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       0.08
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       22.25
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       180
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       0.15
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       35.74
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       126
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                              
                           
                        
                      and
                        
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.96
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.05
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       226
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.40
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       12.16
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       52
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                       ⋅
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         (
                                                         t
                                                         −
                                                         0.22
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      170
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       0.19
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       35.64
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       127
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                       ⋅
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         (
                                                         t
                                                         −
                                                         0.46
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      350
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                      where the corresponding voltage fluctuation severity indicators q are 0.6370 and 0.4603, respectively. This time, a stronger noise with 
                        σ
                        =
                        0.05
                      is added, and the signal length is 
                        T
                        =
                        20
                      seconds. The recovered fundamental signals are
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.9588
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.05
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       225
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       0.9604
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.05
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       225
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                              
                           
                        
                      and the estimated short-term flicker indicators 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              st
                           
                        
                      are 0.6771 and 0.2143.

From Fig. 3 to Fig. 5 we see that: (1) HT is highly sensitive to the noise level σ, where the waveforms of detected voltage envelopes are seriously damaged by noise and thus has the worst quality among the three (HT, SD and SR). (2) SD behaves quite well in demodulating the single frequency modulated signal, yields more plausible envelopes and performs much better than HT. We also note that SD is indifferent to the noise, this is because most of its energy is absorbed during the low-pass filtering stage. However, the performance is still found to be insufficient when dealing with multiple frequency modulated signals and the corresponding recovery errors are somewhat large. (3) The best performing method is SR, where the detected voltage envelopes are near-perfect and track the original ones well, and SR achieves smaller recovery errors than SD. As an interesting example, the waveform shown in Fig. 5(d) illustrates two voltage fluctuation events that occur from approximately 0.18 s to 0.27 s and from 0.38 s to 0.53 s, which fit very well with the analytical expression of 
                        
                           
                              v
                           
                           
                              3
                           
                        
                        (
                        t
                        )
                     . Similarity, SR is also insensitive to the noise, this is mainly due to the locally processing strategy used in our proposed algorithm, where the overlaps between signal segments are found to be crucial for the good performance of noise robustness, and not just because of the blockiness effects.

For a quantitative evaluation of these simulated experimental results, the recovery errors 
                        
                           
                              E
                           
                           
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                           
                        
                     , 
                        
                           
                              E
                           
                           
                              
                                 
                                    ω
                                 
                                 
                                    0
                                 
                              
                           
                        
                     , 
                        
                           
                              E
                           
                           
                              
                                 
                                    φ
                                 
                                 
                                    0
                                 
                              
                           
                        
                     , 
                        
                           
                              E
                           
                           
                              v
                           
                        
                     , and 
                        
                           
                              E
                           
                           
                              
                                 
                                    P
                                 
                                 
                                    st
                                 
                              
                           
                        
                      corresponding to Fig. 3 to Fig. 5 are listed in Table 1. As expected, we see that the recovery error of fluctuation component and the estimation error of the short-term flicker indicator of the proposed SR method are the smallest, whereas the HT and SD produce poor recover results. This result is consistent with the waveforms shown in Fig. 3(d), Fig. 4(d) and Fig. 5(d).

Finally, as a practical application, Fig. 7 to Fig. 9 present the voltage fluctuation detection results on a real voltage signal with three phases, which are measured from an electric arc furnace (EAF) busbar. The one-line diagram of the EAF system is shown in Fig. 6
                     , which is supplied directly from the T1 transformer at 35 kV. Measurements of the three-phase voltages (denote by 
                        
                           
                              s
                           
                           
                              a
                           
                        
                        (
                        t
                        )
                     , 
                        
                           
                              s
                           
                           
                              b
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              s
                           
                           
                              c
                           
                        
                        (
                        t
                        )
                     ) are performed at the P1 point which is located on the primary of EAF feeding transformer T2, with a sampling frequency of 
                        
                           
                              f
                           
                           
                              s
                           
                        
                        =
                        12
                        
                        800
                         
                        Hz
                      and a signal length of 
                        T
                        =
                        600
                      seconds. The noise variance used in our algorithm is estimated by the median estimator that 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        ≈
                        
                           median
                        
                        (
                        |
                        
                           
                              Ψ
                           
                           
                              1
                           
                           
                              d
                           
                        
                        |
                        )
                        /
                        0.6745
                     , where 
                        
                           
                              Ψ
                           
                           
                              1
                           
                           
                              d
                           
                        
                      stands for the wavelet decomposition coefficients of the first subband in the diagonal direction. As expected, Fig. 7
                     (d), Fig. 8
                     (d) and Fig. 9
                     (d) show that the detected envelopes have fitted the extremal points of the voltage signal well, implying a near-perfect recovery of the original.

The amplitude spectra of the fluctuation components 
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              a
                           
                        
                        (
                        t
                        )
                     , 
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              b
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        t
                        )
                      recovered by the proposed SR method are shown in Fig. 10
                     . The figure shows that the voltage signals concentrate most of their fluctuation energy in 0.5 Hz to 43 Hz, and these inter-harmonics components degrade the power quality and produce detrimental effects in electrical equipment and to end-users.

The recovered fundamental signals are
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             a
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       26.42
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.00
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       225
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       25.83
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.00
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       6
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             c
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       25.85
                                       ⋅
                                       
                                          cos
                                       
                                       (
                                       50.00
                                       ⋅
                                       2
                                       π
                                       t
                                       +
                                       127
                                       ⋅
                                       2
                                       π
                                       /
                                       360
                                       )
                                    
                                 
                              
                           
                        
                      whose waveforms are shown in Fig. 11
                     .

The estimated short-term flicker indicators 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              st
                           
                        
                      of three phases are 0.6141, 0.6491, 0.6450, and the corresponding voltage fluctuation severity indicators are 0.1370, 0.1549, 0.2485.

@&#CONCLUSION@&#

We have proposed a novel sparse representation-based algorithm for the voltage fluctuation detection of a power system. By constructing a proper objective function, we convert the fundamental signal estimation problem into a mathematical optimization problem, where the global maximizer is then obtained by an exhaustive searching strategy. A sparse representation-based optimization equation is developed to recover the fluctuation component 
                        v
                        (
                        t
                        )
                     , and the piecewise smoothness prior is exploited to further improve the regularity. Experimental results show that the proposed algorithm performs well for voltage fluctuation detection in terms of the recovery accuracy and noise robustness.

@&#ACKNOWLEDGEMENTS@&#

The authors want to express their sincere thanks to the editors and the anonymous reviewers for their constructive comments and suggestions, which helped to improve the paper greatly. This work is supported by the National Natural Science Foundation of China (Nos. 61402003, 51177002, 61402004) and the Education Ministry Doctoral Foundation of China (No. 20123401110007).

@&#REFERENCES@&#

