@&#MAIN-TITLE@&#Affine arc length polylines and curvature continuous uniform B-splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study links between splines and discrete affine differential geometry.


                        
                        
                           
                           Discrete affine arc length parametrizations lead to B-splines with increased smoothness.


                        
                        
                           
                           We introduce an osculating conic of discrete curves in the plane.


                        
                        
                           
                           We show how to approximate planar curves with nearly affinely regular polylines.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete affine differential geometry

Quadratic B-spline

Geometric continuity

Curve approximation

@&#ABSTRACT@&#


               
               
                  We study the recently introduced notion of polylines that form a discrete version of planar curves in affine arc length parametrization, showing that they match the control polylines of curvature continuous uniform quadratic B-splines (with analogous results in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     ). It is demonstrated how inflection-free planar curves may be approximated by such affine arc length polylines in a way that the polyline is close to an affinely equidistant discretization of the curve and allows good approximations of the smooth affine curvature.
               
            

Affine geometry is the study of geometric objects and properties that are invariant under (equi-)affine transformations. Many of the concepts from Euclidean planar curve geometry can be reproduced in an analogous way in planar affine geometry; thus we have affine arc length, affine curve normal, affine curvature, affine evolutes, affine osculating conics (analogous to the Euclidean osculating circle). Inflection-free planar curves can be parametrized by the affine arc length. This parametrization has simple expressions for the affine normal, curvature etc., as opposed to the rather unwieldy formulae in a general parametrization.

There is a geometrically simple discrete analog to planar curves in affine arc length parametrization: Polylines where the area spanned by three consecutive vertices is constant, that is 
                        det
                        ⁡
                        (
                        
                           
                              x
                           
                           
                              i
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                           
                        
                        )
                        =
                        A
                     , or equivalently, where 
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ∥
                        
                           
                              x
                           
                           
                              i
                              +
                              2
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                     . We term those affine arc length polylines. They were studied recently by Craizer et al. (2012). Using some of the theory contained in that work, we will extend it to include notions not studied before. These include the discrete osculating conic and the connection to curvature continuous quadratic B-splines.

For most applications cubic B-splines are preferred over quadratic B-splines because they generically have 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuity as opposed to only 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     , which is often not enough. For a given control polyline or data to be interpolated the smoothness of quadratic B-splines can be increased by either using non-uniform parameters or allowing non-uniform control vertex weights, which results in rational B-splines (NURBS). This involves a tradeoff, as the main advantage of using uniform B-splines lies in the algorithmic simplicity and speed of evaluation.

There is, however, a different approach to constructing splines with the desired smoothness, which lies in the concept of imposing conditions on the control polyline (the data) itself. This work will show how the condition for curvature continuity (equivalent to geometrical 
                     
                        
                           
                              G
                           
                           
                              2
                           
                        
                      continuity in the plane) is such that the control polylines coincide with the aforementioned affine arc length polylines.

A frequently occurring task is the approximation of a given curve by some type of curve governed by discrete data, in our case a curvature continuous uniform quadratic B-spline. At a first glance the geometric constraints on the control polygon might be thought as being too restrictive to allow the satisfactory approximation of arbitrary curves. A simple approach will result in affine arc length polylines with strong oscillations of the discrete affine curvatures. This makes the polyline visually uneven, because the affine arc lengths of the segments of the smooth curve between two consecutive discrete polyline vertices oscillate as well. However, in Section 4 we present an algorithm which, by means of an uncomplicated iterative process, optimizes the smoothness of the discrete affine curvatures, thus yielding polylines with relatively few vertices and desirable geometric properties.

Generally affine arc length polylines have higher vertex density where the (Euclidean) curvature is higher, thus offering a good compromise between simplicity (few vertices) and quality of approximation (many vertices). The advantage of smoothing the affine curvatures is that it makes the polyline locally as affinely regular as possible. This ensures that the affine arc length polyline is nearly an affinely equidistant discretization of the curve. It also provides good approximations of the smooth affine curvature of the original curve.

Affine differential geometry is a classical field of study going back to the early 1900s due to the research of G. Pick, W. Blaschke, G. Thomson and others. Well-known textbooks on the subject are e.g. Blaschke (1923), Bol (1950). At that time, discretization of those smooth notions was not considered.

Discrete affine differential geometry has mostly focused on surfaces in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , in particular discrete affine minimal surfaces, which in the case of negative curvature can described by A-nets with an added geometric constraint (Craizer et al., 2010; Käferböck and Pottmann, 2013). Using those nets as control nets of bilinear B-spline surfaces yields geometrically smooth surfaces. Thus the principle of imposing geometric conditions on the discrete data in order to make the resulting B-spline object (curve resp. surface) geometrically smoother that it would generically be is the same as in this paper.

The recent work (Craizer et al., 2012) studied the same model of discrete curves in affine arc length parametrization (called equal area polygons) as we have undertaken, focusing on the notion of the discrete affine evolute. They also proved a discrete version of the well-known classical six-sextactic-point theorem, which is the affine version of the four-vertex theorem. Affine osculating conics were not considered, and neither was the connection to curvature continuous quadratic B-splines.

Splines with higher smoothness than 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        , in particular curvature continuity were studied extensively in classical B-spline literature (geometric splines, ν-splines, uniform cubic B-splines), see e.g. Boehm (1985), Dyn and Micchelli (1988). For example, Hagen (1986) stated the general conditions for the curvature continuous joining of Bézier curve segments. The majority of these works did not look at quadratic splines in particular, and most assumed a 
                           degree
                           ≥
                           3
                        .

However, there is also a number of works were 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         quadratic spline interpolation was studied explicitly, like Schaback (1989). The splines in that paper allow a representation as non-uniform B-splines, where the non-uniformity is necessary in order to do without geometric constraints on the control polygon (apart from the obvious one of convexity).

Although the equal-area condition for 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         continuity of uniform quadratic B-splines clearly was realized in the literature, its interpretation in terms of discrete affine differential geometry provides new insights into its geometric meaning.


                        
                           
                              1.
                              Section 2 introduces a way of describing polylines in an affine-invariant way and uses that notation to describe affine arc length polylines, which can be seen as discrete affine arc length parametrized curves. Building upon the work done by Craizer et al. (2012) on the discrete affine evolute, we study discretizations of conics and introduce the notion of the discrete osculating conic.

Finally we show the connection between affine arc length polylines and 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                  continuous uniform quadratic B-splines.

Section 3 generalizes some of the results of the previous section to curves in 
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                  and uniform B-splines of order n.

In Section 4 it is shown how inflection-free planar curves can be approximated by discrete affine arc length polylines such that the affine arc length polyline is close to an affinely equidistant discretization of the original curve. Those approximations have desirable geometric qualities, as the vertex density of the polyline is higher where the Euclidean curvature is higher and the polyline is locally as near affinely regular as possible. They also allow good approximations of the affine smooth affine curvature.

There are several geometries that are commonly termed affine geometry. The one we will be using is (planar) equiaffine geometry, that is the study of geometric notions that are invariant under the group of equiaffine transformations (also called the special affine group) of the plane which comprises the transformations
                        
                           
                              x
                              ↦
                              M
                              x
                              +
                              v
                              ,
                              
                              M
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    2
                                 
                              
                               with 
                              det
                              ⁡
                              M
                              =
                              1
                              ,
                              
                              v
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      Generally the invariant geometric properties of equiaffine geometry are parallelity, ratios of parallel lengths and areas.

On the other hand, general affine geometry allows all transformations 
                        x
                        ↦
                        M
                        x
                        +
                        v
                      with 
                        det
                        ⁡
                        M
                        ≠
                        0
                     . In this paper affine will always refer to equiaffine geometry, because it is the main object of study. General affine geometry will always be referred to as such.

The affine polyline coordinates introduced below belong to equiaffine geometry, but the notion of the affine arc length polyline as well as its affine curvature, osculating conics and the algorithm for approximating curves by affine arc length polylines in Section 4 are fully invariant under the general affine group, thus being objects of general affine geometry.

Let 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                         be a polyline. We will use the forward difference operator frequently, defined as 
                           δ
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                         for any sequence α. We also write 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           :
                           =
                           δ
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         as an abbreviation. Then we define affine polyline coordinates 
                        
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         by
                           
                              (1)
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 det
                                 ⁡
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                 and
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 det
                                 ⁡
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                         They are illustrated in Fig. 1
                        . 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         are invariant under equiaffine transformations, and they associate 
                           2
                           (
                           N
                           +
                           1
                           )
                           −
                           5
                         numbers with the polyline consisting of 
                           N
                           +
                           1
                         vertices, which describe the polyline uniquely up to equiaffine transformations: 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         can be freely chosen, and 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         has one degree of freedom left under the condition 
                           det
                           ⁡
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           )
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                        . After that, the rest of the polyline can be constructed uniquely by way of the equation
                           
                              (2)
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                         as long as 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           ≠
                           0
                        . This formula can be easily verified by 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           det
                           ⁡
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                           =
                           
                              
                                 A
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           det
                           ⁡
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                           +
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ⋅
                           0
                         and 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           det
                           ⁡
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           )
                           =
                           
                              
                                 A
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ⋅
                           0
                           +
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           det
                           ⁡
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           )
                        . The 5 degrees of freedom in choosing 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         correspond to the 5 degrees of freedom of the equiaffine group.

The affine arc length of a curve 
                           f
                           :
                           R
                           →
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         is defined (e.g. in Blaschke, 1923, §4) as
                           
                              
                                 s
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∫
                                    0
                                    t
                                 
                                 det
                                 ⁡
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             ˙
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                       
                                          
                                             f
                                          
                                          
                                             ¨
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 d
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                                 .
                              
                           
                         Therefore noninflecting curves possess a parametrization with respect to the affine arc length.

Using affine polyline coordinates this definition can be discretized to define the affine length of a polyline in an obvious way:
                           
                              (3)
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       N
                                    
                                 
                                 )
                                 :
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                    
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 .
                              
                           
                         Lengths are therefore carried by triples of consecutive polyline vertices 
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        . A polyline can be said to be in discrete affine arc length parametrization if all lengths are the same, that is 
                           A
                           :
                           =
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           =
                           const
                           .
                           ≠
                           0
                        . We call such a polyline an affine arc length polyline. See Fig. 2
                         for an example. As 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         is the area of the parallelogram spanned by 
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        , Craizer et al. (2012) (who only considered closed curves) called them equal-area polygons. Throughout the paper we will assume 
                           A
                           >
                           0
                        , meaning we are restricted to polylines that are noninflecting in a discrete sense. However, in Section 4.4 we demonstrate how several affine arc length polylines may be concatenated to discretize curves with inflection points.

The affine curvature is defined by the equation 
                           
                              
                                 f
                              
                              
                                 ‴
                              
                           
                           +
                           κ
                           
                              
                                 f
                              
                              
                                 ′
                              
                           
                           =
                           0
                        , or equivalently by 
                           κ
                           :
                           =
                           det
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ″
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 ‴
                              
                           
                           )
                        , where 
                           
                              
                                 f
                              
                              
                                 ″
                              
                           
                         is the affine curve normal (Blaschke, 1923). Analogously to the Euclidean case the envelope of the normal lines 
                           f
                           (
                           t
                           )
                           +
                           λ
                           f
                           
                              
                                 (
                                 t
                                 )
                              
                              
                                 ″
                              
                           
                         is called the affine evolute.

In the discrete setting of affine arc length polylines the affine normal lines are
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 −
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           
                         and the vertices of the (discrete) affine evolute result as intersection points of consecutive affine normal lines, as shown in Fig. 3
                        . One can now define the affine curvature 
                        
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                         of an affine arc length polyline 
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                         by straightforward discretization through 
                           
                              
                                 δ
                              
                              
                                 3
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           
                           δ
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           0
                        . Useful equivalent characterizations are
                           
                              (4)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 (
                                 3
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                 or
                                 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       det
                                       ⁡
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    A
                                 
                                 ,
                                 
                                 or
                                 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 2
                                 −
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    A
                                 
                                 .
                              
                           
                         From this it is easy to see that the affine evolute 
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                         of an affine arc length polyline can be expressed by
                           
                              (5)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                         The discrete affine evolute was studied extensively by Craizer et al. (2012). We will focus on the notion of the osculating conic (Section 2.4).


                        Affinely regular polylines were introduced by Coxeter (1969) as the orbits of equiaffine transformations. In particular they arise as equidistant discretizations of conics in affine arc length parametrization. Craizer et al. (2012) show how an affine arc length polyline is affinely regular if and only if its affine evolute is a single point. Due to Eq. (5) that is equivalent to 
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                         being constant.

This is the discrete analog to the well-known result from classical affine differential geometry, that a planar curve with constant affine curvature is a conic, see e.g. Blaschke (1923).

That result can be somewhat generalized:


                        
                           Theorem 1
                           
                              An affine arc length polyline 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               
                              discretizes a conic if and only if the sequence of its affine curvatures alternates between two constant values, that is, 
                              
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                 ∀
                                 
                                 i
                              
                              . (For an example see 
                              
                                 Fig. 5
                              
                              .)
                           


                        
                           Proof
                           We need to show that 6 consecutive vertices 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                               of an affine arc length polyline lie on a conic if and only if 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              .

We lay the unique conic through 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                               and apply an equiaffine transformation such that the x-axis is a symmetry axis of the conic and the symmetry maps 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ↔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              . See Fig. 4
                              .

The affine arc length polyline property 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               implies that also 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ↔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                              . Then the line 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               (which is parallel to 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              ) is symmetric to the line through 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               parallel to 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                              , on which 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                               must lie. Then due to Eq. (4), 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ⇔
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ‖
                                 =
                                 (
                                 3
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ‖
                                 =
                                 (
                                 3
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ‖
                                 =
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ‖
                                 ⇔
                               the symmetry maps 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ↔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                                 ⇔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                               lies on the conic through 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 ⇔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       3
                                    
                                 
                               lie on a conic.  □

In planar affine differential geometry the affine evolute point is also the center of a unique conic which has 5-point (4th order) contact with the curve, called the osculating conic. For 
                           κ
                           =
                           0
                         the affine evolute point is ideal and the osculating conic a parabola.

Because of 
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ∥
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                         the set of the centers of all conics that contain 
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                         is the line through 
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                           /
                           2
                         and 
                           (
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                           )
                           /
                           2
                         (including the ideal point), which passes through the affine evolute point. Thus we can define a unique conic through 
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                         with the affine evolute point as its center, which we call the outer osculating conic.

Another way of defining a discrete osculating conic (again with 
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                         as center point) is to make the three edges involved (
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 2
                              
                           
                        ) tangents of the conic. This can be termed the inner osculating conic. Both conics are displayed in Fig. 6.

Just like in the classical smooth setting, we can infer the type of the conic from the sign of the affine curvature:
                           
                              (6)
                              
                                 The inner and outer osculating conics are
                                 
                                 
                                    {
                                    
                                       
                                          
                                             hyperbolas
                                          
                                       
                                       
                                          
                                             parabolas
                                          
                                       
                                       
                                          
                                             ellipses
                                          
                                       
                                    
                                 
                                 ⇔
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             >
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Both choices of discrete osculating conics, however, are not ideal when one considers the (constant) affine curvatures of those conics as planar curves. The rationale of an osculating conic is that its affine curvature matches that of the given curve at the point of osculation. This is not the case with either of the conics defined above, but a better solution suggests itself:


                        
                           Theorem 2
                           
                              For an affine arc length polyline we define three types of osculating conics of 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                              
                              :
                              
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                                osculating conic
                                             
                                             
                                                definition
                                             
                                             
                                                affine curvature
                                             
                                          
                                       
                                       
                                          
                                             
                                                outer
                                             
                                             
                                                center 
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                , through 
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         +
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                inner
                                             
                                             
                                                center 
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                , tangential to 
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                 
                                                and 
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         +
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                middle
                                             
                                             
                                                center 
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                , geometric mean of inner and outer conic
                                             
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              Then the inner and outer osculating conic are related by uniform scaling around the center (or a translation in the case 
                              
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                              ), which allows us to define the middle osculating conic as their geometric mean. 
                              
                                 
                                    
                                       κ
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       κ
                                    
                                    
                                       i
                                    
                                    
                                       i
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       κ
                                    
                                    
                                       i
                                    
                                    
                                       m
                                    
                                 
                               
                              are the conics' classical smooth affine curvatures (see Section 
                              
                                 2.3
                              
                              ), which are constants for each conic. Then they have the following values:
                              
                                 
                                    (7)
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             i
                                          
                                          
                                             o
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             −
                                             
                                                2
                                                3
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                                4
                                             
                                             )
                                          
                                          
                                             
                                                1
                                                3
                                             
                                          
                                       
                                       
                                       
                                          
                                             κ
                                          
                                          
                                             i
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             −
                                             
                                                2
                                                3
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                                4
                                             
                                             )
                                          
                                          
                                             −
                                             
                                                1
                                                3
                                             
                                          
                                       
                                       
                                       
                                          
                                             κ
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             −
                                             
                                                2
                                                3
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Depending on the sign of 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                              , every polyline 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                               can be brought into one of the forms
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             hyperbola
                                             parabola
                                             ellipse
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   r
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cosh
                                                               ⁡
                                                               λ
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               sinh
                                                               ⁡
                                                               λ
                                                               i
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               λ
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   r
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cos
                                                               ⁡
                                                               λ
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               sin
                                                               ⁡
                                                               λ
                                                               i
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   =
                                                   −
                                                   2
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   sinh
                                                   ⁡
                                                   λ
                                                   (
                                                   1
                                                   −
                                                   cosh
                                                   ⁡
                                                   λ
                                                   )
                                                
                                             
                                             
                                                A
                                                =2λ
                                             
                                             
                                                
                                                   A
                                                   =
                                                   2
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   sin
                                                   ⁡
                                                   λ
                                                   (
                                                   1
                                                   −
                                                   cos
                                                   ⁡
                                                   λ
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   2
                                                   (
                                                   1
                                                   −
                                                   cosh
                                                   ⁡
                                                   λ
                                                   )
                                                   <
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   2
                                                   (
                                                   1
                                                   −
                                                   cos
                                                   ⁡
                                                   λ
                                                   )
                                                   >
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                               with 
                                 r
                                 ,
                                 λ
                                 >
                                 0
                               by an equiaffine transformation. The points of contact of the polyline edges with the inner osculating conic are the polyline edge midpoints 
                                 
                                    1
                                    2
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              , etc. for reasons of symmetry.

If we consider the elliptic case, in the special form from the table above the osculating conics are circles with center at 0. The outer conic has radius r. The inner conic's radius is 
                                 ‖
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 /
                                 2
                                 ‖
                                 =
                                 r
                                 cos
                                 ⁡
                                 
                                    λ
                                    2
                                 
                                 =
                                 r
                                 
                                    
                                       (
                                       1
                                       +
                                       cos
                                       ⁡
                                       λ
                                       )
                                       /
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       /
                                       4
                                    
                                 
                               (with the value of 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                               from the table). This gives us a scaling factor 
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       /
                                       4
                                    
                                 
                               between the outer and inner osculating conic. In the hyperbolic case we analogously find the same factor. The scaling factor “
                                 inner
                                 :
                                 middle
                                 :
                                 outer
                               osculating conic” is therefore 
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          4
                                       
                                       )
                                    
                                    
                                       1
                                       /
                                       4
                                    
                                 
                               (
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 0
                              ). In the case 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                               symmetry shows that the inner osculating conic is also an x-symmetric parabola, and inserting the edge midpoints proves that it has the form 
                                 
                                    
                                       (
                                       i
                                       ,
                                       λ
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       λ
                                       /
                                       4
                                       )
                                    
                                    
                                       T
                                    
                                 
                              . It is therefore related to the outer osculating conic by translation with vector 
                                 
                                    
                                       (
                                       0
                                       ,
                                       A
                                       /
                                       8
                                       )
                                    
                                    
                                       T
                                    
                                 
                              . Thus they have the same smooth affine curvature.

Keeping in mind that the (constant) smooth affine curvatures for hyperbola, parabola and ellipse are 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       −
                                       
                                          4
                                          3
                                       
                                    
                                 
                              , 0 and 
                                 
                                    
                                       r
                                    
                                    
                                       −
                                       
                                          4
                                          3
                                       
                                    
                                 
                              , respectively, the desired results follow from straightforward calculation.  □

Trying to connect planar affine geometry with the theory of B-splines the obvious choice is to look at quadratic B-splines, because they consist of parabolae which have vanishing curvature from the point of view of affine geometry.

So we will take a polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 N
                              
                           
                         to be the control polyline of a uniform quadratic B-spline. The algorithm of Chaikin (1974) is the version of the Lane–Riesenfeld subdivision algorithm (Lane and Riesenfeld, 1980) that goes with quadratic B-splines. It replaces the polyline with 
                           
                              
                                 x
                              
                              
                                 
                                    1
                                    4
                                 
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 
                                    3
                                    4
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 N
                                 −
                                 
                                    1
                                    4
                                 
                              
                           
                        , where 
                           
                              
                                 x
                              
                              
                                 i
                                 ±
                                 
                                    1
                                    4
                                 
                              
                           
                           :
                           =
                           
                              3
                              4
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           +
                           
                              1
                              4
                           
                           
                              
                                 x
                              
                              
                                 i
                                 ±
                                 1
                              
                           
                        . Now it is easy to see (Fig. 7) that the Chaikin algorithm does not change the affine arc length of the polyline:
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       N
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          1
                                          4
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       N
                                       −
                                       
                                          1
                                          4
                                       
                                    
                                 
                                 )
                              
                           
                         In addition an affine arc length polyline will maintain that property under subdivision, where the new constant 
                           
                              
                                 A
                              
                              
                                 ′
                              
                           
                         has the value 
                           
                              
                                 A
                              
                              
                                 ′
                              
                           
                           =
                           
                              1
                              8
                           
                           A
                        .

In fact we find that affine arc length polylines have a distinguished role in the context of uniform quadratic B-splines. The two consecutive parabola segments of the B-spline with control polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         are parametrized by 
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 
                                    (
                                    1
                                    −
                                    t
                                    )
                                 
                                 
                                    2
                                 
                              
                              2
                           
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           +
                           
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              2
                           
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 
                                    (
                                    1
                                    −
                                    t
                                    )
                                 
                                 
                                    2
                                 
                              
                              2
                           
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              2
                           
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         (with 
                           0
                           ≤
                           t
                           ≤
                           1
                         each). Calculating their (Euclidean) curvatures at the intersection point we find 
                           
                              
                                 κ
                              
                              
                                 1
                              
                           
                           (
                           1
                           )
                           =
                           
                              
                                 κ
                              
                              
                                 2
                              
                           
                           (
                           0
                           )
                           ⇔
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           
                              
                                 ‖
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ‖
                              
                              
                                 −
                                 3
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           
                              
                                 ‖
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ‖
                              
                              
                                 −
                                 3
                              
                           
                           ⇔
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                        . Thus we see that a uniform quadratic B-spline is curvature continuous if and only if its control polyline is an affine arc length polyline.
                     

Affine differential geometry differs from its Euclidean counterpart by the fact that the notion of the affine arc length of a curve is explicitly dependent on the dimension of the containing space.

As in the planar case, we use as affine equivalence transformations those linear maps which leave n-dimensional volumes constant, that is, those maps of the form 
                        x
                        ↦
                        M
                        x
                        +
                        v
                      with 
                        det
                        ⁡
                        (
                        M
                        )
                        =
                        1
                     , 
                        v
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                     . Thus the obvious way of defining an affinely-invariant arc length element is to use a determinant of derivatives of the curve f, which is 
                        det
                        ⁡
                        (
                        
                           
                              f
                           
                           
                              ˙
                           
                        
                        ,
                        
                           
                              f
                           
                           
                              ¨
                           
                        
                        ,
                        …
                        ,
                        
                           
                              f
                           
                           
                              (
                              n
                              )
                           
                        
                        )
                      in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     . To make this term invariant under changes of variables, however, it is necessary to add a suitable exponent (1/3 in the planar case). Thus one gets for the affine arc length in n dimensions
                        
                           
                              s
                              (
                              t
                              )
                              =
                              ∫
                              det
                              ⁡
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          ˙
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                 
                                 
                                    
                                       2
                                       
                                          n
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                              d
                              t
                              .
                           
                        
                      Therefore affine arc length parametrization has 
                        s
                        =
                        t
                        ⇒
                        det
                        ⁡
                        (
                        
                           
                              f
                           
                           
                              ˙
                           
                        
                        ,
                        
                           
                              f
                           
                           
                              ¨
                           
                        
                        ,
                        …
                        ,
                        
                           
                              f
                           
                           
                              (
                              n
                              )
                           
                        
                        )
                        ≡
                        1
                     . Allowing (as in the planar case) any constant value ≠0 instead of 1, we now define


                     
                        Definition 3
                        A polyline 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                            consists of 
                              N
                              −
                              n
                              +
                              1
                            
                           discrete affine length elements, which are the subpolylines 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    n
                                 
                              
                           , which have the affine lengths
                              
                                 (8)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          +
                                          n
                                       
                                    
                                    )
                                    =
                                    det
                                    ⁡
                                    
                                       
                                          (
                                          δ
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          …
                                          ,
                                          δ
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                +
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             2
                                             
                                                n
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            in particular 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                                 
                                    1
                                    /
                                    3
                                 
                              
                           . The polyline is called an affine arc length polyline iff all values of 
                              
                                 
                                    L
                                 
                                 
                                    n
                                 
                              
                            are the same ≠0, that is
                              
                                 (9)
                                 
                                    ∃
                                    
                                    A
                                    ≠
                                    0
                                    :
                                    
                                    det
                                    ⁡
                                    (
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    …
                                    ,
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          +
                                          n
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    A
                                    
                                    ∀
                                    i
                                    .
                                 
                              
                           
                        

In the plane it was advantageous to use affine arc length polylines as control polylines of uniform quadratic B-splines; in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      that role is played by uniform B-splines of degree n:


                     
                        Theorem 4
                        
                           Affine arc length polylines are exactly those polylines 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                            
                           which when taken as control polylines of uniform B-spline curves of degree n result in all Frenet curvatures 
                           
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            
                           being continuous at the transitions of the B-spline segments.
                        


                     
                        Proof
                        The B-spline basis functions 
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            for equidistant knots 
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              =
                              j
                            are recursively defined by
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          t
                                          −
                                          j
                                       
                                       k
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       
                                          j
                                          +
                                          k
                                          +
                                          1
                                          −
                                          t
                                       
                                       k
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                     and 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                t
                                                ∈
                                                [
                                                j
                                                ,
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                else
                                             
                                          
                                       
                                    
                                 
                              
                            and form the B-spline curve 
                              f
                              (
                              t
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              (
                              t
                              )
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            with control points 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            (see e.g. Cohen et al., 2001). As B-spline curves are translation invariant, in the usable region 
                              t
                              ∈
                              [
                              n
                              ,
                              N
                              −
                              n
                              ]
                            the basis functions form a partition of unity.

The curvatures 
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    n
                                    −
                                    2
                                 
                              
                            of f are continuous because they only depend on the first 
                              n
                              −
                              1
                            derivatives of f and the basis functions 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                            are 
                              
                                 
                                    C
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                           . The curvature 
                              
                                 
                                    k
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            (called the torsion τ in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           ) is calculated in Aminov (2000) to be
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˙
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          )
                                          ⋅
                                          |
                                          [
                                          
                                             
                                                f
                                             
                                             
                                                ˙
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                n
                                                −
                                                2
                                                )
                                             
                                          
                                          ]
                                          |
                                       
                                       
                                          ‖
                                          
                                             
                                                f
                                             
                                             
                                                ˙
                                             
                                          
                                          ‖
                                          ⋅
                                          
                                             
                                                |
                                                [
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˙
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      (
                                                      n
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                ]
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              [
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              ]
                            denotes the multivector spanned by 
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                           , whose length is equal to the k-dimensional volume of the parallelotope spanned by 
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                           . The only term in the formula which has to be tested for continuity is the determinant, as it is the only one which contains 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                           . Using derivatives of the first B-spline segment we get
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          k
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    
                                    for 
                                    n
                                    ≤
                                    t
                                    ≤
                                    n
                                    +
                                    1
                                    .
                                 
                              
                            Using the calculus of multivectors we can now employ induction for k starting from 
                              k
                              =
                              n
                              +
                              1
                            down to 1.
                              
                                 
                                    
                                       [
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          k
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       [
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          k
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    
                                       [
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          k
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    
                                       [
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          k
                                       
                                       
                                          n
                                          −
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       [
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             −
                                             k
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            With e.g. Sternberg (1964, p. 16) and 
                              k
                              =
                              1
                            we then see 
                              det
                              ⁡
                              (
                              
                                 
                                    f
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              t
                              )
                              )
                              ⋅
                              [
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              ]
                              =
                              [
                              
                                 
                                    f
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              t
                              )
                              ]
                              =
                              [
                              δ
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              δ
                              
                                 
                                    x
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ]
                              =
                              det
                              ⁡
                              (
                              δ
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              δ
                              
                                 
                                    x
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              ⋅
                              [
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              ]
                            for all 
                              n
                              ≤
                              t
                              ≤
                              n
                              +
                              1
                           . Therefore the determinant is continuous over segment transitions (even constant) if and only if the control polyline 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            fulfills Eq. (9).  □

In addition, we saw in Section 2.5 that if we subdivide a general planar polyline 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              N
                           
                        
                      by the Chaikin algorithm to a polyline 
                        
                           
                              x
                           
                           
                              0
                           
                           
                              ′
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              2
                              N
                              −
                              1
                           
                           
                              ′
                           
                        
                     , the overall affine length will stay the same: 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                              −
                              1
                           
                        
                        
                           
                              A
                           
                           
                              i
                           
                           
                              1
                              /
                              3
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              2
                              N
                              −
                              2
                           
                        
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                           
                              1
                              /
                              3
                           
                        
                     . We now find that the same holds true in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      if we use the Lane–Riesenfeld algorithm of degree n, as is appropriate for B-Splines of degree n.


                     
                        Theorem 5
                        
                           Let 
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                            
                           be the vertices of the polyline 
                           x 
                           in 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                           . Let 
                           
                              μ
                              x
                              :
                              =
                              (
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                                 2
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          N
                                       
                                    
                                 
                                 2
                              
                              )
                            
                           denote the averaging operator for finite sequences and 
                           
                              δ
                              x
                              :
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              )
                            
                           the forward difference operator. The Lane–Riesenfeld refinement of degree n (
                           
                              Lane and Riesenfeld, 1980
                           
                           ) of 
                           x 
                           produces a polyline 
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                           , which is described by
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          N
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          N
                                       
                                    
                                    )
                                    .
                                 
                              
                            
                           Then the discrete affine arc lengths (as defined by Eq. 
                           
                              (8)
                           
                           ) of 
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                            
                           are
                           
                              
                                 (10)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          L
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          L
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

Let 
                              v
                              =
                              (
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                    n
                                 
                              
                              )
                              :
                              =
                              (
                              0
                              ,
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              0
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              0
                              ,
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ,
                              0
                              )
                            and thus 
                              δ
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    n
                                 
                              
                              v
                           . We also note that 
                              
                                 
                                    (
                                    δ
                                    μ
                                    v
                                    )
                                 
                                 
                                    2
                                    i
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    2
                                    i
                                    +
                                    2
                                 
                              
                              −
                              
                                 
                                    v
                                 
                                 
                                    2
                                    i
                                 
                              
                              )
                              =
                              0
                           , from which 
                              
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          m
                                       
                                    
                                    v
                                    )
                                 
                                 
                                    2
                                    i
                                 
                              
                              =
                              0
                           , 
                              m
                              ≥
                              0
                            follows by iteration, as the operators δ and μ commute.

We will use induction for k to show
                              
                                 (11)
                                 
                                    
                                       [
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                             +
                                             (
                                             k
                                             −
                                             1
                                             )
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          
                                             
                                                k
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          3
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          2
                                          k
                                          −
                                          1
                                       
                                    
                                    ]
                                 
                              
                            for 
                              k
                              ≤
                              n
                            and 
                              j
                              =
                              0
                              ,
                              2
                              ,
                              …
                              ,
                              2
                              (
                              n
                              −
                              k
                              )
                           . For 
                              k
                              =
                              1
                            the statement is true, because 
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              =
                              0
                            for even j. Assume therefore that it holds for some 
                              k
                              <
                              n
                           , and pass to 
                              k
                              +
                              1
                           .

As an abbreviation we introduce the sequence 
                              w
                              =
                              (
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                              )
                              :
                              =
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              v
                           .
                              
                                 
                                    
                                       [
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             v
                                             )
                                          
                                          
                                             j
                                             +
                                             k
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    [
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          k
                                          +
                                          1
                                       
                                    
                                    ]
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       [
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          k
                                       
                                       
                                          (
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                j
                                                +
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                j
                                                +
                                                i
                                                +
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                −
                                                1
                                                )
                                             
                                             
                                                i
                                             
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                0
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   k
                                                
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                      +
                                                      i
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             =
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             −
                                             2
                                             )
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             j
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    [
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          k
                                          +
                                          1
                                       
                                    
                                    ]
                                    
                                       =
                                       
                                          ↑
                                          
                                             Eq. (11) with
                                             
                                             j
                                             +
                                             2
                                             
                                             in place of
                                             
                                             j
                                          
                                       
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                          −
                                          
                                             
                                                k
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    [
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          5
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          2
                                          k
                                          +
                                          1
                                       
                                    
                                    ]
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                                (
                                                k
                                                +
                                                2
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          3
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                          +
                                          2
                                          k
                                          +
                                          1
                                       
                                    
                                    ]
                                    .
                                 
                              
                            To complete the proof we let 
                              k
                              =
                              n
                            in (11) to see 
                              [
                              
                                 
                                    (
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    (
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    n
                                 
                              
                              ]
                              =
                              
                                 
                                    2
                                 
                                 
                                    −
                                    n
                                    (
                                    n
                                    +
                                    1
                                    )
                                    /
                                    2
                                 
                              
                              [
                              
                                 
                                    (
                                    δ
                                    x
                                    )
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    (
                                    δ
                                    x
                                    )
                                 
                                 
                                    n
                                 
                              
                              ]
                           , which is the proposition according to Definition 3. The length of 
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    ′
                                 
                              
                              )
                            is the same, as can be seen by reversing the ordering of the vertices.  □

We now want to study the problem of approximating an inflection-free planar curve f by an affine arc length polyline x such that 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        f
                        (
                        
                           
                              t
                           
                           
                              i
                           
                        
                        )
                     . Let 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        :
                        =
                        
                           
                              ∫
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                        
                        det
                        ⁡
                        
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                              ,
                              
                                 
                                    f
                                 
                                 
                                    ¨
                                 
                              
                              (
                              t
                              )
                              )
                           
                           
                              1
                              /
                              3
                           
                        
                        
                        d
                        t
                      be the affine arc length from 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      to 
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                     . Curves with inflection points can be treated by allowing a jump of the affine arc length constant A at each inflection point (including a sign change). See Section 4.4 for a demonstration of that approach.

A simple approach to the problem of discretizing a given inflection-free planar curve calls for the choice of two initial points 
                        
                           
                              x
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              x
                           
                           
                              1
                           
                        
                      on the curve. With a likewise fixed value A the method proceeds by imposing 
                        det
                        ⁡
                        (
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              2
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        )
                        =
                        A
                     , thus finding 
                        
                           
                              x
                           
                           
                              i
                              +
                              2
                           
                        
                      at the intersection of the curve with a line parallel to 
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                           
                        
                     . This is the path taken in Craizer et al. (2012).


                     Fig. 5
                     
                     
                      demonstrates this procedure for different values of 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      but identical A in discretizing a conic. All of these discretizations have the sequence of discrete affine curvatures 
                        
                           
                              k
                           
                           
                              i
                           
                        
                      alternate between two constant values (see Theorem 1), except for the one with constant 
                        
                           
                              k
                           
                           
                              i
                           
                        
                     , which is affinely regular. Clearly this discretization is the most desirable one, because it has 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        =
                        const.
                     , making it an affinely equidistant discretization of the conic.

For a generic curve f discretizations by affine arc length polylines cannot be affinely equidistant, but we will try to make the differences 
                        
                           
                              S
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              S
                           
                           
                              i
                           
                        
                      as small as possible. The path we will be taking to achieve this is to minimize 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              2
                           
                        
                     . It is motivated by the following theorem:


                     
                        Theorem 6
                        
                           Consider the affine arc length polyline 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              f
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           , with 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            
                           being the affine arc length from 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            
                           to 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                           . Then if 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            
                           is sufficiently small 
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              )
                              /
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            
                           is a monotonous function of 
                           
                              δ
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           
                           . In particular asymptotically for 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              →
                              0
                            
                           the function 
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              )
                              /
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            
                           attains 0 at 
                           
                              δ
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                           .
                        


                     
                        Proof
                        We consider a quintuple of an affine arc length polyline with vertices lying on f such that
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          −
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    :
                                    =
                                    
                                       (
                                       −
                                       t
                                       
                                          (
                                          2
                                          +
                                          z
                                          (
                                          t
                                          )
                                          )
                                       
                                       ,
                                       
                                       −
                                       t
                                       ,
                                       
                                       0
                                       ,
                                       
                                       t
                                       
                                          (
                                          1
                                          +
                                          w
                                          (
                                          t
                                          )
                                          )
                                       
                                       ,
                                       
                                       t
                                       
                                          (
                                          2
                                          +
                                          y
                                          (
                                          t
                                          )
                                          )
                                       
                                       )
                                    
                                 
                              
                            Assume f is parametrized by the affine arc length and let 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              :
                              =
                              f
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                           , 
                              i
                              =
                              −
                              2
                              ,
                              …
                              ,
                              2
                           . Then 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           . We calculate Taylor polynomials of the discrete polyline coordinates (Section 2.1) by using the following table
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                det
                                                ⁡
                                                (
                                                .
                                                ,
                                                .
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ‴
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      (
                                                      4
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      (
                                                      5
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          0
                                          1
                                          0
                                          
                                             
                                                −
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                2
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                          −1
                                          0
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ‴
                                                   
                                                
                                             
                                          
                                          0
                                          
                                             
                                                −
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          0
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      (
                                                      4
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      (
                                                      5
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                2
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                          
                                          
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              :
                              =
                              
                                 
                                    f
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              (
                              0
                              )
                           , 
                              
                                 
                                    κ
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              κ
                              (
                              0
                              )
                            etc.

We know that in the Taylor series of 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            derivatives 
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                            only appear in terms where the exponent of t is ≥j, and 
                              δ
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              O
                              (
                              t
                              )
                           . Therefore the remainder of the Taylor series of 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              det
                              ⁡
                              (
                              δ
                              
                                 
                                    x
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ,
                              δ
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                            which is not calculable from the table, coming from sums of determinants 
                              det
                              ⁡
                              (
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                           , 
                              j
                              +
                              k
                              ≥
                              7
                           , is 
                              O
                              (
                              
                                 
                                    t
                                 
                                 
                                    7
                                 
                              
                              )
                           . This means that we can calculate the coefficients of 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    i
                                    ,
                                    3
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                    ,
                                    4
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                    ,
                                    5
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                    ,
                                    6
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    6
                                 
                              
                              +
                              O
                              (
                              
                                 
                                    t
                                 
                                 
                                    7
                                 
                              
                              )
                           . For instance
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          2
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          3
                                          +
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                       
                                       2
                                    
                                    
                                       
                                          z
                                       
                                       
                                          0
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          5
                                       
                                    
                                    
                                       (
                                       −
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             6
                                             +
                                             15
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             14
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             6
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          24
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             3
                                             +
                                             2
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          4
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                          
                                          
                                             ″
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          6
                                       
                                    
                                    
                                       (
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             60
                                             +
                                             176
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             205
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             120
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             35
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   4
                                                
                                             
                                             +
                                             4
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   5
                                                
                                             
                                          
                                          240
                                       
                                       −
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             15
                                             +
                                             28
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             18
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             4
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          24
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                          
                                          
                                             ″
                                          
                                       
                                       +
                                       
                                          
                                             3
                                             +
                                             2
                                             
                                                
                                                   z
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          12
                                       
                                       
                                          
                                             z
                                          
                                          
                                             0
                                          
                                          
                                             ‴
                                          
                                       
                                       )
                                    
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             7
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Now we demand that 
                              
                                 
                                    x
                                 
                                 
                                    −
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            is an affine arc length polyline 
                              ⇔
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                           . Equating coefficients of those conditions yields equations in the Taylor coefficients of 
                              w
                              (
                              t
                              )
                              ,
                              y
                              (
                              t
                              )
                              ,
                              z
                              (
                              t
                              )
                           . E.g. 
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                    ,
                                    3
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    0
                                    ,
                                    3
                                 
                              
                              ⇒
                              
                                 
                                    z
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                            or 
                              
                                 
                                    z
                                 
                                 
                                    0
                                 
                              
                              =
                              −
                              3
                              −
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                           . The second solution is excluded because it implies 
                              
                                 
                                    x
                                 
                                 
                                    −
                                    2
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                           . Under the assumption 
                              
                                 
                                    z
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                            the equation 
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                    ,
                                    4
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    0
                                    ,
                                    4
                                 
                              
                            results in 
                              
                                 
                                    z
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                           . Proceeding like this to consecutively solve the eight equations 
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    0
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                           , 
                              j
                              =
                              3
                              ,
                              4
                              ,
                              5
                              ,
                              6
                            we find
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    ⇒
                                    
                                    w
                                    (
                                    t
                                    )
                                    −
                                    z
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          2
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                       
                                       60
                                    
                                    (
                                    1
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       (
                                       5
                                       +
                                       6
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    ⇒
                                    
                                    y
                                    (
                                    t
                                    )
                                    −
                                    w
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          2
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                       
                                       60
                                    
                                    
                                       (
                                       5
                                       +
                                       4
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                              
                            Now we can do the analogous calculation for the equation of constant discrete affine curvature, 
                              
                                 
                                    k
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    0
                                 
                              
                              ⇔
                              
                                 
                                    B
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              (
                              t
                              )
                           , inserting the results from above for 
                              z
                              (
                              t
                              )
                            and 
                              y
                              (
                              t
                              )
                            to get
                              
                                 
                                    det
                                    ⁡
                                    (
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          −
                                          2
                                       
                                    
                                    ,
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    det
                                    ⁡
                                    (
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                    ⇒
                                    
                                    w
                                    (
                                    t
                                    )
                                    =
                                    −
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       6
                                    
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                              
                            and thus 
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              −
                              
                                 
                                    
                                       κ
                                    
                                    
                                       0
                                    
                                    
                                       ′
                                    
                                 
                                 6
                              
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              +
                              O
                              (
                              
                                 
                                    t
                                 
                                 
                                    5
                                 
                              
                              )
                           . If the discrete affine curvature is not constant, we use the equation 
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    B
                                 
                                 
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              
                              δ
                              
                                 
                                    k
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              0
                            (see (4)) to obtain
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    t
                                    
                                       (
                                       δ
                                       
                                          
                                             k
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             16
                                             +
                                             
                                                
                                                   (
                                                   δ
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    /
                                    4
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                    
                                    
                                    α
                                    (
                                    δ
                                    
                                       
                                          k
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       6
                                    
                                    β
                                    (
                                    δ
                                    
                                       
                                          k
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Here α and β are abbreviations for differentiable terms in 
                              δ
                              
                                 
                                    k
                                 
                                 
                                    −
                                    1
                                 
                              
                            with 
                              α
                              (
                              0
                              )
                              =
                              0
                            and 
                              β
                              (
                              0
                              )
                              =
                              1
                           , whose exact forms are not necessary to know. For slightly simpler notation we may define ϕ by 
                              δ
                              
                                 
                                    k
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              4
                              sinh
                              ⁡
                              (
                              ϕ
                              )
                           , then we equivalently get
                              
                                 (12)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    t
                                    
                                    
                                       
                                          e
                                       
                                       
                                          ϕ
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                    
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       6
                                    
                                    
                                       
                                          β
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    α
                                 
                                 
                                    ˜
                                 
                              
                              (
                              0
                              )
                              =
                              0
                            and 
                              
                                 
                                    β
                                 
                                 
                                    ˜
                                 
                              
                              (
                              0
                              )
                              =
                              1
                            like 
                              α
                              ,
                              β
                            above. Thus the relative change of the affine arc lengths is
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                S
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    ≈
                                    
                                       
                                          e
                                       
                                       
                                          ϕ
                                       
                                    
                                    −
                                    1
                                    
                                    for 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    →
                                    0
                                    .
                                 
                              
                             □

This shows that minimizing the 
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              2
                           
                        
                      is effective in order to make an affine arc length polyline a near affine equidistant discretization of f. In fact it turns out that the 
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              2
                           
                        
                      are a very sensitive measure for the non-constantness of the 
                        
                           
                              S
                           
                           
                              i
                           
                        
                     : If 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        =
                        f
                        (
                        0
                        )
                      and 
                        
                           
                              x
                           
                           
                              1
                           
                        
                        =
                        f
                        (
                        
                           
                              t
                           
                           
                              1
                           
                        
                        )
                     , even a small deviation of 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      from the optimum value (
                        (
                        
                           
                              S
                           
                           
                              1
                           
                        
                        −
                        
                           
                              S
                           
                           
                              0
                           
                        
                        )
                        /
                        
                           
                              S
                           
                           
                              0
                           
                        
                        ≪
                        1
                        %
                     ) will cause strong oscillations in 
                        
                           
                              k
                           
                           
                              i
                           
                        
                     , and thus large values of 
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              2
                           
                        
                     , as evidenced by Fig. 11. We find the optimal value of 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      by minimizing 
                        ∑
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              2
                           
                        
                     . This optimization process, as well as the initial value for 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      is discussed in detail in Section 4.2.

Another way of characterizing the optimal affine arc length polyline in our problem is to define them it be (locally) “as affinely regular as possible”. By this we mean that locally its deviation from an affinely regular polyline is as small as possible.

To justify this we will denote the sector areas with respect to the discrete affine evolute point 
                        
                           
                              ξ
                           
                           
                              i
                           
                        
                      of 
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              2
                           
                        
                      by 
                        
                           
                              A
                           
                           
                              j
                           
                        
                     , as shown in Fig. 8
                     . The polyline 
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              2
                           
                        
                      is affinely regular with respect to 
                        
                           
                              ξ
                           
                           
                              i
                           
                        
                     , and so we have 
                        
                           
                              A
                           
                           
                              
                              −
                              1
                           
                        
                        =
                        
                           
                              A
                           
                           
                              0
                           
                        
                        =
                        
                           
                              A
                           
                           
                              1
                           
                        
                     . Calculating the areas of the next triangles outside those three we get the relative changes
                        
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       0
                                    
                                 
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    k
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       0
                                    
                                 
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              .
                           
                        
                      Thus for 
                        
                           
                              x
                           
                           
                              i
                              −
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              3
                           
                        
                      to be near affinely regular we want 
                        
                           
                              k
                           
                           
                              i
                           
                        
                        −
                        
                           
                              k
                           
                           
                              i
                              −
                              1
                           
                        
                      and 
                        
                           
                              k
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              k
                           
                           
                              i
                           
                        
                      as near zero as possible. So finally we can state our problem clearly:


                     We wish to discretize f by an affine arc length polyline 
                     
                        
                           
                              x
                           
                           
                              i
                           
                        
                      
                     such that equivalently
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          discretizes
                                       
                                       
                                       f
                                       
                                       
                                          in a nearly
                                       
                                    
                                 
                                 
                                    
                                       
                                          affinely equidistant way
                                       
                                    
                                 
                              
                              
                              ⇔
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          is locally near
                                       
                                    
                                 
                                 
                                    
                                       
                                          affinely regular
                                       
                                    
                                 
                              
                              
                              ⇔
                              
                              
                                 ∑
                                 i
                              
                              
                                 
                                    (
                                    δ
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 min
                              
                           
                        
                     
                  

The method we will be using to minimize the 
                        
                           
                              (
                              δ
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              2
                           
                        
                      is a simple iterative algorithm called golden section search. It is explained in detail in Section 4.2.

It turns out that if we approximate the curve f by an affine arc length polyline with minimal 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              2
                           
                        
                     , the affine curvatures of the middle osculating conics 
                        
                           
                              κ
                           
                           
                              i
                           
                           
                              m
                           
                        
                        =
                        
                           
                              k
                           
                           
                              i
                           
                        
                        
                        
                           
                              A
                           
                           
                              −
                              
                                 2
                                 3
                              
                           
                        
                      form good approximations of the smooth affine curvature of f. See Figs. 11 and 13 as well as Table 1
                      for examples. For non-optimal choices of 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      this approximation is destroyed by the strong oscillations of 
                        
                           
                              k
                           
                           
                              i
                           
                        
                     .

As mentioned in the previous section, the construction of an affine arc length polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                         with 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           f
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                         calls for frequent calculation of intersection points of the given curve f and straight lines; it needs to be performed for every vertex 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         in every optimization step. This can be nontrivial and thus time-consuming. Therefore it is proposed here to preprocess f, replacing it by a curve 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                         which is a very close approximation of f, and whose structure makes those intersection operations easy.

This can be achieved by obtaining a fine sampling 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           0
                           ,
                           …
                           ,
                           N
                         of f and interpolating this polyline by parabolic arcs. It is appropriate to construct those arcs in an affine-invariant way: Make the tangent direction of the arc from 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 p
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         in 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         to be 
                           
                              
                                 p
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 p
                              
                              
                                 j
                                 −
                                 1
                              
                           
                         and in 
                           
                              
                                 p
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         to be 
                           
                              
                                 p
                              
                              
                                 j
                                 +
                                 2
                              
                           
                           −
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                        . It is illustrated in Fig. 9
                        
                        . We will always assume that 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           :
                           [
                           0
                           ,
                           N
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         is parametrized in such a way that 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         (which lies on f). Thus for 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           (
                           t
                           )
                         the integral part of t specifies the parabolic arc this point is on, and the fractional part the position on that arc.

It is important to note that p is not an affine arc length polyline, because it does not have curvature continuity. It is only a tool to facilitate the construction of the affine arc length polyline x.

It turns out that the density (number of vertices) of the polyline p strongly affects the quality of the end result x: it must be sufficiently high. We suggest 
                           |
                           p
                           |
                           ≈
                           20
                           ⋅
                           |
                           x
                           |
                        . In the example below we aimed to approximate f by an affine arc length polyline x with 60 vertices, so we replaced f by a curve made from 1000 parabolic segments. See Table 1 for details.

While it is also possible to replace f with a piecewise linear curve instead of a piecewise quadratic one, due to the lower approximation quality the vertex count of p must be much higher to enable the same smoothness of the final affine arc length polyline x.

After choosing a first vertex on 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                        , e.g. 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           :
                           =
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           (
                           0
                           )
                        , we need an initial value 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           :
                           =
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                         to start the optimization. We do this by calculating the exact affine arc length of the replacement curve 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                        , which is easy (and another advantage of a piecewise parabolic replacement of f). If we take the affine polyline coordinates of 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         to be 
                           
                              
                                 A
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                        , then the segment from 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 p
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         has the affine arc length
                           
                              (15)
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             4
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   ⁎
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   ⁎
                                                
                                             
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                
                                                
                                                   ⁎
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       /
                                       3
                                    
                                 
                                 .
                              
                           
                         The total length of 
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                         is 
                           S
                           :
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                        . If we want to approximate the curve by the affine arc length polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                         it is a good choice to use 
                           A
                           :
                           =
                           
                              
                                 (
                                 S
                                 /
                                 n
                                 )
                              
                              
                                 3
                              
                           
                        . As initial value for 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         we want to place 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 ˜
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                         such that the affine arc length from 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                         to 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         is roughly 
                           1
                           /
                           n
                         of the total affine arc length. For simplicity we initialize 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         with an integral value:
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 
                                 such that
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                                 ≈
                                 S
                                 /
                                 n
                                 .
                              
                           
                         From this the rest of the affine arc length polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                         can be constructed easily as described in Section 4.

Now we want to perform optimization on 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         in order to minimize the error function 
                           ψ
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                           :
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                        , keeping 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                         and A fixed. The error function is unimodal with respect to 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        . Therefore we can use the iterative method called golden section search (see (Kiefer, 1953)). This method is a variant of ternary search which finds a minimum of a unimodal function of one variable in an interval. As initial interval we can use e.g. 
                           [
                           0
                           ,
                           2
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ]
                           =
                           :
                           [
                           a
                           ,
                           d
                           ]
                        . It is split into three parts with length ratios 
                           ϕ
                           :
                           1
                           :
                           ϕ
                        , where ϕ is the golden section. This gives us four points 
                           a
                           <
                           b
                           <
                           c
                           <
                           d
                        . Now the function ψ to be minimized is evaluated at the middle points b and c. If 
                           ψ
                           (
                           b
                           )
                           <
                           ψ
                           (
                           c
                           )
                         the minimum cannot lie in the right interval 
                           (
                           c
                           ,
                           d
                           ]
                        , which is discarded. The remaining interval 
                           [
                           a
                           ,
                           c
                           ]
                         is once again subdivided into 3 intervals with the length ratios 
                           ϕ
                           :
                           1
                           :
                           ϕ
                        . Here the properties of the golden section guarantee that ϕ needs only be evaluated one more time to achieve this: 
                           (
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           d
                           )
                           ↦
                           (
                           a
                           ,
                           a
                           +
                           c
                           −
                           b
                           ,
                           b
                           ,
                           c
                           )
                        . If 
                           ψ
                           (
                           b
                           )
                           ≥
                           ψ
                           (
                           c
                           )
                        , the left interval is the one discarded. Every iteration decreases the total interval size by a factor of 
                           ϕ
                           −
                           1
                           ≈
                           0.618
                         until the interval is judged small enough. In the end we simply set 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           :
                           =
                           
                              1
                              2
                           
                           (
                           b
                           +
                           c
                           )
                        . Examples below were created in that way.

Below is the summary of the proposed method of approximating a noninflecting planar curve f with an affine arc length polyline 
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                        .
                           
                              1.
                              
                                 Preprocessing: Replace f by a piecewise parabolic curve 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                 , to facilitate the constructions in the following steps. 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    :
                                    [
                                    0
                                    ,
                                    N
                                    ]
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 , 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    j
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                 , where 
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                  lies on f; the tangent directions of 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    j
                                    )
                                  are chosen as shown in Fig. 9. It is important that the number of parabolic segments is sufficiently high, to make the replacement curve 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                  a good approximation of f.

If 
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                  is the affine length of the parabolic segment of 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                  from 
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                  to 
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                  (as given by Eq. (15)), the total affine length of 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                  is 
                                    S
                                    :
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                 . Let 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    0
                                    )
                                 . We set 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                  to an initial integral value such that 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                  is as close to 
                                    S
                                    /
                                    n
                                  as possible. Thus 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 .

The affine arc length polyline 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                  can now be constructed uniquely from 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                 , 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                  and the constant A, which we set to the value 
                                    A
                                    :
                                    =
                                    
                                       
                                          (
                                          S
                                          /
                                          n
                                          )
                                       
                                       
                                          3
                                       
                                    
                                 . The construction consecutively finds 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                  at the intersection of the curve 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                  and the straight line of all points z with 
                                    det
                                    ⁡
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          −
                                          2
                                       
                                    
                                    ,
                                    z
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    A
                                 . The affine arc length polyline determines the affine curvatures 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          n
                                          −
                                          2
                                       
                                    
                                 .

Golden section search is performed to find the optimal value 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                  which minimizes 
                                    ψ
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    :
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 . The affine arc length polyline is constructed anew from 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                 , A and the updated 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                  to get the new value of 
                                    ψ
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                  in every optimization step. The optimization terminates after a fixed number of iterations.

As an example we take f to be a Bézier curve of degree 8, to be approximated by an affine arc length polyline with 60 vertices. Fig. 11
                         and Table 1 compare the affine curvatures of the middle osculating conics 
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           
                           
                              
                                 A
                              
                              
                                 −
                                 2
                                 /
                                 3
                              
                           
                         with the exact affine curvatures of the original Bézier curve at that point, 
                           κ
                           (
                           (
                           
                              
                                 t
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 2
                              
                           
                           )
                           /
                           4
                           )
                        .

Curves with inflection points do not have an affine arc length parametrization in the classical sense and can therefore not be represented by affine arc length polylines. It is however possible to split them at the inflection points and treat the segments separately, with visually pleasing results. Below is a description of the procedure.

Assume that we want to approximate a curve 
                           f
                           (
                           t
                           )
                        , 
                           0
                           ≤
                           t
                           ≤
                           1
                         which has k inflection points by a polyline 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         containing 
                           n
                           +
                           1
                         vertices.
                           
                              1.
                              Identify the inflection points 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 , 
                                    0
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    <
                                    …
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    <
                                    N
                                  of the piecewise parabolic replacement curve 
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                 . This is easy, as 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    Z
                                 .

Let 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    0
                                    )
                                  and 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    =
                                    0
                                 . We want to place vertex 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                  close to the i-th inflection point for each 
                                    i
                                    ≥
                                    1
                                 . To find a good choice for the indices 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                  we calculate 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ˙
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ¨
                                             
                                          
                                          
                                          )
                                          |
                                       
                                       
                                          1
                                          /
                                          3
                                       
                                    
                                    d
                                    t
                                 , 
                                    
                                       
                                          S
                                       
                                       
                                          ˜
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          |
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ˙
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                ¨
                                             
                                          
                                          
                                          )
                                          |
                                       
                                       
                                          1
                                          /
                                          3
                                       
                                    
                                    d
                                    t
                                  and then choose the 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                  as to fulfill
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          :
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          :
                                          …
                                          :
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          :
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                          ≈
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                          :
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          :
                                          …
                                          :
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          :
                                          n
                                       
                                    
                                  as closely as possible.

Now we consecutively construct the sub-polylines 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 , constructing 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                  for the already fixed 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                    
                                  and 
                                    A
                                    :
                                    =
                                    (
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    /
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 . For the smoothing optimization in this step it is advisable to disregard a few vertices that are closest to the inflection points. The sub-polyline 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                  determines the affine curvatures 
                                    
                                       
                                          k
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          2
                                       
                                    
                                 . Therefore, if we skip l vertices at each end of the sub-polyline this means that we will minimize 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                          +
                                          l
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          3
                                          −
                                          l
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                k
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 , for e.g. 
                                    l
                                    =
                                    2
                                 .

This may be redone with adjusted value for A if the resulting 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                  is too far from the inflection point, but an exact coincidence is not necessary.

An example of this situation is shown in Figs. 12 and 13
                        
                        .

We have shown that the theory of affine arc length polylines, the discretization of curves in affine arc length parametrization, can be extended beyond the previous work by Craizer et al. (2012). In particular we defined discrete osculating conics. In addition we showed how affine arc length polylines equivalently arise as control polygons of curvature continuous uniform quadratic B-splines. Some of our results were shown to also hold in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      for uniform B-splines of degree n. Finally, we presented an algorithm for the approximation of inflection-free planar curves by affine arc length polylines in a way that the smoothness of the discrete affine curvature was optimized, making it a good approximation of the smooth affine curvature of the original curve. This demonstrates how the added geometric constraints on the discrete data pose no obstacle to the practical problem of approximating an arbitrary given curve.

There are several directions for future research that look promising. One possibility is to try to extend discrete affine curve geometry in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     . Another idea is to further study the concept of imposing geometric constraints on discrete data in order to make piecewise smooth objects deriving from it (geometrically) smoother than in the generic case. In particular, we need to see whether the notion affine arc length polylines can be transferred into the theory of surfaces in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     .

@&#ACKNOWLEDGEMENTS@&#

This research was supported by grant No. 23735-N13 of the Austrian Science Fund (FWF) and by the DFG-Collaborative Research Center, TRR 109, Discretization in Geometry and Dynamics through grant I 706-N26 of the Austrian Science Fund (FWF). I thank Helmut Pottmann for supervision and important advice during the creation of this paper.

@&#REFERENCES@&#

