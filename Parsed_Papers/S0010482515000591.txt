@&#MAIN-TITLE@&#Structure constrained semi-nonnegative matrix factorization for EEG-based motor imagery classification

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Structure constrained semi-NMF method for motor imagery classification.


                        
                        
                           
                           The mean envelopes of ERP are extracted as structural constraints.


                        
                        
                           
                           Enables the analysis of temporal patterns of general EEG time series by semi-NMF.


                        
                        
                           
                           The temporal patterns extracted by SCS-NMF can be combined with other features.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

EEG

Brain computer interface

Motor imagery classification

Event-related potential

Structure constraint

Semi-nonnegative matrix factorization

@&#ABSTRACT@&#


               
               
                  Background
                  Electroencephalogram (EEG) provides a non-invasive approach to measure the electrical activities of brain neurons and has long been employed for the development of brain-computer interface (BCI). For this purpose, various patterns/features of EEG data need to be extracted and associated with specific events like cue-paced motor imagery. However, this is a challenging task since EEG data are usually non-stationary time series with a low signal-to-noise ratio.
               
               
                  New method
                  In this study, we propose a novel method, called structure constrained semi-nonnegative matrix factorization (SCS-NMF), to extract the key patterns of EEG data in time domain by imposing the mean envelopes of event-related potentials (ERPs) as constraints on the semi-NMF procedure. The proposed method is applicable to general EEG time series, and the extracted temporal features by SCS-NMF can also be combined with other features in frequency domain to improve the performance of motor imagery classification.
               
               
                  Results
                  Real data experiments have been performed using the SCS-NMF approach for motor imagery classification, and the results clearly suggest the superiority of the proposed method.
               
               
                  Comparison with existing methods
                  Comparison experiments have also been conducted. The compared methods include ICA, PCA, Semi-NMF, Wavelets, EMD and CSP, which further verified the effectivity of SCS-NMF.
               
               
                  Conclusions
                  The SCS-NMF method could obtain better or competitive performance over the state of the art methods, which provides a novel solution for brain pattern analysis from the perspective of structure constraint.
               
            

@&#INTRODUCTION@&#

Brain-computer interface (BCI) aims at establishing an efficient communication channel between human brain and manipulatable device, and therefore has a broad range of real-life applications such as assisting humans with severe disabilities [1]. Existing BCI systems can measure and interpret brain activities evoked by either exogenous or endogenous stimuli, and motor imagery is a representative endogenous event that one can initiate by imaging certain limb or other motions. Electroencephalogram (EEG) is a non-invasive measurement approach that records the electrical activities of brain neurons along the scalp, and it has long been considered as an effective method providing important information for motor imagery analysis and classification [2].

Since the focus of this study is to develop a decomposition-based method for identifying EEG patterns in time domain, here we only review the related work on pattern extraction; for classification algorithms like support vector machine used in EEG-based BCIs, the reader is referred to Lotte et al. [3]. EEG data are frequent measurements of electrical signals, it is therefore natural to investigate their frequency domain features such as event-related synchronization (ERS) and event-related desynchronization (ERD) [4,5] after fast Fourier transform (FFT), wavelet transform or Hilbert–Huang transform (HHT) [6]. EEG data are also high-dimensional non-stationary time series with a poor signal-to-noise (SNR) ratio [3,7], it is thus more challenging to identify the useful temporal patterns in time domain. Nevertheless, the concept of event-related potential (ERP), defined as the time-locked average of EEG signals in response to a repeated event, has been introduced into EEG data analysis to improve the SNR [8]. The key temporal patterns embedded in ERPs can then be extracted using decomposition methods such as principle component analysis (PCA) [9] and independent component analysis (ICA) [10]. In particular, the nonnegative matrix factorization (NMF) methods [11–13] have received increasing attention due to its capability of decomposing data into physically meaningful parts. More importantly, unlike the orthogonality assumption in PCA and the independency assumption in ICA, the NMF methods do not make such assumptions on data and are thus applicable to a broader range of problems.

In the past decade, many NMF variants have been proposed by incorporating different penalties into the original NMF objective function. Ding et al. [12] proposed the semi-NMF and convex NMF methods; the semi-NMF method relaxes the non-negativity constraint and thus allow negative entries in the results, and the convex NMF forces the basis vectors to be a convex combination of input data and introduces sparsity into the results implicitly. Li et al. [14] proposed a local nonnegative matrix factorization (LNMF) method by introducing sparsity and redundancy restrictions to obtain a minimum number of basis vectors to achieve better locality. The sparseness constraint in Hoyer’s work [15] has a form similar to that of the LNMF. Cai et al. [16] developed the graph regularized nonnegative matrix factorization (GNMF) method, which introduces the inter-sample geometric similarity as an extra proximity constraint on sample representation. A constrained nonnegative matrix factorization (CNMF) was developed by Liu et al. [17] with the label information imposed as a hard constraint.

In the methods mentioned above, the PCA and ICA methods make the orthogonality and the independence assumption, respectively, which may not be valid to brain signals. In addition, note that EEG time series can take positive or negative values, which makes the conventional NMF methods inapplicable. Therefore, among all the NMF variants described above, we select the semi-NMF method proposed by Ding et al. [12] and extend it to address the temporal pattern extraction problem for EEG data. This idea is different from those of several previous studies, which applied the NMF method to brain signals (after wavelet transform or short-time FFT) in the frequency domain [18–21]. The SCS-NMF method developed in this paper extracts the temporal EEG patterns, which are physically meaningful, and thus enables the time-domain analysis of brain signals in a pure additive manner. We thus believe that SCS-NMF provides a useful alternative for temporal EEG pattern analysis.

A key question that has not been sufficiently addressed in previous studies is what temporal patterns embedded in ERPs in response to the same cue- or self-paced event should be extracted and used for motor imagery classification. In this study, we consider a data-driven approach, which directly learns the temporal patterns from data without feeding it on any prior knowledge. More specifically, we borrow the idea from the empirical mode decomposition (EMD) step in HHT, which extracts the upper and lower envelopes of non-stationary time series via cubic spline interpolation [6]. We thus calculate the mean envelopes of ERPs by averaging the upper and lower envelopes, and hypothesize that these mean envelopes are the common patterns useful to motor imagery classification, based on the fact that the post-stimulus responses of brain to the same event are highly replicable [8]. We impose the mean envelopes of ERPs as structure constraints on the semi-NMF procedure such that the time series from each single trial can be decomposed into a linear combination of the basis temporal patterns. Finally, based on the coefficients of those linear combinations obtained via SCS-NMF, a linear support vector machine (SVM) is trained to classify the brain responses to the imagined motions. To the best knowledge of authors, this is the first time that semi-NMF is extended and introduced into BCI-related problems, which enables the pattern analysis of brain signals in time domain.

The rest of the paper is organized as follows: the SCS-NMF method is described and theoretically justified in Section 2, the real data experiment results are shown in Section 3, and the conclusions are presented in Section 4.

@&#METHOD@&#

In this section, we describe the details of how to extract and use the mean envelopes of ERPs as structure constraints to regularize the semi-NMF procedure.

By definition, an ERP is the time-locked average of EEG data (maybe pre-processed using, e.g., bandpass filtering) over multiple trials on the same subject in response to a repeated event [8]. The upper and lower envelopes of an ERP can be calculated via cubic spline interpolation as described in [6], and the mean envelope of ERP is simply the arithmetic average of the upper and lower envelopes.

We show some examples of the mean envelopes of ERPs in 
                        Fig. 1 to visually illustrate why they can be employed as the structure constraints for temporal pattern extraction. Dataset IVa from BCI competition III [22] is used to produce Fig. 1, and this dataset contains observations from 5 subjects (labelled as ‘aa’, ‘al’, ‘av’, ‘aw’, and ‘ay’, respectively), and each subject with 118 channels recorded for three motor imageries (left hand, right hand, and right foot). Extended international 10–20 system is applied to configure the 118 electrodes. Two kinds of visual cues indicating the expected motor imagery have been employed, which are either a static letter behind a fixation cross or a randomly moving objects. For each subject, 280 trials of motor imagery have been conducted. For each trial, the visual cue indicated for 3.5s and the presentation of target cues were intermitted by a period of random length from 1.75s to 2.25s. The recorded signals were band-pass filtered between 0.05 and 200Hz and downsampled to 100Hz. Define one trial as the experimental observation of the brain activities of one subject evoked by a single event, the ERPs in Fig. 1(a) are calculated by averaging the filtered data from channel 38 (the FC4 position in the international 10–20 system) over each group of 30 trials in response to the left hand motion imagination from three different subjects (aa, al and ay), and three ERPs are plotted for one subject; also, the mean envelopes of the grand-average ERP (that is, the arithmetic average of the three ERPs) of each subject is plotted in Fig. 1(b). In Fig. 1, the zero instant is set as the onset time of the visual cue. One can tell from Fig. 1 that the three ERPs of each subject resemble each other if neglecting the differences in data magnitude; more interestingly, the mean envelopes of the three subjects are also similar to each other in terms of shape. This observation motivates us to introduce the mean envelopes of ERPs as structure constraints on the semi-NMF procedure for pattern extraction.

Here we describe how to use the weighted mean envelopes to construct the structure constraint matrix based on a given training dataset. Let 
                           L
                         denote the number of different motor imagery types and let 
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                         
                        
                           (
                           
                              l
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                           )
                         denote the number of trials on the same human subject corresponding to the 
                           l
                        th motor imagery type. Although the 
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                         trials are for the same motor imagery, the patterns (e.g., shape and magnitude) of the EEG time series collected from these trials will change as time goes by, as suggested in Fig. 1(a). Therefore, instead of pulling all the 
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                         trials together to calculate one single ERP for a motor imagery type, it is more reasonable to divide the 
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                         trials into 
                           M
                         non-overlapping groups according to their proximity in time and calculate an ERP as well as the mean envelope of this ERP for each group. The method to calculate the mean envelope is given in Section 2.1. Thus, a structure constraint matrix 
                           
                              
                                 S
                              
                              
                                 P
                                 ×
                                 K
                              
                           
                         can be constructed with its 
                           k
                        th 
                           (
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                           
                           )
                         column being the mean envelope (denoted by 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                        ) of the ERP of the 
                           k
                        th group, where 
                           K
                           =
                           L
                           /
                           M
                         is the total number of the mean envelopes and 
                           P
                         is the dimension of a mean envelope (data frames in one trial). If an experiment involves multiple human subjects, a structure constraint matrix of dimension 
                           P
                           ×
                           K
                         can be constructed for each of the subjects.

In addition, we introduce a weighting scheme into the construction of the structure constraint matrix. From Fig. 1(b), one can tell that the timing of the mean envelope extrema (e.g., around 0.5 and 4.0s) is close to each other for different subjects. It has also been pointed out in [8] that the polarity and position of an ERP component (local extrema along the ERP time course) are the major properties that can distinguish different ERPs. Therefore, the influence of the local extrema should be stressed. This observation motivates us to consider the following weighting scheme
                           
                              (1)
                              
                                 
                                    
                                       S
                                    
                                    
                                       P
                                       ×
                                       K
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             S
                                          
                                          
                                             p
                                             k
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    |
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       p
                                       )
                                       ×
                                       exp
                                       
                                          (
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            (
                                                            p
                                                            )
                                                            −
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            (
                                                            p
                                                            )
                                                         
                                                         ‖
                                                      
                                                      2
                                                   
                                                
                                                σ
                                             
                                          
                                          )
                                       
                                    
                                    |
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 S
                              
                              
                                 P
                                 ×
                                 K
                              
                           
                         is the weighted structure constraint matrix, 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                        is pth element in the kth mean envelop vector, 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         is the set of the extremum elements in 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                         obtained when calculating the upper and lower envelope of an ERP, and 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                         is the extremum value in 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         that is the nearest to 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                        . The parameter 
                           σ
                         in Eq. (1) is set to 100 in our implementation, but this value can be modified to account for the actual average distance between two adjacent extrema in specific data. If 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                           =
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                         (that is, 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                         is an extremum), its absolute value will remain unchanged; otherwise, 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           (
                           p
                           )
                         will be reduced toward zero by the weighting scheme and thus becomes a weak structure constraint. In short, the weighting scheme keeps the absolute values of the extremum in the mean envelopes the same, but reduces the absolute values of other signals if they are far from the extrema. To give an intuitive illustration, 
                        Fig. 2 visualizes the weighted mean envelops obtained respectively from the mean envelopes in Fig. 1(b).

The original semi-NMF method decomposes a data matrix 
                           X
                         into the product of a basis matrix 
                        
                           W
                         and a coefficient matrix 
                           
                              
                                 H
                              
                              T
                           
                         (also called feature matrix) as follows
                           
                              (2)
                              
                                 
                                    
                                       X
                                    
                                    
                                       P
                                       ×
                                       Q
                                    
                                 
                                 ≈
                                 
                                    
                                       W
                                    
                                    
                                       P
                                       ×
                                       K
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       Q
                                       ×
                                       K
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where all the entries in 
                           
                              
                                 H
                              
                              T
                           
                         are nonnegative but the non-negativity constraints on 
                           X
                         and 
                           W
                         are relaxed [12], 
                           P
                         and 
                           K
                         are the same as those defined in the previous section, and 
                           Q
                         is the total number of trials. Note that here 
                           X
                         contains only the training data such that the ith column of 
                           X
                         is just the data from the ith trial in a motor imagery experiment, which is simply constructed by concatenating all the channels into one column vector. Since 
                           K
                         (the number of mean envelopes) is much smaller than 
                           Q
                        , the semi-NMF method can significantly reduce the dimension of the raw data and the learning task can be then conducted in the coefficient vector space (that is, the space expanded by the columns of 
                           
                              
                                 H
                              
                              T
                           
                        ). The columns in 
                           
                              
                                 H
                              
                              T
                           
                         corresponding to the training trials are used to train a classifier. After the feature basis 
                           W
                         is obtained, the testing data will be projected onto 
                           W
                         and the resulted coefficient can then be used for testing or prediction based on the trained classifier.

We now incorporate the structure constraint matrix 
                           S
                         into semi-NMF by introducing the following structure penalty term
                           
                              (3)
                              
                                 D
                                 (
                                 W
                                 ,
                                 S
                                 )
                                 =
                                 λ
                                 
                                    
                                       ‖
                                       
                                          W
                                          −
                                          S
                                       
                                       ‖
                                    
                                    2
                                 
                                 ,
                                 ,
                              
                           
                        where 
                           ‖
                           
                              ⋅
                           
                           ‖
                         denotes the Frobenius norm and 
                           λ
                         is the penalty coefficient that controls the structural similarity between 
                           W
                         and 
                           S
                        . Accordingly, the objective function of the structure constrained semi-NMF (SCS-NMF) becomes
                           
                              (4)
                              
                                 O
                                 =
                                 
                                    
                                       ‖
                                       
                                          X
                                          −
                                          W
                                          
                                             
                                                H
                                             
                                             T
                                          
                                       
                                       ‖
                                    
                                    2
                                 
                                 +
                                 λ
                                 
                                    
                                       ‖
                                       
                                          W
                                          −
                                          S
                                       
                                       ‖
                                    
                                    2
                                 
                                 .
                              
                           
                        
                     

Equivalently, Eq. (4) can be reformulated as
                           
                              (5)
                              
                                 O
                                 =
                                 Tr
                                 (
                                 (
                                 X
                                 −
                                 W
                                 
                                    
                                       H
                                    
                                    T
                                 
                                 )
                                 
                                    
                                       (
                                       X
                                       −
                                       W
                                       
                                          
                                             H
                                          
                                          T
                                       
                                       )
                                    
                                    T
                                 
                                 )
                                 +
                                 λ
                                 Tr
                                 (
                                 (
                                 W
                                 −
                                 S
                                 )
                                 
                                    
                                       (
                                       W
                                       −
                                       S
                                       )
                                    
                                    T
                                 
                                 )
                                 =
                                 Tr
                                 (
                                 X
                                 
                                    
                                       X
                                    
                                    T
                                 
                                 )
                                 −
                                 2
                                 Tr
                                 (
                                 X
                                 H
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 +
                                 Tr
                                 (
                                 W
                                 
                                    
                                       H
                                    
                                    T
                                 
                                 H
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 +
                                 λ
                                 Tr
                                 (
                                 W
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 −
                                 2
                                 λ
                                 Tr
                                 (
                                 W
                                 
                                    
                                       S
                                    
                                    T
                                 
                                 )
                                 +
                                 λ
                                 Tr
                                 (
                                 S
                                 
                                    
                                       S
                                    
                                    T
                                 
                                 )
                                 ,
                              
                           
                        where 
                           Tr
                           
                              (
                              ⋅
                              )
                           
                         denotes the matrix trace. The Largrangian function 
                           Γ
                         of SCS-NMF can then be derived by incorporating the non-negativity constraints on 
                           
                              
                                 H
                              
                              T
                           
                        
                        
                           
                              (6)
                              
                                 Γ
                                 =
                                 Tr
                                 (
                                 X
                                 
                                    
                                       X
                                    
                                    T
                                 
                                 )
                                 −
                                 2
                                 Tr
                                 (
                                 X
                                 H
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 +
                                 Tr
                                 (
                                 W
                                 
                                    
                                       H
                                    
                                    T
                                 
                                 H
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 +
                                 λ
                                 Tr
                                 (
                                 W
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 )
                                 −
                                 2
                                 λ
                                 Tr
                                 (
                                 W
                                 
                                    
                                       S
                                    
                                    T
                                 
                                 )
                                 +
                                 λ
                                 Tr
                                 (
                                 S
                                 
                                    
                                       S
                                    
                                    T
                                 
                                 )
                                 +
                                 Tr
                                 (
                                 β
                                 
                                    
                                       H
                                    
                                    T
                                 
                                 )
                                 ,
                              
                           
                        
                     

The derivatives of 
                           Γ
                         with respect to 
                           W
                         and 
                           H
                         are
                           
                              (7)
                              
                                 
                                    
                                       ∂
                                       Γ
                                    
                                    
                                       ∂
                                       W
                                    
                                 
                                 =
                                 −
                                 2
                                 X
                                 H
                                 +
                                 2
                                 W
                                 
                                    
                                       H
                                    
                                    T
                                 
                                 H
                                 +
                                 2
                                 λ
                                 W
                                 −
                                 2
                                 λ
                                 S
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       ∂
                                       Γ
                                    
                                    
                                       ∂
                                       H
                                    
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       X
                                    
                                    T
                                 
                                 W
                                 +
                                 2
                                 H
                                 
                                    
                                       W
                                    
                                    T
                                 
                                 H
                                 +
                                 β
                                 .
                              
                           
                        
                     

The updating rules for 
                           W
                         and 
                           H
                         can be arrived from 
                           
                              
                                 ∂
                                 Γ
                              
                              
                                 ∂
                                 W
                              
                           
                           =
                           0
                         and 
                           
                              
                                 ∂
                                 Γ
                              
                              
                                 ∂
                                 H
                              
                           
                           =
                           0
                        , respectively, with considering the non-negativity constraints on 
                           H
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 ←
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             X
                                             H
                                             +
                                             λ
                                             S
                                             )
                                          
                                          
                                             i
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             W
                                             
                                                
                                                   H
                                                
                                                T
                                             
                                             H
                                             +
                                             λ
                                             W
                                             )
                                          
                                          
                                             i
                                             k
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       h
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 ←
                                 
                                    
                                       h
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      T
                                                   
                                                   W
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   +
                                                
                                             
                                             +
                                             
                                                
                                                   [
                                                   H
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               W
                                                            
                                                            T
                                                         
                                                         W
                                                         )
                                                      
                                                      −
                                                   
                                                   ]
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      T
                                                   
                                                   W
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   −
                                                
                                             
                                             +
                                             
                                                
                                                   [
                                                   H
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               W
                                                            
                                                            T
                                                         
                                                         W
                                                         )
                                                      
                                                      +
                                                   
                                                   ]
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 M
                              
                              +
                           
                         and 
                           
                              
                                 M
                              
                              −
                           
                         denote the positive and negative parts of a matrix 
                           M
                        , respectively, and are calculated as 
                           
                              
                                 M
                              
                              
                                 j
                                 k
                              
                              
                                 +
                              
                           
                           =
                           
                              (
                              
                                 
                                    |
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                             k
                                          
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       j
                                       k
                                    
                                 
                              
                              )
                           
                           /
                           2
                         and 
                           
                              
                                 M
                              
                              
                                 j
                                 k
                              
                              
                                 −
                              
                           
                           =
                           
                              (
                              
                                 
                                    |
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                             k
                                          
                                       
                                    
                                    |
                                 
                                 −
                                 
                                    
                                       M
                                    
                                    
                                       j
                                       k
                                    
                                 
                              
                              )
                           
                           /
                           2
                        .

In addition, due to the introduction of the structure constraint, the projection of the testing data onto the feature basis space is only an approximation. However, the approximation error has been minimized after the optimization of the objective function in Eq. (4).

To evaluate the performance of SCS-NMF, several representative methods are selected to compare with SCS-NMF using real experimental data. More specifically, we consider five decomposition methods (ICA, ICA-R [23], PCA, the original semi-NMF method, and the EMD method in HHT), one frequency domain method (wavelet transform), and one classical BCI feature analysis method (the common spatial pattern method [24]). All the methods under comparison are employed to extract EEG data features to train a linear SVM to fulfill the task of the motor imagery classification. For fairness of comparison, the experimental data have been processed in the same way (e.g., the same ERPs are used for ICA, PCA, the original semi-NMF, SCS-NMF etc.) and the computing parameters of all the methods have been tuned as suggested in the corresponding literature. Specifically, the number of components in ICA is equal to the number of channels used to collect the data as suggested in [25]. In the application of ICA-R, the column vectors in matrix 
                           S
                         are employed as the reference signals and the number of independent components is set as the number of columns in matrix 
                           S
                        . The dimension of the basis matrix in the original semi-NMF is fine-tuned and the optimal value (that is, 12) is used throughout the experiments. The number of EMD components is also equal to the number of channels since each channel corresponds to one time course component. For the wavelet method, 6 level wavelet packet decomposition based on Sym4 wavelet from the Symlets family is employed [26].

Clustering accuracy (AC) [16,27] is employed to assess the performances of the methods under comparison, defined as
                           
                              
                                 A
                                 C
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          δ
                                          
                                             (
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                map
                                                (
                                                C
                                                
                                                   
                                                      ׳
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    n
                                 
                                 ,
                              
                           
                        where 
                           n
                         is the number of trials of motor imagery, 
                           C
                         is the ground truth of cluster labels, 
                           C
                           ׳
                         is the obtained classification result, 
                           m
                           a
                           p
                           (
                           C
                           
                              
                                 ׳
                              
                              
                                 i
                              
                           
                           )
                         is the mapping from 
                           C
                           
                              
                                 ׳
                              
                              
                                 i
                              
                           
                         to their corresponding labels in 
                           C
                         (the optimal mapping is obtained using the Kuhn–Munkres algorithm [28]), and 
                           δ
                           (
                           x
                           ,
                           y
                           )
                         is the delta function which takes 1 if 
                           x
                           =
                           y
                         and zero otherwise.

Two widely-used public datasets are employed for algorithm performance evaluation, including data set I [29] and data set IVa [22] in BCI competition III. Data set I contains 278 training trials and 100 testing trials on one subject for two motor imageries (the imagined motions of the left small finger and the tongue). 8×8 electrodes (64 channels) are configured to cover the right motion cortex and each of the trials lasts 3s with a sampling frequency of 1000Hz. The training and testing trials are one week apart. Data set IVa contains 280 trials on 5 subjects (aa, al, av, aw and ay) for 3 imagined motions (left hand, right hand and right foot). The sampling frequency of signals from 118 channels is 1000Hz and band-pass filtered between 0.05 to 200Hz. Two forms of visual stimuli (letters behind a fixed cross or randomly moving object) have been used in these experiments. The former one may induce target-correlated eye movement, and the latter one may induce target-uncorrelated eye movement. Both stimuli may introduce noise into the EEG recordings. Experiments in Section 3.2 suggest that the influence of these noises on the motion imagery classification performance is minor. In addition, to remove noise and for computational efficiency, all the data have been band-pass filtered between 8 to 35Hz using an equiripple filter and downsampled to 100Hz.

@&#PERFORMANCE EVALUATION@&#

We consider a 5 fold cross-validation scheme for algorithm performance evaluation. That is, for each data set, all the trials are divided into 5 subsets of equal size, four of which are used as the training sets and the remaining one for testing. For each method in comparison, the results reported here are the average over five runs of evaluations as each subset is used for testing once. The results of data set I and IVa are given in 
                        
                        Tables 1 and 2, respectively. It should be stressed that the performance evaluation for each of the methods under comparison is solely based on the feature that this method can extract. Therefore, the results reported in Tables 1 and 2 can be further improved by combining multiple features [3], as we will show in Section 3.4.

In Table 1, the results for data set I are listed. Considering that the 278 training trials and the 100 testing trials in this data set were conducted one week apart, the difference in experiment date may introduce batch effect into ERP patterns. Thus, we evaluate the algorithm performance using both the 278 training trials alone and all the 378 trials. On the more homogeneous data (278 trials on the same day), SCS-NMF’s performance is close to that of CSP (~4% less); however, when the data become more heterogeneous (378 trials on two different days), SCS-NMF achieves the best result (8% more accurate than CSP). The results for data set IVa are summarized in Table 2. Similar to the work in [30] and [31], for each of the trials in this data set, only the EEG data from 0.5s to 2.5s post the visual cue are used for pattern extraction. From Table 2, it can be clearly told that SCS-NMF consistently performs better than any of the other methods on all the five subjects. One may note that the two widely-used decomposition methods, ICA and PCA, do not perform as well as the SCS-NMF method for all the cases. The reasons could be that the independency assumption of ICA may not be completely satisfied for brain signals and also the signs of the component and coefficient matrices may introduce activation polarity ambiguity in ICA [32], and the PCA method is sensitive to gross noise [33], which is an unavoidable issue for EEG signals. In addition, even though the ICA-R method has employed the same constraint matrix as that of the SCS-NMF method, the classification accuracy of ICA-R method is only better than that of ICA, but not comparable with SCS-NMF. The reason is that the source signals and the reference signals are both assumed to be independent by ICA-R, which obviously cannot be satisfied by matrix 
                           S
                         due to the dependencies among the column vectors. Overall, we can conclude that SCS-NMF method is an effective approach for extracting temporal patterns of EEG data and its performance is superior to the other six representative methods.

To give an intuitive illustration of the obtained feature components, 
                        Fig. 3 visualizes the obtained vectors in matrix 
                           W
                        . It can be clearly seen that the obtained basis vectors can be interpreted as some ERP components at different time points [8]. These results suggest that the onset time of the ERP components (like P1, P2 etc.) varies even for the same subject. However, to thoroughly quantify and analyze the properties of the obtained bases within and across subjects, lots of additional efforts are needed in the future.

The key parameter in SCS-NMF is the structural penalty coefficient 
                           λ
                        . To evaluate the sensitivity of the SCS-NMF with respect to 
                           λ
                        , algorithm performances on both data sets with 
                           λ
                         changing from 0.001 to 100 have been calculated, and the results are summarized in 
                        Table 3. It can be seen from Table 3 that as 
                           λ
                         changes from 0.001 to 100, the performance discrepancy ranges from 4.03% to 6.18%. Such results suggest that the SCS-NMF method is relatively robust against the change of 
                           λ
                        . However, when 
                           λ
                         is set as a very large number, e.g., 10,000, the classification results on the seven experiments in Table 3 are respectively 56.37%, 51.23%, 51.38%, 53.81%, 51.12%, 52.19%, and 50.58%, which are just slightly better than random guess. These results are similar to those when we set 
                           W
                           =
                           S
                         in Eq. (2), which are respectively 56.29%, 51.33%, 51.35%, 53.78%, 51.10%, 52.09%, and 50.38%. Therefore, to obtain an optimal performance, the value of 
                           λ
                         should be set within an appropriate range according to our results.

Another parameter that can have an effect on the algorithm performance is 
                           K
                        , and by definition it is the number of mean envelopes used to construct the structure constraint matrix 
                           
                              
                                 S
                              
                              
                                 P
                                 ×
                                 K
                              
                           
                        . The value of 
                           K
                         is determined by the number of groups of the non-overlapping trials from the training set, i.e. 
                           M
                        , and 
                           M
                         is thus determined by the number of non-overlapping trials used to obtain one envelop as discussed in Section 2.2. For all the experiments in this paper, 20 successive trials have been employed to compute one mean envelop, which is an empirical choice for the datasets in this study. For further illustration, 
                        Fig. 4 shows the change in algorithm performance as the parameter 
                           K
                         varies (Fig. 4(a)), as well as the number of non-overlapping trials used to compute each mean envelop on data set Iva (Fig. 4(b)). Only the training data have been employed to compute the structure constraint, which includes 224 trials for each subject in dataset IVa due to the 5 fold cross-validation scheme applied for the algorithm performance evaluation. Therefore, when 5, 10, 15, 25 and 30 non-overlapping trials have been employed to compute the mean envelopes (structure constraint), the corresponding values of 
                           K
                         are 44, 22, 14, 11, 8 and 7, respectively. Accordingly, the algorithm performance with respect to 
                           K
                         and the number of non-overlapping trials are given in Fig. 4(a) and (b). It can be seen from Fig. 4 that when 
                           K
                         is between 10 and 15, the algorithm performance is relatively stable, and the maximum difference in algorithm accuracy is about 10% for different K values.

In comparison with the traditional NMF, additional computing work needs to be done for the SCS-NMF method. We thus discuss the computational complexity of the SCS-NMF here. From the updating rules in Eqs. (9) and (10), it can be obtained that the computational complexity at each iteration is 
                           O
                           (
                           P
                           Q
                           K
                           +
                           Q
                           
                              
                                 K
                              
                              2
                           
                           +
                           2
                           P
                           K
                           )
                         and 
                           O
                           (
                           P
                           Q
                           K
                           +
                           K
                           
                              
                                 P
                              
                              2
                           
                           +
                           
                              
                                 Q
                              
                              2
                           
                           K
                           )
                         for Eqs. (9) and (10), respectively. Assuming 
                           t
                         iterations have been executed, the total computational complexity would be 
                           O
                           
                              (
                              
                                 t
                                 (
                                 2
                                 P
                                 Q
                                 K
                                 +
                                 Q
                                 
                                    
                                       K
                                    
                                    2
                                 
                                 +
                                 2
                                 P
                                 K
                                 +
                                 K
                                 
                                    
                                       P
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    2
                                 
                                 K
                                 )
                              
                              )
                           
                        . If the motor imagery experiments keep going on, the value of 
                           Q
                         (the number of trials) will continue to increase; thus, it will become expensive to conduct the SCS-NMF decomposition in real time. However, possible solutions to this problem include, e.g., off-line training and incremental SCS-NMF. The off-line training provides a set of bases to decompose the incoming trial data, based on which the classification is then performed. The high repeatability of the brain response to certain stimulus assures the feasibility of this solution. On the other hand, online learning with SCS-NMF could be implemented by simply using the ideas of incremental NMF methods like those in [34,35]. An in-depth research of the real time solution with SCS-NMF will be conducted in the future.

@&#CONCLUSION@&#

A novel method called structure constrained semi-nonnegative matrix factorization (SCS-NMF) for motor imagery classification is developed in this study. The SCS-NMF method extracts the mean envelopes of ERP as the common pattern that EEG signals will have in response to the same event, and then impose the mean envelope pattern as structural constraints on the semi-NMF procedure. This approach introduces semi-NMF into motor imagery classification for the first time and enables the analysis of temporal patterns of general EEG time series. The temporal patterns extracted by SCS-NMF can also be combined with the frequency domain features to form a more comprehensive time-frequency pattern analysis scheme for EEG data. Experiments on two widely-used data sets have been performed, and the results clearly suggest effectivity of SCS-NMF.

This study also provides a basis for further investigations of pattern extraction methods for EEG data. For instance, in the machine learning field, abundant of algorithms (e.g., isomap [36], locally linear embedding [37], and locality preserving projections [38]) have been proposed to explore the geometry of the data space and study the dependency between patterns, which is not considered in this work. However, the different motor imageries surely are not independent of each other, which is of a great interest to be explored in the future.

The authors whose names are listed immediately blow certify that they have NO affiliations with or involvement in any organization or entity with any financial interest, or non-financial interest in the subject matter or materials discussed in this manuscript.

@&#ACKNOWLEDGMENT@&#

This work is supported by the Fundamental Research Funds for the Central Universities, National Natural Science Foundation of China grant 61105034, 61203350, Research Fund for the Doctoral Program of Higher Education of China grant 20100201120040, China Postdoctoral Science Foundation grant nos. 20110491662, 2012T50805.

Similar to other NMF-family methods, Eq. (4) is not convex with respect to either 
                        W
                      or 
                        H
                      so there is no guarantee that the updating rules for SCS-NMF will always reach the global minimum of the objective function. In addition, since NMF is an underdetermined problem, it can only be shown that SCS-NMF is locally convergent in the sense that the objective function is non-increasing. We borrow the ideas in [12] and [13] for the convergence proof.
                        Theorem 1
                        The optimization function 
                              O
                              =
                              
                                 
                                    ‖
                                    
                                       X
                                       −
                                       W
                                       
                                          
                                             H
                                          
                                          T
                                       
                                    
                                    ‖
                                 
                                 2
                              
                              +
                              λ
                              
                                 
                                    ‖
                                    
                                       W
                                       −
                                       S
                                    
                                    ‖
                                 
                                 2
                              
                            is non-increasing under the updating rules in Eqs. (9) and (10).

As described in [13], we can define the following auxiliary function for 
                              W
                            as.

Now we only need to prove that the objective function 
                        O
                      is non-increasing under the updating rule in Eq. (10). According to the local convergence proof of semi-NMF in [12], we need to prove one proposition first to show that updating rule in Eq. (10) gives the optimal solution to the objective function.
                        Proposition 1
                        The limiting solution of Eq. (10) satisfies the KKT condition given the non-negativity constraint on matrix 
                              H
                           .

The objective function 
                              O
                            can be rewritten as.

Considering the non-negativity constraint on matrix 
                        H
                      and that only the 
                        H
                     -related terms will influence the limiting solution, the Lagrangian function in Eq. (6) can be reduced to
                        
                           
                              Γ
                              (
                              H
                              )
                              =
                              Tr
                              
                                 (
                                 
                                    −
                                    2
                                    
                                       
                                          X
                                       
                                       T
                                    
                                    W
                                    
                                       
                                          H
                                       
                                       T
                                    
                                    +
                                    H
                                    
                                       
                                          W
                                       
                                       T
                                    
                                    W
                                    
                                       
                                          H
                                       
                                       T
                                    
                                    −
                                    β
                                    H
                                 
                                 )
                              
                              ,
                           
                        
                     where 
                        
                           
                              β
                           
                           
                              i
                              j
                           
                        
                      is the Lagrange multipliers for the non-negativity constraint. The first order partial derivative of 
                        Γ
                        (
                        H
                        )
                      with respect to 
                        H
                      is given in Eq. (8).

Combining the zero gradient condition and complementary slackness condition, one can show that
                        
                           (13)
                           
                              
                                 
                                    (
                                    
                                       −
                                       2
                                       
                                          
                                             X
                                          
                                          T
                                       
                                       W
                                       +
                                       2
                                       H
                                       
                                          
                                             W
                                          
                                          T
                                       
                                       W
                                    
                                    )
                                 
                                 
                                    j
                                    k
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              0
                              ,
                           
                        
                     
                  

At the convergence point, the updating rule in Eq. (10) can be further reduced to
                        
                           (14)
                           
                              
                                 
                                    (
                                    
                                       −
                                       2
                                       
                                          
                                             X
                                          
                                          T
                                       
                                       W
                                       +
                                       2
                                       H
                                       
                                          
                                             W
                                          
                                          T
                                       
                                       W
                                    
                                    )
                                 
                                 
                                    j
                                    k
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              0
                              ,
                           
                        
                     given that 
                        
                           
                              X
                           
                           T
                        
                        W
                        =
                        
                           
                              (
                              
                                 
                                    X
                                 
                                 T
                              
                              W
                              )
                           
                           +
                        
                        −
                        
                           
                              (
                              
                                 
                                    X
                                 
                                 T
                              
                              W
                              )
                           
                           −
                        
                      and 
                        
                           
                              W
                           
                           T
                        
                        W
                        =
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 T
                              
                              W
                              )
                           
                           +
                        
                        −
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 T
                              
                              W
                              )
                           
                           −
                        
                     . Comparing Eqs. (13) and (14), it can be concluded that the limiting solution of the updating rule in Eq. (10) satisfies the KKT condition.

To prove the non-increasing property of the objective function 
                        O
                      under the updating rule in Eq. (10), the following appropriate auxiliary function needs to be constructed
                        
                           
                              G
                              
                                 (
                                 
                                    H
                                    ,
                                    
                                       
                                          H
                                       
                                       k
                                    
                                 
                                 )
                              
                              =
                              −
                              
                                 
                                    ∑
                                    
                                       j
                                       k
                                    
                                 
                                 
                                    2
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          +
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          +
                                          l
                                          o
                                          g
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              +
                              
                                 
                                    ∑
                                    
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    ∑
                                    
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   +
                                                
                                                )
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                H
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    ∑
                                    
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          j
                                          l
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          +
                                          l
                                          o
                                          g
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        A
                        =
                        
                           
                              W
                           
                           T
                        
                        W
                      and 
                        B
                        =
                        
                           
                              X
                           
                           T
                        
                        H
                     . Similar to the proof in [12], the above function can be proven to be an auxiliary function, which gives the optimal solution to 
                        H
                        =
                        
                           
                              arg
                              
                              min
                           
                           H
                        
                        G
                        (
                        H
                        ,
                        
                           
                              H
                           
                           
                              k
                           
                        
                        )
                     . From 
                        
                           
                              
                                 ∂
                                 /
                                 ∂
                                 
                                    
                                       H
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 G
                                 
                                    (
                                    
                                       
                                          
                                             H
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             H
                                          
                                          
                                             j
                                             k
                                          
                                          
                                             k
                                          
                                       
                                    
                                    )
                                 
                              
                              |
                           
                           
                              
                                 
                                    H
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        
                        =
                        0
                     , we can obtain
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                                G
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       ⇒
                                       −
                                       2
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             k
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             k
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             2
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      +
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             2
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       ⇒
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   +
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                   k
                                                
                                                
                                                   −
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      +
                                                   
                                                   )
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ⇒
                                       
                                          
                                             H
                                          
                                          
                                             j
                                             k
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             H
                                          
                                          
                                             j
                                             k
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               H
                                                            
                                                            k
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            −
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                      
                                                         −
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               H
                                                            
                                                            k
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            +
                                                         
                                                         )
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     which is just the updating rule in Eq. (10).

Finally, from Eqs. (9) and (10), one can tell that when 
                        λ
                        =
                        0
                     , the updating rules of SCS-NMF degenerate to the original semi-NMF.

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.compbiomed.2015.02.010.


                     
                        
                           
                              Supplementary data
                           
                           
                        
                     
                  

@&#REFERENCES@&#

