@&#MAIN-TITLE@&#Multivariate versus univariate Kriging metamodels for multi-response simulation models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Applying nonseparable dependence models ensures positive-definite covariance matrix.


                        
                        
                           
                           We develop a Monte Carlo laboratory that satisfies all Kriging assumptions.


                        
                        
                           
                           We find that simple univariate Kriging has smaller MSE, so it is more practical.


                        
                        
                           
                           With known parameters, multivariate Kriging is not better than univariate Kriging.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Simulation

Stochastic processes

Multivariate statistics

@&#ABSTRACT@&#


               
               
                  To analyze the input/output behavior of simulation models with multiple responses, we may apply either univariate or multivariate Kriging (Gaussian process) metamodels. In multivariate Kriging we face a major problem: the covariance matrix of all responses should remain positive-definite; we therefore use the recently proposed “nonseparable dependence” model. To evaluate the performance of univariate and multivariate Kriging, we perform several Monte Carlo experiments that simulate Gaussian processes. These Monte Carlo results suggest that the simpler univariate Kriging gives smaller mean square error.
               
            

@&#INTRODUCTION@&#

In operations research (OR) practice, simulation is often applied. Simulation may be either deterministic or random (stochastic). Applications of deterministic simulation abound in engineering such as computer aided engineering (CAE), but there are also applications in OR as demonstrated by the following two examples. Example 1 concerns the management of fisheries at the French Research Institute for Exploitation of the Sea (IFREMER); see Mahevas and Pelletier (2004). Example 2 is the case study on the CO2 greenhouse effect by Kleijnen, Van Ham, and Rotmans (1992). Applications of random simulation are plentiful in OR, especially in queueing and inventory management; see the references in Kleijnen (2008, pp. 3–6).


                     Kriging model may be used to analyze the input/output (I/O) behavior of a given simulation model; this analysis may serve validation, sensitivity analysis, and optimization, as discussed by Kleijnen (2008). This Kriging gives a metamodel; i.e., it approximates the I/O function defined by the underlying simulation model. There are different types of metamodels; most popular is a polynomial of either first or second order; see Kleijnen (2008). We, however, focus on Kriging, which has already become popular in engineering and is gaining popularity in OR; see the many references in Chen, Ankenman, and Nelson (2012) and Kleijnen (2008). Most of this Kriging literature, however, ignores multivariate Kriging; also see our literature summary below.

In practice, a given simulation model has multiple outputs—also called responses or performance criteria. For example, Kleijnen (1993) discusses a case study on the production planning of steel tubes of different types, using a simulation model with 28 outputs which—after a discussion with management—were reduced to two outputs. Kleijnen and Smits (2003) discusses multiple performance metrics in supply chain management. The literature on metamodels, however, often reduces these multiple outputs to a single output—either ignoring all the other outputs or combining all outputs through a weighting function; in our Monte Carlo experiments (detailed In Section 4) we shall briefly discuss results for the sum and the product of two outputs. Other publications present metamodels per individual output ignoring the correlations between outputs; e.g., Kleijnen, Van Beers, and Van Nieuwenhuyse (2010) fit univariate Kriging models for each of the two outputs—namely, cost and service—of a call-center simulation. In all our Monte Carlo experiments we also apply such univariate Kriging—besides multivariate Kriging.

Intuitively, it may seem that multivariate Kriging gives a lower mean squared error (MSE) than univariate Kriging, because the former accounts for the cross-correlations between different output types, whereas the latter accounts only for the auto-correlations between outputs of the same type for different input combinations—as we shall explain in Sections 2 and 3. However we think this intuition may be misleading. In practice the Kriging parameters are unknown so they must be estimated, which increases the MSE; multivariate Kriging requires the estimation of additional parameters—namely, the cross-correlations—which further increases the MSE. Note that Hernandez and Grover (2013) also use the MSE criterion in their article on Kriging.

To empirically compare univariate and multivariate Kriging, we use Monte Carlo experiments that guarantee the validity of the Kriging metamodel. The literature usually experiments with realistic simulation models, but these experiments imply approximation errors (bias) of the Kriging metamodels. Moreover, these simulation models may be computationally expensive. We limit our investigation to Kriging in deterministic simulation, which is also the basis for Kriging in stochastic simulation.

Furthermore, we limit our first Monte Carlo experiments to situations with a single input and two outputs. Many OR problems do have a single input; examples are queueing simulation models with the traffic rate as the single input and inventory models such as the newsvendor problem with the order quantity as the single input. Moreover, Kriging in simulation usually assumes that in case of multiple inputs the correlation function is the product of the correlation functions per individual input; see Eq. (2). In this example we limit the number of multiple outputs to two; in case of more outputs, the cross-correlations are correlations between all pairs of outputs. We do vary the magnitudes of the cross-correlation between the two outputs. In the second example we base our Monte Carlo experiment on a climate simulation with five inputs and three outputs.

To provide some background for our study, we summarize the rather limited number of publications that explicitly discuss multiple outputs. This literature assumes different types of multivariate models; we distinguish the following three types:
                        
                           1.
                           In practice, simulation models may have (say) n types of output; each type is a specific transformation of the same input combination and the same pseudorandom number stream; in deterministic simulation, this stream vanishes. Software (such as Arena) for building and running discrete-event simulation models permits the automatic collection of multiple outputs. Not only simulation may give multiple outputs; real-life systems may too. This type is the focus of our study.

A given real system may be represented by n different simulation models with different degrees of realism (detail); so-called multi-fidelity simulation. We claim that this situation is extremely rare in OR. The simulation model with few details is run for many input combinations, whereas the detailed type is run for fewer combinations. Obviously, the most detailed simulation is the real system itself. See Santner, Williams, and Notz (2003), Forrester, Sobester, and Keane (2008), Goh et al. (2013), Tuo, Wu, and Yu (2013), and also “partially heterotropic” situations in Wackernagel (2003, p. 158).

Besides the output of interest, the modelers collect information on the gradient of this output. In discrete-event simulation, this type is rare, because the estimation of this gradient is complicated (it typically uses either “perturbation analysis” or the “score function” method). An example is Chen, Ankenman, and Nelson (2013). Obviously, the output and its gradient are estimated for the same input combinations.

For type-1 real-life systems, Cressie (1991, pp. 138–142) speaks of cokriging in his book on spatial data analysis. Wackernagel (2003, pp. 143–209) also discusses geostatistics, so he restricts the input data to one, two, or three dimensions (whereas simulation implies an arbitrary number of dimensions). Gneiting, Kleiber, and Schlather (2010) also discuss cokriging in geostatistics assuming so-called Matérn correlation functions. Santner et al. (2003, pp. 101–116) do discuss simulation or computer experiments, assume type-3 simulations. Higdon, Gattiker, Williams, and Rightley (2008) discuss the combination of real-life “field data” and simulation data, where both types of data concern the same real-life system so it concerns type-2 situations; they allow for very many types of output. Forrester (2010) also discusses type-2 situations; i.e., the combination of (i) scarce and expensive real-life data with abundant and inexpensive simulation data, or (ii) scarce and expensive data from a detailed simulation model with abundant and inexpensive data from a quick-and-dirty simulation model. Williams, Santner, Notz, and Lehman (2010) discuss multivariate Kriging in constrained optimization in simulation with multiple outputs—but they follow Santner et al. (2003). Altogether we recommend Santner et al. (2003) and Wackernagel (2003) for an introduction to multivariate Kriging. Note that Li, Azarm, Farhang-Mehr, and Diaz (2006) also recognize that in practice simulation models have multiple outputs and that Kriging is an important type of metamodel, but those authors use a completely different approach (they do not use cokriging with estimated cross-correlations).

Besides the areas of operations research (our focus), geostatistics, and engineering there is another area with major contributions to Kriging or Gaussian process (GP); namely machine learning; see Rasmussen and Williams (2005). Multivariate GPs are investigated in machine learning in multi-task learning, multi-sensor networks or structured output data. To obtain positive definite (PD) covariance matrixes, this community uses either so-called separable models or nonseparable models. The nonseparable models are based on either convolution method or the linear model of coregionalization (LMC). We define these different models in Section 3. Separable models for multi-task learning are used by Bonilla, Chai, and Williams (2007). Álvarez, Rosasco, and Lawrence (2011) show how several models in machine learning are special cases of LMC. In LMC, they use Cholesky’s decomposition of the cross-covariance matrix to construct a PD covariance matrix, and they show that the convolution method gives lower standardized mean square errors than LMC. Fricker, Oakley, and Urban (2010) present an LMC variant that uses eigendecomposition of the cross-covariance matrix to construct a PD covariance matrix. They show that their LMC variant gives a lower mean squared error than the convolution method. The convolution method is introduced to this community by Boyle and Frean (2005). The main disadvantage of this method are the computational and storage requirements. Álvarez and Lawrence (2011) propose a more efficient approximation for multivariate GPs constructed through the convolution method. This method does not spend much effort on accurate modeling of cross-covariance. To improve the accuracy in convolution method, more parameters are needed; Fricker et al. (2010) propose a new method that introduces such parameters. Note that Constantinescu and Anitescu (2013) specify the covariance matrixes imposing constraints originating from the physics laws that determine relationships among the outputs of their application; in OR, however, such knowledge is usually not available.

We summarize our article as follows. We consider multivariate Kriging model constructed through LMC which is proposed by Fricker et al. (2010). Furthermore, we interpret this novel Kriging model. We also present Monte Carlo results for the performance of this multivariate model and univariate Kriging per output. Using this Monte Carlo laboratory, we confirm previous results showing that multivariate Kriging does not provide improvements compared with univariate Kriging—even under ideal conditions. Svenson and Santner (2010) use Fricker et al. (2010)’s LMC for their multi-objective optimization problem; unlike we, they do not compare univariate and multivariate Kriging. Fricker et al. (2010) find that univariate Kriging always gives smaller RMSEs than multivariate Kriging. Fricker et al. (2010) suggest that if the output is a function of other outputs, then multivariate Kriging outperform univariate Kriging. We use the data in Fricker et al. (2010) only to select the parameters in our Monte Carlo experiment with a multivariate Kriging metamodel that has no specification errors; i.e., their Kriging metamodel is only an approximation of the true I/O function of their underlying simulation model, whereas multivariate Kriging in our Monte Carlo laboratory gives a metamodel without any bias. So, instead of selecting some arbitrary data that might accidentally favor or “bias” our methodology, we base our experiments on Fricker et al. (2010)’s data. Note that in an Appendix we give details, including several statistical tests for verifying the correctness of Monte Carlo experiments with Kriging; such tests are necessary because computer codes may contain unintended programming errors and peers should be enabled to reproduce results.

We organize the remainder of this article as follows. Section 2 summarizes the basics of univariate Kriging, including references to computational issues. Section 3 extends this Kriging to multivariate Kriging with nonseparable dependence structure, including technical details. Section 4 describes our Monte Carlo laboratory with GP models so the Kriging assumptions are guaranteed and we can use this laboratory to empirically compare univariate and multivariate Kriging. Section 5 presents conclusions and topics for future research. The references at the end of this article enable the reader to study more aspects of this challenging topic.

The various disciplines that apply Kriging, use different terminologies. We have already observed that geostatisticians speak of “sites”, whereas simulationists speak of “points” or “combinations”. In machine learning, the “old” points are called the “training set”. Simulationists use correlation functions, whereas geostatisticians use the related concept of variograms.

Our notation remains close to the notation in DACE—the free univariate MATLAB Kriging toolbox developed and well-documented by Lophaven, Nielsen, and Sondergaard (2002), assuming deterministic simulation. For the reader’s convenience, Appendix A includes Table A.1, summarizing the symbols used. Note that alternative free software is mentioned by Frazier (2010), Kleijnen (2008, p. 146), Roustant, Ginsbourger, and Deville (2012). Commercial software called JMP is offered by SAS. Several authors present a Bayesian interpretation of the Kriging model, but we follow a frequentist approach.

Suppose the given simulation model is run for m combinations of the k simulation inputs 
                        
                           x
                           =
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                     . These combinations are also called “locations” or “scenarios”; Lophaven et al. (2002) call them “sites”, which stems from the origin of Kriging; namely, geostatistics (Daniel Krige was a mining engineer in South Africa). Simulating these m input combinations gives the outputs 
                        
                           y
                           =
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                     .

Like most authors on Kriging in simulation, we assume Ordinary Kriging:
                        
                           (1)
                           
                              y
                              =
                              μ
                              +
                              z
                              ,
                           
                        
                     where 
                        
                           μ
                        
                      denotes the mean output, and z a stationary GP with zero mean. Because z is stationary, z has a constant—but unknown—variance 
                        
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                        
                     , and its covariances 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      
                     
                        
                           (
                           i
                           ,
                           
                              
                                 i
                              
                              
                                 ′
                              
                           
                           =
                           1
                           ,
                           …
                           ,
                           m
                           )
                        
                      between the outputs of the input combinations 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      are determined by the distance between 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ;
                                       k
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      in the k-dimensional input space (we use the symbol 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      instead of 
                        
                           
                              
                                 σ
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      because in multivariate Kriging 
                        
                           
                              
                                 σ
                              
                              
                                 g
                                 ;
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      refers to the covariances between the outputs of type g and 
                        
                           
                              
                                 g
                              
                              
                                 ′
                              
                           
                        
                     ). Kriging of simulation models with their possibly high-dimensional input space assumes that these covariances are the products of the k individual correlation functions; e.g., a so-called Gaussian correlation function implies
                        
                           (2)
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ;
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Π
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              exp
                              [
                              -
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          ;
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          ;
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              ]
                              ,
                           
                        
                     where 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           ⩾
                           0
                        
                      measures the importance of input 
                        
                           j
                           ;
                           
                              
                                 x
                              
                              
                                 j
                                 ;
                                 i
                              
                           
                        
                      is the ith entry of the jth simulation input; and 
                        
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          ;
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          ;
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      measures the distance in the input dimension j between the combinations i and 
                        
                           
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                     . Note that if 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           =
                           0
                        
                     , then changes in input j have no effect at all on the covariance 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     . If 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           =
                           ∞
                        
                     , then the covariance 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      reduces to zero, so the outputs at the locations i and 
                        
                           
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      are independent. The covariances 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      are gathered in the symmetric and positive-definite 
                        
                           m
                           ×
                           m
                        
                      covariance matrix 
                        
                           Σ
                        
                     , and the corresponding correlations 
                        
                           
                              
                                 c
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           /
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                        
                      are collected in 
                        
                           R
                        
                      so 
                        
                           Σ
                           =
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                           R
                        
                     . The two extreme values for the correlation coefficient (
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           =
                           0
                        
                      or 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           =
                           ∞
                        
                     ) give a singular covariance matrix, because this matrix has identical columns. Note that Simpson, Poplinski, Koch, and Allen (2001) claim that Ordinary Kriging defined in (1) with a Gaussian correlation function defined in (2) is the most common Kriging model in engineering.

The classic Kriging predictor assumes known (hyper) parameters 
                     
                        
                           μ
                        
                      and 
                        
                           Σ
                        
                     . Requiring the predictor to be linear and unbiased and using the mean squared prediction error (MSPE) criterion, the best linear unbiased predictor (BLUP) for the output 
                        
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                        
                      of 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      is
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              =
                              μ
                              +
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              y
                              -
                              μ
                              1
                              )
                              ,
                           
                        
                     where 
                        
                           1
                        
                      denotes the m-dimensional vector with ones; 
                        
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       0
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       0
                                       ;
                                       m
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      the vector with the covariances between the outputs at the new and the m old input combinations (so 
                        
                           Σ
                           =
                           (
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 m
                              
                           
                           )
                        
                      with vectors 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ;
                                       m
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                     ); and 
                        
                           (
                           y
                           -
                           μ
                           1
                           )
                        
                      the vector with residuals. Note that 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      denotes the “new” input combination; an alternative notation replaces the subscript 0 by 
                        
                           m
                           +
                           1
                        
                     . If 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      is actually one of the old points 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      (i
                     =
                     
                        
                           1
                           ,
                           …
                           ,
                           m
                        
                     ), then the predictor 
                        
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ^
                              
                           
                        
                      equals the observed output 
                        
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                        
                     ; i.e., Kriging gives an exact interpolator.

In practice, however, the parameters 
                        
                           μ
                        
                      and 
                        
                           Σ
                        
                      are unknown, so a major problem is their estimation. Note that 
                        
                           Σ
                        
                      includes the variance 
                        
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                        
                      on its main diagonal and the k parameters 
                        
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                        
                      assuming the Gaussian correlation function (2). Santner et al. (2003) use maximum likelihood estimation (MLE). Because z in (1) follows a GP, the density function (say) f of 
                        
                           y
                        
                      is
                        
                           (4)
                           
                              f
                              (
                              y
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       
                                          m
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             -
                                             μ
                                             1
                                             )
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       y
                                       -
                                       μ
                                       1
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    Σ
                                 
                              
                           
                        
                      denotes the determinant of 
                        
                           Σ
                        
                     . This density function is denoted by 
                        
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                           (
                           μ
                           ,
                           Σ
                           )
                        
                      with 
                        
                           μ
                           =
                           μ
                           1
                        
                     .

MLE minimizes the log-likelihood function 
                     
                        
                           l
                           (
                           Σ
                           ,
                           μ
                           |
                           y
                           )
                        
                     , while ignoring terms that do not depend on the parameters 
                        
                           μ
                        
                      and 
                        
                           Σ
                        
                      to be estimated; i.e., (4) implies
                        
                           (5)
                           
                              l
                              (
                              Σ
                              ,
                              μ
                              |
                              y
                              )
                              =
                              ln
                              
                                 
                                    
                                       Σ
                                    
                                 
                              
                              +
                              
                                 
                                    (
                                    y
                                    -
                                    μ
                                    1
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              y
                              -
                              μ
                              1
                              )
                              .
                           
                        
                     The resulting MLE estimators are denoted by 
                        
                           
                              
                                 Σ
                              
                              
                                 ^
                              
                           
                        
                      and 
                        
                           
                              
                                 μ
                              
                              
                                 ^
                              
                           
                        
                     . This minimization is a difficult mathematical problem. The classic solution in Kriging is to “divide and conquer” through the application of mathematical statistics, as follows.

We use 
                        
                           Σ
                           =
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                           R
                        
                      to replace 
                        
                           
                              
                                 
                                    Σ
                                 
                              
                           
                        
                      by 
                        
                           
                              
                                 
                                    R
                                 
                              
                           
                           
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 m
                              
                           
                        
                      and 
                        
                           
                              
                                 Σ
                              
                              
                                 -
                                 1
                              
                           
                        
                      by 
                        
                           
                              
                                 R
                              
                              
                                 -
                                 1
                              
                           
                           /
                           
                              
                                 σ
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                        
                     , and obtain
                        
                           (6)
                           
                              l
                              (
                              R
                              ,
                              μ
                              |
                              y
                              )
                              =
                              m
                              ln
                              
                                 
                                    σ
                                 
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              ln
                              
                                 
                                    
                                       R
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          (
                                          y
                                          -
                                          μ
                                          1
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    y
                                    -
                                    μ
                                    1
                                    )
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     Following Santner et al. (2003) and also Gano, Renaud, Martin, and Simpson (2006), we minimize this function in the following steps:
                        
                           1.
                           Initialize; i.e., select preliminary values for 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ^
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ^
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                ^
                                             
                                          
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                               which together define 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                              .

Compute the generalized least squares (GLS) estimator of the mean:
                                 
                                    (7)
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ^
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             1
                                             )
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       y
                                       .
                                    
                                 
                              
                           

Substitute 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ^
                                       
                                    
                                 
                               resulting from Step 2 and 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                               resulting from Step 1 into the variance estimate
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   y
                                                   -
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                   1
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             (
                                             y
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   ^
                                                
                                             
                                             1
                                             )
                                          
                                          
                                             m
                                          
                                       
                                       .
                                    
                                 
                              Note that 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                               uses the denominator m, whereas the classic unbiased estimator assuming 
                                 
                                    R
                                    =
                                    I
                                 
                               would use 
                                 
                                    m
                                    -
                                    1
                                 
                              .

Solve the remaining problem in (6):
                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                m
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            z
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ^
                                                   
                                                
                                                +
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Use the 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                               that solves (9) to update 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                              , and substitute the resulting 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                               into (7) and (8).

These estimated Kriging parameters result in the estimated MSPE or variance of the Kriging predictor (3):
                        
                           (10)
                           
                              
                                 
                                    MSPE
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                ^
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          1
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              .
                           
                        
                     Minimization problem defined in (9) is difficult because of “the multimodal and long near-optimal ridge properties of the likelihood function”; i.e., this problem is not convex; see Gano et al. (2006), Jones, Schonlau, and Welch (1998, p. 486), and Marrel et al. (2010, p. 5). The problem of a flat likelihood function leading to highly variable MLE is tackled by Li and Sudjianto (2005), adding a penalty function to the likelihood function.

In this section we consider 
                        
                           n
                           ⩾
                           1
                        
                      outputs for each of the m input combinations (type-1 model in Section 1); i.e., the simulation outputs become 
                        
                           
                              
                                 y
                              
                              
                                 i
                                 ;
                                 g
                              
                           
                        
                      
                     
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                           )
                        
                      
                     
                        
                           (
                           g
                           =
                           1
                           ,
                           …
                           ,
                           n
                           )
                        
                     . For the reader’s convenience, we collect symbols in the Appendices A and B including Tables A.1 and B.1. In multivariate Kriging, we can still use the multinormal density defined for the univariate case in (4)—provided we define the stacked vector (say) 
                        
                           Y
                        
                      with mn elements such that we first gather the n outputs at the first input combination 
                        
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       1
                                       ;
                                       n
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      (first row of Table B.1), then the n outputs at the second input combination 
                        
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                       ;
                                       n
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                     , etc., until finally the n outputs at the mth input combination 
                        
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       m
                                       ;
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       m
                                       ;
                                       n
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      (last row of Table B.1). Note that 
                        
                           
                              
                                 y
                              
                              
                                 g
                              
                           
                        
                      (output of type g with 
                        
                           g
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     ) has the constant mean 
                        
                           
                              
                                 μ
                              
                              
                                 g
                              
                           
                        
                      (see Table A.1). The resulting vector 
                        
                           Y
                        
                      has the multivariate normal density function 
                        
                           
                              
                                 N
                              
                              
                                 mn
                              
                           
                           (
                           μ
                           ,
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                           )
                        
                      where 
                        
                           μ
                        
                      denotes the mean vector with mn elements and 
                        
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                        
                      denotes the 
                        
                           mn
                           ×
                           mn
                        
                      covariance matrix of 
                        
                           Y
                        
                     :
                        
                           (11)
                           
                              f
                              (
                              Y
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       
                                          mn
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         Y
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             Y
                                             -
                                             μ
                                             )
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             Y
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       Y
                                       -
                                       μ
                                       )
                                    
                                 
                              
                              .
                           
                        
                     For 
                        
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                        
                      we offer the following comments.

In this section we discuss the general case with k inputs and n outputs (in Appendix C we detail the simplest multivariate Kriging example; namely, 
                        
                           k
                           =
                           1
                        
                      input and 
                        
                           n
                           =
                           2
                        
                      outputs). A stationary GP for each type of output implies that the output 
                        
                           
                              
                                 y
                              
                              
                                 g
                              
                           
                        
                      has the constant variance 
                        
                           
                              
                                 σ
                              
                              
                                 g
                              
                              
                                 2
                              
                           
                        
                      and (auto)covariances that decrease with the distance between its input combinations; again see (2). Moreover, in multivariate Kriging different output types 
                        
                           
                              
                                 y
                              
                              
                                 g
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                        
                      with 
                        
                           g
                           ;
                           
                              
                                 g
                              
                              
                                 ′
                              
                           
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                      and 
                        
                           g
                           
                           ≠
                           
                           
                              
                                 g
                              
                              
                                 ′
                              
                           
                        
                      have cross-covariances, when simulated for the same or for different input combinations; i.e., 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      may be the same as 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      or may be different. For example, if 
                        
                           n
                           =
                           2
                        
                      (bivariate output), then
                        
                           
                              Cov
                              (
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                cov
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                cov
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                cov
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                cov
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     If we have 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      in this example with n
                     =2, then the 
                        
                           2
                           ×
                           2
                        
                      matrix (say) 
                        
                           
                              
                                 Σ
                              
                              
                                 0
                              
                           
                        
                      does not vary with the input combination 
                        
                           x
                        
                      and becomes
                        
                           (12)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 σ
                              
                              
                                 1
                                 ;
                                 2
                              
                           
                           =
                           cov
                           (
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           )
                        
                     . In the general case with n outputs, the (symmetric) covariance matrix at input combination i 
                     
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                           )
                        
                      is
                        
                           (13)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                      ;
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                      ;
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                ⋱
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     So in the general case, 
                        
                           Y
                        
                      has the 
                        
                           mn
                           ×
                           mn
                        
                      covariance matrix
                        
                           (14)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                …
                                             
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋱
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                Cov
                                                (
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                Y
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     To predict the n outputs at input combination 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                     , we define—analogously to 
                        
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                        
                      defined below (3)—the 
                        
                           n
                           ×
                           mn
                        
                      matrix
                        
                           
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                    ;
                                    m
                                    ;
                                    n
                                 
                              
                              =
                              (
                              Cov
                              (
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              )
                              ,
                              …
                              ,Cov
                              (
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                              )
                              )
                              )
                              ,
                           
                        
                     and obtain—analogously to (3)—the multivariate BLUP
                        
                           (15)
                           
                              
                                 
                                    y
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    μ
                                 
                                 
                                    ^
                                 
                              
                              +
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                    ;
                                    m
                                    ;
                                    n
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              Y
                              -
                              F
                              
                                 
                                    μ
                                 
                                 
                                    ^
                                 
                              
                              )
                              ,
                           
                        
                     where the vector 
                        
                           
                              
                                 μ
                              
                              
                                 ^
                              
                           
                        
                     —analogously to (7)—denotes the GLS estimator
                        
                           (16)
                           
                              
                                 
                                    μ
                                 
                                 
                                    ^
                                 
                              
                              =
                              (
                              
                                 
                                    F
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    F
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                                 
                                    -
                                    1
                                 
                              
                              Y
                              ,
                           
                        
                     with 
                        
                           F
                           =
                           
                              
                                 1
                              
                              
                                 m
                              
                           
                           ⊗
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                        
                      where 
                        
                           
                              
                                 1
                              
                              
                                 m
                              
                           
                        
                      denotes an m-dimensional vector with ones, 
                        
                           ⊗
                        
                      the Kronecker operator, and 
                        
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                        
                      the 
                        
                           n
                           ×
                           n
                        
                      unity matrix; also see Svenson and Santner (2010).

The estimated MSPE of the multivariate Kriging predictor (15) is
                        
                           (17)
                           
                              
                                 
                                    MSPE
                                 
                                 
                                    ^
                                 
                              
                              [
                              
                                 
                                    y
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              ]
                              =
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          0
                                          ;
                                          m
                                          ;
                                          n
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                Y
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                0
                                                ;
                                                m
                                                ;
                                                n
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              +
                              U
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                   
                                                      ^
                                                   
                                                
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          F
                                       
                                    
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     with 
                        
                           U
                           =
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                           -
                           
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       0
                                       ;
                                       m
                                       ;
                                       n
                                    
                                 
                              
                              
                                 ^
                              
                           
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             Y
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 )
                              
                              
                                 -
                                 1
                              
                           
                           F
                        
                     .

Now we consider one particular way to obtain a 
                        
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                        
                      that is PD. Our formalization follows the nonseparable dependence model in Svenson and Santner (2010), who in turn follow Fricker et al. (2010), who precede Fricker, Oakley, and Urban (2013). Fricker et al. (2010) explain both nonseparable models and separable models. Separable models assume 
                        
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                           =
                           
                              
                                 Σ
                              
                              
                                 0
                              
                           
                           R
                        
                      where we defined the cross-covariance matrix 
                        
                           
                              
                                 Σ
                              
                              
                                 0
                              
                           
                        
                      in (13) and the auto-covariance matrix 
                        
                           R
                        
                      below (2); i.e., separable models assume that the matrix 
                        
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                        
                      can be separated into two components with the second component implying that all outputs have the same auto-correlation matrix. Moreover, Fricker et al. (2010) show that separable models have an undesirable so-called Markov property; see Eq. (6) in Fricker et al. (2010) or Eq. (4) in Fricker et al. (2013). An example of a separable model is Zhang (2007). Furthermore Fricker et al. (2010, 2013) discuss how nonseparable models may be created through either convolution method or LMC. These former methods convolve a Gaussian white noise process with a smoothing kernel; see Ver Hoef and Barry (1998) and Higdon (2002). Moreover, Fricker et al. (2010) present empirical results that suggest that convolution method gives worse results than LMC, so we limit our research to LMC. Originally, geostatistics uses LMC to model spatial multivariate processes, see Wackernagel (2003, pp. 194–200). In LMC the output process is a linear combination of building-block processes. Fricker et al. (2010) use an LMC with n blocks. Here we detail LMC following Fricker et al. (2010).

Obviously, an n-variate Gaussian variable with mean vector 
                        
                           μ
                        
                      and covariance matrix 
                        
                           Σ
                        
                      may be generated from a vector 
                        
                           Z
                        
                      with n normally independently identically distributed (NIID) “standard” variables (which have zero means and unit variances) through 
                        
                           μ
                           +
                           AZ
                        
                      with 
                        
                           Σ
                           =
                           
                              
                                 AA
                              
                              
                                 ⊤
                              
                           
                        
                      where 
                        
                           A
                        
                      is a symmetric matrix. Svenson and Santner (2010) extend this idea, and consider
                        
                           (18)
                           
                              Y
                              =
                              μ
                              +
                              AZ
                              ,
                           
                        
                     where 
                        
                           Y
                        
                      denotes the n-variate output at any input combination, 
                        
                           μ
                           =
                           
                              
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      is the vector of GP means, 
                        
                           A
                           =
                           (
                           
                              
                                 a
                              
                              
                                 g
                                 ;
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                        
                      is a symmetric and PD matrix, and 
                        
                           Z
                        
                      is a vector of mutually independent stationary GPs with zero mean and unit variance. More precisely, 
                        
                           Z
                        
                      has the Gaussian correlation function defined in (2). It is simple to derive that (18)—together with 
                        
                           R
                        
                      defined below (2) and defining 
                        
                           
                              
                                 θ
                              
                              
                                 (
                                 l
                                 )
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      with l
                     =1,…,
                     n—implies
                        
                           (19)
                           
                              Cov
                              (
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                              )
                              =
                              A
                              diag
                              [
                              R
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              )
                              ,
                              …
                              ,
                              R
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              )
                              ]
                              
                                 
                                    A
                                 
                                 
                                    ⊤
                                 
                              
                              .
                           
                        
                     We point out that we stack the covariance matrixes per input combination, not per output. If 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     , then (2) gives 
                        
                           exp
                           [
                           -
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       ;
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       ;
                                       
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                           ]
                           =
                           1
                        
                      so (19) implies that 
                        
                           
                              
                                 Σ
                              
                              
                                 0
                              
                           
                        
                     —defined in (13)–becomes
                        
                           (20)
                           
                              Cov
                              (
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    AA
                                 
                                 
                                    ⊤
                                 
                              
                              .
                           
                        
                     Hence, 
                        
                           
                              
                                 σ
                              
                              
                                 g
                                 ;
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      (covariance between 
                        
                           
                              
                                 y
                              
                              
                                 g
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     ) and 
                        
                           
                              
                                 σ
                              
                              
                                 g
                                 ;
                                 g
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 g
                              
                              
                                 2
                              
                           
                        
                      (variance of 
                        
                           
                              
                                 y
                              
                              
                                 g
                              
                           
                        
                     ) are
                        
                           (21)
                           
                              
                                 
                                    σ
                                 
                                 
                                    g
                                    ;
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    g
                                    ;
                                    l
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                    ;
                                    l
                                 
                              
                              (
                              g
                              ,
                              
                                 
                                    g
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              ,
                              …
                              ,
                              n
                              )
                              .
                           
                        
                     For example, for 
                        
                           n
                           =
                           2
                        
                      we get (remember that 
                        
                           A
                        
                      is symmetric so 
                        
                           
                              
                                 a
                              
                              
                                 g
                                 ;
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           
                              
                                 a
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                                 ;
                                 g
                              
                           
                        
                     )
                        
                           (22)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Note that each element 
                        
                           
                              
                                 a
                              
                              
                                 g
                                 ;
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      (
                        
                           =
                           
                              
                                 a
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                                 ;
                                 g
                              
                           
                        
                     ) affects the two variances and the covariance; we shall detail this characteristic in the next section. If we assume the Gaussian correlation function (2) and a single input x, then (19) becomes 
                        
                           R
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           -
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           ;
                           
                              
                                 θ
                              
                              
                                 (
                                 g
                                 )
                              
                           
                           )
                           =
                           exp
                           [
                           -
                           
                              
                                 θ
                              
                              
                                 (
                                 g
                                 )
                              
                           
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                           ]
                           =
                           exp
                           [
                           -
                           
                              
                                 θ
                              
                              
                                 (
                                 g
                                 )
                              
                           
                           
                              
                                 d
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 2
                              
                           
                           ]
                        
                      with 
                        
                           
                              
                                 d
                              
                              
                                 i
                                 ;
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      so we get
                        
                           
                              Cov
                              [
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                              ]
                              =
                              A
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     so 
                        
                           Cov
                           [
                           Y
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           ,
                           Y
                           (
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                           ]
                        
                      is
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      1
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                      ;
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                      ;
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                R
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      ;
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Following Fricker et al. (2010) and Svenson and Santner (2010), we select 
                        
                           A
                        
                      as the eigendecomposition of 
                        
                           
                              
                                 Σ
                              
                              
                                 0
                              
                           
                        
                      while guaranteeing that 
                        
                           A
                        
                      is PD. We therefore use the Cholesky transformation, 
                        
                           A
                           =
                           
                              
                                 LL
                              
                              
                                 ⊤
                              
                           
                        
                     . We should ensure that all the elements on the main diagonal of 
                        
                           L
                        
                      are non-negative; i.e., we should impose the constraint 
                        
                           
                              
                                 l
                              
                              
                                 i
                                 ;
                                 i
                              
                           
                        
                      
                     
                        
                           ⩾
                        
                     0 (i
                     =1,…,
                     n) in the MLE optimization.

Actually, Svenson and Santner (2010) apply Restricted MLE (RMLE) instead of MLE (for details on RMLE see Santner et al. (2003, pp. 66–67)). The RMLE 
                        
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                        
                      (which must be PD) and 
                        
                           
                              
                                 Θ
                              
                              
                                 ^
                              
                           
                        
                      (the multivariate analogue of 
                        
                           
                              
                                 θ
                              
                              
                                 ^
                              
                           
                        
                      defined below (6) in Step 1) minimize the following analogue of (6):
                        
                           (24)
                           
                              l
                              (
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                              
                              ,
                              μ
                              |
                              Y
                              )
                              =
                              ln
                              
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             Y
                                          
                                       
                                    
                                 
                              
                              +
                              ln
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             Y
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       F
                                    
                                 
                              
                              +
                              
                                 
                                    (
                                    Y
                                    -
                                    F
                                    
                                       
                                          μ
                                       
                                       
                                          ^
                                       
                                    
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              Y
                              -
                              F
                              
                                 
                                    μ
                                 
                                 
                                    ^
                                 
                              
                              )
                              .
                           
                        
                     In our next Monte Carlo experiments we shall use RMLE for univariate and multivariate Kriging for better comparison of the two methods. RMLE for univariate Kriging requires replacing m by 
                        
                           m
                           -
                           1
                        
                      in (6), (8), and (9).

First we explain why we need a laboratory instead of real applications. Kriging is based on specific assumptions; e.g., Kriging assumes a GP. To analyze the performance of the resulting Kriging procedure, we should start with situations that satisfy these assumptions; a “laboratory” can fully satisfy all our assumptions. Real applications enable us to study the “robustness” of the Kriging method; i.e., how well does the method perform if not all its assumptions are completely satisfied? However, before we perform such robustness studies, we should examine the performance of Kriging in the case where all assumptions do hold. Moreover, real applications may be extremely expensive; i.e., a single simulation run may take hours or days, whereas in our lab a “simulation” run takes only (micro) seconds (depending on the computer hardware and software).

Kriging literature derives formulas for the estimated variance of the predictor in univariate and multivariate Kriging respectively. These formulas are popular, but we do not use them to compare univariate and multivariate Kriging because we estimate the MSE from the known I/O function for the simple systems that we simulate in our lab. Moreover, these formulas are biased because they ignore the variability caused by the estimation of the parameters of the GP; see Den Hertog, Kleijnen, and Siem (2006) and Kleijnen and Mehdad (2013).

To compare multivariate and univariate Kriging, we use the MSE criterion; this criterion gives the “optimal” Kriging predictor defined in (3), and is relevant in sensitivity analysis (not optimization) of simulation models. Furthermore, in our first example (Section 4.1) we briefly consider a second criterion; namely, the coverage of the 90% confidence interval for the predictor in univariate versus multivariate Kriging. Fricker et al. (2010) also use criteria closely related to our two criteria.

We wish to guarantee that the Kriging metamodel itself is a valid metamodel of the I/O function implied by the underlying simulation model. Therefore we generate the “simulation” observations 
                        
                           Y
                        
                      from 
                        
                           
                              
                                 N
                              
                              
                                 mn
                              
                           
                           (
                           μ
                           ,
                           
                              
                                 Σ
                              
                              
                                 Y
                              
                           
                           )
                        
                      defined in (11), to obtain the I/O data; these data are detailed in Table B.1 in Appendix B. To these I/O data we apply univariate and multivariate Kriging respectively, and compare their MSEs. Note that a similar Monte Carlo lab is used by Chen et al. (2012) for the “empirical evaluation” of their stochastic Kriging. In Section 4.1 we present a simple Monte Carlo example; in Section 4.2, we present a more complicated example.

After we specify that our lab consists of a GP, we must select values for the parameters 
                           
                              μ
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                              
                           
                         in 
                           
                              
                                 
                                    N
                                 
                                 
                                    mn
                                 
                              
                              (
                              μ
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                              
                              )
                           
                        . In our simple example we specify a bivariate output so 
                           
                              n
                              =
                              2
                           
                         and a single input so k
                        =1. To generate “simulation” data, we select m
                        =10 “old” I/O combinations; m
                        =10 agrees with the value 
                           
                              10
                              k
                           
                         often recommended in the literature; also see the “practical guidelines” in Loeppky, Sacks, and Welch (2009). Because space-filing designs are most popular in Kriging, we select these m values equi-spaced in the standardized experimental domain 0 
                           
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              1
                           
                        . Consequently, we get 
                           
                              
                                 
                                    x
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              
                                 
                                    (
                                    0
                                    ,
                                    1
                                    /
                                    9
                                    ,
                                    2
                                    /
                                    9
                                    ,
                                    …
                                    ,
                                    8
                                    /
                                    9
                                    ,
                                    1
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . We decide to predict the simulation outputs for 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                         “new” input values each halfway its two immediate neighbors, so we get 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              =
                              9
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              
                                 
                                    (
                                    1
                                    /
                                    18
                                    ,
                                    3
                                    /
                                    18
                                    ,
                                    …
                                    ,
                                    17
                                    /
                                    18
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . When we sample the GP, we should also sample the “true” simulation outputs at these new input values 
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                                 
                                    ⊤
                                 
                              
                           
                        ; i.e., we sample 10+9=19 bivariate outputs:
                           
                              (25)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       38
                                       ×
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               1
                                                               ;
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               1
                                                               ;
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               19
                                                               ;
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               19
                                                               ;
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∼
                                 
                                    
                                       N
                                    
                                    
                                       (
                                       38
                                       ×
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                (
                                                38
                                                ×
                                                1
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                Σ
                                             
                                             
                                                (
                                                38
                                                ×
                                                38
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Furthermore, we select all n
                        =2 means equal to zero so in (25) we have 
                           
                              
                                 
                                    μ
                                 
                                 
                                    (
                                    38
                                    ×
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    (
                                    0
                                    ,
                                    …
                                    ,
                                    0
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . We wish to experiment with “high” and “low” values for the variances 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                        . A problem, however, is that in the nonseparable dependence model, the variances—and cross-covariances and auto-covariances—depend on A in (19). In our experiments with two outputs, the values we select for the variances and the cross-covariance together with (22) imply
                           
                              (26)
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        so the three variables 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                    ;
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    a
                                 
                                 
                                    1
                                    ;
                                    2
                                 
                              
                           
                         (
                           
                              =
                              
                                 
                                    a
                                 
                                 
                                    2
                                    ;
                                    1
                                 
                              
                           
                        ), and 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                    ;
                                    2
                                 
                              
                           
                         must satisfy three equations. We select 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                        , 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              25
                           
                         (so 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        =5, which quantifies variability better than its square, 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                        ), and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                    ;
                                    2
                                 
                              
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    ;
                                    2
                                    )
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        
                        =1 so 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    ;
                                    2
                                    )
                                 
                              
                           
                        
                        =0.2 and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                    ;
                                    2
                                 
                              
                           
                        
                        =4 so 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    ;
                                    2
                                    )
                                 
                              
                           
                        
                        =0.8; i.e., in our experiments we keep 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         fixed, while we experiment with a low and a high cross-correlation (the cross-correlation remains constant across input combinations). For the auto-covariances we assumed a Gaussian auto-correlation function and a single input, as derived in (23). In (23) we have already selected all elements of 
                           
                              A
                           
                        (namely, 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                    ;
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    a
                                 
                                 
                                    1
                                    ;
                                    2
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    2
                                    ;
                                    1
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                    ;
                                    2
                                 
                              
                           
                        ) when selecting the variances and the cross-correlation. To further simplify our selection, we select equal Kriging parameters 
                           
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              =
                              θ
                           
                         for the two outputs; this changes 
                           
                              Cov
                              [
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              Y
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                              ]
                           
                         in (23) into
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   R
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                         ;
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ;
                                                   θ
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                   
                                                   )
                                                   R
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                         ;
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ;
                                                   θ
                                                   )
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ;
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                   
                                                   )
                                                   R
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                         ;
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ;
                                                   θ
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ;
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   R
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                         ;
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ;
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        We wish to experiment with low and high auto-correlations. The Gaussian auto-correlation function (2) implies that 
                           
                              cor
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                    ;
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ;
                                    1
                                 
                              
                              )
                              =
                              exp
                              [
                              -
                              θ
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                        . Obviously, these correlations decrease with the distance 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ;
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . These distances 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ;
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         vary with m (number of old equidistant input values in the experimental range) and the 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                         new input values to be predicted (which we selected halfway the old values). Given the input range 
                           
                              0
                              ⩽
                              x
                              ⩽
                              1
                           
                        , these distances range between 
                           
                              1
                              /
                              [
                              (
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              )
                              /
                              2
                              ]
                              =
                              1
                              /
                              18
                           
                         (closest neighbors) and 1 (neighbors farthest apart). We decide to focus on the strongest auto-correlation between old input values 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              )
                              =
                              exp
                              [
                              -
                              θ
                              /
                              
                                 
                                    9
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                        ; e.g., 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              )
                           
                        
                        =0.2 implies—after rounding—
                           
                              θ
                           
                        
                        =131 and 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              )
                           
                        
                        =0.8 implies 
                           
                              θ
                              =
                              18
                           
                        , which are far away from the two extreme values 0 and 
                           
                              ∞
                           
                         discussed below (2). Altogether, Table 1
                         displays our four experiments combining “low” and “high” values for the cross-correlation 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    ;
                                    2
                                    )
                                 
                              
                           
                         and the maximum auto-correlation for output g denoted by 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              )
                           
                         with g
                        =1, 2. Note that Table 1 excludes zero or negative cross-correlations. We exclude zero correlation because discrete-event simulation with multiple outputs always gives correlated outputs as these outputs are driven by the same pseudorandom numbers. We exclude negative correlations, because the OR analysts usually know the signs of the correlations between the outputs of their simulation models; e.g., in queuing simulation, the average of the waiting time distribution and (say) the 90% quantile of that distribution are obviously positively correlated. If the analysts know that the correlation between two specific outputs is negative, then they simply take the negative values of one of these two outputs to make the correlation positive.

We decided to obtain M
                        =100 macro-replicates; i.e., we repeat our sampling—from the four different GPs in Table 1—100 times using non-overlapping pseudo-random number streams. We use these macro-replicates, to verify our computer code; i.e., we statistically test various intermediate results; namely, the means, variances, auto-correlations, and cross-correlations of the simulated bivariate GP output (25). This verification is detailed in Appendix D.

In practice, the simulation analysts have only “a single macro-replicate” to compute the RMLEs 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ^
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ^
                                 
                              
                           
                        . In nonseparable multi-variate Kriging, these RMLEs are based on the likelihood function (24). This function may have many local maxima so the search for these RMLEs may get stuck on a local hill. To get initial estimates of 
                           
                              
                                 
                                    A
                                 
                                 
                                    ^
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Θ
                                 
                                 
                                    ^
                                 
                              
                           
                        , Svenson (2011, pp. 314–315) uses a global optimizer; namely, the genetic algorithm (GA) in Forrester (2010); to get final estimates, he uses MATLAB’s “fmincon”. In our first Monte Carlo example, we use DACE for univariate Kriging; we combine DACE with the same GA and bounds that Svenson uses.

Given these RMLEs computed from the “old” I/O data, we can predict the output for one of the new points (say) 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         with 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                        ; i.e., in (3) we replace the unknown parameters by their RMLEs, which gives (say) 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        . We compare this predicted value 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         with the “observed” value 
                           
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        ; the latter value is conditional on the m old observed values 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         because of (25), which uses the true parameters instead of their RMLEs. This gives the squared error (SE) at the new input value 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           
                         for output g in macro-replicate r where in this example n
                        =2, m
                        =10, M
                        =100:
                           
                              (27)
                              
                                 
                                    
                                       SE
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ;
                                       r
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ;
                                                               r
                                                            
                                                            
                                                               (
                                                               g
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   ^
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ;
                                                   r
                                                
                                                
                                                   (
                                                   g
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 with
                                 
                                 (
                                 g
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 )
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 (
                                 r
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 )
                                 .
                              
                           
                        Because we predict the output for 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                         new input combinations, we use this equation to compute the estimated integrated MSE (IMSE) for output g:
                           
                              
                                 
                                    
                                       
                                          
                                             IMSE
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             g
                                             )
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             SE
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ′
                                                
                                             
                                             ;
                                             r
                                          
                                          
                                             (
                                             g
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Next we use this 
                           
                              
                                 
                                    
                                       
                                          IMSE
                                       
                                       
                                          r
                                       
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         to compute its average over the M macro-replicates:
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   IMSE
                                                
                                                
                                                   (
                                                   g
                                                   )
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             
                                                
                                                   IMSE
                                                
                                                
                                                   r
                                                
                                                
                                                   (
                                                   g
                                                   )
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                                 .
                              
                           
                        
                     


                        Table 2
                         gives this average for univariate and multivariate Kriging, for the two outputs of our four experiments defined in Table 1. The standard errors—displayed in parentheses below the averages—show that the reported averages are quite accurate after M
                        =100 macro-replicates. All eight differences between these averages for univariate and multivariate Kriging—denoted by Difference in the table—are non-significant, where our null-hypothesis is that there is no difference between the MSEs of univariate and multivariate Kriging, for both responses and all four experiments. This significance we test through the t-statistic for differences estimated from correlated observations (caused by common random numbers used by the four experiments). We use an experimentwise type-I error rate 
                           
                              α
                           
                        
                        =0.20 combined with Bonferroni’s inequality so the “per comparison” error rate is 
                           
                              (
                              α
                              /
                              2
                              )
                              /
                              8
                           
                        
                        =0.0125. Furthermore, the point estimates show that univariate Kriging gives a smaller MSE for output 1 in all four experiments; for output 2 with its higher variance, univariate Kriging gives smaller MSE in two out of four experiments.

Comparisons of rows instead of columns in Table 2 shows that the averages are much bigger in rows 2 and 4. Table 1 shows that rows 2 and 4 have a lower value for the auto-correlation; obviously, such a low auto-correlation implies that the Kriging predictor for a new point is less accurate when taking a weighted average of the old simulation outputs (the Kriging predictor is indeed a weighted average with weights determined by the distances between the new point and the old points). These differences between rows are so big that we do not need a statistical test to conclude that these differences are important. To explain the results in Table 2, we compute t-statistics from the M
                        =100 RMLEs for the Kriging parameters 
                           
                              (
                              
                                 
                                    μ
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    g
                                    ;
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                           
                         where 
                           
                              
                                 
                                    σ
                                 
                                 
                                    g
                                    ;
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                        =0 in univariate Kriging. Our null-hypothesis 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                           
                         states that the expected value of a RMLE equals the true value of the corresponding Kriging parameter; e.g., 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              :
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    g
                                 
                              
                           
                        . Table 3
                         shows whether such a t-test rejects 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                           
                        ; i.e., the superscript 
                           
                              ∗
                           
                         denotes that the t-statistic is significant at the 5% significance level. This table implies that for univariate Kriging we should reject 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                           
                         only for 
                           
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                           
                        , whereas for multivariate Kriging we should reject 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                           
                         for 
                           
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    σ
                                 
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    g
                                    ;
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        . So multivariate Kriging gives inaccurate estimates of the Kriging parameters. These inaccurate estimates may result from the search in a space with more dimensions when solving a nonconvex problem. Svenson and Santner (2010) also mention that RMLE in multivariate Kriging requires a search in higher dimensions than univariate Kriging does, because the latter assumes zero cross-correlations; so the former search might actually result in poor estimates of the Kriging parameters. Svenson and Santner (2010) and Fricker et al., 2010 give numerical results for several examples suggesting that multivariate Kriging may not improve MSE dramatically relative to application of univariate Kriging to multiple outputs. To further investigate these numerical results, we run univariate and multivariate Kriging with the true Kriging parameters—which is easy in Monte Carlo experiments and impossible in real experiments. We point out that univariate Kriging uses 100% accurate information on 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        , but that information is incomplete because it ignores the cross-correlations 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                          ;
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         and consequently univariate Kriging uses the wrong 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        . The “old” and “new” outputs vary over the M macro-replicates, because they are sampled from (25). This gives Table 4
                        , which displays the average performance defined in (28); this performance is the same for univariate and multivariate Kriging. Comparing this table with Table 2 shows that the performance is better when using the true Kriging parameters instead of their RMLEs, as we expected. However, IMSEs in Table 4 are not significantly better than IMSEs in Table 2. To explain that in this example univariate and multivariate Kriging give the same performance when they use the true Kriging parameters, we study the only difference between univariate and multivariate Kriging; namely, 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    0
                                    ;
                                    m
                                    ;
                                    n
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    Y
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         in (15). Univariate Kriging assumes zero cross-covariances. We find that the corresponding elements in multivariate Kriging—using the true Kriging parameters—are virtually zero. For example, when predicting the output for the first element of 
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              
                                 
                                    (
                                    1
                                    /
                                    18
                                    ,
                                    3
                                    /
                                    18
                                    ,
                                    …
                                    ,
                                    17
                                    /
                                    18
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                           
                         in macro-replicate 1 of experiment 1 (with 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    :
                                    2
                                    )
                                 
                              
                           
                        
                        =0.8), multivariate Kriging gives values between 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    16
                                 
                              
                           
                         and 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    13
                                 
                              
                           
                        . We also compute these values for 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    1
                                    :
                                    2
                                    )
                                 
                              
                           
                        
                        =0.95 and again find virtually zero values; detailed results are given in Table E.1 of Appendix E. These results are typical for this example; i.e., in the more realistic example of Section 4.2 we shall find different results.

Our conclusion is that univariate Kriging is simpler than multivariate Kriging, and that multivariate Kriging does not perform better than univariate Kriging, even when multivariate Kriging would know the true GP parameters.

Besides the MSE, Fricker et al. (2010) study the coverage of the confidence interval of the Kriging predictor. A popular 90% two-sided confidence intervals for 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ;
                                                r
                                             
                                             
                                                (
                                                g
                                                )
                                             
                                          
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         is
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ;
                                                   r
                                                
                                                
                                                   (
                                                   g
                                                   )
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 ±
                                 1.64
                                 
                                    
                                       
                                          
                                             MSPE
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ′
                                                
                                             
                                             ;
                                             r
                                          
                                          
                                             (
                                             g
                                             )
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 1.64 is the 0.95 quantile of the standard Gaussian density and 
                           
                              
                                 
                                    MSPE
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ;
                                    r
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                           
                         follows from (10) and (17). Obviously, for given 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           
                         and g values, macro-replicate r gives an interval that does or does not cover the true value 
                           
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ;
                                    r
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                           
                        ; from the M macro-replicates we compute the estimated coverage. The coverage of this 90% confidence interval turns out to be too low, for any t and g (box plots are available from the authors). This low coverage may be caused by the classic variance of the Kriging predictor, which ignores consequences of estimating the Kriging parameters; see again Den Hertog et al. (2006) and Kleijnen and Mehdad (2013).

Finally, Fricker et al. (2010) suggest that the relative performance of multivariate Kriging may improve when “the” output is a function of the individual cross-correlated outputs. Therefore we also experiment with the sum and the product, 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    4
                                    )
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                           
                        . Appendix F (Table F.1) suggests that univariate Kriging gives smaller MSE for all n
                        =4 outputs and all four experiments in Table 1 except for 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    4
                                    )
                                 
                              
                           
                         in experiment 1. Univariate Kriging gives better coverage than multivariate Kriging, but still below the nominal value. Note that we do know the true values of the Kriging parameters for 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                           
                        , but not for 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    4
                                    )
                                 
                              
                           
                        . Furthermore, there are more Kriging parameters to be estimated; namely, 
                           
                              
                                 
                                    σ
                                 
                                 
                                    g
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              g
                              ,
                              
                                 
                                    g
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                              ,
                              …
                              ,
                              n
                              =
                              4
                              )
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    g
                                    )
                                 
                              
                           
                        . The Appendix (Table F.2) suggests that multivariate Kriging has more significant differences between the estimated and the true parameter values.

In this subsection we summarize our second type of Monte Carlo example; namely, an example with d
                        =5 inputs and n
                        =3 outputs that is inspired by the simple climate model (SCM) case study in Fricker et al. (2010). For this example we select m
                        =57 old I/O data 
                           
                              (
                              X
                              ,
                              W
                              )
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                           
                        
                        =93 new data 
                           
                              (
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    W
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        ; these data we received from one of the coauthors (namely, Urban). For our Kriging computations we use Svenson’s code. So, from the old data 
                           
                              (
                              X
                              ,
                              W
                              )
                           
                         we compute 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    ^
                                 
                              
                           
                        , the RMLE of the GP parameters. This 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    ^
                                 
                              
                           
                         has 24 elements; namely, the three means 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         (g
                        =1, 2, 3), the three variances 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        , the 
                           
                              5
                              ×
                              3
                              =
                              15
                           
                         auto-correlations 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         (j
                        =1,…,
                        d
                        =5), and the three cross-covariances 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                          ;
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        .

We observe that the three outputs have indeed positive cross-correlations; i.e., from the simulation outputs 
                           
                              W
                           
                         we compute the classic estimates which do not assume a GP:
                           
                              (29)
                              
                                 
                                    
                                       r
                                    
                                    
                                       (
                                       g
                                       ;
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             (
                                             g
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   (
                                                   g
                                                   )
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                    
                                    
                                       m
                                    
                                 
                                 .
                              
                           
                        This gives 
                           
                              
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    ;
                                    2
                                    )
                                 
                              
                           
                        
                        =0.47, 
                           
                              
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    ;
                                    3
                                    )
                                 
                              
                           
                        
                        =0.55, and 
                           
                              
                                 
                                    r
                                 
                                 
                                    (
                                    2
                                    ;
                                    3
                                    )
                                 
                              
                           
                        
                        =0.80; these estimates are scale-free. The estimates (29) should be distinguished from 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          g
                                          ;
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        , which denote the RMLE computed for the multivariate GP with scaled old data. These computations give 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          1
                                          ;
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        
                        =0.50, 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          1
                                          ;
                                          3
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        
                        =0.53, and 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          2
                                          ;
                                          3
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        
                        =0.82, which agree very well with the classic estimates.

Because we scale the I/O data, the simulation outputs have zero means. The n
                        =3 estimated GP means 
                        
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         turn out to be virtually zero, in both multivariate and univariate Kriging. For the computations of univariate Kriging we apply Svenson’s code per output, ignoring cross-correlations; i.e., assuming these correlations are zero. The estimated variances in multivariate Kriging 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         are 5.98, 3.48, and 3.62; i.e., output 1 has a bigger variance. We point out that univariate Kriging gives different estimates; namely, 6.38, 4.29, and 7.09; we emphasize that univariate Kriging assumes zero cross-variances so it is to be expected that its variance estimates are different. The 15 estimated auto-correlation coefficients 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         differ in multivariate Kriging and univariate Kriging.

In our second Monte Carlo example, the true GP is the GP with the parameters that we estimated for the SCM case study using multivariate Kriging; e.g., 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          1
                                          ;
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        
                        =0.50. Analogous to (25) we sample 
                           
                              Y
                           
                         from the multivariate normal distribution; this 
                           
                              Y
                           
                         has 
                           
                              (
                              57
                              +
                              93
                              )
                              ×
                              3
                           
                        
                        =450 elements. This gives the IMSE defined analogously to (28). We use M
                        =30 macro-replicates, which require approximately 15hours of computer time on our PC. Comparing columns 2 and 4 of Table 5
                         shows that univariate Kriging gives a much smaller MSE than multivariate Kriging. Like we do in our first Monte Carlo experiment, we also compute the IMSE assuming true GP parameters 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                          ;
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                        ; notice that 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    ^
                                 
                              
                           
                         is computed through (16). Comparing columns 2 and 3 shows that using these true parameters drastically decreases the IMSE of multivariate Kriging. Comparing columns 3 and 4 shows that multivariate Kriging with true GP parameters does not give a smaller IMSE than univariate Kriging with estimated parameters. Comparison of these two columns shows that multivariate Kriging’s inferior performance is not due to the estimation of more parameters. We conjecture that multivariate Kriging suffers from an inherent bad property—like separable models, which have the Markov property, which implies that the cross-covariance between the outputs does not help. Comparing columns 3 and 5 shows that using the true parameters gives univariate Kriging with higher IMSE than multivariate Kriging; in Section 4.1 we have already pointed out that univariate Kriging uses 100% accurate but incomplete information on the GP parameters. We point out that the first example used assumptions so simplistic that univariate Kriging was not affected by the incompleteness of the information on the RMLE of the GP parameters.

In this article we compare univariate and multivariate Kriging metamodels for simulation models with multiple outputs. A major problem of multivariate Kriging is ensuring that the (symmetric) covariance matrix of all the observed simulation outputs remains positive-definite; to solve this problem, we apply a nonseparable dependence model that was originally proposed by Fricker et al. (2010). We compare the resulting multivariate Kriging with univariate Kriging per type of simulation output; univariate Kriging ignores the cross-correlations between the multiple simulation outputs. To compare these two Kriging types, we perform some Monte Carlo experiments in which we guarantee that all the assumptions of multivariate Kriging are satisfied. We use these experiments to estimate the MSEs of multivariate and univariate Kriging. These experimental results suggest that the simpler univariate Kriging gives lower MSE than the more complicated multivariate Kriging; one explanation is that multivariate Kriging requires the estimation of additional Kriging parameters—namely, the cross-correlations between the simulation outputs—which affects the estimates of all parameters. To check this explanation, we run additional Monte Carlo experiments replacing the estimated Kriging parameters by their true values, which are known in a Monte Carlo experiment. We then find that multivariate Kriging with the true GP parameters still does not perform better than univariate Kriging. We conjecture that nonseparable models created through LMC have some inherent property that causes inferior performance. In Example 1 we briefly examine the coverage, and conclude that both multivariate and univariate Kriging give coverages lower than the nominal (90%) value; multivariate Kriging does not improve this coverage.


                     Future research may address the following topics.
                        
                           •
                           Multivariate Kriging may serve as a metamodel not only for simulation models with multiple outputs but also for multi-fidelity simulation, discussed in Section 1 (type 2). Our Monte Carlo lab can be easily adapted to model such types of simulation. Besides the output of interest, the modelers may also estimate its gradient; also see Section 1 (type 3).

The goal of simulation may be optimization instead of sensitivity analysis. This optimization might replace MSE by a criterion such as used in efficient global optimization (EGO), but adapted for multivariate optimization. This optimization may use constrained optimization, selecting one output as the goal variable and satisfying constraints on the 
                                 
                                    (
                                    n
                                    -
                                    1
                                    )
                                 
                               remaining outputs. An alternative for this constrained optimization is multi-objective Pareto optimization.

In our Monte Carlo experiments we guaranteed that Kriging gives a valid metamodel, but in practice we may improve the validity of the metamodel by replacing ordinary Kriging by “universal” Kriging which uses a linear regression model instead of the constant 
                                 
                                    μ
                                 
                               in (1); see Fricker et al. (2010).

In our Monte Carlo experiments we may replace the Gaussian correlation function by some other correlation function to generalize our results; in practice, such a function may improve the validity of the Kriging metamodel.

If indeed multivariate Kriging does not outperform univariate Kriging in deterministic simulation, then it does not seem interesting to extend multivariate Kriging from deterministic simulation to more complicated (random) discrete-event simulation.

@&#ACKNOWLEDGMENTS@&#

Joshua Svenson and Tom Santner (Ohio State) shared their Kriging code with us. Nathan Urban shared his data on the climate model that we used in our second Monte Carlo experiments. David Ginsbourger referred us to Álvarez et al. (2011). Two anonymous reviewers gave detailed comments that helped us to improve the original version of our paper.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.02.001.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

