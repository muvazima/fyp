@&#MAIN-TITLE@&#Tolerance analysis by polytopes: Taking into account degrees of freedom with cap half-spaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In tolerance analysis, sets of constraints can be compliant with operand polyhedra.


                        
                        
                           
                           These operands are generally unbounded due to the inclusion of degrees of freedom.


                        
                        
                           
                           Cap half-spaces are added to each polyhedron to make it compliant with a polytope.


                        
                        
                           
                           The influence of the cap half-spaces on the topology of polytopes must be controlled.


                        
                        
                           
                           It is necessary to ensure the compliance of a mechanism in terms of requirements.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Tolerance analysis

Degree of freedom

Polyhedron

Polytope

Cap half-spaces

Minkowski sum

@&#ABSTRACT@&#


               
               
                  To determine the relative position of any two surfaces in a system, one approach is to use operations (Minkowski sum and intersection) on sets of constraints. These constraints are made compliant with half-spaces of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      where each set of half-spaces defines an operand polyhedron. These operands are generally unbounded due to the inclusion of degrees of invariance for surfaces and degrees of freedom for joints defining theoretically unlimited displacements. To solve operations on operands, Minkowski sums in particular, “cap” half-spaces are added to each polyhedron to make it compliant with a polytope which is by definition a bounded polyhedron. The difficulty of this method lies in controlling the influence of these additional half-spaces on the topology of polytopes calculated by sum or intersection. This is necessary to validate the geometric tolerances that ensure the compliance of a mechanical system in terms of functional requirements.
               
            


                        
                           
                              (36)
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                       ,
                                       4
                                       /
                                       1
                                       ,
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       3
                                       ,
                                       4
                                       /
                                       2
                                       ,
                                       4
                                    
                                 
                                 ⊕
                                 
                                    
                                       P
                                    
                                    
                                       2
                                       ,
                                       4
                                       /
                                       2
                                       ,
                                       0
                                    
                                 
                                 ⊕
                                 
                                    [
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      0
                                                      /
                                                      2
                                                      ,
                                                      1
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      1
                                                      /
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                      /
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                )
                                             
                                             ∩
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      0
                                                      /
                                                      2
                                                      ,
                                                      2
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      2
                                                      /
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                      ,
                                                      2
                                                      /
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ∩
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      0
                                                      /
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      ,
                                                      3
                                                      /
                                                      1
                                                      ,
                                                      3
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                      ,
                                                      3
                                                      /
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ⊕
                                 
                                    
                                       P
                                    
                                    
                                       1
                                       ,
                                       0
                                       /
                                       1
                                       ,
                                       4
                                    
                                 
                              
                           
                        
                     

hyperplane of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     

negative closed half-space associated to 
                           H
                         in 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     

positive closed half-space associated to 
                           H
                         in 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     


                        
                           
                              
                                 k
                              
                              
                                 
                                    th
                                 
                              
                           
                         cap half-space in 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        ; 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         the 
                           
                              
                                 k
                              
                              
                                 
                                    th
                                 
                              
                           
                         non-cap half-space in 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     

number of non-cap half-spaces in a polytope of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     

number of cap half-spaces in a polytope of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                     


                        
                           
                              
                                 k
                              
                              
                                 
                                    th
                                 
                              
                           
                         non-cap half-space of polytope 
                           i
                        .


                        
                           
                              
                                 k
                              
                              
                                 
                                    th
                                 
                              
                           
                         cap half-space of polytope 
                           i
                        .

normal fan of polytope 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        
                     

normal fan of the polyhedron containing 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        .

dual cone associated to vertex 
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                           
                        
                     


                        
                           
                              
                                 j
                              
                              
                                 
                                    th
                                 
                              
                           
                         vertex of polytope 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        .

functional polyhedron

dimension of the tolerance zone containing the surface 
                           i
                        , 
                           j
                        
                     

translation at point N along 
                           x
                        -axis

rotation along 
                           x
                        -axis

cross product of vectors 
                           
                              
                                 
                                    N
                                 
                              
                              
                                 i
                              
                           
                           
                              M
                           
                         and 
                           
                              r
                           
                        
                     

@&#INTRODUCTION@&#

A first approach to handling geometric tolerancing is generally a parametric approach  [1]. Parametric approaches, especially those used in the various commercial tools, formalize the relative position of any two surfaces of a mechanism at a specific point by a simple relation (linear or non-linear) between parameters of position (translation and/or rotation). This relation is obtained using either an analytical method  [2–5] or a Monte Carlo method  [6]. Several works on this subject are based on TTRS and MGDE concepts  [7]. The GapSpace approach has been proposed to ensure the assembly conditions  [8].

This type of approach does not take into consideration the dependencies between the limits of rotation parameter and translation parameter. Nor does it support the redundancy of suppressing degrees of freedom (hyperstatism) between two parts.

A solution to address these limitations is to introduce sets of constraints  [9–15]. These sets of constraints define the boundaries of relative displacements between two surfaces of the same part (geometric constraints) and boundaries of relative displacements between two surfaces of two separate parts, but which are potentially in contact (contact constraints). In general the sets of constraints manipulated by clearance space are not linear  [11]. This article focus on the approach by constraints and more precisely on bounded sets of constraints made up of linear constraints  [12].

Sets of geometric and contact constraints are generally operand sets which can be made compliant with finite sets of half-spaces of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                        [12]. The boundaries of relative displacements between two surfaces result from the intersection of the half-spaces of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      of an operand set, defining an operand polyhedron. A polyhedron is not usually bounded, due to the degree of invariance of a surface or to the degree of freedom of joints defining theoretically unlimited displacements  [16,17].

The relative position between any two surfaces of a mechanism is determined by operations on these operand polyhedrons (Minkowski sum and intersection),  [17–19]. To solve these operations, and in particular the Minkowski sums in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , one method is to delimit the intersection of the half-spaces of an operand set and thus transform a polyhedron of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      into a polytope of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , as a polytope of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                      is a bounded polyhedron of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                        [20]. This method is justified by the algorithmic complexity of summing polyhedra of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , requiring the development of algorithms to compute tolerance analysis of the Minkowski sums of polytopes  [21–23].

The main contribution of this article is to introduce the concept of “cap” half-spaces to bound operand polyhedra. They are added to the operand set and in this way determining the relative position of two surfaces of a mechanical systems is based solely on operations on operand polytopes generating a calculated polytope  [24].

By checking that a calculated polytope is included within a functional polytope the conformity of a mechanical system can be simulated with respect to a functional requirement  [12], see Fig. 1
                     .

The addition of cap half-spaces to the operand sets will affect the topology of a calculated polytope. Hence it has to be possible to differentiate among all the facets of a calculated polytope between those that are generated by the cap half-spaces and the others generated by half-spaces that derive from geometric and contact constraints. This is essential in order to validate the geometric tolerances that ensure that a mechanical system is compliant in relation to a functional requirement.

This article describes how to identify the facets generated by the cap half-spaces of a polytope resulting from a Minkowski sum or an intersection between two operand polytopes.

In the following, we limit ourselves to 6-dimension polyhedra and polytopes: the half-spaces arising from the geometric and contact constraints are linear inequalities in six variables: three rotation variables and three translation variables  [24].

In the first part, some properties of polyhedra and polytopes are considered; the second part looks at determining the cap half-spaces which set boundaries to the half-space intersections resulting from geometric and contact constraints.

The third part deals with the two methods of identifying the dependent facets of cap half-spaces in a summation and an intersection respectively. An example of an application of tolerance analysis illustrating these two methods is described at the end of the article.

For the application used as an example, we put forward the following physical hypotheses:


                     
                        
                           •
                           no form defect in the real surfaces,

no local strain in surfaces in contact,

no deformable parts.

We first set out some definitions and properties of polyhedra and polytopes to ensure a proper understanding of the rest of the article. These are taken from  [20].

A hyperplane is an affine subspace of dimension 0, 1, 2 or 
                           
                              (
                              n
                              −
                              1
                              )
                           
                         in 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         called point, line, plane and hyperplane respectively. A hyperplane of dimension 
                           
                              (
                              n
                              −
                              1
                              )
                           
                         is denoted a 
                           
                              (
                              n
                              −
                              1
                              )
                           
                        -hyperplane.

Let us consider 
                           H
                         a hyperplane in some 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        : 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           +
                           ⋯
                           +
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           +
                           ⋯
                           +
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           =
                           b
                        . 
                           
                              (1)
                              
                                 H
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    =
                                    b
                                    }
                                 
                                 
                                 with  
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    x
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                   and  
                                 b
                                 ∈
                                 R
                                 .
                              
                           
                         For each hyperplane 
                           H
                         we define the positive closed half-space 
                           
                              
                                 
                                    
                                       H
                                    
                                    ¯
                                 
                              
                              
                                 +
                              
                           
                         by: 
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          ¯
                                       
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ≥
                                    b
                                    }
                                 
                              
                           
                         and the negative closed one 
                           
                              
                                 
                                    
                                       H
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         similarly: 
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ≤
                                    b
                                    }
                                 
                              
                           
                         In the following any manipulated constraint will be written in terms of 
                           
                              
                                 
                                    
                                       H
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         denoted simply: 
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    ≤
                                    b
                                    }
                                 
                                 .
                              
                           
                        
                     

A polyhedron 
                           P
                         is the intersection of a finite number of closed half-spaces of 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        . We define: 
                           
                              (5)
                              
                                 P
                                 =
                                 
                                    
                                       ⋂
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       x
                                    
                                    ≤
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    }
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    
                                    
                                       Ax
                                    
                                    ≤
                                    
                                       b
                                    
                                    
                                    }
                                 
                                 ,
                                 
                                 
                                    A
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       m
                                       ×
                                       n
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 T
                              
                           
                         is the 
                           
                              
                                 i
                              
                              
                                 
                                    th
                                 
                              
                           
                         line of 
                           
                              A
                           
                         and 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         the 
                           
                              
                                 i
                              
                              
                                 
                                    th
                                 
                              
                           
                         component of 
                           
                              b
                           
                        .

This definition characterizes the 
                           H
                           −
                         description of 
                           P
                        , see Fig. 2
                        (a),  [20,25] and  [26].

A hyperplane 
                           H
                         is said to be a support hyperplane for polyhedron 
                           P
                         if and only if:
                           
                              (6)
                              
                                 P
                                 ∩
                                 H
                                 ≠
                                 0̸
                                 
                                 and
                                 
                                 P
                                 ⊂
                                 
                                    
                                       
                                          
                                             H
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 .
                              
                           
                         A face 
                           F
                         of 
                           P
                         is the intersection of the polyhedron 
                           P
                         with one of its support hyperplanes. The faces of a 
                           d
                        -polyhedron 
                           P
                         are convex sub-sets of dimension 
                           k
                           ,
                           0
                           ≤
                           k
                           ≤
                           d
                           −
                           1
                        .

A face of dimension 
                           k
                         is called 
                           k
                        -face. A 0-face is a vertex, a 1-face is an edge and a 
                           
                              (
                              d
                              −
                              1
                              )
                           
                        -face is a facet of 
                           P
                        .

If the polyhedron 
                           P
                         is bounded, it is called a polytope. A polytope of dimension 
                           d
                         is denoted 
                           d
                        -polytope in 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                           
                              (
                              n
                              ≥
                              d
                              )
                           
                        , see Fig. 2(b).

By duality, a polytope 
                           P
                         can be defined by the convex hull of a finite number of points of 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        .

Let us consider 
                           V
                         a finite set of points of 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        : 
                           
                              (7)
                              
                                 P
                                 =
                                 conv
                                 
                                    (
                                    V
                                    )
                                 
                                 .
                              
                           
                         Definition (7) is the 
                           V
                        -description of 
                           P
                           [9] and   [26].

Hence a polytope can be defined by its vertices.

In this article we consider only convex polyhedra and convex polytopes, which we call simply polyhedra and polytopes.

Associated to each vertex 
                           v
                         of polytope 
                           P
                        , is a primal cone and a dual cone such that:


                        
                           
                              •
                              the primal cone consists of the set of 
                                    p
                                 -faces of the polytope derived from this vertex with 
                                    p
                                    =
                                    0
                                  to dim(
                                    P
                                 ) (see Fig. 2(c)),

the dual (or normal) cone is constructed such that each 
                                    p
                                 -face of the primal cone is normal to a (dim(
                                    P
                                 )-
                                    p
                                 )-face of the dual cone


                        
                           
                              •
                              each non-empty face of a cone of 
                                    F
                                  is also a cone of 
                                    F
                                 ,

the intersection of two cones of 
                                    F
                                  is a face common to the two cones.

If 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         are the dual cones of a polytope 
                           P
                        , then 
                           F
                         is the normal fan of polytope 
                           P
                         denoted 
                           N
                           
                              (
                              P
                              )
                           
                        .


                        Fig. 2(d) and (e) illustrate the normal fans for a polyhedron and a polytope respectively.

The common refinement of two fans is defined by the intersection of pairs of cones from the two families  [25]:
                           
                              (8)
                              
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ∧
                                 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∩
                                    C
                                    2
                                    :
                                    
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Whatever manufacturing processes are employed, and whatever materials are used, a manufactured part is never geometrically perfect. The geometric features of a manufactured part will never be exactly the same as the nominal characteristics of which they are a specific physical realization. Generally, variations in production processes generate geometric deviations from a geometric model produced by a Computer Assisted Design tool (CAD). These deviations, also called defects, may compromise the expected performance of a mechanical system. Tolerancing sets an acceptable range of deviation using geometric specifications while still guaranteeing that the mechanical system will function as required. These limits are mainly given in the form of tolerance zones, or zones within which the surfaces being produced must be included.

In mathematical terms, the displacement limits for a surface in a tolerance zone are defined by a set of geometric constraints. A tolerance zone is defined by its dimension 
                           t
                         and two deviations 
                           
                              
                                 d
                              
                              
                                 inf
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 sup
                              
                           
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    sup
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    inf
                                 
                              
                              =
                              t
                                with  
                              
                                 
                                    d
                                 
                                 
                                    inf
                                 
                              
                              ≤
                              
                                 
                                    d
                                 
                                 
                                    sup
                                 
                              
                              )
                           
                         which position is in relation to the nominal surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                        . Each real surface is modeled by a substitution surface (i.e. one which is perfect) with 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         representing a specific physical representation of the nominal surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         (see Fig. 3
                        ). If 
                           
                              |
                              
                                 
                                    d
                                 
                                 
                                    inf
                                 
                              
                              |
                           
                           =
                           
                              |
                              
                                 
                                    d
                                 
                                 
                                    sup
                                 
                              
                              |
                           
                           =
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        , the nominal surface is combined with the median surface of the tolerance zone.

The set of geometric constraints is defined in the following equation  [12]: 
                           
                              (9)
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ⊆
                                 Z
                                 T
                                 ⇔
                                 ∀
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       0
                                    
                                 
                                 :
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       inf
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ≤
                                 
                                    
                                       d
                                    
                                    
                                       sup
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         is the translation displacement of 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         in relation to 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         at point 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                              
                           
                         is the unit outward pointing vector normal to the surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         in 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                        .

By discretizing the surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         into 
                           n
                         points 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                         gives 
                           n
                         Eq. (9) with 
                           1
                           ≤
                           i
                           ≤
                           n
                        .

Using small displacement torsors, Eq. (10) can be written for every point 
                           M
                         of the Euclidean space  [27]: 
                           
                              (10)
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 
                                    
                                       
                                          N
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    M
                                 
                                 ×
                                 
                                    r
                                 
                              
                           
                         where:


                        
                           
                              r
                           
                          : rotation vector of 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         in relation to 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                        ,


                        
                           
                              
                                 
                                    t
                                 
                              
                              
                                 M
                              
                           
                        : translation vector of 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         in relation to 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         at point 
                           M
                        .

Developing Eq. (10) gives (11): 
                           
                              (11)
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          M
                                       
                                    
                                    +
                                    
                                       
                                          
                                             N
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       M
                                    
                                    ×
                                    
                                       r
                                    
                                    )
                                 
                                 .
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 .
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          
                                             MN
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ×
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                                 
                                 
                                    r
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            MN
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We define the components of the following vectors in an 
                           
                              (
                              
                                 x
                              
                              ,
                              
                                 y
                              
                              ,
                              
                                 z
                              
                              )
                           
                         base: 
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       M
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M–
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M–
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M–
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          N
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    M
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 and
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Thus Eq. (11) can be written in the 
                           
                              (
                              
                                 x
                              
                              ,
                              
                                 y
                              
                              ,
                              
                                 z
                              
                              )
                           
                         base in accordance with (12): 
                           
                              (12)
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             MN
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ×
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                                 
                                 
                                    r
                                 
                                 +
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 .
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         z
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         z
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M-
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M-
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   M-
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 
                                    x
                                 
                                 .
                              
                           
                         We propose: 
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               MN
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               MN
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               MN
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          ×
                                          6
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                 
                              
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   sup
                                                
                                             
                                             )
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   inf
                                                
                                             
                                             )
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    .
                                 
                              
                           
                         Finally, Eq. (9) defining 
                           n
                         geometric constraints can be written in accordance with (14) from (12) and (13): 
                           
                              (14)
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ⊆
                                 Z
                                 T
                                 ⇔
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ≤
                                 
                                    
                                       d
                                    
                                    
                                       sup
                                    
                                 
                                 
                                 
                                 and
                                 
                                 
                                 −
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ≤
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       inf
                                    
                                 
                                 ⇔
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    x
                                 
                                 ≤
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    x
                                 
                                 ≤
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       ″
                                    
                                 
                                 ⇔
                                 
                                    Ax
                                 
                                 ≤
                                 
                                    b
                                 
                                   with
                                 
                                 
                                 
                                    A
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    b
                                 
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Using Eq. (14), it is possible to make Eq. (9) compliant as an 
                           H
                        -description of a polyhedron 
                           P
                         of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                           [20]. It defines 
                           2
                           n
                         half-spaces 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         with 
                           1
                           ≤
                           k
                           ≤
                           2
                           n
                        . The intersection of the 
                           2
                           n
                         half-spaces 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         defines a polyhedron 
                           P
                         of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        . 
                           
                              (15)
                              
                                 P
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          6
                                       
                                    
                                    
                                    :
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       x
                                    
                                    ≤
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       x
                                    
                                    ≤
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          6
                                       
                                    
                                    
                                    :
                                    
                                    
                                       Ax
                                    
                                    ≤
                                    
                                       b
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       ⋂
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       k
                                       =
                                       2
                                       .
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 .
                              
                           
                         Let us consider the example of Fig. 4
                        (a) which shows the definition of an ISO specification for the location of a plane surface. This location implies that any manufactured surface 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        , a specific physical realization of the nominal square plane surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         with dimension 
                           b
                        , must be located within a tolerance zone defined by two parallel planes at 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         distance apart: see Fig. 4(b). In the 
                           
                              (
                              
                                 x
                              
                              ,
                              
                                 y
                              
                              ,
                              
                                 z
                              
                              )
                           
                         base, points A, B, C and D, vertices of the square 
                           
                              (
                              b
                              ×
                              b
                              )
                           
                        , have the following respective coordinates: 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 and  
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The geometric constraints inherent in the location of 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         are defined by eight half-spaces as in Eq. (15)   [12]: 
                           
                              (16)
                              
                                 P
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                
                                                   z
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   N-
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   N-
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   N-
                                                   z
                                                
                                             
                                             )
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                    
                                       Ax
                                    
                                    ≤
                                    
                                       b
                                    
                                    }
                                 
                                 with
                                 :
                                 
                                    A
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             −
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             b
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       8
                                       ×
                                       6
                                    
                                 
                                   and,  
                                 
                                    b
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       8
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       8
                                    
                                 
                                 .
                              
                           
                         The intersection of the eight half-spaces, expressed at the center N of the square 
                           
                              (
                              ABCD
                              )
                           
                         with surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         and generated by this location specification, generates a 3-dimension polytope in the affine space constructed on the 
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    N-
                                    z
                                 
                              
                              )
                           
                         base, see Fig. 4(c).

If the contour line is not rectangular, we proceed to its discretization. If the surface is not a plane, a mesh of the surface is generated and the constraints are written for the mesh nodes.

For the location tolerance of the axis of a cylinder, the two extremities are considered; the constraints are written for these points.

The constraints could be defined for a given direction (case of a tolerance zone made up of 2 parallel planes) or for discretized directions (case of a cylindrical zone).

One can generalize the writing of the constraints for any toleranced curve by discretization.

Like the geometric constraints described in 3.1, non-interferences by surfaces potentially in contact are characterized by contact constraints. Definition (9) can be specialized by writing: 
                           
                              (17)
                              
                                 ∀
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       c
                                    
                                 
                                 
                                 :
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       inf
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ≤
                                 
                                    
                                       d
                                    
                                    
                                       sup
                                    
                                 
                              
                           
                         with:


                        
                           
                              •
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          c
                                       
                                    
                                   : contact element (see Fig. 5
                                 ) which may be along a surface, a line or defined by a point,


                                 
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                   : translation displacement at point 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                    
                                  of surface 1 in relation to surface 2 between two parts potentially in contact,


                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                   : unit vector normal to a plane tangent to the two surfaces at point 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                    
                                 , oriented towards the outer material in relation to surface 2,


                                 
                                    
                                       
                                          d
                                       
                                       
                                          inf
                                       
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          sup
                                       
                                    
                                  are defined according to the type of contact: 
                                    
                                       
                                          d
                                       
                                       
                                          inf
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          J
                                       
                                       
                                          2
                                       
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          sup
                                       
                                    
                                    =
                                    +
                                    
                                       
                                          J
                                       
                                       
                                          2
                                       
                                    
                                  in cases where the joints are in bilateral contact (generally the case with a cylindrical pair, ball-and-cylinder pair, spherical pair), where 
                                    J
                                   (
                                    J
                                    =
                                  dimension of hole - dimension of shaft) is clearance in the joint, the definition of 
                                    J
                                  is compliant with that given in the ISO standard  [28].

A contact element is the element consisting of all possible points of contact between two surfaces. It derives from the intersection of two surfaces potentially in contact in the specific configuration where the two surfaces merge and there is no clearance.

For example, the contact element of a cylindrical pair joint is a cylinder. This cylinder is the intersection of two cylinders that are coaxial and have the same diameter. Fig. 5 shows the contact elements for planar pair and cylindrical pair joints (surface contact elements), cylinder-and-plane pair and ball-and-cylinder pair joints (line contact element), and ball-and-plane pair joint (punctual contact element). This non-exhaustive list gives the main types of joint used in tolerance analysis.

As for geometric constraints, points 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                         are obtained by discretization of the contact element and in this way, the writing of the contact constraints is generalized.

The definition of a contact polyhedron 
                           P
                         is similar to that in Eq. (15).

In cases of unilateral contact (usually ball-and-plane pair joint, cylinder-and-plane pair or planar pair joints), we have the specific case where:


                        
                           
                              •
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          inf
                                       
                                    
                                    =
                                    0
                                 ,


                                 
                                    
                                       
                                          d
                                       
                                       
                                          sup
                                       
                                    
                                  is not defined.

The result is that only equations 
                           
                              
                                 d
                              
                              
                                 inf
                              
                           
                           ≤
                           
                              
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           .
                           
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                              
                           
                         defined in (14) are generated by the contact constraints. The polyhedron is defined as follows: 
                           
                              (18)
                              
                                 P
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          6
                                       
                                    
                                    
                                    :
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       x
                                    
                                    ≤
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ″
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       ⋂
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       k
                                       =
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   k
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 .
                              
                           
                        
                     

Generally, the relative position of any two surfaces of a mechanical system derives from the sum and intersection of 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                         polyhedra. Due to the algorithmic complexity of Minkowski sums, we chose to manipulate only geometric polytopes and contact polytopes, in other words bounded sets. A geometric polytope is defined as a bounded geometric polyhedron. Similarly, a contact polytope is a bounded contact polyhedron. In the next two sections we show how geometric and contact polyhedra are made compliant with geometric and contact polytopes respectively.

Geometric polyhedra defined previously in (15) are not generally bounded as their surfaces usually have degrees of invariance  [7]. The degree of invariance of a surface will hereafter be written 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                           . These polyhedra are therefore not 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                            polytopes.

In this article, we propose to put boundaries on these polyhedra by the addition of 
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              
                              
                                 
                                    
                                       
                                          H
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                       
                                       ¯
                                    
                                 
                                 
                                    −
                                 
                              
                            half-spaces, called cap half-spaces, to all the half-spaces resulting from the geometric constraints. The degree of invariance of a surface depends on the class of surface  [7]; it defines a theoretically unlimited displacement which leaves the toleranced surface in the Euclidean space invariant overall. A displacement may have two boundaries, each one characterizing a cap half-space. Thus, two cap half-spaces per degree of invariance are added to the half-spaces defining the polyhedron (see Table 1
                           ). Generally in 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                           , the geometric polytope derived from this addition of 
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              =
                              2
                              .
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                            cap half-spaces can be defined by the expression: 
                              
                                 (19)
                                 
                                    P
                                    =
                                    
                                       (
                                       
                                          
                                             ⋂
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             k
                                             =
                                             2
                                             .
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       )
                                    
                                    ∩
                                    
                                       (
                                       
                                          
                                             ⋂
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             k
                                             =
                                             2
                                             .
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                   n
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       )
                                    
                                 
                              
                            where: 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                            is the degree of invariance of the surface.

The cap half-spaces are additional half-spaces so that a 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                            polyhedron can be made compliant with a 6-polytope while still retaining the geometry and the topology of the polyhedron, i.e. the polyhedron faces. This polytope defines:


                           
                              
                                 •
                                 displacements of the surface inside a tolerance zone,

displacements limited by the cap half-spaces that leave the surface invariant overall.

Half-spaces identified in Eq. (19) can be written: 
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       =
                                       
                                          
                                             
                                                a
                                             
                                          
                                          
                                             k
                                          
                                          
                                             T
                                          
                                       
                                       
                                          x
                                       
                                       ≤
                                       
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             d
                                          
                                          
                                             sup
                                          
                                       
                                       
                                       or
                                       
                                       
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             inf
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       =
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             k
                                          
                                          
                                             T
                                          
                                       
                                       
                                          x
                                       
                                       ≤
                                       C
                                       ,
                                       
                                       C
                                       ∈
                                       
                                       
                                          ]
                                          0
                                          ,
                                          +
                                          ∞
                                          [
                                       
                                       .
                                    
                                 
                              
                            The second members of the half-spaces correspond to the distances of their respective hyper-planes from the origin of the displacements, see Fig. 6
                           .

The second member of a half-space generated by a geometric constraint depends on 
                              
                                 
                                    d
                                 
                                 
                                    sup
                                 
                              
                            or 
                              
                                 
                                    d
                                 
                                 
                                    inf
                                 
                              
                            that is to say on the dimension of the tolerance zone 
                              t
                            and the position of the tolerance zone in relation to the nominal surface, see Fig. 6.

The second member of a cap half-space 
                              
                                 
                                    
                                       
                                          H
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                       
                                       ¯
                                    
                                 
                                 
                                    −
                                 
                              
                           , identified as 
                              C
                           , is a strictly positive value.

The cap half-spaces are introduced for the sole purpose of facilitating the calculation of the sums and intersections of the polyhedra (unbounded sets) by transforming them into polytopes (bounded sets). The value of 
                              C
                            must be large enough to distinguish bounded displacements from unbounded ones, while not affecting the final result. The choice of the value of 
                              C
                            will be considered in further detail later in the article.

The 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    k
                                 
                              
                            coefficients depend on the classes of the surfaces and the displacements leaving the surfaces invariant overall.

A 
                              
                                 (
                                 
                                    u
                                 
                                 ,
                                 
                                    v
                                 
                                 ,
                                 
                                    w
                                 
                                 )
                              
                            base is associated to each surface according to the displacement axes, leaving it invariant overall. The cap half-spaces enabling them to be limited are defined on the basis of these axes: see Fig. 7
                           .

Let us return to the example in Fig. 4: this shows a plane surface where 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                              =
                              3
                           . In 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                           , 
                              2
                              .
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                              =
                              6
                            cap half-spaces at least are required to set boundaries to the intersection of the half-spaces resulting from geometric constraints (15). In a 
                              
                                 (
                                 
                                    u
                                 
                                 ,
                                 
                                    v
                                 
                                 ,
                                 
                                    w
                                 
                                 )
                              
                            base linked to the plane surface such that 
                              
                                 w
                              
                            is normal to the surface, displacements leaving the surface invariant overall are limited as follows, with 
                              C
                              >
                              0
                            and N the point of definition of half-spaces 
                              
                                 
                                    
                                       
                                          H
                                       
                                       ¯
                                    
                                 
                                 
                                    k
                                 
                                 
                                    −
                                 
                              
                           :
                              
                                 (21)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   r.w
                                                
                                                ≤
                                                C
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   .u
                                                
                                                ≤
                                                C
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   .v
                                                
                                                ≤
                                                C
                                             
                                          
                                       
                                    
                                    
                                    
                                    ,
                                    
                                    
                                    
                                       
                                          
                                             −
                                             
                                                r.w
                                             
                                             ≤
                                             C
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      t
                                                   
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                .u
                                             
                                             ≤
                                             C
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      t
                                                   
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                .v
                                             
                                             ≤
                                             C
                                             .
                                          
                                       
                                    
                                 
                              
                            Equations at (21) can be made compliant with 6 cap half-spaces of 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                            in the same way as those at (20). We now define the following projections for any 
                              
                                 (
                                 
                                    x
                                 
                                 ,
                                 
                                    y
                                 
                                 ,
                                 
                                    z
                                 
                                 )
                              
                            base: 
                              
                                 (22)
                                 
                                    
                                       u
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       v
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                    and
                                    
                                    
                                       w
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                            the 6 cap half-spaces are then defined such that: 
                              
                                 (23)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               z
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               z
                                                            
                                                         
                                                         ≤
                                                         C
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               z
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               z
                                                            
                                                         
                                                         ≤
                                                         C
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               N-
                                                               x
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               N-
                                                               y
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               N-
                                                               z
                                                            
                                                         
                                                         .
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               z
                                                            
                                                         
                                                         ≤
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      x
                                                   
                                                
                                                .
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      y
                                                   
                                                
                                                .
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      z
                                                   
                                                
                                                .
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      z
                                                   
                                                
                                                ≤
                                                C
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      x
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                   
                                                
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      y
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      y
                                                   
                                                
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      z
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      z
                                                   
                                                
                                                ≤
                                                C
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      x
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      y
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      N-
                                                      z
                                                   
                                                
                                                .
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      z
                                                   
                                                
                                                ≤
                                                C
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Fig. 8
                            shows the limits of surface displacements in the 
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       N-
                                       x
                                    
                                 
                                 )
                              
                            base where displacement according to 
                              
                                 
                                    t
                                 
                                 
                                    N-
                                    x
                                 
                              
                            is unbounded and the corresponding cap half-spaces.

Cap half-spaces are similarly defined for classes of surface: spherical, cylindrical, revolution or prismatic.

The contact polyhedra defined above are generally unbounded as the joints have degrees of freedom 
                              
                                 
                                    d
                                 
                                 
                                    m
                                    o
                                    b
                                 
                              
                           . Just as the limits of surface displacement in a tolerance zone can be defined, displacement limits for two surfaces potentially in contact can be modeled in the case of bilateral contacts. Cap half-spaces limit the displacements inherent in the degrees of freedom of the joints.

The number of cap half-spaces in this case depends on the type of joint (see Table 2
                           ).

Each degree of freedom defines a theoretically unbounded displacement which is limited by two cap half-spaces. Finally, 
                              2
                              .
                              
                                 
                                    d
                                 
                                 
                                    m
                                    o
                                    b
                                 
                              
                            cap half-spaces are added to the half-spaces generated by contact constraints, by analogy with the 
                              2
                              .
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    v
                                 
                              
                            cap half-spaces added to the half-spaces generated by geometric constraints according to (19).

In the specific case of joints with unilateral contact, each contact constraint limits displacement in a single direction (18). Contact constraints generate only 
                              n
                            half-spaces of 
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                            instead of 
                              2
                              n
                           . In order to set boundaries on the intersection of these 
                              n
                            half-spaces, 
                              n
                            other constraints are added so as to suppress the unilaterality of the contact. These 
                              n
                            constraints form 
                              n
                            extra cap half-spaces in addition to the 
                              m
                            cap half-spaces limiting displacements resulting from the degrees of freedom according to Eq. (24) where 
                              
                                 
                                    d
                                 
                                 
                                    m
                                    o
                                    b
                                 
                              
                            corresponds to the degree of freedom of the joint: 
                              
                                 (24)
                                 
                                    P
                                    =
                                    
                                       (
                                       
                                          
                                             ⋂
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             k
                                             =
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       )
                                    
                                    ∩
                                    
                                       (
                                       
                                          
                                             ⋂
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             k
                                             =
                                             m
                                             +
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             −
                                          
                                       
                                       )
                                    
                                    
                                    with   
                                    
                                    m
                                    =
                                    2
                                    .
                                    
                                       
                                          d
                                       
                                       
                                          m
                                          o
                                          b
                                       
                                    
                                    .
                                 
                              
                            In this case, the polyhedron (18) is defined solely by matrix 
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ″
                                 
                              
                           . To suppress the unilaterality of the contact, we propose to add 
                              n
                            constraints identified by matrix 
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ′
                                 
                              
                             (dimension 
                              n
                           ) opposite to matrix 
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ″
                                 
                              
                           . Next, the 
                              m
                            cap half-spaces are added, according to the degrees of freedom.

Just as for the cap half-spaces for the geometric polytopes, the value of 
                              C
                            for the second members should be selected with care so as not to affect the final result.

An operand polytope will then be defined as follows: 
                           
                              (25)
                              
                                 P
                                 =
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                n
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 
                                 
                                 with  
                                 
                                    
                                       n
                                    
                                    
                                       n
                                       c
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 2
                                 n
                                 +
                                 m
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         is the set of 
                           
                              
                                 n
                              
                              
                                 n
                                 c
                              
                           
                         half-spaces (
                           n
                           c
                         for non-cap) resulting from the geometric or contact constraints and 
                           
                              
                                 
                                    
                                       H
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         is the set of 
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                         cap half-spaces. The intersection of the 
                           
                              
                                 n
                              
                              
                                 n
                                 c
                              
                           
                         half-spaces defines a polyhedron.

We now propose the following properties:


                        
                           Property 1
                        : a j-face of a polytope is described as a non-cap 
                        
                           j
                        
                        -face if and only if it is included in a 
                        
                           j
                        
                        -face of the corresponding polyhedron.
                     


                        
                           Property 2
                        : any 
                        
                           j
                        
                        -face that is not a non-cap 
                        
                           j
                        
                        -face is cap.

For geometric or contact polytopes, the non-cap facets are thus included in the hyper-planes 
                           
                              
                                 H
                              
                              
                                 k
                              
                           
                        , boundaries of the half-spaces 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         resulting from the geometric or contact constraints.


                        Fig. 9
                         shows a synthesis of the tolerance analysis procedure by polytopes. From the tolerance zones on the one hand and the joints on the other, the geometric and contact constraints can be written respectively.

These constraints usually define unbounded sets, or polyhedra.

Cap half-spaces are added to the polyhedra in order to set boundaries and transform them into polytopes. The sums and intersections of these polytopes can then be calculated to simulate geometric variations according to the structure of the mechanism by a resulting polytope. From this, the boundaries of the functional defects of the mechanism can be identified and we are thus able to determine whether the limits set out in the specifications are respected.

The next paragraph describes the methods used to differentiate among all the facets of a polytope resulting from a sum or an intersection, those facets that are generated by cap half-spaces from the others.

Let us define polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         resulting from the Minkowski sum of two polytopes 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         of 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                         as follows: 
                           
                              (26)
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    |
                                    
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         We shall try to define the faces of polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         which are independent from the cap half-spaces of operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         by manipulating the polytopes using a double description (i.e. by their 
                           V
                        -description and their 
                           H
                        -description).

Fukuda has shown that every face of the sum 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         of two 
                           n
                        -polytopes 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         can be decomposed in only one way into the sum of two faces of operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           [26].

Let us propose the following:


                        
                           Property 3:
                        
                        the faces of 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         
                        resulting from the sum of two non-cap faces of 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         
                        and 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         
                        are the non-cap faces of 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         
                        . All the other faces of 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         
                        are called cap faces.
                     


                        Fig. 10
                         shows a classic example of the Minkowski sum of two polytopes 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         in geometric tolerancing. Polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         is made up of four non-cap facets 
                           
                              
                                 e
                              
                              
                                 11
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 12
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 13
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 14
                              
                           
                         (solid line in Fig. 10). Polytope 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         is made up of two non-cap facets 
                           
                              
                                 e
                              
                              
                                 21
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 23
                              
                           
                         (solid line in Fig. 10) and two cap facets 
                           
                              
                                 e
                              
                              
                                 22
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 24
                              
                           
                         (dotted line in Fig. 10).

All the vertices of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         are non-cap whereas all the vertices of 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         are cap. In fact, polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         is identical to the corresponding polyhedron and the vertices of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         are therefore vertices of the polyhedron, and hence are non-cap, according to 1 given in Section  3.4. The vertices of 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         do not exist on the corresponding polyhedron: they are therefore cap, according to properties 1 and 2 given in Section  3.4.

We will now consider two examples of sums of faces (edges or vertices) in this example. The first is the sum of the two non-cap edges 
                           
                              
                                 e
                              
                              
                                 12
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 23
                              
                           
                        . The result is edge 
                           
                              
                                 e
                              
                              
                                 33
                              
                           
                         of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         where: 
                           
                              
                                 e
                              
                              
                                 33
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 12
                              
                           
                           ⊕
                           
                              
                                 e
                              
                              
                                 23
                              
                           
                        .


                        
                           
                              
                                 e
                              
                              
                                 33
                              
                           
                         is a non-cap edge according to property 3, see Fig. 10.

The second example is the Minkowski sum of a non-cap edge 
                           
                              
                                 e
                              
                              
                                 11
                              
                           
                         of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and a cap vertex 
                           
                              
                                 v
                              
                              
                                 2
                                 a
                              
                           
                         of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         respectively. The result is a cap edge 
                           
                              
                                 e
                              
                              
                                 31
                              
                           
                         of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 31
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 11
                              
                           
                           ⊕
                           
                              
                                 v
                              
                              
                                 2
                                 a
                              
                           
                        .


                        
                           
                              
                                 e
                              
                              
                                 31
                              
                           
                         is a cap edge according to property 3, see Fig. 10.

The second example shows that a non-cap facet of an operand polytope can be translated into a cap facet in the polytope sum. In other words, a cap facet in the first operand can modify the attribute (from non-cap to cap) of a facet in the polytope sum, as a result of the translation of a facet from the second operand.

In 
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        , the algorithmic application of the property posited by Fukuda in  [26] requires all the 
                           d
                           -
                         faces 
                           
                              (
                              0
                              ≤
                              d
                              ≤
                              5
                              )
                           
                         of operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         to be determined in order to identify all the cap facets in 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        . This is very complex to implement with dimensions greater than 3 and is prohibitive in terms of algorithmic complexity and hence in calculation time.

For this reason we decided to manipulate the polytopes by their 
                           V
                           -
                        description and their 
                           H
                           -
                        description, i.e. with a double description  [12,22]. This guarantees the traceability of the specifications in operations used in geometric tolerancing  [22], however it is then difficult to distinguish cap faces and non-cap faces since property 3 cannot be applied.

The method proposed here uses the normal fans of operand polytopes and the normal fans of associated operand polyhedra. To show how cap faces can be identified through normal fans, we first describe the basis of the algorithm used to determine the Minkowski sum of polytopes.

The topology of polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         is defined by its normal fan 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         resulting from a common refinement of the normal fans of operand polytopes  [25]: 
                           
                              (27)
                              
                                 N
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 =
                                 N
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∧
                                 N
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Determining the common refinement of two fans 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         involves calculating the union of all the intersections of the polyhedric cones of fans 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         taken two by two   [20].

Polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         is characterized by its vertices 
                           
                              
                                 v
                              
                              
                                 1
                                 i
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 1
                                 i
                              
                           
                         is the 
                           
                              
                                 i
                              
                              
                                 
                                    th
                                 
                              
                           
                         vertex of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        .

Similarly:


                        
                           
                              •
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                  is characterized by its vertices 
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                  where 
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                  is the 
                                    
                                       
                                          j
                                       
                                       
                                          
                                             th
                                          
                                       
                                    
                                  vertex of 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 ,


                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                  is characterized by its vertices 
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                  where 
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                  is the 
                                    
                                       
                                          k
                                       
                                       
                                          
                                             th
                                          
                                       
                                    
                                  vertex of 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                 .

We have shown in  [22] the property (28) in 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        : 
                           
                              (28)
                              
                                 dim
                                 
                                    (
                                    DualCone
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       )
                                    
                                    ∩
                                    DualCone
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             2
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 n
                                 ⇒
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       3
                                       k
                                    
                                 
                                 .
                                 
                                 
                                 DualCone
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    )
                                 
                                 ∩
                                 DualCone
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 DualCone
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    )
                                 
                                 where  the  edges  of  DualCone
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 are  normal  to  the facets  of   
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 
                                 that  converge  at   
                                 
                                    
                                       v
                                    
                                    
                                       3
                                       k
                                    
                                 
                              
                           
                         Eqs. (26) and (27) can be generalized to polyhedra. If 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         are polyhedra, 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         is also a polyhedron; the normal fans 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         and 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are not complete, i.e. they do not partition 
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        . The normal fan of a polyhedron is a regular Gröbner fan  [29,30].

In general, 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         designates the normal fan of polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         designates the normal fan of the polyhedron containing 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        .

To identify cap and non-cap facets, we define the following property:


                        
                           Property 4:
                        
                        The normals of the non-cap facets of 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         
                        are the result of the common refinement of the normal fans 
                        
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         
                        and 
                        
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         
                        of the corresponding operand polyhedra.
                     


                        Fig. 11
                        (a) shows the normal fan 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         of polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        , resulting from the common refinement of fans 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . The edges of the dual cones that make up 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are the normal of the facets of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        : see Fig. 10 and Fig. 11(a).


                        
                           Note:
                         the normal fans shown are normalized normal fans, in other words, they are intersected with the unit sphere  [31].


                        Fig. 11(b) shows the normal fan 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , common refinement of the normal fans 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         of the polyhedra associated with 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         respectively. The polyhedron associated with 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         results from the intersection of the half-spaces defining 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         without its cap half-spaces. Likewise for the polyhedron associated with 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

In the example in Fig. 10, the polyhedron associated with 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         are identical, since 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         has no cap half-spaces. The same is true for their normal fans. The normal fan 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         of the polyhedron associated with 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         is reduced to two rays (two 1 dimension cones). Similarly for the common refinement 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ∧
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        .

The edges of the normal fan 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are normals of the facets of the polyhedron Minkowski sum of the polyhedra associated with 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         respectively.

From this we deduce that the normals of the non-cap facets of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         correspond to the edges of 
                           N
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         which are common to the edges of 
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , i.e. edges 
                           
                              
                                 e
                              
                              
                                 33
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 36
                              
                           
                        , see Fig. 10 and Fig. 11(b).

The non-cap vertices of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         are easy to identify.

From Eq. (28) and property 1 taken from the work of Fukuda  [26], we can deduce Eqs. (29) and (30): 
                           
                              
                                 (29)
                                 
                                    i
                                    f
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    
                                         are  non-cap  vertices,
                                    dim
                                    
                                       (
                                       DualCone
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                1
                                                i
                                             
                                          
                                          )
                                       
                                       ∩
                                       DualCone
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                2
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    n
                                    ⇒
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    where
                                    
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    
                                    is  a  non-cap  vertex
                                 
                              
                              
                                 (30)
                                 
                                    i
                                    f
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    
                                    or
                                    
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    
                                         is  a  cap  vertex,
                                    dim
                                    
                                       (
                                       DualCone
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                1
                                                i
                                             
                                          
                                          )
                                       
                                       ∩
                                       DualCone
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                2
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    n
                                    ⇒
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    where
                                    
                                    
                                       
                                          v
                                       
                                       
                                          3
                                          k
                                       
                                    
                                    
                                    is  a  cap  vertex .
                                 
                              
                           
                        
                     

The intersection of two operand polytopes 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         is defined as the intersection of the set of half-spaces from the 
                           H
                        -descriptions of the two operands: 
                           
                              (31)
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ∩
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 
                                 with  
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ⋂
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       k
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                   ,
                                                   k
                                                
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 
                                 
                                 and   
                                 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ⋂
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       k
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                   ,
                                                   k
                                                
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       −
                                    
                                 
                                 .
                              
                           
                         According to definition (25), we have: 
                           
                              (32)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                n
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 
                                 
                                 with  
                                 
                                    
                                       n
                                    
                                    
                                       n
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         where: 
                           
                              
                                 n
                              
                              
                                 n
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         is the number of non-cap half-spaces denoted 
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         and 
                           
                              
                                 n
                              
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         is the number of cap half-spaces denoted 
                           
                              
                                 
                                    
                                       H
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                        .

In geometric tolerancing, we need to determine the intersection of the displacements defined by the geometric and/or contact constraints. This intersection derives from the intersection of the non-cap half-spaces of operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        , i.e. polyhedra 
                           
                              
                                 P
                              
                              
                                 1
                              
                              
                                 
                                    (
                                    R
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                              
                                 
                                    (
                                    R
                                    )
                                 
                              
                           
                         containing 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         respectively, see Fig. 12
                        (a). In order to make this intersection compliant with a polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         (i.e. a bounded set), a set of non-cap half-spaces must be added, see Fig. 12(b). Polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         is defined by Eq. (33) in accordance with (25): 
                           
                              (33)
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                n
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                n
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    (
                                    
                                       
                                          ⋂
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          k
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      3
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       H
                                       
                                          
                                             c
                                          
                                          
                                             3
                                             ,
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                         denotes a cap half-space of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        .

It is no easy matter to determine cap half-spaces 
                           
                              
                                 
                                    
                                       H
                                       
                                          
                                             c
                                          
                                          
                                             3
                                             ,
                                             k
                                          
                                       
                                    
                                    ¯
                                 
                              
                              
                                 −
                              
                           
                        . The topology of polytope 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         depends on the choice of second member 
                           C
                         of the cap half-spaces of the operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

Thus as a general rule: 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           ≠
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        , see Fig. 12(c).

In the next section we propose a method to truncate a hyper-parallelepiped, to determine displacements limited by the non-cap half-spaces resulting from the intersection of two operand polytopes.

One method to determine 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         consists of determining the intersection between:


                        
                           
                              •
                              a right hyper-parallelepiped circumscribed at the union of the vertices of 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 ,

the non-cap half-spaces of operands 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 .

The facets of polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         where the hyper-planes contain the facets of the right hyper-parallelepiped are the cap facets of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        , which can be used to define 
                           
                              (
                              
                                 
                                    ⋂
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    k
                                    =
                                    
                                       
                                          n
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          H
                                          
                                             
                                                c
                                             
                                             
                                                3
                                                ,
                                                k
                                             
                                          
                                       
                                       ¯
                                    
                                 
                                 
                                    −
                                 
                              
                              )
                           
                         introduced into Eq. (33). All the other facets are non-cap. In addition, all the vertices of 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         located on a hyper-plane containing one of the facets of the initial right hyper-parallelepiped are cap vertices. All the other vertices are non-cap.


                        Fig. 13
                        (a) shows the determination of a circumscribed right hyper-parallelepiped (a rectangle in this example) at the union of the vertices of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

The circumscribed right hyper-parallelepiped must not be a minimal volume. If this were the case, then this may result in a hyper-parallelepiped of which one facet might be confused with a facet of 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        . It would then not be possible to detect whether such a facet is cap or non-cap.

To avoid this, a right circumscribed hyper-parallelepiped is determined at an interval 
                           d
                         from the minimal volume circumscribed right hyper-parallelepiped, where 
                           d
                           >
                           0
                        : Fig. 13(a).


                        Fig. 13(b) shows polytope 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         resulting from the intersection between a circumscribed right hyper-parallelepiped with vertices 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         and the non-cap half-spaces of operands 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

We shall now apply the methods for identifying cap half-spaces in the sums and intersections of polytopes using a simulation to ensure that a functional condition is fulfilled in a simple mechanical system, illustrated in Fig. 14
                     . This system is made up of three parts: support 1, bearing 2 and shaft 3. No degree of mobility is allowed between support 1 and bearing 2. Two degrees of mobility are allowed between the shaft 3 and the bearing 2: rotation and translation along 
                        
                           x
                        
                     .

A functional condition FC is defined across the distance 
                        d
                      between point M of the shaft 3 and the support 1: 
                        
                           (34)
                           
                              d
                              min
                              ≤
                              d
                              ≤
                              d
                              max
                              .
                           
                        
                      Considering 
                        
                           
                              d
                           
                           
                              0
                           
                        
                      the nominal value of 
                        d
                     , 
                        d
                        e
                        v
                     , 
                        d
                        e
                        
                           
                              v
                           
                           
                              inf
                           
                        
                      and 
                        d
                        e
                        
                           
                              v
                           
                           
                              sup
                           
                        
                      such that: 
                        
                           
                              
                                 d
                                 e
                                 v
                                 =
                                 d
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              
                                 d
                                 e
                                 
                                    
                                       v
                                    
                                    
                                       inf
                                    
                                 
                                 =
                                 d
                                 min
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              
                                 d
                                 e
                                 
                                    
                                       v
                                    
                                    
                                       sup
                                    
                                 
                                 =
                                 d
                                 max
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 .
                              
                           
                        
                      The equation can still be written: 
                        
                           (35)
                           
                              d
                              e
                              
                                 
                                    v
                                 
                                 
                                    inf
                                 
                              
                              ≤
                              d
                              e
                              v
                              ≤
                              d
                              e
                              
                                 
                                    v
                                 
                                 
                                    sup
                                 
                              
                              .
                           
                        
                      The variable 
                        d
                        e
                        v
                      is the deviation in translation along 
                        
                           y
                        
                      of point M on shaft 3 in relation to support 1, with a lower bound of 
                        d
                        e
                        
                           
                              v
                           
                           
                              inf
                           
                        
                      and an upper bound of 
                        d
                        e
                        
                           
                              v
                           
                           
                              sup
                           
                        
                     .

The purpose of this application is to simulate the compliance of the mechanical system in terms of the functional condition FC, given the geometric variations assigned to parts 1, 2 and 3.

This example will be considered in the normal plane 
                        
                           z
                        
                      containing point M. Thus each displacement will be defined by three parameters: rotation along 
                        
                           z
                        
                     , translation along 
                        
                           x
                        
                      and translation along 
                        
                           y
                        
                     . The polytopes manipulated will be 3 dimension and can be represented graphically.

Parts 1, 2 and 3 are made up solely of plane and cylindrical surfaces.

We write the surface j of part i as i, j.

Surfaces 2, 4 and 3, 4 are cylindrical; surfaces 1, 1; 1, 2; 1, 3; 1, 4; 2, 1; 2, 2 and 2, 3 are plane surfaces, see Fig. 15
                        .

The topological structure of the mechanical system is set out in a graph  [32], see Fig. 15.

For each surface i, j there is a corresponding vertex 
                           i
                        , 
                           j
                         on the graph. Vertices 1, 0; 2, 0 and 3, 0 correspond to nominal models of parts 1, 2 and 3 respectively: see Fig. 15.

An edge connected to a vertex designated 
                           i
                        , 0 (
                           i
                           =
                           1
                        , 2 or 3) corresponds to position deviations of a surface i, j in relation to its nominal position.

A geometric polytope is associated to each edge connected to a vertex designated 
                           i
                        , 0 (
                           i
                           =
                           1
                        , 2 or 3). This polytope characterizes the variations in position of a surface i, j in relation to its nominal surface inside a tolerance zone of dimension 
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        .

For a plane surface 
                           i
                        ,
                           j
                        , 
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is the distance between two parallel planes arranged symmetrically in relation to a nominal plane as shown in Fig. 4.

For a cylindrical surface, 
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is the diameter of a coaxial cylinder with the axis of the corresponding nominal cylinder.

Parts 1, 2 and 3 are positioned according to four contact specifications  [33] so that:


                        
                           
                              •
                              contact between surfaces 1, 1 and 2, 1 is “unilateral”, planar pair type, contact element normal plane 
                                    
                                       y
                                    
                                 , nature of contact is sliding (i.e. clearance 
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                  between 1, 1 and 2, 1 is null).

The two contacts between surfaces 1, 2 / 2, 2 and 1, 3 / 2, 3 respectively are unilateral, cylinder-and-plane pair type, contact element is a straight line parallel to 
                                    
                                       z
                                    
                                  contained within a normal plane 
                                    
                                       x
                                    
                                 , nature of contact: floating.

contact between 3, 4 and 2, 4 is bilateral, cylindrical pair type, contact element is a cylinder with director vector 
                                    
                                       x
                                    
                                 , nature of contact is floating (clearance 
                                    
                                       
                                          J
                                       
                                       
                                          4
                                       
                                    
                                  between 2, 4 and 3, 4 is such that: 
                                    
                                       
                                          J
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          2
                                          ,
                                          4
                                       
                                    
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          3
                                          ,
                                          4
                                       
                                    
                                  with 
                                    
                                       
                                          J
                                       
                                       
                                          4
                                       
                                    
                                    >
                                    0
                                 ).

An edge between two surfaces of two distinct parts corresponds to the position deviations between two surfaces potentially in contact.

A contact polytope is associated to each edge connected between two surfaces of two distinct parts. The four contact polytopes of the system studied here derive from the four contact specifications formulated above; they will be described in more detail in the following section.

Finally, an additional edge, labeled FC defines the functional condition between surfaces 3, 4 and 1, 4. A “functional polyhedron” is associated to this edge, derived from the functional constraints defined in Eq. (35).

The different points (I, J, L, M, N …) marked in Fig. 16
                         define the geometric constraints, contact constraints and cap half-spaces needed to characterize operand polytopes.


                        Table 3
                         summarizes the definition of geometric polytopes associated to the respective surfaces identified in Fig. 15, and according to the procedure described in Section  3.3.1.

For geometric polytopes associated to surfaces 2, 2 and 2, 3 respectively, we consider 
                           
                              
                                 L
                              
                              
                                 4
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 5
                              
                           
                        , see Fig. 16.

We designate as 
                           
                              
                                 P
                              
                              
                                 i
                                 ,
                                 j
                                 /
                                 i
                                 ,
                                 0
                              
                           
                         the geometric polytope characterizing position variations between surface i, j and its nominal model i,0. Table 4
                         summarizes the definition of contact polytopes associated respectively to the four contact specifications of the system studied, according to the procedure described in Section  3.3.2.

We designate as 
                           
                              
                                 P
                              
                              
                                 i
                                 ,
                                 j
                                 /
                                 u
                                 ,
                                 v
                              
                           
                         the contact polytope characterizing the position variations between surface i, j and surface 
                           u
                        , 
                           v
                        .

Because of the topological structure of the graph it is possible to define the operations required between operand polytopes to determine polytope 
                           
                              
                                 P
                              
                              
                                 3
                                 ,
                                 4
                                 /
                                 1
                                 ,
                                 4
                              
                           
                         characterizing variations in position between surfaces 3, 4 and 1, 4  [12,24].

Polytope 
                           
                              
                                 P
                              
                              
                                 3
                                 ,
                                 4
                                 /
                                 1
                                 ,
                                 4
                              
                           
                         is defined by the equation given in Box I
                        .

For easier writing and in accordance with the method described in Section  5, the operator 
                           ∩
                         designates an operation to determine the intersection between:


                        
                           
                              •
                              a circumscribed right hyper-parallelepiped at the union of the operand vertices,

the non-cap half-spaces of the operand polytopes.

The compliance of the mechanical system is validated by including the calculated polytope 
                           
                              
                                 P
                              
                              
                                 3
                                 ,
                                 4
                                 /
                                 1
                                 ,
                                 4
                              
                           
                         in the functional polyhedron 
                           
                              
                                 P
                              
                              
                                 3
                                 ,
                                 4
                                 /
                                 1
                                 ,
                                 4
                              
                              
                                 f
                              
                           
                         according to the resultant of the FC condition defined in: 
                           
                              (37)
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                       ,
                                       4
                                       /
                                       1
                                       ,
                                       4
                                    
                                 
                                 ⊆
                                 
                                    
                                       P
                                    
                                    
                                       3
                                       ,
                                       4
                                       /
                                       1
                                       ,
                                       4
                                    
                                    
                                       f
                                    
                                 
                                 .
                              
                           
                         The equation can be written as: 
                           
                              (38)
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                          ,
                                          4
                                          /
                                          1
                                          ,
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          3
                                          ,
                                          4
                                          /
                                          2
                                          ,
                                          4
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          4
                                          /
                                          2
                                          ,
                                          0
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          ,
                                          0
                                          /
                                          1
                                          ,
                                          1
                                       
                                    
                                    ⊕
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ∩
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       ∩
                                       
                                          
                                             P
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    with
                                    :
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          0
                                          /
                                          2
                                          ,
                                          1
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          1
                                          /
                                          1
                                          ,
                                          1
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          ,
                                          1
                                          /
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          0
                                          /
                                          2
                                          ,
                                          2
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          2
                                          /
                                          1
                                          ,
                                          2
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          ,
                                          2
                                          /
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          0
                                          /
                                          2
                                          ,
                                          3
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          ,
                                          3
                                          /
                                          1
                                          ,
                                          3
                                       
                                    
                                    ⊕
                                    
                                       
                                          P
                                       
                                       
                                          1
                                          ,
                                          3
                                          /
                                          1
                                          ,
                                          0
                                       
                                    
                                    .
                                 
                              
                           
                         Firstly, polytopes 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         are determined by applying the method described in Section  4. Polytopes 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         are then determined using the method described in Section  5. Lastly, polytope 
                           
                              
                                 P
                              
                              
                                 3
                                 ,
                                 4
                                 /
                                 1
                                 ,
                                 4
                              
                           
                         is deduced from 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         and other operands by applying the method in Section  4.

To simplify the graphs, the following points have been considered:


                        
                           
                              •
                              the dimensions of the tolerance zones 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                  are all equal one with another, with 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    >
                                    0
                                 ,

clearance 
                                    
                                       
                                          J
                                       
                                       
                                          4
                                       
                                    
                                  is such that: 
                                    
                                       
                                          J
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 .


                        
                           
                              •
                              facets shown in shaded mode are non-cap facets,

facets shown in wireframe mode are cap facets.

Polytopes 
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    1
                                    /
                                    2
                                    ,
                                    0
                                 
                              
                            are identical and their center of symmetry is the origin of the displacements; only facets orthogonal to direction 
                              
                                 
                                    t
                                 
                                 
                                    M
                                    −
                                    x
                                 
                              
                            are cap facets: see Table 3. Polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    1
                                 
                              
                            may be considered as a polytope reduced to a single vertex corresponding to the origin of the displacements, given the contact constraints defined in Table 3. Definitions of geometric polytopes.


                           Fig. 17
                           (a) shows the determining of polytope 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    0
                                    /
                                    2
                                    ,
                                    1
                                 
                              
                              ⊕
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    1
                                 
                              
                              ⊕
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                           ) in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            where 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    1
                                 
                              
                           , a neutral element of the Minkowski sum, is not shown. Fig. 17(b) shows a projection of polytope 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            in 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           , in the plane 
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       M
                                       −
                                       y
                                    
                                 
                                 )
                              
                           . In this example, the topology of polytope 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            is identical to the topologies of 
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    1
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    1
                                    /
                                    2
                                    ,
                                    0
                                 
                              
                            given that the Minkowski sum between two isometric polytopes resembles a homothety coefficient of 2  [20]. Only the facets of 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            orthogonal to direction 
                              
                                 
                                    t
                                 
                                 
                                    M
                                    −
                                    x
                                 
                              
                            are cap facets.

Polytopes 
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    2
                                    /
                                    2
                                    ,
                                    0
                                 
                              
                            are identical and their center of symmetry is the origin of the displacements, see Table 3. The non-cap facets of 
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    2
                                    /
                                    2
                                    ,
                                    0
                                 
                              
                            are those which are orthogonal to direction 
                              
                                 
                                    t
                                 
                                 
                                    M
                                    −
                                    y
                                 
                              
                           .

Polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    2
                                 
                              
                            is not centered at the origin of the displacements and has only one non-cap facet corresponding to its only contact constraint, see Table 3.

By applying the method developed in Section  4, we can deduce polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            (with 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    0
                                    /
                                    2
                                    ,
                                    2
                                 
                              
                              ⊕
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    2
                                 
                              
                              ⊕
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    0
                                 
                              
                           ) shown in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            in Fig. 18
                           (a).


                           Fig. 18(b) shows a projection of polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            in 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           , in the plane 
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       M
                                       −
                                       y
                                    
                                 
                                 )
                              
                           .

Polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            has only one non-cap facet resulting from the only non-cap facet of contact polytope 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    2
                                    /
                                    1
                                    ,
                                    2
                                 
                              
                           .

Similarly, Fig. 19
                           (a) shows the determination of 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       2
                                       ,
                                       0
                                       /
                                       2
                                       ,
                                       3
                                    
                                 
                                 ⊕
                                 
                                    
                                       P
                                    
                                    
                                       2
                                       ,
                                       3
                                       /
                                       1
                                       ,
                                       3
                                    
                                 
                                 ⊕
                                 
                                    
                                       P
                                    
                                    
                                       1
                                       ,
                                       3
                                       /
                                       1
                                       ,
                                       0
                                    
                                 
                                 )
                              
                            in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            and Fig. 19(b) shows a projection of 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            in 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           , in the plane 
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       M
                                       −
                                       y
                                    
                                 
                                 )
                              
                           .

We shall apply the method described in Section  5 to determine 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           .

Let us define a circumscribed right parallelepiped at the union of the vertices of 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           : see Fig. 20
                           .

The intersection of this parallelepiped with the non-cap half-spaces of 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            generates 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           : see Fig. 20.

This example shows that if 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            is calculated with a conventional intersection algorithm, the result will be different and will not correspond to the expected result in a tolerance analysis problem.

The determination of 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ∩
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            is an unusual case, where the intersection of the non-cap half-spaces of the operands generates a bounded set. The resulting polytope contains no cap half-spaces, see Fig. 21
                           .

In this case, the intersection of a circumscribed right hyper-parallelepiped at the union of the vertices of operands 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ∩
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            with the non-cap half-spaces of these operands gives the same result as the intersection of the non-cap half-spaces: see Fig. 21.

Determination of 
                              
                                 
                                    P
                                 
                                 
                                    3
                                    ,
                                    4
                                    /
                                    1
                                    ,
                                    4
                                 
                              
                            is shown in Fig. 22
                           . Note that polytopes 
                              
                                 
                                    P
                                 
                                 
                                    3
                                    ,
                                    4
                                    /
                                    2
                                    ,
                                    4
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    ,
                                    4
                                    /
                                    2
                                    ,
                                    0
                                 
                              
                            are identical as 
                              
                                 
                                    t
                                 
                                 
                                    2
                                    ,
                                    4
                                 
                              
                              =
                              
                                 
                                    J
                                 
                                 
                                    4
                                 
                              
                            according to the hypotheses put forward at the beginning of Section  6.3. All the operand polytopes 
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       3
                                       ,
                                       4
                                       /
                                       2
                                       ,
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                       ,
                                       4
                                       /
                                       2
                                       ,
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       1
                                       ,
                                       0
                                       /
                                       1
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                   and  
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            and hence polytope 
                              
                                 
                                    P
                                 
                                 
                                    3
                                    ,
                                    4
                                    /
                                    1
                                    ,
                                    4
                                 
                              
                            are centered at the origin of the displacements.

By applying the method described in Section  4 it can be seen that polytope 
                              
                                 
                                    P
                                 
                                 
                                    3
                                    ,
                                    4
                                    /
                                    1
                                    ,
                                    4
                                 
                              
                            is made up of two cap polyhedra shown in wireframe in Fig. 22. This means that it is not possible to control geometric variations at point M in translation along direction 
                              
                                 x
                              
                            between surfaces 3, 4 and 1, 4.

This specific feature is due to:


                           
                              
                                 •
                                 the mobility in translation along 
                                       
                                          x
                                       
                                     between parts 3 and 1,

the displacements in translation along 
                                       
                                          x
                                       
                                     leaving surfaces 3, 4 and 1, 4 invariant.


                           Fig. 23
                            shows a calculated polytope 
                              
                                 
                                    P
                                 
                                 
                                    3
                                    ,
                                    4
                                    /
                                    1
                                    ,
                                    4
                                 
                              
                            included in the functional polyhedron defined in Eq. (35). Using the descriptors “cap” and “non-cap” for the vertices and facets of polytopes in operations applied here it is clear that this inclusion does not depend on cap half-spaces. From this we deduce that the position variations at point M in translation along 
                              
                                 y
                              
                            between surfaces 3, 4 and 1, 4 can be controlled. As a result, the functional condition FC defined in Eq. (35) is respected.

In this example, the operand polytopes have been computed with the following numerical values: 
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       0.1
                                       
                                       mm ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       150
                                       
                                       mm ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       80
                                       
                                       mm .
                                    
                                 
                              
                            The extreme displacements 
                              
                                 
                                    e
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    e
                                 
                                 
                                    max
                                 
                              
                            at point M in translation along 
                              y
                           -axis 
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       M
                                       −
                                       y
                                    
                                 
                                 )
                              
                            are equal to −0.758 mm and 
                              +
                           0.758 mm respectively.

The mechanical system is compliant with the functional condition FC defined by (35) if: 
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             d
                                             e
                                             
                                                
                                                   v
                                                
                                                
                                                   inf
                                                
                                             
                                             ≤
                                             
                                                
                                                   e
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             e
                                             
                                                
                                                   v
                                                
                                                
                                                   sup
                                                
                                             
                                             ≥
                                             
                                                
                                                   e
                                                
                                                
                                                   max
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                            The extreme displacements 
                              
                                 
                                    e
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    e
                                 
                                 
                                    max
                                 
                              
                            obtained by a classical 1d stack-up are equal to −0.25 mm and 
                              +
                           0.25 mm respectively.

The difference between the results (0.508 mm) is due to the rotation effects.

In the first part of this article, we showed how geometric constraints characterizing the displacements of a surface within a tolerance zone can be made compliant with a geometric polyhedron. In the same way, contact constraints characterizing relative displacements between two surfaces potentially in contact can be made compliant with a contact polyhedron. Cap half-spaces were introduced to be able to delimit geometric polyhedra to transform them into geometric polytopes. These cap half-spaces limit the unbounded displacements of a surface within a tolerance zone. In the same way, contact polyhedra were delimited by cap half-spaces to give contact polytopes. These half-spaces limit the unbounded displacements between two surfaces potentially in contact.

Thus the relative position of any two surfaces of a mechanical system can be formalized by operations, Minkowski sum and intersection, on operand polytopes of 
                        
                           
                              R
                           
                           
                              6
                           
                        
                     . The reason for using cap half-spaces to delimit polyhedra so they become polytopes is related to the algorithmic complexity of Minkowski sums of polyhedra of 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     .

In the second part the mechanisms to identify the cap half-spaces of a Minkowski sum and an intersection were described. The influence of cap half-spaces on the topology of a polytope obtained by summation or intersection is paramount to validate the compliance of a mechanical system in terms of a functional requirement.

The third part demonstrated how operations on polytopes are carried out to simulate compliance of a simple mechanism in terms of a functional condition.

Although the sample application is treated as a plane problem where only polytopes of 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      could be handled, the mechanisms to identify cap half-spaces in the sums and intersections can be used in 
                        
                           
                              R
                           
                           
                              6
                           
                        
                      with no restrictions.

A prototype of tolerance analysis software is currently being developed based on the concepts of algorithmic geometry presented in this article. With this tool it will be possible to calculate the sums and intersections of polytopes of 
                        
                           
                              R
                           
                           
                              6
                           
                        
                      and ensure that cap half-spaces are identified. In future it should be possible to use this tool to experiment on complex mechanical systems.

If the calculated polytope is not included in the functional polyhedron, or does not fill the functional polyhedron, the values of the tolerances and clearances have to be optimized.

Using the tool presented here it will be possible to determine the contributing constraints from the operands on the critical vertices of the resultant polytope. It is hoped to extend this work in future and develop the tolerance allocation from knowledge of the contributing constraints

@&#REFERENCES@&#

