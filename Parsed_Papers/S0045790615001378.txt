@&#MAIN-TITLE@&#Segmentation of erythrocytes infected with malaria parasites for the diagnosis using microscopy imaging

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Edge-based segmentation of erythrocytes infected with malaria parasites in microscopic images.


                        
                        
                           
                           Gamma equalization for contrast enhancement can improves the segmentation performance.


                        
                        
                           
                           Proposed method outperforms others traditional edge segmentation methods.


                        
                        
                           
                           To facilitate segmentation performance, a confusion matrix is proposed.


                        
                        
                           
                           The proposed method is useful for pathologists in the diagnosis of malaria.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Microscopic images

Malaria diagnosis

Mathematical morphology

Edge detection

Confusion matrix

@&#ABSTRACT@&#


               
               
                  Malaria, one of the deadliest diseases, is responsible for nearly 627,000 deaths every year. It is diagnosed manually by pathologists using a microscope. It is time-consuming and subjected to inconsistency due to human intervention, so computerized image analysis for diagnosis has gained importance. In this article, an edge-based segmentation of erythrocytes infected with malaria parasites using microscopic images has been developed to facilitate the diagnostic process. The color space transformation and Gamma equalization reduce the effects of colors and correct luminance differences of images. Fuzzy C-means clustering is applied to extract infected erythrocytes, which is further processed for the final segmentation. The experimental results showed that the proposed method can gain 98%, 93.3%, 98.65% and 90.33% of sensitivity, specificity, prediction value positive and prediction value negative, respectively. In conclusion, the proposed method provides a consistent and robust method of edge-based segmentation of parasite infected erythrocytes using microscopic images for diagnosis.
               
            

@&#INTRODUCTION@&#

Malaria being an infectious disease and is one of the largest global health threats that reported about 3.4billion cases of infection and was responsible for 627,000 deaths according to the world malaria report, 2013 published by the WHO [1]. Among the deceased, 77% individuals were children of less than five-year age. It is considered as endemic in 104 countries. It is caused by fives species of the parasite Plasmodium viz. P. falciparum, P. knowlesi, P. vivax, P. ovale and P. malariae. It spreads to humans via biting of infected Anopheles mosquito vectors. Of the five species, P. falciparum is the most deadly.

For the diagnosis of malaria, pathologists use light microscopy to identify infection based on color and morphological changes in the erythrocytes. However, it is a time consuming process, requires expert technicians and prone to be erroneous. Though some of the problems associated with manual microscopy can be overcome by using computer based methods. In modern diagnostics, digital image processing has considerably increased the accuracy in the medical imaging. In this regard, segmentation plays a vital role. The Segmentation methods can be classified as: region-based, edge-based, histogram thresholding, clustering, morphological, model-based, active contours and soft computing [2]. There are some difficulties in edge-based segmentation of parasite infected erythrocytes in microscopic images: low contrast, lack of clear edges in infected erythrocytes due to similar intensity profiles, colors, noises and irregular edges. In the current study, an edge-based segmentation of infected erythrocytes is proposed to address the above problems to accurately segment infected edges in microscopic images for the diagnosis.

The significant contributions of this paper are as follows:
                        
                           I.
                           We propose an edge-based segmentation method for malaria infected erythrocytes in microscopic blood images.

We examine the effect of the proposed method with other seven traditional edge-based segmentation methods and then conclude that the proposed method is successful in segmenting parasite infected erythrocytes. Hence, segmentation outperforms others traditional edge segmentation methods.

The necessity of illumination correction for low contrast images to get accurate segmentation through gamma equalization is presented. In addition, adaptive median filter was selected for noise minimization based on the quantitative measure of performance of 8 noise removal filters.

The comparison between proposed segmentation performance and state-of-the-art methods for diagnosis of malaria is realized.

The rest of the paper is organized as follows: The earlier studies on malaria diagnosis are briefly summarized in Section 2. The methodology of the proposed segmentation is detailed in Section 3. In Section 4, we describe the diagnosis process. Experimental results are shown in Section 4. Section 5 presents a discussion. Finally, conclusions are drawn in Section 6.

There are several studies suggesting a computer vision approach for the diagnosis of malaria through microscopic blood smear images [3–21]. Ross et al. [3] proposed malaria parasites detection and classification by means of the principal component analysis and back propagation neural network. Kaewkamnerd et al. [4] presented a method for malaria parasite detection and a classification system for the parasites based on thick blood images. Prasad et al. [5] proposed a digital image analysis decision support system for the parasite detection. Frean [6] introduced a reliable enumeration of malaria parasites using digital image analysis in thick blood films. Boray Tek et al. [7] used a pattern recognition frame work for the diagnosis of malaria. Besides this, they proposed parasite detection, identification of the infecting species and the life cycle stages [8]. Daniel et al. [9], to detect plasmodium parasites from microscopic blood images, used an artificial neural network. Lai et al. [10] proposed a protozoan parasite extraction technique for the microscopic images to solve and reduce the problem of the images with poor quality and complex background. Diaz et al. [11] proposed a method for the classification of erythrocytes and identification of infection stage. Salena et al. [12] proposed malaria infected erythrocytes counting for diagnosis in which adaptive histogram equalization used for enhancement of the image and separating overlapping infected cells was carried out by clump splitting.

Tek et al. [13] used k-nearest neighbor classifier for the malaria parasites classification. Vishnu et al. [14] proposed malaria parasite segmentation in an HSV color space model by detecting dominant hue range. In a recent study, Das et al. [15] introduced a machine learning approach for the malaria parasite classification and characterization. Yunda et al. [16], used a combination of AGNES and morphological gradient techniques for segmentation of malaria parasites and a neural network for the classification. Unsupervised malaria parasites detection in microscopic images by using Chan-Vese segmentation to extract boundary of RBC, has been described in [17]. Determination of plasmodium parasitemia and segmentation in thin blood smears for the diagnosis has been described [18,19]. Detection of malaria parasites using CBIR approaches for Diagnosis of malaria was introduced in [20]. Recently, Linder et al. [21] propose segmentation and parasite estimation through digitized blood smears.

Finally, to the best of our knowledge, the edge-based segmentation of erythrocytes infected with malaria parasites has not been demonstrated on microscopic blood images. Herein, we propose a method for segmentation of infected erythrocytes edges through microscopic imaging for the diagnosis of malaria. Besides, a comparison between the proposed segmentation and common edge segmentation methods, presented.

@&#METHODOLOGY@&#

In this section, we describe the methodology that facilitates the edge-based segmentation of malaria parasite infected erythrocytes through microscopic blood images. The proposed scheme applies the following methods sequentially: (a) color space transformation, (b) Illumination correction, (c) noise reduction, (d) edge enhancement, (e) fuzzy C-means clustering, (f) connected component analysis and (g) Minimum Perimeter Polygon. The flowchart of the proposed method as depicted in Fig. 1
                     , wherein, a microscopic image of the blood sample is the input. The details of the proposed method are shown in following subsections.

Microscopic blood images are commonly acquired using a digital camera with a blood smear attachment having different color tones. An input RGB (Red–Green–Blue) microscopic blood image is converted into a gray scale one for the simplicity and convenience of scalar processing (single channel) by using the following method.
                           
                              (1)
                              
                                 g
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0.299
                                                
                                                
                                                   0.587
                                                
                                                
                                                   0.114
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    f
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ,
                              
                                 
                                    f
                                 
                                 
                                    B
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    G
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           
                         represents red, blue and green channel intensities of the input image 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                        . The resultant image 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                         represents the gray level image of the color one 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                        . The result obtained by applying color space transformation to Fig. 2
                        (a) is shown in Fig. 2(b).

Illumination in the microscope blood images differs due to different experimental conditions. One of the major problems while segmenting parasite infected erythrocytes is poor contrast. Therefore, it is necessary to enhance the contrast of such images before further processing techniques can be applied. In this study, we used gamma equalization (GE) to improve contrast of the images [10,22]. The Eq. (2) was used for gamma equalization to the image 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                        . 
                           
                              (2)
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       max
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      g
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      -
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      )
                                                   
                                                   
                                                      γ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      -
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      )
                                                   
                                                   
                                                      γ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 where
                                 
                                 0
                                 <
                                 γ
                                 <
                                 1
                              
                           
                        where 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                         is the intensity value at a pixel 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         of a gray scale image, 
                           
                              
                                 
                                    g
                                 
                                 
                                    max
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              
                              and
                              
                              
                                 
                                    g
                                 
                                 
                                    min
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           
                         are maximum and minimum intensity values of a gray scale image 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                        , respectively.

The results obtained by applying gamma equalization with different values of γ to Fig. 2(b) are shown in Fig. 2(c–g). In this study, the optimum γ value to get accurate segmentation for input images is 0.8. The selection of γ value is based on the measure of entropy [23]. Entropy, defined in Eq. (3), is used to measure the uncertainty associate with gray levels in the images. Larger value of the entropy indicates that more information content is available in the image. We observed based on several experiments, for 
                           
                              γ
                              =
                              0.8
                           
                         , the entropy value of an illumination corrected image is same as of an original grayscale image. A value of γ more than 1 would cause the image to become darker. The Entropy computed for the gamma equalization used in this work for different values of γ for six images is tabulated in Table 1
                        . Some of the illumination corrected images after applying gamma equalization are shown in Fig. 3
                        .
                           
                              (3)
                              
                                 E
                                 =
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          N
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         is the probability density function (PDF) of a given image of gray levels 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         and N is the total number of gray levels in the image.

In medical image analysis, one of the challenging tasks is noise removal. Several noise removal techniques exist but all of them have some limitations [22,24]. We used adaptive median filter (AMF) technique for impulse noise reduction. The algorithm of the AMF used in this study is shown as Algorithm 1. Consider, the initialization of window size W
                        =3, 
                           
                              
                                 
                                    W
                                 
                                 
                                    med
                                 
                              
                           
                        
                        =median of gray levels in W, 
                           
                              
                                 
                                    W
                                 
                                 
                                    min
                                 
                              
                           
                        
                        =minimum of gray value in W, 
                           
                              
                                 
                                    W
                                 
                                 
                                    max
                                 
                              
                           
                        
                        =maximum of gray value in W, 
                           
                              
                                 
                                    W
                                 
                                 
                                    xy
                                 
                              
                           
                        
                        =gray value at pixel location 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    size
                                 
                              
                           
                        
                        =maximum window size. A result of applying adaptive median filter to Fig. 2(g) is shown in Fig. 4
                        (h) with 
                           
                              
                                 
                                    W
                                 
                                 
                                    max
                                 
                              
                              =
                              7
                           
                        . 
                           Algorithm 1
                           Adaptive median filter 
                                 
                                    
                                       
                                       
                                          
                                             STAGE-A:
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            med
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            med
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if 
                                                   
                                                      (
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      >
                                                      0
                                                      
                                                      and
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      <
                                                      0
                                                      )
                                                   
                                                 then go to Stage-B
                                          
                                          
                                             
                                                else
                                          
                                          
                                             
                                                
                                                W
                                                =
                                                W
                                                +2
                                          
                                          
                                             if 
                                                   
                                                      (
                                                      W
                                                      ⩽
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            size
                                                         
                                                      
                                                      )
                                                   
                                                 then repeat Stage-A
                                          
                                          
                                             
                                                else
                                          
                                          
                                             
                                                output:=
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            med
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             STAGE-B:
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            xy
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            xy
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if 
                                                   
                                                      (
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      >
                                                      0
                                                      
                                                      and
                                                      
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      <
                                                      0
                                                      )
                                                   
                                                 then
                                          
                                          
                                             
                                                output:=
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            xy
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                else
                                          
                                          
                                             
                                                output:=
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            med
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The performance of adaptive median filter with other eight noise removal filters is evaluated by using the measures [25]: SNR, PSNR, MSE and RMSE, which stands for signal-to-noise ratio, peak signal-to-noise ratio, mean square error and root mean square error, respectively, and are computed by using Eqs. (4)–(7) and the comparative study is presented in Table 2
                        . On the basis of the quantitative measures of the performance (Table 2), AMF was found to be the most significant filter to reduce the impulsive noise from the image and was used as noise reduction filter. In respect to the other filter methods, AMF has lowest MSE and highest PSNR value, which signify presence of the least error in the filtered image. The results after applying noise removal filters to Fig. 2(b) are shown in Fig. (4).
                           
                              (4)
                              
                                 SNR
                                 =
                                 10
                                 ·
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      [
                                                      f
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ]
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      [
                                                      f
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      -
                                                      g
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ]
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 PSNR
                                 =
                                 10
                                 ·
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                max
                                                (
                                                f
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      mn
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      [
                                                      f
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      -
                                                      g
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ]
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 MSE
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             x
                                             =
                                             0
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             y
                                             =
                                             0
                                          
                                          
                                             n
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             [
                                             f
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             -
                                             g
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       mn
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 RMSE
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   x
                                                   =
                                                   0
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   y
                                                   =
                                                   0
                                                
                                                
                                                   n
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   [
                                                   f
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   -
                                                   g
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ]
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             mn
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In general, the infected erythrocytes appear darker than the normal ones in infected blood sample; and the contours of the malaria parasite infected erythrocytes are the darkest areas. The edge enhancement [10,22] is used to enhance the contrast between infected erythrocytes edges and the background pixels to get better erythrocytes segmentation performance. The algorithm for edge enhancement is given as Algorithm 2. The result of applying edge enhancement to the image Fig. 9(b) is shown in Fig. 9(e).
                           Algorithm 2
                           Edge enhancement 
                                 
                                    
                                       
                                       
                                          
                                             Input: Noise reduction image
                                          
                                          
                                             Output: Image with Enhanced edges
                                          
                                          
                                             
                                                
                                                   
                                                      Step 1:
                                                      The gray values are arranged in ascending order by considering 
                                                            
                                                               n
                                                               ×
                                                               n
                                                            
                                                          window.
                                                   
                                                   
                                                      Step 2:
                                                      Calculate median value say, M.
                                                   
                                                   
                                                      Step 3:
                                                      Divide into two classes namely 
                                                            
                                                               
                                                                  
                                                                     G
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               =
                                                               {
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     M
                                                                  
                                                               
                                                               }
                                                               
                                                               and
                                                               
                                                               
                                                                  
                                                                     G
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               =
                                                               {
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               }
                                                            
                                                         .
                                                   
                                                   
                                                      Step 4:
                                                      Calculate mean values X
                                                         1, X
                                                         2 and X
                                                         3 of the gray values of pixels of 
                                                            
                                                               n
                                                               ×
                                                               n
                                                            
                                                          matrix, class G
                                                         1 and G
                                                         2, respectively.
                                                   
                                                   
                                                      Step 5:
                                                      The intensity of the pixel 
                                                            
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                            
                                                          is 
                                                            
                                                               f
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                            
                                                          and is computed as follows.
                                                            
                                                               
                                                                  f
                                                                  (
                                                                  x
                                                                  ,
                                                                  y
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          2
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    if
                                                                                    
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          2
                                                                                       
                                                                                    
                                                                                    ⩽
                                                                                    G
                                                                                    ⩽
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          1
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          3
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    if
                                                                                    
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          1
                                                                                       
                                                                                    
                                                                                    ⩽
                                                                                    G
                                                                                    ⩽
                                                                                    
                                                                                       
                                                                                          X
                                                                                       
                                                                                       
                                                                                          3
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    G
                                                                                 
                                                                                 
                                                                                    elsewhere
                                                                                    .
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

A soft clustering method Fuzzy C-means (FCM) has been widely applied to medical imaging problems, especially for segmentation [22]. We imply FCM algorithm to extract the malaria infected erythrocytes from microscopic images. The number of clusters is set two. It utilizes a membership value 
                           
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                              
                           
                         to indicate the degree of membership of the ith data point to the jth cluster, which is permissible for segmentation as microscopic blood images are usually heterogeneous. The main objective of FCM is to minimize the cost function J as in Eq. (8).
                           
                              (8)
                              
                                 J
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          c
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       m
                                    
                                 
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 
                                 where
                                 ,
                                 
                                 m
                                 ∈
                                 [
                                 1
                                 ,
                                 ∞
                                 )
                              
                           
                        subject to the constraints,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                                
                                                   where
                                                   
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ⩽
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   >
                                                   0
                                                   ,
                                                
                                                
                                                   for
                                                   
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   c
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where n-is the number of data points, 
                           
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              ‖
                           
                         is the Euclidean distance between ith data-point and jth cluster center and c-indicates the number of clusters 
                           
                              (
                              c
                              ⩽
                              n
                              )
                           
                        . The FCM is optimized when pixels close to their centroids are assigned high membership values, and those that are far away are assigned low values. A solution to the objective functionJ as in Eq. (8) can be obtained via an iterative process. For this, the membership function 
                           
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                              
                           
                         as in Eq. (9) and centroids 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         as in Eq. (10) are updated iteratively until minimum J is achieved.
                           
                              (9)
                              
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             -
                                             2
                                             /
                                             (
                                             m
                                             -
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             c
                                          
                                       
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             -
                                             2
                                             /
                                             (
                                             m
                                             -
                                             1
                                             )
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 
                                 and
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 c
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 c
                              
                           
                        The criterion used to terminate iteration is 
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                              <
                              ∈
                           
                         , where k-is the iteration steps and 
                           
                              ∈
                           
                         is terminating factor lies between 0 and 1. The results obtained after applying FCM to extract malaria parasite infected erythrocytes are shown in Fig. 5
                        .

The purpose of this step was to improve the parasite extracted binary image obtained from FCM method. A morphological method, erosion, was used to erase some small noises and spots. Holes inside the infected erythrocytes were filled using hole filling operation for the final segmentation.

Some of the infected parasite extracted binary images by FCM, showed extra erythrocytes regions appearing in the surrounding infected erythrocytes. These regions needs to be eliminated in the noise reduction step, since they have the intensity values similar to that of the infected erythrocytes and may be mis-segmented as infected. To refine the final segmented results, a morphological binary erosion operation was used to erase such small noises and smoothen the outcome [24]. The erosion of the binary image 
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            by structuring element (STREL) 
                              
                                 s
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            produced a new binary image 
                              
                                 g
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            as shown in Eq. (11).
                              
                                 (11)
                                 
                                    g
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    AND
                                    {
                                    W
                                    [
                                    f
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ]
                                    }
                                 
                              
                           
                           
                              
                                 
                                    where
                                    
                                    W
                                    [
                                    f
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ]
                                    =
                                    
                                       
                                          
                                             f
                                             (
                                             x
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             y
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             :
                                             [
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             ]
                                             ∈
                                             s
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                    
                                 
                              
                           In this study, 
                              
                                 3
                                 ×
                                 3
                              
                            square STREL selected for erosion operation. Several structuring elements of sizes, a 
                              
                                 3
                                 ×
                                 3
                                 ,
                                 5
                                 ×
                                 5
                              
                            and 
                              
                                 7
                                 ×
                                 7
                              
                            were tested. After several trials, it was observed that 
                              
                                 5
                                 ×
                                 5
                                 ,
                                 7
                                 ×
                                 7
                              
                            structuring elements eliminated some of the infected erythrocytes pixels, while 
                              
                                 3
                                 ×
                                 3
                              
                            square SE offered the best results.

In some of the parasite extracted images obtained by FCM, there might be holes in the centers of the erythrocytes. These holes need to be filed in order to get exact segmentation of infected erythrocytes for further processing [24]. Suppose 
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is the parasite extracted image after applying FCM, we choose the marker image, 
                              
                                 h
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           , to be black everywhere except the image border, where it is set to complement the image 
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           . The holes filled image is a binary one 
                              
                                 G
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is equal to 
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           , with all holes filled, and is given in Eq. (13). The procedure to fill holes in infected erythrocytes is illustrated in Fig. 6
                           . The results after applying connected component analysis to parasite extracted images in second row of Fig. 5 are shown in Fig. 7
                           . The specific parameter values for the operations used in connected component analysis step are depicted in Table 3
                           .
                              
                                 (12)
                                 
                                    h
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      f
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      is
                                                      
                                                      on
                                                      
                                                      the
                                                      
                                                      border
                                                      
                                                      of
                                                      
                                                      f
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    G
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    1
                                    -
                                    {
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    [
                                    h
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ]
                                    }
                                 
                              
                           
                        

After the ‘connected component analysis’, the segmentation of infected erythrocytes was carried out by Minimum-Perimeter Polygon (MPP) algorithm [24]. It uses two ‘crawler’ points viz. a black crawler (
                           
                              
                                 
                                    b
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         and a white crawler
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        . The black crawler 
                           
                              
                                 
                                    b
                                 
                                 
                                    c
                                 
                              
                           
                         Crawls along mirrored concave vertices whereas while crawler 
                           
                              
                                 
                                    w
                                 
                                 
                                    c
                                 
                              
                           
                         crawls along convex vertices. These two crawler points, the last MPP vertex found, and the vertexes being examined are all that is shown as Algorithm 3. Besides, we applied Beucher Gradient [25] for parasite extracted images by FCM, we obtained infected erythrocytes edges and hence which works well. The edge-based segmentation results after applying MPP to first row images in Fig. 5 are depicted in Fig. 8
                        .

Consider the points 
                           a
                           =
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           )
                           ,
                           b
                           =
                           (
                           
                              
                                 x
                              
                              
                                 2
                                 ,
                              
                           
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           )
                         and 
                           
                              c
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                    ,
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         and can be represented in the matrix form as given below.
                           
                              
                                 A
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        From the above matrix on three points a, b and c, we define
                           
                              (14)
                              
                                 Δ
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 )
                                 =
                                 
                                    
                                       (
                                       -
                                       1
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       (
                                       -
                                       1
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       2
                                       )
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       (
                                       -
                                       1
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       3
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        It follows from analysis that,
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   c
                                                   )
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                   if
                                                   
                                                   c
                                                   
                                                   lies
                                                   
                                                   on
                                                   
                                                   the
                                                   
                                                   line
                                                   
                                                   through
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                             
                                             
                                                
                                                   Δ
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   c
                                                   )
                                                   <
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   c
                                                   
                                                   lies
                                                   
                                                   negative
                                                   
                                                   side
                                                   
                                                   of
                                                   
                                                   the
                                                   
                                                   line
                                                   
                                                   through
                                                   
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                             
                                             
                                                
                                                   Δ
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   c
                                                   )
                                                   >
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   c
                                                   
                                                   lies
                                                   
                                                   positive
                                                   
                                                   side
                                                   
                                                   of
                                                   
                                                   the
                                                   
                                                   line
                                                   
                                                   through
                                                   
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Algorithm 3
                           MPP algorithm. 
                                 
                                    
                                       
                                       
                                          
                                             Input: Parasite extracted image by FCM
                                          
                                          
                                             Output: Segmented edges of infected erythrocytes
                                          
                                          
                                             Step 1: Initialize 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             Step 2: if 
                                                   
                                                      Δ
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      >
                                                      0
                                                   
                                                 then next vertex is 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and let 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and hence we reinitialize 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and proceed with the next vertex after 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             Step 3: if 
                                                   
                                                      Δ
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      0
                                                   
                                                 then 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 becomes candidate vertex and 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 or if 
                                                   
                                                      Δ
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ⩾
                                                      0
                                                   
                                                 then put 
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                 and continue with next vertex.
                                          
                                          
                                             Step 4: if 
                                                   
                                                      Δ
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      <
                                                      0
                                                   
                                                 then the next vertex will be 
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and reinitialize by 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and continue with next vertex after 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             Step 5: Repeat until the starting vertex is reached.
                                          
                                       
                                    
                                 
                              
                           

The final edge-based segmentation of the erythrocytes infected with malaria is considered for diagnosis process. In the segmented image, the erythrocytes edges are interpreted as malarial infection (test: positive), whereas absence of erythrocytes edges indicates a healthy condition (test: negative). The overall edge-based segmentation processes, and diagnosis result is shown in Fig. 9
                        .

@&#EXPERIMENTAL RESULTS@&#

The entire proposed segmentation method outlined in Fig. 1 was carried out by using 180 microscopic blood images that included malaria infected and healthy blood samples [7,8]. In this section, the proposed segmentation results, numerical analysis of the segmentation accuracy; and a comparison of the proposed segmentation method with seven traditional segmentation methods presented.

Initially, all microscopic blood images were analyzed without using gamma equalization. For few of the images, the segmentation leads to native results for infected erythrocytes due to the illumination effects. Consequently, gamma equalization was introduced to improve the accuracy. The gamma equalization considerably improved the segmentation. In Fig. 10
                        , the second and third row images are the segmented erythrocytes infected with malaria parasites using and without using gamma equalization, respectively, of the first row original blood images. It is evident that, the proposed segmentation method with gamma equalization provides more accurate segmentation results. The method gets the best segmentation performance when 
                           
                              γ
                              =
                              0.8
                           
                        , which is the most optimum value tested for all the images. The results of applying the proposed segmentation method to few microscopic blood images are shown in Fig. 11
                        . In order to test the performance, the experiment was also conducted on the images of the healthy blood samples and its works well.

For evaluating the performance of our method we make use of sensitivity (SE), specificity (SP), and prediction value positive (PVP) and prediction value negative (PVN). For this purpose, a confusion matrix as shown in Eq. (16) was calculated. The elements of the confusion matrix and its description are shown in Table 4
                        .
                           
                              (16)
                              
                                 C
                                 =
                                 {
                                 [
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ]
                                 :
                                 1
                                 ⩽
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ⩽
                                 2
                                 }
                              
                           
                        The confusion matrix becomes identity matrix in the optimal case of the perfect segmentation as given in Eq. (17).
                           
                              (17)
                              
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   i
                                                   =
                                                   j
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   elsewhere
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The evaluation measures SE (for i
                        =1), SP (for j
                        =2), PVN (for j
                        =2) and PVP (for j
                        =1) are calculated by Eqs. (18)–(21) respectively.
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ii
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             jj
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             jj
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             jj
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                           
                        The overall accuracy of the method is calculated by using Eq. (22).
                           
                              (22)
                              
                                 Acc
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     12
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     22
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     22
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     21
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 %
                              
                           
                        The mis-segmentation error (MSER) can be calculated using Eq. (23). The smaller MSER represents the higher segmentation accuracy. The accuracy determined by using Eq. (22) may not be an adequate performance measure when the number of negative cases is more than the number of positive ones. Therefore, the other performance measure that accounts for this is PVP in product, which is called F-measure and computed using Eq. (24). The α coefficient 
                           
                              (
                              0
                              <
                              α
                              <
                           
                        1) allows turning over relative weights to true positive (TP) and precision rates. In the current study, F-measure was computed by setting 
                           
                              α
                              =
                              0.4
                           
                         , so the search was addressed to detect TP.
                           
                              (23)
                              
                                 MSER
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               ⩽
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               ⩽
                                                               2
                                                            
                                                            
                                                               i
                                                               =
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 F
                                 =
                                 
                                    
                                       (
                                       PVP
                                       ∗
                                       SE
                                       )
                                    
                                    
                                       (
                                       α
                                       ∗
                                       SE
                                       +
                                       (
                                       1
                                       -
                                       α
                                       )
                                       PVP
                                       )
                                    
                                 
                              
                           
                        
                     


                        Table 5
                         summarizes the performance measures of the proposed segmentation method. It can be seen that when image equalization is used, the method gives better accuracy than without using it. SE (98%) indicates the probability of the segmentation results being positive given that the image is of a malaria infected sample. SP (93.3%) indicates the probability of the segmentation results being negative given that the image is not of a parasite infected sample. PVP (98.65%) reveals that the probability of the stained object to be a parasite given a positive result. PVN shows that the negative case (of PVP) is 90.33%.

In this sub section, we compared seven traditional existing edge segmentation methods, namely Sobel, Prewitt, Roberts, Log, Zero-cross, Canny and Watershed segmentation, with the proposed method [22]. The results of this comparison are shown in the Fig. 12
                        . It can be concluded that these methods are unable to segment the infected erythrocytes edges and detect many unwanted erythrocytes edges. In addition, Watershed segmentation algorithm has a problem of over-segmentation.

The present study clearly outlines inefficiency of the common edge-based segmentation methods in segmentation of the malaria parasites infected erythrocytes edges. On the other hand, the proposed scheme is robust, automatic, and stable to gain accurate parasite segmentation; even the color, irregular edges, background complex and luminance of the parasites are distinguished. In order to increase the accuracy, we applied gamma equalization to improve contrast of the images. Applying gamma equalization resulted in more accuracy compared to without gamma equalization. An effect of applying gamma equalization is shown in Fig. 10. Besides, the comparison of the proposed methods results with prior existing methods for automatic diagnosis of malaria is summarized in Table 7.

@&#DISCUSSION@&#

Automated diagnosis of malaria using microscopic images is still a challenging task. The proposed method provides segmentation of malaria infected erythrocytes for diagnosis. There are several methods of automatic malaria diagnosis [3–21], but most of them focus on detection, region-based segmentation, classification, parasite count, etc. and none of the methods yields 100% accuracy. Moreover, to the best of our knowledge, there is no study on edge-based segmentation for the diagnosis. The main aim of this study was to accurately segment edges of infected erythrocytes. The obtained results outwit what has been so far reported in the literature for both infected and healthy blood samples.

The proposed approach was tested on a total of 180 images, with MSE 0.02%, obtaining a sensitivity of 98% and a specificity of 93.3%. The used images were obtained from medical image web services and research articles. The proposed method results have been obtained with the computer configuration and programming language shown in Table 6
                     . The proposed method is simple and allows an adequate segmentation of infected erythrocytes, and for healthy samples. The used images were very noisy and had low contrast which caused difficulty in segmentation. Therefore, as the first, luminance differences were reduced by gamma equalization to enhance image contrast. A comparison of the proposed edge-based segmentation method with the existing ones with respect to sensitivity and specificity for the diagnosis of malaria is shown in Table 7
                     .

In the literature, there are only few methods [12,20]; those consider the speed (execution time) for the diagnosis of malaria through microscopic images. In malaria count method [12], the execution time to process a single image is 30s. In CBIR approach [20], the average speed of the algorithm is 30s to detect the malaria parasites. The proposed edge-based segmentation takes approximately 21s to process a single image for the diagnosis and it may vary image to image depends on the size and color effects. None of the methods in the literature [3–21] pays attention to the time complexity of the algorithm.

In addition, the execution time (Approximately) for common edge segementations method: Sobel, prewitt, Roberts, Log, Zero-corss, Canny, Watershed are 1.064551, 0.216634, 0.194486, 0.306138, 0.227571, 1.13153, 0.686703, respectively. The proposed execution time is more when compared to common edge segmentation methods but they were not able to segment infected erythrocytes accurately, and many unwanted edges were segmented. It was observed that these common edge segmentation methods inefficient to segment infected erythrocytes using microscopic images. The proposed edge-based segmentation without using gamma equalization for illumination correction yields 92.6% sensitivity and 86.7% specificity. On the other side, the developed approach using gamma equalization for illumination correction leads to 98% sensitivity and 93.3% specificity for the edge-based segmentation.

@&#CONCLUSIONS@&#

In this paper, an edge-based segmentation of malaria infected erythrocytes in microscopic images for the diagnosis is proposed. We have utilized gamma equalization method to maintain illumination especially for low contrast images. The infected erythrocytes were extracted by using soft clustering method FCM. The MPP algorithm was applied to parasite extracted images to refine final edge-based segmentation. Experimental results on 180 microscopic blood images showed that the proposed method is able to achieve 98%, 93.3%, 98.65% and 90.33% of SE, SP, PVP, and PVN and about 0.02, 0.9 of MSER and F-measure, respectively. These results show that the proposed method has precise segmentation ability for both infected and healthy samples. Besides, the performance of the proposed segmentation method was compared with seven existing edge segmentation methods, and it is shown that the segmented results of this work are more accurate. It can serve pathologists for the diagnosis of malaria. As future work, the proposed method can further be developed to identify the exact stage of the parasite infection and classification of species of malaria parasites to provide appropriate diagnosis.

@&#ACKNOWLEDGEMENT@&#

The authors would like to express profound gratitude to reviewers for their valuable comments and suggestions to improve the quality of this paper.

@&#REFERENCES@&#

