@&#MAIN-TITLE@&#Development of an automatic identification algorithm for antibiogram analysis

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Development of an Automatic Identification Algorithms (AIA) is proposed.


                        
                        
                           
                           AIA allows automatic scanning of inhibition zones obtained by antibiograms.


                        
                        
                           
                           88.8% of the tests showed no difference between AIA and human readings.


                        
                        
                           
                           AIA resolved the overlapping of inhibition zones and other reading problems.


                        
                        
                           
                           Formation of a second inhibition halo were overcomed by AIA.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Antibiogram

Automatic measuring

Discs labels

Inhibition zone

Disc diffusion method

@&#ABSTRACT@&#


               
                  Graphical abstract
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Microbiologists play an important role in identifying the drugs that will be most effective in the treatment of clinical infections, as well as in defining the antibiotic resistance profiles of microorganisms found in the environment. Such environmental microorganisms have been established as antibiotic resistance disseminators [1–5]. Therefore, it is necessary to evaluate the sensitivity of microorganisms to antimicrobial agents as quickly as possible once isolated. Similarly, clinical determinations of the antibiotic resistance profile of a pathogen are critical for correct treatment.

There are different types of susceptibility tests available, including disc diffusion and broth micro-dilution methods, as well as commercial tests for the determination of the minimal inhibitory concentration (MIC). The disc diffusion method is the most commonly used method worldwide [6], mainly owing to its low cost and simplicity. In this method, each disc containing an antimicrobial agent will form an inhibition zone where the microorganism is not able to grow. The size (diameter) of the inhibition zone is used to classify the strains as resistant (R), intermediate (I), or sensitive (S) [7].

Several organizations are responsible for regulating the standardization of susceptibility tests, procedures, and interpretation criteria: the United States Food and Drug Administration (FDA), the Clinical and Laboratory Standards Institute (CLSI), the National Committee for Clinical Laboratory Standards (NCCLS), and the French Society for Microbiology (SFM) [7]. These standards help to define the threshold diameters defining the antibiotic resistance phenotype (R, I, and S), tables for MIC interpretative criteria, as well as the optimal method for the preparation of the inoculums and the indication of which antimicrobials should be tested for each microorganism [6,7]. The spatial arrangement of antimicrobial discs on the plates is not always standardized and is usually defined by the professional in charge. However, strategies such as the use of a disc dispenser can help to standardize this procedure and simplify the task, mainly to standardize the discs in the same position when there is the need for numerous antibiograms. Nonetheless, a critical aspect of this procedure is the antibiogram reading step, after all while the manual zone measurement is reliable, the use of automated approach can reduce the number of errors and improve the accuracy of susceptibility test [8].

The measurement of the inhibition zone diameter is usually performed manually by specialists using a millimeter-scale ruler (Fig. 1
                     A). Although seemingly trivial, this task may present several challenges such as overlapping of inhibition zones [9-12] (Fig. 1B), problems related with the seeding of the organism [13] (Fig. 1C), non-homogeneity of the circumference (Fig. 1D), partial action of the antimicrobial (Fig. 1E), and formation of a second inhibition halo [14,15] (Fig. 1F). When faced with any one of these challenges, accurate interpretation of the results is dependent on the experience of the professional. In addition, the manual measurement of inhibition zones can take a considerable amount of time, making the method impractical for some diagnostic laboratories, mainly those in hospitals that must run through several samples in a timely manner. One potential solution proposed thus far is to focus effort on developing new methods for the automatic interpretation of susceptibility tests.

An earlier approach [16] presented a solution for automatic identification of inhibition zones; however, this solution did not provide strategies to avoid problems such as overlapping and non-homogeneity of the inhibition zones. Another report [17] approached this challenge through the detection of edges with respect to their texture; meanwhile, this method is based only on the saturation of pixels for locating the discs. Another proposed approach for automatic identification of inhibition zones [13] relies on the assumption that only the regions of inhibition are homogeneous, which is not always true. Furthermore, Legrand et al. [18] presented an automatic method but did not describe the image processing techniques there used. The Oxoid Aura Image System [19] shows promising results; nevertheless, the techniques used are also not fully disclosed, which prevents the reproduction and application of the algorithm. Nevertheless, the main goal of these methods is to simplify and accelerate the processing of antibiograms, as well as their reading and interpretation, and to avoid variations in intra- and inter-observer readings when manually measured [13–18].

Toward this end, the aim of the present study was to develop and detail an automated method for the detection of inhibition zones that can overcome the challenges described above to allow for simple readings of antibiograms obtained through the disc diffusion method. The measurements provided by an image-processing Automatic Identification Algorithm (AIA) were compared with those obtained by simultaneous manual measurements of the inhibition zones, performed by a professional using a ruler. A set of 63 environmental strains was used for this comparison.

@&#MATERIAL AND METHODS@&#

In this study, a set of 63 environmental isolates, recovered from different aquatic habitats, were analyzed for susceptibility to antibiotics by a routine process described by Ferreira da Silva et al. [20], using Mueller–Hinton agar (Oxoid Limited; Hampshire, UK) in 90 × 15-mm Petri dishes. For each isolate, the susceptibility tests were performed for 12 different antibiotics: amoxicillin (25μg), gentamicin (10μg), ciprofloxacin (5μg), sulfamethoxazole/trimethoprim (23.75/1.25μg), tetracycline (30μg), cephalothin (30μg), meropenem (10μg), ceftazidime (30μg), ticarcillin (75μg), colistin sulfate (50μg), sulfamethoxazole (25μg), and streptomycin (10μg). In each plate, six discs were manually applied with a disc dispenser (Thermo Scientific™ Oxoid™ Antimicrobial Susceptibility Disk Dispenser, ST6090, Waltham, MA, EUA). Some of the antibiograms were performed more than once in order to evaluate the reproducibility of the method, and a total of 756 readings (126 images) were performed because some image plates have not had enough quality for human readers distinguish the halos.

The breakpoints recommended for non-enterobacteria by the CLSI [7] were used as susceptibility thresholds, allowing for the classification of the isolates into three categories for each antibiotic tested: S, I, and R. The results obtained with the AIA were compared to the reference method (manual reading) and expressed in terms of agreement and disagreement. Identical characterization in both methods was defined as agreement; categorization of I with one method and R or S with another method was defined as minor disagreement; categorization of S in the reference method and R in the test method (AIA) were defined as major disagreement; categorization of R in the reference method and S in test method were defined as very major disagreement [16].

Each plate was visually examined (naked eye) by three independent human readers (R1, R2, and R3), using a ruler to measure the diameter corresponding to each inhibition zone. The average of the two measurements obtained by the first two human readers (R1 and R2) was defined as the reference diameter (RD) value when the difference between these measurements was less than 4mm [16]. If the difference was larger than 4mm, the RD value was defined as the estimate obtained by a third human reader (R3). This approach was used in order to evaluate the influence that the lack of expertise/practice may have in the manual reading results. To enhance the reliability of this third reading (R3), that was performed by a senior member of research staff.

Image acquisition was performed using the transiluminator ChemiDocTM MP System (Bio-Rad Life Science; Hercules, CA, USA). Images were captured with Image Lab software (Bio-Rad Life Science; Hercules, CA, USA), using Epi white-illumination mode. The system was configured to obtain images with a size of 1392 ×1040 pixels, at a resolution of 254dpi.

The 126 images were manually classified as standard or oddity. The standard images correspond to plates with a maximum of two overlapping and without the presence of the challenges described in Fig. 1 (Overlapping of inhibition zones; Problems related with the seeding of the organism; Non-homogeneous circumference; Partial action of the antimicrobial; Second inhibition halo). The other images were classified as oddity. Each group was composed by 63 images (378 readings).

The developed Automatic Identification Algorithm (AIA) consists in two main steps, both dependent on the position of the disks. In the first step the alphanumeric labels of the disks were identified and in the second step the zones of inhibition were identified and measured (Fig. 2
                        ). For a better understanding, these steps are individually described below. MATLAB R2012b (MathWorks, Inc.; Natick, MA, USA) was used for encoding the proposed solution.

Initially, for the identification of the discs, general segmentation was performed, in which the region of interest, containing only the Petri dish, was segmented and converted to grayscale (Fig. 2B). Binarization using a histogram was applied based on Otsu׳s method [21] to define the threshold. However, as this method is indicated for bimodal histograms, the background pixels (with intensity level of 0 to 5) were masked to 255 pixels. Therefore, another binarization using a histogram was applied, with a threshold of 97% of the maximum pixel amplitude of the grayscale image. This second binarization was performed in order to identify at least two antimicrobial discs in a binary image. Morphological processing was applied to each region labeled in binary image segmentation (Fig. 2C.1) in order to reliably target the discs. The ratio of two diameters perpendicular to region center, vertical diameter (VD), horizontal diameter (HD), and area (A) of the regions were analyzed, and acceptable VD/HD ratio and A values were considered as 0.9–1.1 and 
                           π
                           
                              
                                 (
                                 2.9
                                 
                                 mm
                                 )
                              
                              
                                 2
                              
                           
                        –
                           π
                           
                              
                                 (
                                 3.1
                                 
                                 mm
                                 )
                              
                              
                                 2
                              
                           
                         (equivalent of a 6-mm-diameter disc as shown in Eq. (1)). The conversion from millimeter to pixel was based on the size of Petri dish (90mm) and the image size. Fig. 1C.2 shows the regions classified as discs.
                           
                              (1)
                              
                                 {
                                 
                                    
                                       
                                          
                                             disc
                                          
                                          
                                             if
                                             
                                             (
                                             0.9
                                             ≤
                                             VD
                                             /
                                             HD
                                             ≤
                                             1.1
                                             
                                             and
                                          
                                       
                                       
                                          
                                          
                                             π
                                             
                                                
                                                   (
                                                   2.9
                                                   
                                                   mm
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ≤
                                             A
                                             ≤
                                             π
                                             
                                                
                                                   (
                                                   3.1
                                                   
                                                   mm
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             noise
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Nevertheless, the bimodal histogram and morphological features failed to correctly identify all of the discs on the Petri dish. For a more robust estimate of the discs׳ positions, a ring was created with the same dimensions of the dispenser used. Thus, it was possible to define which of the ranked discs were governed by the ring (Fig. 2D.1). By holding only one reference disc on the inner ring, it was possible to estimate the position of the other discs using the equations of rotation as follows:
                           
                              (2)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                                 ]
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             cos
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             sen
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             sen
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             cos
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                                 [
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          
                                             y
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        where x
                        
                           r
                        (i) e y
                        
                           r
                        (i) are the coordinates of each estimated position i, and x and y are the coordinates of the reference disc (Eq. (2)), where i=1…6 (6 discs). The same logistic regression model was used in a previous study [22] by modifying the algorithm according to the number of discs and the dispenser geometry. In this way, the strategy can be applied to different contexts simply by knowing the number and the pattern of the discs disposed on the plate.

After applying the above estimation procedure, the disc positions were identified. Therefore, one image segmentation was applied on the original image using the coordinates of each estimated position, and local sub-images were created around each disc (Fig. 2D.2). A cross-correlation was performed between each sub-image using a 6-mm-diameter white circular element in sweeping motion. At every step, the sum of the pixels in the image was calculated, so that the sum of the major value was considered to be the correct position of the disc. Fig. 2E shows the identified position.

First of all, two image databases containing pictures of six discs each were created, as shown in Table 1
                        .

Once the exact position of each disc was determined, it was possible to binarize the image, resulting only in the antimicrobial label (Fig. 3
                        ). The threshold used in such binarization corresponded to half of the area under the histogram.

Thus, when all labels of all the antimicrobials were identified, it was possible to compare the extracted sequence of antimicrobial labels with the created image libraries. The algorithm used for the comparison of labels was pattern recognition by Affine Moment Invariants (AMI) [23]. Such algorithm receives two binary images as entry, resulting in the Number of Features (NF) between them, allowing the comparison between the extracted label and labels from database. The systematic steps to extract the correct sequence were
                           
                              1.
                              Take one of the labels as reference and perform a comparison between the six labels from the plate and the six labels from the Dtabase Standard 1 (e.g. Fig. 4
                                 ) and Standard 2, shown in Table 1.

Each comparison resulted in a NF value and 
                                    μ
                                    nF
                                    _
                                    std
                                    _
                                    k
                                  average from NF was calculated, which n indicating the rotation index and k the database index.

A position rotation in order to record the labels is realized, taking as reference the following label in the counterclockwise direction.

The loop formed by steps 2 and 3 was repeated until six position changes for each sequence image database.

The comparison between the sequence and the two database patterns was performed, rotating to the six possible positions. The sequence with higher correspondence medium value was adopted as correct (Fig. 2G).

The identification of the inhibition zones was limited to diameters between 8 and 30mm, which is sufficient for the antibiotics tested [7]. Initially, the original image was processed with a low-pass filter type of Finite Impulse Response (FIR) order 25 and cutoff frequency of 5% of the bandwidth of the image. Then, each region of interest containing the disc and a square of 30mm per side was segmented (Fig. 5
                        A). For the segmentation, four lines that are each 4-pixels-thick were drawn: one vertical, one horizontal, and two diagonal, which crossed the center of the disc (Fig. 5B).

The average of every 4-pixels-thick was calculated, resulting in a mean vector for each line, and then a new average between the resultant vectors was calculated. In order to make the zone of inhibition even more evident, it was performed the average of opposite elements having as reference the vector center. This vector of averaging was named 
                           v
                         which describes the beginning of the segmented square up to half of the antibiogram disc. Fig. 5C shows the irregularity of the averaging curve. When analyzing the curve of Fig. 5C from the highest position to the lowest, the amplitude of the disc was found to be equal to gray level value of 255 and decreases to a peak described by the number 2. This region corresponds to the desired zone of inhibition.

In this way, vector 
                           v
                         was smoothed by a 5 point moving average filter [24]. After that, the strategy of zero crossings of the first derivative of the vector was used to identify the peaks of 
                           v
                        . The peak position (P
                        
                           m
                        ) was considered to be the transition point between the zone of inhibition and biomass. Another possible strategy for finding the approximate intensity level of the region without halos of inhibition was to calculate the average pixels located in a 40 × 40-pixels matrix drawn in the center of the plate (M
                        
                           central
                        ). To establish a satisfactory threshold (T), Eq. (3) was used. To achieve vector without peaks, P
                        
                           m
                         is set to zero; i.e., the first element of 
                           v
                         is considered.
                           
                              (3)
                              
                                 T
                                 =
                                 
                                    
                                       v
                                       [
                                       
                                          
                                             P
                                          
                                          
                                             m
                                          
                                       
                                       ]
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             central
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where 
                           v
                         corresponds to the vector of averaging, P
                        
                           m
                         corresponds to the peak closest to the disc.

To identify the diameter of each zone of inhibition, the average pixels from four semi-circles concentric to the disc were calculated, and their diameters (d) were increased and the averages were recalculated until the value of T was reached for at least one of the zones.

It is worth noting that the first circumference was defined with d=8mm and the T value defined the amplitude boundary pixels in the zone of inhibition. This strategy allowed us to overcome the problem of overlapping, whereas at least one semi-circumference would reach the T value. Fig. 6
                         illustrates an example of the growth of semicircles in the case of overlapping and Fig. 2F shows the final result.

Considering our experience with the pattern under study, the criterion adopted to identify discs without inhibition zones was ten or fewer pixels with a level intensity greater than 90% of T. This criterion was adopted for the pixels contained only in the first iteration of the four semicircles.

The results obtained using the AIA were compared with those obtained from human measurements (RD). The weighted kappa index, which is commonly used for comparing inter-rater agreement, was calculated according to the method of Fleiss [25] and the Pearson correlation coefficient was calculated [26]. SPSS 17.0 (IBM Corp.; Armonk, NY, USA) was used for the kappa and MATLAB R2012b (MathWorks, Inc.; Natick, MA, USA) was used for the Pearson correlation coefficient.

@&#RESULTS@&#

The differences between the measurements of R1 and R2, as well as the differences between the automated AIA and human RD estimates are shown in Fig. 7
                        A, in the case of the total sample size (756 readings). The R1 and R2 readers measured the same diameter in 61.64% of the tests. Differences greater than 11mm were observed in 2.91% of the tests.

The distribution of differences between the automated AIA and human RD estimates are shown in Fig. 7A (gray bars), in the case of the total sample size (756 reading). The majority of the tests (54.37%) were equal, whereas 1.46% of the tests have had differences greater than 11mm.


                        Fig. 7 B shows the differences between the measurements of R1 and R2, as well as the differences between the automated AIA and human RD estimates, in standard images (378 readings). The R1 and R2 readers estimates were: 271 estimates were equal, whereas differences greater than 11mm were observed in 6 tests. Meanwhile, the distribution of differences between the automated AIA and human RD estimates were: 215 estimates were equal, meanwhile differences of 4mm or more were observed in 32 tests. Differences greater than 11mm were observed in 5 tests.

For the oddity images (Fig. 7C), the R1 and R2 readers estimates were: 198 estimates were equal, whereas differences greater than 11mm were observed in 12 tests. Meanwhile, the distribution of differences between the automated AIA and human RD estimates were: 195 estimates were equal, whereas differences of 4mm or more were observed in 53 tests. Differences greater than 11mm were observed in 7 tests.

The Pearson correlation coefficient (0.85) revealed a strong significant correlation (
                           p
                           <
                           0.05
                        ) between the measures in total sample size. For the oddity images the correlation level was 0.80 (
                           p
                           <
                           0.05
                        ), whereas in standard images the correlation was 0.90 (
                           p
                           <
                           0.05
                        ).

The results of the susceptibility tests derived from the RD and AIA estimates are shown in Table 2
                        . Meanwhile the estimates in categorized images are presented in Table 3
                        .


                        Table 4
                         shows the results analyzed from the perspective of agreement and disagreement. The resulting kappa index values were 0.907 and 0.773 for comparisons between R1/R2 readers and between AIA/RD, respectively. Regarding the images categorized as oddity, the resulting kappa index values were 0.851 and 0.695 for comparisons between R1/R2 readers and between AIA/RD, respectively. On the other hand the resulting kappa index values were 0.995 and 0.834 for comparisons between R1/R2 readers and between AIA/RD, respectively, in standard images.

Agreement between categorizations derived from the measurements of the two first human readers was observed in 718 (95%) readings, in the case of the total sample size (756 reading). Disagreements were observed in the 38 remaining tests, 19 (3%) of which were minor. Agreement between categorizations derived from AIA and those derived from RD was observed in 663 (88%) readings. Disagreements were observed in the 93 remaining cases, 46 (6%) of which were minor (Table 4). In the case of oddity images, agreement between categorizations derived from the measurements of the two first human readers was observed in 349 (92%) readings. Disagreements were observed in the 29 remaining tests, 15 (4%) of which were minor. Agreement between categorizations derived from AIA and those derived from RD was observed in 319 (84%) readings. Disagreements were observed in the 29 remaining cases, 24 (6%) of which were minor (Table 4). For the standard images, agreement was observed in 369 (98%) readings in categorizations derived from the measurements of the two first human readers. Disagreements were observed in the 9 remaining tests, 4 (1%) of which were minor. Agreement between categorizations derived from AIA and those derived from RD was observed in 344 (91%) readings. Disagreements were observed in the 34 remaining cases, 19 (5%) of which were minor (Table 4).

@&#DISCUSSION@&#

The AIA, which is presented in this paper as an algorithm designed to estimate the diameter of the inhibition zones in disc diffusion susceptibility tests, produced relatively lower estimates than observed in previous studies which use automated system (i.e., kappa index values between 0.84 and 0.92 [16,17,19]), with 88.8% of tests showing no difference or differences lower than 4mm (Fig. 7).

For susceptibility categorization, 88% of cases showed agreement, whereas the percentage of major (2%) and very major disagreement (5%) of AIA were close to or superior to those of already developed systems. Hejblum et al. [16] obtained values, in the worst case, of 3% and 2% for major and very major disagreement, respectively. Nolte et al. [27] found rates of 7% and 8% of major and very major disagreement, respectively; furthermore, their agreement rate was lower (82%) than that obtained in the present work (88%).

It was verified relatively significant differences between gold standard and automated readings in our study. The presence of oddities could be an explanation for these differences. In this case, the presence of oddities is able to challenge thresholds on the algorithm, leading the system to wrong interpretations of inhibition zones. Therefore, automated methods should be a support for a laboratory specialist who has the expertise and practice to judge efficacy and accuracy of these methods.

Moreover, AIA showed a correlation index of 0.85, higher correlation than the Sirscan system in the worst case (0.80) [28], but lower than the best case of a correlation of 0.97 [28]. In future studies, we aim to calculate the levels of correlation for each organism and for each antibiotic separately, as performed in other studies [16,27].

When the images were classified, the results were improved, mainly in the case of standard images. All estimates, kappa index (Table 6), susceptibility categorizations (Table 4) and correlation index were better in standard image (0.90) than oddity images (0.80). Probably the challenges in oddity images led to relatively lower estimates in the total sample size. Therefore, it is clear that the good quality of the image as well as a good antibiogram are important factors to improve the algorithm performance.

The correct identification of the discs׳ positions is a critical information for the proper functioning of AIA, given that the identification of the inhibition zones and alphanumeric labels depend fundamentally on the correct identification of the fusion discs׳ positions. However, bimodal histogram methods and morphological features, separately, cannot ensure the identification of all positions, since, quite often, it is verified a change in the antibiogram disc׳s tonality or destruction of disc׳s label as a result of the incubation process.

As described in Section 2.7, with at least two discs, it is possible to estimate the position of the other discs, turning our strategy more tolerable to failure when compared to bimodal histogram methods and morphological features. Fig. 8
                      illustrates a case which binarization has not been able to ensure the location of all six discs, since one of the discs has failed the test to morphological features. However, the missing disc position was correctly estimated using the dispenser geometry and the label could be deduced by the relative position to adjacent labels. In this sense, use of a disc dispenser allows for correct disc positioning and identification, ensuring the quality of the tests, thereby avoiding incorrect disc placement or in a greater number than those recommended by the organization which are responsible for regulating the standardization of susceptibility tests [11].

In our study, the quality of the images was maintained owing to controlled standardization of the equipment, thereby avoiding the lighting problems described previously [29]. The image libraries constructed using our approach also limited the algorithm to identifying only the stipulated sequence of discs. However, this was done in a robust manner by implementing a strategy for assessing the neighboring discs. Furthermore, it will also be possible to insert new sequences of disc labels to the library in future work.

The use of four independent semi-circumferences (Fig. 6) counteracted the effects of overlapping of inhibition zones, circumference heterogeneity, problems with the seeding of the organism, and the formation of a second halo of inhibition; once reaching the threshold T, the halo diameter could be determined. In the case of overlapping of inhibition zones, at least one of the diagonals is expected to reach T. The strategy of using diverse increments in the diameter negates the problem of circumference heterogeneity, and continues toward the next incrementation until reaching T. Although problems with the seeding of the organism could decrease the average of the semi-circle in extreme cases (Fig. 1C), as four diagonals were used, the results would be inconclusive only if all four have problems in reading. Finally, the issue of a second inhibition halo is more complex, because the intensity levels are quite variable. The proposed solution could correctly identify cases with pixels of close intensity to the biomass and, consequently, near the threshold T.

Another challenge of an antibiogram test is partial action of the antibiotic [14,15]. This too was overcome by implementing a strategy that uses 10 pixels with higher intensity than 90% of threshold T (Eq. (3)) to identify discs without halos in the first interaction. As shown in Fig. 1E, in the case of partial action of the antibiotic, there are traces of biomass that cross the zone of inhibition. Such traces have a high level of intensity that is verified with the use of 10 pixels in the present strategy. In addition, the partial actuation can also decrease the intensity of related pixels, which is why 90% of threshold T was selected.


                     Fig. 9
                      shows how the AIA has performed the halos readings even with these cited challenges above.

The fact that our proposed method could overcome these common obstacles in disc diffusion methods is particularly valuable, because these problems can occur during routine tasks of analytical laboratories, and may also interfere with or hinder the correct interpretation of results in research studies [8–10]. Moreover, other authors who have proposed methods for the automatic detection of inhibition zones have claimed that these parameters continued to influence aspects of inhibition zone determination [17]. Gavoille et al. [17] reported problems with methods that assume a continuous boundary of inhibition zones. However, their strategy, which uses the Student׳s t-test as an edge detection criterion, is sensitive to noise on the inhibition zones. Furthermore, the method does not offer a solution to the partial action of the antibiotic. Salgado et al. [13] considered the use of directional filtering and texture analysis to measure inhibition halos. They assumed homogeneity of texture after filtering, but there is no evidence of the effectiveness of this method. In addition, substrate color components such as RGB and HSI are considered, which can be as variable as the texture.Therefore, it is assumed that our approach to classify images as oddity was little or not explored in previous works. All plates with feasible human analysis were submitted to the developed algorithm, leading to new developed strategies which differ essentially from the current bibliography.

Moreover, the generation of 
                        v
                      was increased with the use of diagonal lines and peaks treatment. The proposed algorithm was limited to a range of 8–30mm in diameter [7] for the inhibition zones. The first circle used in the calculation starts with an 8mm diameter, and the filter based on the threshold T (Eq. (3)) deals with both the case of no inhibition zone or the case of large inhibition zones exceeding 30mm. In cases outside this range (
                        d
                        >
                        30
                        
                        mm
                        ;
                        d
                        <
                        8
                        
                        mm
                     ), the response of the algorithm fixes values of 30mm and 6mm, respectively.

@&#CONCLUSIONS@&#

In this paper, we presented an AIA to measure the zones of inhibition obtained by the disc diffusion method. The proposed AIA software is expected to become a valuable clinical support tool to help specialists achieve robust antibiogram interpretation. It is not intended to be a substitute for human measurements; the goal is to increase examiner reliability, as well as the number of antibiograms that could be read within a short period of time. In this context, the results showed good performance such as 87% of tests were correctly classified and the developed technique enabled the identification of the inhibition region of antibiotics with high correlation coefficient (0.85; 
                        p
                        <
                        0.05
                     ). Furthermore, oddity images led to relatively lower estimates in the total sample size although problems – not addressed in other works – such as the multiple overlapping of inhibition zones, imperfect seeding of the microorganism, heterogeneity of the circumference, partial action of the antimicrobial, and formation of a second halo of inhibition were overcomed through automatic and adaptive techniques for each image received by the algorithm. Together, our results indicate that AIA is a versatile and solid tool for laboratory use.

None declared.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the financial support provided by CNPq (grants 205058/2012-4, 204833/2012-4 and 238670/2012-0) and FINEP (Medical Products and biomaterials 2010/05), and the IVM grant SFRH/BPD/87360/2012 from Fundação para a Ciência e Tecnologia, Portugal. Besides, the authors appreciate Prof. Bruno Macchiavello’s close reading of the manuscript.

@&#REFERENCES@&#

