@&#MAIN-TITLE@&#Primary user behavior aware spectrum allocation scheme for cognitive radio networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A proportional-fair oriented sharing-scheme is proposed to allocate channels.


                        
                        
                           
                           A PU activity model is developed to provide most stable channels to users.


                        
                        
                           
                           A time varying framing process is used to make variable sized frames at MAC layer.


                        
                        
                           
                           The proposed scheme reduces the delay, collisions and increases the throughput.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

@&#ABSTRACT@&#


               
               
                  Cognitive radio (CR) technology can solve the problems of spectrum scarcity and low spectrum utilization. However, random behavior of the primary user (PU) appears to be an enormous challenge. In this paper, we propose a PU behavior aware joint channel selection and allocation scheme. In the first step, the channels are ranked based on statistics of the PU usage whereas in the second phase, a proportional fair oriented channel allocation scheme is employed to allocate channels among CRs. We also introduce the concept of a time-varying framing process (TVFP) that minimizes the overall data transmission time. Simulation results show that the proposed scheme outperforms existing schemes in terms of the transmission-time and the number of collisions with the PUs. In addition, it helps to save a significant amount of transmission power. Moreover, it provides a significantly higher system throughput as compared to the existing schemes.
               
            

@&#INTRODUCTION@&#

On-going wireless communication is managed through a fixed spectrum management strategy for the transmission of the user’s video, voice and text data. According to the fixed-spectrum management framework, the users are performing their communication on a fixed spectrum band with a specific modulation and coding scheme. However, advancements in the wireless industry have shortened the life span for the evolution of new communication standards to meet the stringent quality of service (QoS) demands of emerging wireless applications. Each emerging wireless standard requires a specific band for its operation. Therefore, there could be a situation in which the entire radio band gets occupied, leaving no spectrum band available for future standards. In addition, the Federal Communication Commission (FCC) has indicated very low spectrum utilization index [1]. Thus, spectrum-scarcity and limited spectrum-utilization are the prime limitations of the existing spectrum-management framework.

To cater these issues, researchers have introduced a new concept for the efficient management of the spectrum known as dynamic spectrum access (DSA). CR is a potential technology that can utilize the DSA mechanism to operate on any available channel [2,3]. CR is an intelligent device that has the capability to sense the radio environment and adapts its operating parameters accordingly. There are three main entities involved in cognitive radio communication networks (CRCN), the licensed user (LU), or PU; CR or the secondary user (SU); and the spectrum band with a variable nature (quality and occupancy). The CR has two advanced features, spectrum-sensing (SS) and parameter reconfiguration. SS allows the CR to scan the radio spectrum to locate the free slots whereas the parameter reconfiguration mechanism adjusts the radio parameters accordingly [4]. If the channel is empty, the CR performs its communication and leaves the channel on the arrival of PU to avoid interference with the PUs [5]. The SS schemes can be classified as local or cooperative [6,7]. In a local SS scheme, each CR locally decides itself about the presence or absence of the PU on particular channel, whereas in the cooperative SS schemes the decision is taken based on the collective sensing information of the CRs.

The channel selection is an important area of CRCN, which helps in selecting the best channels from the pool of vacant spectrum slots. Most of the existing research relies on monitoring the PU arrival activity [8,9]. In these schemes, if a PU arrives on the channel, then the SU/CR immediately adjourns its transmission, quits the current channel and looks for other opportunities to transmit its remaining data. However, to deal with such a disruptive scenario, other schemes are presented in [10,11]. In such schemes, each CR predicts the future occurrence of the PU on different channels and then selects the best channels in terms of future idle state for the communication. In the current article, we adopt the latter approach and select the channel by predicting the state of channel considering the past statistics of PUs over different channels.

After selecting the best channels, the next prime task is the channel allocation among CRs. The spectrum allocation scheme allocates the best quality selected channels among CRs. The performance of CRCN is highly dependent on the effectiveness of the spectrum allocation scheme. In [12], the authors provide a detailed analysis on spectrum allocation schemes and classify these schemes as open, hierarchical, and dynamic exclusive. Moreover, the authors discuss the issues and research challenges relevant to each sharing model. The overlay or underlay classification model of the allocation schemes is presented in [13]. The overlay model utilizes the vacant spectrum bands whereas the underlay approach allows CRs to perform data transmission in parallel with the operation of the PU. The underlay approach is robust as compared to the overlay scheme however it requires complex modeling for its implementation.

In [14], the authors introduce a channel sharing scheme for centralized networks where the spectrum polling mechanism is introduced to aggregate the spectrum from multiple network operators. The spectrum is shared among different user to achieve higher throughput efficiency and a lower price. Although the objective function of the proposed scheme quickly converges to the optimal value and meets the desired throughput levels of the users, it lacks in considering the activity of the PUs, which is perhaps the key challenge in CRCN. Another scheme is proposed in [15] to improve the overall efficiency of the cellular CR networks where multiple networks are offering their spectrum on lease. The channels are allocated to users based on the best service criteria. Although the authors succeed in minimizing the number of packet drops and delay incurred in the transmission, it does not incorporate the effects of CR interference over PU transmission. Another spectrum-sharing scheme is presented in [16] where the authors utilize the mechanism of the selective relay system to reduce the outage probability of the PUs and CRs. A PU is selected to act as a relay (decoder and forwarder) and then optimal Q (operating point) value is determined for better efficiency of the system. Although the given scheme helps to reduce the outage probability of the CRs, it is lacking in providing the fairness to CRs.

Also, various researchers have exploited the color-graph based spectrum-sharing schemes inside CRCN. In [17], the authors introduce color-graph based mechanism to share the available channels among CRs. The main limitation of the given scheme is that it provides equal data rate to all users which seem to be impractical for heterogeneous applications. Moreover, the graph-coloring approaches are considered rigid for CRCN owing to random behavior of the PU which may lead to variability of available colors for each CR. And, it directs for list coloring approaches that are generally harder to implement [18]. In [19], Xing et al., introduced the channel quality prediction mechanism to reduce the waiting time of the CRs and provide higher spectral efficiency. However, this scheme does not provide any insight about the fairness to individual CR users. The central controller-based classification schemes are presented in [20,21] where each CR exchanges control information with the central CR base station (CRBS) to get the spectrum band for its communication. The CRBS forms an optimal sharing pattern for allocation of available channels among CRs. However, these schemes are lacking in consideration of PU activity. The PU activity severely degrades the QoS of the CR, and this needs to be addressed properly. By implementation of the PU activity aware spectrum allocation scheme, we can utilize the available channel more effectively.

In this paper, we propose primary user behavior aware (PUBA) joint channel selection and allocation scheme for a centralized CRCN. The history of PU activity has been maintained and the best channels are selected in terms of least PU activity. A proportional fair oriented channel allocation framework is designed for scheduling the available channels among CRs, which provides the higher throughput, reduce collision and transmission time Moreover, we monitor the arrival activity of the PU during the slot duration (if the PU arrives in the middle of the slot) to perform the switching task. This significantly enhances the performance of our proposed scheme in terms reducing collisions with the PU. The main contributions of the paper can be summarized as follows:
                        
                           •
                           We propose a model for the management of PU traffic. It stores the activity of the PU on different channels and then selects the best channels in terms of the least PU occupancy.

We propose a proportional fair oriented channel allocation framework that incorporates the characteristics of channels in terms of capacity (noise, interference) and occupancy (PU activity) to share the available channels among CRs with the promise to meet their minimal data rata requirements.

We utilize the time varying framing process (TVFP) to make variable size frames at the medium access (MAC) layer based on the capacity of a channel. This decreases the overall service time for the data transmission.

We present simulation results, showing that the proposed scheme achieves higher throughput, reduces collisions with PUs and minimizes data transmission time. Moreover, it saves a significant amount of power.

The remainder of this paper is organized as follows. Section 2 describes the system model along with the system’s components. Section 3 describes the simulation results. Finally, Section 4 presents the conclusions of the paper.

We consider a centralized CRCN similar to the network shown in Fig. 1
                     , where multiple primary operators O
                     ={o
                     1,
                     o
                     2,
                     o
                     3 …,
                     ow
                     } are willing to offer their spectrum on lease to C
                     ={c
                     1,
                     c
                     2,...,
                     ci
                     ,…,
                     cr
                     } CR users which are operating under the control of a single CR base station (CRBS). On a regular basis, CR users scan M
                     ={m
                     1,
                     m
                     2,…,
                     mk
                     ,…,
                     cp
                     } channels of primary operators within the TV band during the sensing duration Ts
                     . Each CR forwards its observation about PU activity (sensing report) on different channels to CRBS, which maintains the statics of the PUs. After attaining sensing-reports from CRs, the CRBS analyzes the sensing information and performs channel ranking operation. As a result, the CRBS groups the channels into three classes, good, average and worse channels and utilizes the best channels to CRs. If all the channels in the best queue (holds least PU activity channels) are already allocated to CRs then the average channels can be utilized for transmission. As soon as the best channel is available, the CR can be switched to better quality channels. However, for the current paper, we considered that the switching operation is performed only due to the arrival of the PU. After the selection of the best channels, the CRBS computes the data capacity of the channels and then shares the selected channels among different CRs based on the desired QoS (i.e minimum data rate requirement). The sharing of channels is done using the proportional fair mechanism, which provides the fairness at the individual CR level.


                     Table 1
                      presents the key notations used in the paper.

The main assumptions of the propose schemes are as follows:
                        
                           1.
                           We assume that CRs perform the cannel sensing operation periodically after 2 seconds as indicated in IEEE 802.22.

We assume that CRs are equipped with cyclostationary feature detectors for optimized sensing reliability.

We assume that CRs are perfectly synchronized with the CRBS and initially they perform the handshaking tasks over a control channel within the industrial scientific and medical (ISM) band.

If the PU appears in the middle of the time slot, the CRBS directs the CR to pause over that channel. Later on, the CRBS switches the CR to some other vacant channel.

To simplify the operations of CRs, we adopt the slotted structure with the slot length shown in Fig. 2
                        (a). The slot length consists of the sensing period (Ts
                        ), the switching period (Tc
                        ) and the transmission period (Td
                        ). Mathematically the slot duration can be represented as follows:
                           
                              (1)
                              
                                 T
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        
                     


                        Fig. 2(b) shows four different size frames and introduces the concept of time-varying frame process (TVFP) which provides the facility to adjust the size (Kbps) of the data packets dynamically according to the available channel capacity (i.e., f
                        2
                        <
                        f
                        1
                        <
                        f
                        3). It indicates that at a certain time instant, frame-2 shows poor SINR value and hence less capacity for CR which is performing communication on channel-2. Similarly, the larger frame size of f
                        3 indicates that the corresponding channel has a higher capacity. Thus, the proposed scheme forms dynamic frames directly proportional with the capacity of channel. The channel switching takes place during the transmission of the third frame f
                        3 where additional delay Tc
                         occurs in the transmission of the data.

To provide better QoS to the CRs, we propose a framework for the channel selection and allocation scheme as shown in Fig. 3
                        . Each CR sniffs the TV spectrum band and forms a sensing report which indicates the idle/busy state of the channel at the given time slot z. The selection and sharing unit (SSU) is the core part of our framework that performs PU history management (PHM), spectrum allocation and spectrum handover tasks. The PHM is responsible for managing the history of the different channels based on PU activity using sensing reports from different CRs. Later on, the percentage PU activity on different channels is calculated considering the latest 100 SRs and then the channels are ranked as best, average or worst based on the PU activity.

The procedure for channel ranking is shown in Fig. 4
                        . The PU activity based channel history helps CRs to select the best channels with the least PU activity and minimizes the channel switchings or channel handovers that severely degrade the QoS of a CR. In addition, the PHM sets the value of the PU arrival flag (PAF) on the arrival of the PU in the middle of a time slot. The spectrum handover unit checks the value of the PAF, and if it is equal to 1, it performs the channel switching. The spectrum allocation unit is responsible for the allocation of the sensed channels among CRs. By considering the QoS requirements of the CR and quality of the channels, the spectrum allocation unit forms an optimal sharing pattern in terms of data rates and fairness. We employ a proportional fair scheme for the channel allocation, and explained in Section 2.5.

We assume that the PUs and the CRBS are operating in same vicinity and that the CRs have random position within the coverage of the CRBS. We assume that there are K
                        ⊆
                        u users can be served by the CRBS and the channels are time varying and orthogonal to each other. The achievable channel gain hi
                        
                        ,
                        
                           k
                         for i-th CR over k-th channel can be represented as follows:
                           
                              (2)
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                          
                                             -
                                             α
                                          
                                       
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                              
                           
                        where gi
                        
                        ,
                        
                           k
                         is the sum of the multipath components with zero mean Gaussian random variable or Rayleigh fading channel. The channels are assumed to have block fading owing to the assumption of the constant channel condition during a particular time slot. The term α indicates the path loss component. Let Pi
                        
                        ,
                        
                           k
                         be the power of i-th CR transmitter over k-th channel then the signal to interference plus noise (SINR) ratio can be represented using Eq. (3) as follows:
                           
                              (3)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                             .
                                             k
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             ≠
                                             k
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             j
                                             ,
                                             l
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where the term Ii
                        
                        ,
                        
                           l
                         represents the interference due to the other active CR transmitters during the j-th time slot and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                                 
                                    2
                                 
                              
                           
                         shows the noise variance.

This section explains the steps involved in the procedure of channel ranking based on PU activity. The sensing stage of the CR can be described using the binary hypothesis given in [22].
                           
                              (4)
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   :
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   :
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where k represents the index of a channel with frequency band β Hz. After receiving the SRs from CRs, the CRBS maintains the history for the PU activity of each channel which can be represented using Eq. (5)
                        
                           
                              (5)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                         q
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                         q
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         p
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         p
                                                         2
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         pq
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where θpq
                         is the history matrix for holding the PU activity of p channels over q time slots. The idle or busy state of k-th channel at j-th time slot can be represented using expression given in Eq. (6)
                        
                           
                              (6)
                              
                                 
                                    
                                       α
                                    
                                    
                                       jk
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   PU
                                                   -
                                                   present
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   PU
                                                   -
                                                   absent
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       a
                                    
                                    
                                       jk
                                    
                                 
                                 ∈
                                 
                                    
                                       θ
                                    
                                    
                                       jk
                                    
                                 
                              
                           
                        
                     

The percentage PU activity 
                           
                              λ
                           
                         of k-th channel can be computed using Eq. (7) as follows:
                           
                              (7)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          q
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       jk
                                    
                                 
                                 
                                 ∀
                                 
                                    
                                       a
                                    
                                    
                                       jk
                                    
                                 
                                 =
                                 1
                              
                           
                        where ∑ (.) indicates that how much time the channel was in a busy state. Based on the value of 
                           
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                           
                        , the channels can be ranked as best, average or worst using Eq. (8):
                           
                              (8)
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   best
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ≤
                                                   20
                                                   %
                                                
                                             
                                             
                                                
                                                   average
                                                
                                                
                                                   20
                                                   %
                                                   <
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   <
                                                   50
                                                   %
                                                
                                             
                                             
                                                
                                                   worst
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ≥
                                                   50
                                                   %
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The channels which have the least PU activity are ranked as the best channels whereas the channels with higher PU arrival possibilities are ranked as worst channels. In current article, we are using the best channels in terms of 
                           
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                           
                        . The CRs can opportunistically access the best channels in the TV band as indicated in the IEEE 802.22 [23].

This section describes the procedure for channel allocation among CRs. We represent a proportional fair oriented channel allocation scheme for fair and throughput efficient scheduling among different CR users. The data rate on a particular channel can be calculated using the Shannon’s capacity expression given in Eq. (9)
                        
                           
                              (9)
                              
                                 
                                    
                                       R
                                    
                                    
                                       jk
                                    
                                 
                                 =
                                 β
                                 log
                                 (
                                 1
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                 
                                 )
                              
                           
                        Suppose that 
                           
                              
                                 
                                    R
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                           
                         is the maximum achievable rate for i-th CR during the j-th time slot over the k-th channel. The PUBA scheme keeps track of the running average throughput 
                           
                              
                                 
                                    A
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                           
                         for each CR. Therefore, the selection of i-th CR during j-th time slot can be performed using the expression given in Eq. (10) 
                        [24,25] as follows:
                           
                              (10)
                              
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          1
                                          ≤
                                          i
                                          ≤
                                          r
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 z
                              
                           
                        
                     

The average values of the achievable data rates 
                           
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                           
                         (Kbps) for each CR user are updated at each time slot j
                        ∈{1, 2, …, z} can be represented using Eq. (11) as follows:
                           
                              (11)
                              
                                 
                                    
                                       A
                                    
                                    
                                       jk
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   β
                                                   )
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   β
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   β
                                                   )
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   i
                                                   
                                                   ≠
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where β
                        =1/t and t is the memory of the moving average filter used to update the achievable throughput. The i-th user can perform the transmission over k-th channel only if the instantaneous channel capacity is higher than its average data rate. The given algorithm maximizes the throughput and fairness among different CR users. For example, if a CR user is performing transmission over a better quality channel, it can achieve higher data rate and vice versa.

The algorithm of the PUBA scheme is described below. First, the channels are ranked based on the PU activity factor. Later on, the data capacities of the best channels are estimated to allocate them among CR users. If the PU arrives in the middle of the time slot, the channel handover takes place to avoid possible interference between PU and CR. The time complexity of the proposed scheme based on the pseudo-code given below can be given as Tc
                        
                        =
                        o(p
                        ×
                        q)+
                        o(p
                        1)+
                        o(r
                        ×
                        z). From a general perspective, choosing n
                        =max(p,
                        q,
                        p
                        1,
                        r,
                        z), the time complexity of the proposed algorithm can also expressed as Tc
                        
                        =
                        o(n
                        ×
                        n)+
                        o(n)+
                        o(n
                        ×
                        n). By performing simplification, the complexity expression can be written as Tc
                        
                        =
                        o(n
                        2)+
                        o(n)+
                        o(n
                        2) or Tc
                        
                        =
                        o(2n
                        2)+
                        o(n). Therefore, the entire complexity of the proposed scheme is Tc
                        
                        =
                        o(cn
                        2)=
                        o(n
                        2), where c is a constant. Comparing the computation complexity of the proposed scheme with the existing max-min fair scheme proposed in [20], the proposed scheme has lower complexity in terms of the factor o(p
                        1)<
                        o(p) where p
                        1
                        ⊆
                        p. The final complexity of both schemes does not directly depend on o(p
                        1), it can be concluded that the overall complexity of the proposed scheme is equal to the max-min fair scheme. However, the proposed scheme shows much better performance in terms of collision rate, transmission time, and system throughput and transmission power.
                           
                              
                                 
                                 
                                    
                                       
                                          Algorithm: Primary user behavior aware (PUBA) spectrum allocation scheme
                                    
                                 
                                 
                                    
                                       1. Input: 
                                          u, v, t,β,
                                          θpq
                                          ,
                                          αj
                                          
                                          ,
                                          
                                             k
                                          , 
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                           
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          , 
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                             
                                           
                                          γk
                                          
                                       
                                    
                                    
                                       2. θj
                                          
                                          ,
                                          
                                             k
                                          
                                          ←0, 
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ←0; 
                                          % Initialization
                                    
                                    
                                       3. while 
                                          u !=0 
                                           % Total number of CR users
                                    
                                    
                                       4. 
                                          for 
                                          k
                                          =1 to p
                                          
                                          % for channel ranking
                                    
                                    
                                       5. 
                                          
                                          for 
                                          j
                                          =1 to q
                                       
                                    
                                    
                                       
                                          6. 
                                          
                                          
                                          θj
                                          
                                          ,
                                          
                                             k
                                          
                                          ←
                                          αj
                                          
                                          ,
                                          
                                             k
                                           ∀j,
                                          k
                                       
                                    
                                    
                                       7. 
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          ←
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      q
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      q
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          ∀ajk
                                          
                                          =1
                                    
                                    
                                       8. 
                                          
                                          end
                                       
                                    
                                    
                                       9. 
                                          
                                          
                                          
                                          if 
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                           
                                          < 20% {mk
                                          ←best}
                                    
                                    
                                       10. 
                                          
                                          
                                          else if 20% < 
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          < 50% {mk
                                          
                                          ←average}
                                    
                                    
                                       11. 
                                          
                                          
                                          else {mk
                                          
                                          ←worst}
                                    
                                    
                                       12. 
                                          
                                          
                                          
                                          end
                                       
                                    
                                    
                                       13. 
                                          end
                                       
                                    
                                    
                                       14. 
                                          
                                          for 
                                          k
                                          =1 to p1% p
                                          1
                                          ⊆
                                          p
                                       
                                    
                                    
                                       
                                          15. 
                                          
                                          
                                          
                                          Rk
                                          
                                          ←log(1+
                                          ϕk
                                          )
                                    
                                    
                                       16. 
                                          
                                          
                                          end
                                       
                                    
                                    
                                       17. 
                                          
                                          for 
                                          i
                                          =1 to r% for channel allocation
                                    
                                    
                                       18. 
                                          
                                          
                                          for 
                                          j
                                          =1 to z
                                       
                                    
                                    
                                       19. 
                                          
                                          
                                          
                                          If 
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                      i
                                                   
                                                
                                                >
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                           
                                          % minimal QoS
                                    
                                    
                                       20. 
                                          
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ←
                                                arg
                                                
                                                max
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                /
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       21. 
                                          
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      jk
                                                      +
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  -
                                                                  β
                                                                  )
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        jk
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  +
                                                                  β
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        jk
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                                  =
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  -
                                                                  β
                                                                  )
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        jk
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                                  
                                                                  ≠
                                                                  
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       22. 
                                          
                                          
                                          
                                          
                                          If PAF = =1
                                    
                                    
                                       23. 
                                          
                                          
                                          
                                          
                                          Go to step 3.
                                    
                                    
                                       24. 
                                          
                                          
                                          
                                          
                                          end
                                       
                                    
                                    
                                       25. 
                                          
                                          
                                          
                                          end
                                       
                                    
                                    
                                       26. 
                                          
                                          
                                          end
                                       
                                    
                                    
                                       27. 
                                          
                                          end
                                       
                                    
                                    
                                       28. 
                                          end
                                          % program controlling loop.
                                    
                                 
                              
                           
                        
                     

@&#PERFORMANCE EVALUATION@&#

This section describes the procedure used to setup the simulation environment and evaluates the performance of the PUBA scheme under different parameters such as average service time, collision probability, power consumption and CR achievable throughput. We present the simulation results for specific simulation parameters and present them into three subsections to improve clarity.

We simulate the proposed PUBA scheme in MATLAB and evaluate the performance considering the network topology depicted in Fig. 1, where we consider that three PU network operators are offering spectrum to the CR users on lease basis. To incorporate the heterogeneous behavior of the spectrum in terms of capacity, four different channel bandwidths are considered such as 2kHz, 4kHz, 6kHz and 8kHz. We consider twenty active CRs (i.e., r
                        =20) competing for the channels from central CRBS with the total data of 200 Kilo Bytes (kB). The nature of CRs is heterogenous in terms of their data size. We consider that each active CR can have total input data from the following four sizes 5kB, 10kB, 15kB or 20kB in such a way that they collectively generate 200kB data. The transmitter gets the identifiers (IDs) starting from CR1, whereas there receivers are assigned identifiers from CR21 to CR40. The range of the CR network is 1km (1000m), and the CRs exist at different locations within the range of CRBS. The CR can dynamically select the transmission power from 5dBm to 45dBm and interference power is considered to be 35–80% of the signal power. The value of gi
                        
                        ,
                        
                           k
                         can vary from 0.1 to 0.99 and the value of α is assumed to be 2 for the current study. The rest of the parameters are depicted in Table 2
                        .

The instantaneous throughput of the CR depends on the quality of the channel and the interference incurred due to the transmission of other transmitters. The throughput variation of the CRCN varies with changes in the parameters as depicted in Eq. (3). Fig. 5
                         illustrates the variations in the throughput of the operating CRs across different active transmitters. For the current simulation result, we randomly select the PU activity (0.1–0.5) on different channels and carry out the simulation results for 500 iterations. For a detailed analysis, we plot the line graph for three different cases by varying the external noise and channel gains given in Eqs. (2) and (3). It is clear from the experimental result that the average data rate/slot/channel decreases with the increase of the active CRs at a particular time instant. For example, when there are only 20 active CRs in CRCN, the data rate is almost double than the average data rate/slot/channel with the 60 active CRs. The average data rate is reduced 2.4 times when there are 80 active CRs.

As mentioned earlier, the nature of a radio channel in CRCN varies significantly across channel bandwidth and capacity. In addition, the idle/busy state of a channel varies with respect to the PU arrival activity. Therefore, it is extremely important for the allocation scheme to consider quality and occupancy parameters of a channel for optimal allocation. The fixed size framing process (FSFP) cannot cater with the capacity variations of the channel in CRCN and cannot meet the high throughput demands in the case of video transmission. Thus, we introduce the concept of TVFP for CRCN at the MAC layer. At particular time instant, the size of data frame is proportional to the available data capacity of the respective channel.


                        Fig. 6
                         illustrates the concept of TVFP and compares its effectiveness with FSFP. We compute the time for the transmission of 200kB data which is generated by 20 different CRs. The TVFP serves the CRs in considerably less amount of time as compared to FSFP. For example, the TVFP quickly serves the CRs in 2.2 to 3.2 times quickly as compared to the to the MAC frame with constant frame size of 1.5kilobits (kb) and 2.5kb respectively. For other cases, the performance of the TVFP is equally good. Hence, the proposed TVFP provides quick service to the CRs to support their data transmission.

This section shows the comparison of our proposed PUBA scheme with the max- min fairness scheme (MFS) given in [20]. Although the PUBA scheme can perform better than many of the existing channel selection and allocation schemes, we compare it with MFS to illustrate the effectiveness of our scheme. The procedure of the channel selection based on the PU history makes our scheme substantially more effective than the existing schemes that simply allocate the available spectrum without incorporating PU effects. To quantify the performance of our proposed scheme, we perform comparisons using four important factors as discussed below.

In this section, we show the comparison in terms of the collisions with the PU. The results are simulated for 500 iterations to compute the average arrival rate of the PU on 20 different channels allocated to 20 active CRs. The arrival rate of the PU on the channels selected through PUBA is considerably less as compared to the MFS scheme and it is achieved through the management of the PU activity. We plot the normalized collision rate with PU by varying PU activity from 5% to 50% on different channels. As the PUBA scheme incorporates the PU activity, it selects the best channels (stable /low switching probability) in terms of the least PU activity. Moreover, the spectrum handover unit in Fig. 3 further adds the intelligence to avoid the interference by evicting/switching CRs from the channel on the unexpected arrival (middle of slot) of the PU. Hence, the history management and spectrum handover components significantly reduce the overall collision probability.


                           Fig. 7
                            compares the proposed scheme with the MFS based on the normalized collision rate and it shows very low collision probability in the case of the PUBA scheme. For example, on 20% and 50% PU activity, the proposed scheme shows a collision rate 3 times less than the MFS. The performance of the proposed scheme is equally good for the other concentrations of the PUs. Thus, the PUBA scheme is also suitable for those portions of spectrum bands where the PU activity is highly unpredictable as it allows the CRs to operate on the stable (least PU activity) channels.

This section evaluates the performance of the PUBA scheme in comparison with the MFS scheme based on the total time slots consumed for the data transmission of CRs. Fig. 8
                            illustrates the average service time for the transmission of different file sizes ranging from 50KB to 250KB for two different percentages of PU activity (i.e 25% and 45%). It is clear from the comparison of the two graphs that it takes longer to serve the user on higher PU activity channels. This is due to the fact that higher PU activity channels require channel switching which causes extra delay for the channel switching and sensing operations depicted in Eq. (1) and discussed in regards to Fig. 3.

To compare the PUBA with MFS, consider the cases of 150KB, 250KB data and 25% PU activity, the MFS scheme takes 2.5, 2.7 times higher time to service the entire CRs respectively. Similarly, the performance of the proposed scheme is equally good for the rest of cases. Hence, the proposed scheme is efficient in providing quick service to CRs. It is clearly visible through the bar graph in Fig. 7 that the PUBA scheme serves all CRs in considerably less time compared to the MFS scheme.

The third important parameter for the comparison is transmission power. We consider the twenty CR users with total data of 200KB. We perform 500 iterations and the average data rate/slot/channel is 3.9845 Kbps. The rest of the parameter settings are the same. We assume that 1 kilowatt (KW) power is required to transmit 1KB of data. Moreover, we consider that 500mW is consumed during channel switching task (in case of collisions with the PU). Also, the sensing operation is performed after each collision, which consumes 100watts/sensing instant. We vary the PU activity from 5% to 50% and present the average power consumption.

It is clearly visible through the line chart in Fig. 9
                            that the PUBA scheme consumes a considerably small amount of transmission power compared to the MFS scheme. For the PUBA scheme, the power consumption is extremely low when the PU activity is less than 20%. However, when the PU activity goes beyond 20%, the power consumption shows increasing behavior in an exponential manner. To compare with MFS, consider cases of 25% and 40% PU activity, the proposed schemes shows 37% and 63.7% lower power consumption compared to the MFS scheme. Hence, the proposed scheme is equally good for power sensitive applications such as cognitive radio sensor networks.

The final comparison factor is the average system throughput which is the time average of the throughput of all active CRs. There are two noticeable things in the given result. Firstly, the systems throughput increases with the increase in the number of available channels. The throughput of the system increases 60% when the available channels increase from 40 to 100. Secondly, the proposed scheme provides on average 70% higher throughput compared to the MFS (see Fig. 10
                           ).

@&#CONCLUSION@&#

A proportional fair oriented channel allocation scheme is developed to share the best channels among competing CRs. The incorporation of the PU activity and TVFP can greatly improve the system performance in terms of capacity and stability. Simulation results demonstrate that the proposed TVFP is up to 3-times quicker in data transmission compared to the fix-sized MAC layer packets. This is achieved through the process of dynamically resizing the frames based on the instantaneous capacity of the channels. Results also revealed that the proposed scheme provides stable channels to the CRs where the collision probability is 1/3 compared to the MFS. This is accomplished through the channel ranking mechanism which explicitly incorporates PU’s prior channel usage statistics.

Specifically talking from the perspective of the average service time, the proposed scheme allows the CRs to complete their transmission 2.5 times quicker as compared to the MMF scheme. From the power saving perspective, the PUBA scheme consumes up to 63% lower power compared to the MFS scheme. Moreover, the outcomes of the proposed scheme suggest that it offers 70% higher system throughput in contrast with the MFS scheme. Hence, the proposed PUBA scheme efficiently meets the minimal QoS criteria for CR users.

@&#ACKNOWLEDGEMENTS@&#

This research was supported by the MSIP (Ministry of Science, ICT & Future Planning), Korea, under CITRC (Convergence Information Technology Research Center) support program (NIPA-2014-H0401-14-1006) supervised by the NIPA (National IT Industry Promotion Agency) and the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Science and Technology (2012009449).

@&#REFERENCES@&#

